2025-11-16 18:52:14,739 - __main__ - INFO - ================================================================================
2025-11-16 18:52:14,740 - __main__ - INFO - D…BUT DE L'ENTRAŒNEMENT DU MOD»LE XGBOOST
2025-11-16 18:52:14,740 - __main__ - INFO - ================================================================================
2025-11-16 18:52:14,759 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-16 18:52:14,759 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/clustering_results.csv', 'indicateurs_path': '../data/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': '/results/models'}
2025-11-16 18:52:14,760 - __main__ - INFO - Chargement des donnÈes...
2025-11-16 18:52:14,796 - __main__ - INFO - Clusters chargÈs: (1415, 65)
2025-11-16 18:52:14,877 - __main__ - INFO - Indicateurs chargÈs: (86315, 15)
2025-11-16 18:52:14,877 - __main__ - INFO - PrÈparation des donnÈes...
2025-11-16 18:52:14,941 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-16 18:52:14,944 - __main__ - INFO - DataFrame fusionnÈ: (1415, 126)
2025-11-16 18:52:15,746 - __main__ - INFO - Features PM ajoutÈes: (1415, 133)
2025-11-16 18:52:15,750 - __main__ - INFO - CrÈation des features et target...
2025-11-16 18:52:15,750 - __main__ - INFO - Nombre de features: 64
2025-11-16 18:52:15,753 - __main__ - INFO - X shape: (1415, 64), y shape: (1415,)
2025-11-16 18:52:15,753 - __main__ - INFO - EntraÓnement du modËle XGBoost...
2025-11-16 18:52:15,758 - __main__ - INFO - Train: (1132, 64), Test: (283, 64)
2025-11-16 18:52:18,109 - __main__ - INFO - ModËle entraÓnÈ avec succËs
2025-11-16 18:52:18,132 - __main__ - INFO - …valuation du modËle...
2025-11-16 18:52:19,829 - __main__ - INFO - Sauvegarde locale du modËle dans /results/models...
2025-11-16 18:52:19,878 - __main__ - INFO - Sauvegarde dans Azure Blob Storage (container: prediction-demande)...
2025-11-16 18:52:19,912 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://airm.blob.core.windows.net/prediction-demande?restype=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.26.0 Python/3.13.9 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ff56c7cc-c314-11f0-8599-40c73c3d51f2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-11-16 18:52:20,499 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 404
Response headers:
    'Content-Length': '225'
    'Content-Type': 'application/xml'
    'Vary': 'REDACTED'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '6752758d-401e-007e-8021-571e46000000'
    'x-ms-client-request-id': 'ff56c7cc-c314-11f0-8599-40c73c3d51f2'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'ContainerNotFound'
    'Date': 'Sun, 16 Nov 2025 17:52:20 GMT'
2025-11-16 18:52:20,501 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://airm.blob.core.windows.net/prediction-demande?restype=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.26.0 Python/3.13.9 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ffb09465-c314-11f0-9c73-40c73c3d51f2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-11-16 18:52:20,520 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 16 Nov 2025 17:52:20 GMT'
    'ETag': '"0x8DE2538E40FA941"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '6752759c-401e-007e-0c21-571e46000000'
    'x-ms-client-request-id': 'ffb09465-c314-11f0-9c73-40c73c3d51f2'
    'x-ms-version': 'REDACTED'
    'Date': 'Sun, 16 Nov 2025 17:52:20 GMT'
2025-11-16 18:52:20,521 - __main__ - INFO - Container prediction-demande crÈÈ
2025-11-16 18:52:20,526 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://airm.blob.core.windows.net/prediction-demande/models/20251116_185220/xgb_to_predictor.joblib'
Request method: 'PUT'
Request headers:
    'Content-Length': '2605191'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.26.0 Python/3.13.9 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ffb46350-c314-11f0-ad94-40c73c3d51f2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-11-16 18:52:20,960 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Sun, 16 Nov 2025 17:52:21 GMT'
    'ETag': '"0x8DE2538E4536008"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '675275a6-401e-007e-1521-571e46000000'
    'x-ms-client-request-id': 'ffb46350-c314-11f0-ad94-40c73c3d51f2'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Sun, 16 Nov 2025 17:52:21 GMT'
2025-11-16 18:52:20,965 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://airm.blob.core.windows.net/prediction-demande/models/20251116_185220/xgb_scaler.joblib'
Request method: 'PUT'
Request headers:
    'Content-Length': '2919'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.26.0 Python/3.13.9 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'fff7729b-c314-11f0-badd-40c73c3d51f2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-11-16 18:52:20,979 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Sun, 16 Nov 2025 17:52:21 GMT'
    'ETag': '"0x8DE2538E456DE96"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '67527631-401e-007e-0d21-571e46000000'
    'x-ms-client-request-id': 'fff7729b-c314-11f0-badd-40c73c3d51f2'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Sun, 16 Nov 2025 17:52:21 GMT'
2025-11-16 18:52:20,985 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://airm.blob.core.windows.net/prediction-demande/models/20251116_185220/feature_columns.txt'
Request method: 'PUT'
Request headers:
    'Content-Length': '454'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.26.0 Python/3.13.9 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'fffa693d-c314-11f0-9ed7-40c73c3d51f2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-11-16 18:52:21,001 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Sun, 16 Nov 2025 17:52:21 GMT'
    'ETag': '"0x8DE2538E459E862"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '67527643-401e-007e-1e21-571e46000000'
    'x-ms-client-request-id': 'fffa693d-c314-11f0-9ed7-40c73c3d51f2'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Sun, 16 Nov 2025 17:52:21 GMT'
2025-11-16 18:52:21,006 - __main__ - INFO - ================================================================================
2025-11-16 18:52:21,008 - __main__ - INFO - ================================================================================
2025-11-16 18:52:21,009 - __main__ - INFO -    Train MAE: 0.0005
2025-11-16 18:52:21,009 - __main__ - INFO -    Train R≤:  1.0000
2025-11-16 18:52:21,009 - __main__ - INFO -    Test MAE:  0.0560
2025-11-16 18:52:21,009 - __main__ - INFO -    Test R≤:   0.8265
2025-11-16 18:54:22,719 - __main__ - INFO - ================================================================================
2025-11-16 18:54:22,719 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-16 18:54:22,719 - __main__ - INFO - ================================================================================
2025-11-16 18:54:22,720 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-16 18:54:22,720 - __main__ - INFO - ‚ÑπÔ∏è  Utilisation de la configuration par d√©faut
2025-11-16 18:54:22,720 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-16 18:54:22,720 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/clustering_results.csv', 'indicateurs_path': '../data/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': '/results/models'}
2025-11-16 18:54:22,720 - __main__ - INFO - Chargement des donn√©es...
2025-11-16 18:54:22,748 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-16 18:54:22,836 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-16 18:54:22,837 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-16 18:54:22,896 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-16 18:54:22,901 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-16 18:54:23,849 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-16 18:54:23,852 - __main__ - INFO - Cr√©ation des features et target...
2025-11-16 18:54:23,852 - __main__ - INFO - Nombre de features: 64
2025-11-16 18:54:23,856 - __main__ - INFO - X shape: (1415, 64), y shape: (1415,)
2025-11-16 18:54:23,856 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-16 18:54:23,861 - __main__ - INFO - Train: (1132, 64), Test: (283, 64)
2025-11-16 18:54:27,775 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-16 18:54:27,795 - __main__ - INFO - üìä Test MAE: 0.0560
2025-11-16 18:54:27,795 - __main__ - INFO - üìä Test R¬≤: 0.8265
2025-11-16 18:54:27,796 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-16 18:54:28,710 - __main__ - INFO - üìà Graphique sauvegard√©: /results/xgb_scatter_plot.png
2025-11-16 18:54:29,268 - __main__ - INFO - üìà Graphique sauvegard√©: /results/xgb_feature_importance.png
2025-11-16 18:54:29,281 - __main__ - INFO - Sauvegarde locale du mod√®le dans /results/models...
2025-11-16 18:54:29,330 - __main__ - INFO - üíæ Mod√®le sauvegard√©: /results/models\xgb_to_predictor.joblib
2025-11-16 18:54:29,331 - __main__ - INFO - üíæ Scaler sauvegard√©: /results/models\xgb_scaler.joblib
2025-11-16 18:54:29,331 - __main__ - INFO - üíæ Features sauvegard√©es: /results/models\feature_columns.txt
2025-11-16 18:54:29,331 - __main__ - INFO - Sauvegarde dans Azure Blob Storage (container: prediction-demande)...
2025-11-16 18:54:29,385 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://airm.blob.core.windows.net/prediction-demande?restype=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.26.0 Python/3.13.9 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '4c82b285-c315-11f0-8e23-40c73c3d51f2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-11-16 18:54:29,947 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 16 Nov 2025 17:52:20 GMT'
    'ETag': '"0x8DE2538E40FA941"'
    'Vary': 'REDACTED'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '40dfab5d-d01e-0072-4722-578fe9000000'
    'x-ms-client-request-id': '4c82b285-c315-11f0-8e23-40c73c3d51f2'
    'x-ms-version': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-has-immutability-policy': 'REDACTED'
    'x-ms-has-legal-hold': 'REDACTED'
    'x-ms-immutable-storage-with-versioning-enabled': 'REDACTED'
    'x-ms-default-encryption-scope': 'REDACTED'
    'x-ms-deny-encryption-scope-override': 'REDACTED'
    'Date': 'Sun, 16 Nov 2025 17:54:29 GMT'
2025-11-16 18:54:29,951 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://airm.blob.core.windows.net/prediction-demande/models/20251116_185429/xgb_to_predictor.joblib'
Request method: 'PUT'
Request headers:
    'Content-Length': '2605191'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.26.0 Python/3.13.9 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '4cd9305e-c315-11f0-9665-40c73c3d51f2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-11-16 18:54:30,528 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Sun, 16 Nov 2025 17:54:30 GMT'
    'ETag': '"0x8DE2539318E01BD"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '40dfab67-d01e-0072-4f22-578fe9000000'
    'x-ms-client-request-id': '4cd9305e-c315-11f0-9665-40c73c3d51f2'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Sun, 16 Nov 2025 17:54:30 GMT'
2025-11-16 18:54:30,529 - __main__ - INFO - ‚òÅÔ∏è Fichier upload√©: models/20251116_185429/xgb_to_predictor.joblib
2025-11-16 18:54:30,531 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://airm.blob.core.windows.net/prediction-demande/models/20251116_185429/xgb_scaler.joblib'
Request method: 'PUT'
Request headers:
    'Content-Length': '2919'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.26.0 Python/3.13.9 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '4d31b503-c315-11f0-86e3-40c73c3d51f2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-11-16 18:54:30,551 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Sun, 16 Nov 2025 17:54:30 GMT'
    'ETag': '"0x8DE253931913280"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '40dfabfa-d01e-0072-5022-578fe9000000'
    'x-ms-client-request-id': '4d31b503-c315-11f0-86e3-40c73c3d51f2'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Sun, 16 Nov 2025 17:54:30 GMT'
2025-11-16 18:54:30,552 - __main__ - INFO - ‚òÅÔ∏è Fichier upload√©: models/20251116_185429/xgb_scaler.joblib
2025-11-16 18:54:30,555 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://airm.blob.core.windows.net/prediction-demande/models/20251116_185429/feature_columns.txt'
Request method: 'PUT'
Request headers:
    'Content-Length': '454'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.26.0 Python/3.13.9 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '4d35374e-c315-11f0-ae22-40c73c3d51f2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-11-16 18:54:30,575 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Sun, 16 Nov 2025 17:54:30 GMT'
    'ETag': '"0x8DE25393194B107"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '40dfac01-d01e-0072-5722-578fe9000000'
    'x-ms-client-request-id': '4d35374e-c315-11f0-ae22-40c73c3d51f2'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Sun, 16 Nov 2025 17:54:30 GMT'
2025-11-16 18:54:30,576 - __main__ - INFO - ‚òÅÔ∏è Fichier upload√©: models/20251116_185429/feature_columns.txt
2025-11-16 18:54:30,576 - __main__ - INFO - ‚úÖ Sauvegarde Azure termin√©e avec succ√®s
2025-11-16 18:54:30,578 - __main__ - INFO - ================================================================================
2025-11-16 18:54:30,578 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-16 18:54:30,578 - __main__ - INFO - ================================================================================
2025-11-16 18:54:30,578 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-16 18:54:30,578 - __main__ - INFO -    Train MAE: 0.0005
2025-11-16 18:54:30,579 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-16 18:54:30,579 - __main__ - INFO -    Test MAE:  0.0560
2025-11-16 18:54:30,579 - __main__ - INFO -    Test R¬≤:   0.8265
2025-11-16 18:56:57,786 - __main__ - INFO - ================================================================================
2025-11-16 18:56:57,786 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-16 18:56:57,786 - __main__ - INFO - ================================================================================
2025-11-16 18:56:57,787 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-16 18:56:57,787 - __main__ - INFO - ‚ÑπÔ∏è  Utilisation de la configuration par d√©faut
2025-11-16 18:56:57,787 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-16 18:56:57,787 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/clustering_results.csv', 'indicateurs_path': '../data/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': '/results/models'}
2025-11-16 18:56:57,787 - __main__ - INFO - Chargement des donn√©es...
2025-11-16 18:56:57,812 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-16 18:56:57,898 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-16 18:56:57,898 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-16 18:56:57,955 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-16 18:56:57,957 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-16 18:56:58,827 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-16 18:56:58,830 - __main__ - INFO - Cr√©ation des features et target...
2025-11-16 18:56:58,830 - __main__ - INFO - Nombre de features: 64
2025-11-16 18:56:58,833 - __main__ - INFO - X shape: (1415, 64), y shape: (1415,)
2025-11-16 18:56:58,833 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-16 18:56:58,836 - __main__ - INFO - Train: (1132, 64), Test: (283, 64)
2025-11-16 18:57:02,036 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-16 18:57:02,052 - __main__ - INFO - üìä Test MAE: 0.0560
2025-11-16 18:57:02,052 - __main__ - INFO - üìä Test R¬≤: 0.8265
2025-11-16 18:57:02,053 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-16 18:57:02,777 - __main__ - INFO - üìà Graphique sauvegard√©: /results/xgb_scatter_plot.png
2025-11-16 18:57:03,145 - __main__ - INFO - üìà Graphique sauvegard√©: /results/xgb_feature_importance.png
2025-11-16 18:57:03,155 - __main__ - INFO - Sauvegarde locale du mod√®le dans /results/models...
2025-11-16 18:57:03,196 - __main__ - INFO - üíæ Mod√®le sauvegard√©: /results/models\xgb_to_predictor.joblib
2025-11-16 18:57:03,196 - __main__ - INFO - üíæ Scaler sauvegard√©: /results/models\xgb_scaler.joblib
2025-11-16 18:57:03,196 - __main__ - INFO - üíæ Features sauvegard√©es: /results/models\feature_columns.txt
2025-11-16 18:57:03,225 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://airm.blob.core.windows.net/prediction-demande?restype=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.26.0 Python/3.13.9 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a834e7cd-c315-11f0-abd8-40c73c3d51f2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-11-16 18:57:03,739 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 16 Nov 2025 17:52:20 GMT'
    'ETag': '"0x8DE2538E40FA941"'
    'Vary': 'REDACTED'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c9e75275-701e-0038-1522-572ac1000000'
    'x-ms-client-request-id': 'a834e7cd-c315-11f0-abd8-40c73c3d51f2'
    'x-ms-version': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-has-immutability-policy': 'REDACTED'
    'x-ms-has-legal-hold': 'REDACTED'
    'x-ms-immutable-storage-with-versioning-enabled': 'REDACTED'
    'x-ms-default-encryption-scope': 'REDACTED'
    'x-ms-deny-encryption-scope-override': 'REDACTED'
    'Date': 'Sun, 16 Nov 2025 17:57:03 GMT'
2025-11-16 18:57:03,742 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://airm.blob.core.windows.net/prediction-demande/models/20251116_185703/xgb_to_predictor.joblib'
Request method: 'PUT'
Request headers:
    'Content-Length': '2605191'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.26.0 Python/3.13.9 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a883caf1-c315-11f0-b173-40c73c3d51f2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-11-16 18:57:04,621 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Sun, 16 Nov 2025 17:57:04 GMT'
    'ETag': '"0x8DE25398D66B6AE"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c9e75280-701e-0038-1c22-572ac1000000'
    'x-ms-client-request-id': 'a883caf1-c315-11f0-b173-40c73c3d51f2'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Sun, 16 Nov 2025 17:57:04 GMT'
2025-11-16 18:57:04,624 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://airm.blob.core.windows.net/prediction-demande/models/20251116_185703/xgb_scaler.joblib'
Request method: 'PUT'
Request headers:
    'Content-Length': '2919'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.26.0 Python/3.13.9 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a90a6984-c315-11f0-9231-40c73c3d51f2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-11-16 18:57:04,640 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Sun, 16 Nov 2025 17:57:04 GMT'
    'ETag': '"0x8DE25398D69E771"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c9e753d9-701e-0038-5222-572ac1000000'
    'x-ms-client-request-id': 'a90a6984-c315-11f0-9231-40c73c3d51f2'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Sun, 16 Nov 2025 17:57:04 GMT'
2025-11-16 18:57:04,642 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://airm.blob.core.windows.net/prediction-demande/models/20251116_185703/feature_columns.txt'
Request method: 'PUT'
Request headers:
    'Content-Length': '454'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.26.0 Python/3.13.9 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a90d2d27-c315-11f0-8dcb-40c73c3d51f2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-11-16 18:57:04,663 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Sun, 16 Nov 2025 17:57:04 GMT'
    'ETag': '"0x8DE25398D6CA382"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c9e753e0-701e-0038-5822-572ac1000000'
    'x-ms-client-request-id': 'a90d2d27-c315-11f0-8dcb-40c73c3d51f2'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Sun, 16 Nov 2025 17:57:04 GMT'
2025-11-16 18:57:04,666 - __main__ - INFO - ================================================================================
2025-11-16 18:57:04,666 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-16 18:57:04,666 - __main__ - INFO - ================================================================================
2025-11-16 18:57:04,667 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-16 18:57:04,667 - __main__ - INFO -    Train MAE: 0.0005
2025-11-16 18:57:04,667 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-16 18:57:04,667 - __main__ - INFO -    Test MAE:  0.0560
2025-11-16 18:57:04,668 - __main__ - INFO -    Test R¬≤:   0.8265
2025-11-16 18:58:05,063 - __main__ - INFO - ================================================================================
2025-11-16 18:58:05,064 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-16 18:58:05,064 - __main__ - INFO - ================================================================================
2025-11-16 18:58:05,064 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-16 18:58:05,065 - __main__ - INFO - ‚ÑπÔ∏è  Utilisation de la configuration par d√©faut
2025-11-16 18:58:05,065 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-16 18:58:05,065 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/clustering_results.csv', 'indicateurs_path': '../data/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': '/results/models'}
2025-11-16 18:58:05,065 - __main__ - INFO - Chargement des donn√©es...
2025-11-16 18:58:05,091 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-16 18:58:05,170 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-16 18:58:05,170 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-16 18:58:05,227 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-16 18:58:05,229 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-16 18:58:06,024 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-16 18:58:06,028 - __main__ - INFO - Cr√©ation des features et target...
2025-11-16 18:58:06,028 - __main__ - INFO - Nombre de features: 64
2025-11-16 18:58:06,030 - __main__ - INFO - X shape: (1415, 64), y shape: (1415,)
2025-11-16 18:58:06,030 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-16 18:58:06,036 - __main__ - INFO - Train: (1132, 64), Test: (283, 64)
2025-11-16 18:58:08,553 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-16 18:58:08,567 - __main__ - INFO - üìä Test MAE: 0.0560
2025-11-16 18:58:08,568 - __main__ - INFO - üìä Test R¬≤: 0.8265
2025-11-16 18:58:08,568 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-16 18:58:09,322 - __main__ - INFO - üìà Graphique sauvegard√©: /results/xgb_scatter_plot.png
2025-11-16 18:58:09,782 - __main__ - INFO - üìà Graphique sauvegard√©: /results/xgb_feature_importance.png
2025-11-16 18:58:09,797 - __main__ - INFO - Sauvegarde locale du mod√®le dans /results/models...
2025-11-16 18:58:09,837 - __main__ - INFO - üíæ Mod√®le sauvegard√©: /results/models\xgb_to_predictor.joblib
2025-11-16 18:58:09,837 - __main__ - INFO - üíæ Scaler sauvegard√©: /results/models\xgb_scaler.joblib
2025-11-16 18:58:09,837 - __main__ - INFO - üíæ Features sauvegard√©es: /results/models\feature_columns.txt
2025-11-16 18:58:11,014 - __main__ - INFO - ================================================================================
2025-11-16 18:58:11,014 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-16 18:58:11,014 - __main__ - INFO - ================================================================================
2025-11-16 18:58:11,015 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-16 18:58:11,015 - __main__ - INFO -    Train MAE: 0.0005
2025-11-16 18:58:11,015 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-16 18:58:11,016 - __main__ - INFO -    Test MAE:  0.0560
2025-11-16 18:58:11,016 - __main__ - INFO -    Test R¬≤:   0.8265
2025-11-16 19:00:32,173 - __main__ - INFO - ================================================================================
2025-11-16 19:00:32,173 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-16 19:00:32,173 - __main__ - INFO - ================================================================================
2025-11-16 19:00:32,173 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-16 19:00:32,174 - __main__ - INFO - ‚ÑπÔ∏è  Utilisation de la configuration par d√©faut
2025-11-16 19:00:32,174 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-16 19:00:32,174 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/clustering_results.csv', 'indicateurs_path': '../data/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/models'}
2025-11-16 19:00:32,174 - __main__ - INFO - Chargement des donn√©es...
2025-11-16 19:00:32,186 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-16 19:00:32,266 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-16 19:00:32,266 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-16 19:00:32,315 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-16 19:00:32,319 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-16 19:00:33,131 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-16 19:00:33,134 - __main__ - INFO - Cr√©ation des features et target...
2025-11-16 19:00:33,135 - __main__ - INFO - Nombre de features: 64
2025-11-16 19:00:33,137 - __main__ - INFO - X shape: (1415, 64), y shape: (1415,)
2025-11-16 19:00:33,137 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-16 19:00:33,142 - __main__ - INFO - Train: (1132, 64), Test: (283, 64)
2025-11-16 19:00:35,899 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-16 19:00:35,915 - __main__ - INFO - üìä Test MAE: 0.0560
2025-11-16 19:00:35,916 - __main__ - INFO - üìä Test R¬≤: 0.8265
2025-11-16 19:00:35,916 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-16 19:00:36,509 - __main__ - INFO - üìà Graphique sauvegard√©: results\xgb_scatter_plot.png
2025-11-16 19:00:36,801 - __main__ - INFO - üìà Graphique sauvegard√©: results\xgb_feature_importance.png
2025-11-16 19:00:36,830 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/models...
2025-11-16 19:00:36,870 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/models\xgb_to_predictor.joblib
2025-11-16 19:00:36,871 - __main__ - INFO - üíæ Scaler sauvegard√©: results/models\xgb_scaler.joblib
2025-11-16 19:00:36,871 - __main__ - INFO - üíæ Features sauvegard√©es: results/models\feature_columns.txt
2025-11-16 19:00:38,265 - __main__ - INFO - ================================================================================
2025-11-16 19:00:38,266 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-16 19:00:38,266 - __main__ - INFO - ================================================================================
2025-11-16 19:00:38,266 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-16 19:00:38,266 - __main__ - INFO -    Train MAE: 0.0005
2025-11-16 19:00:38,267 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-16 19:00:38,267 - __main__ - INFO -    Test MAE:  0.0560
2025-11-16 19:00:38,267 - __main__ - INFO -    Test R¬≤:   0.8265
2025-11-23 16:35:31,375 - __main__ - INFO - ================================================================================
2025-11-23 16:35:31,375 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 16:35:31,376 - __main__ - INFO - ================================================================================
2025-11-23 16:35:31,376 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 16:35:31,376 - __main__ - INFO - ‚ÑπÔ∏è  Module YAML non disponible, utilisation de la config par d√©faut
2025-11-23 16:35:31,376 - __main__ - INFO - ‚ÑπÔ∏è  Utilisation de la configuration par d√©faut
2025-11-23 16:35:31,377 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 16:35:31,377 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/clustering_results.csv', 'indicateurs_path': '../data/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/models'}
2025-11-23 16:35:31,377 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 16:35:31,379 - __main__ - ERROR - Erreur lors du chargement des donn√©es: [Errno 2] No such file or directory: '../results/clustering_results.csv'
2025-11-23 16:35:31,379 - __main__ - ERROR - ‚ùå ERREUR FATALE: [Errno 2] No such file or directory: '../results/clustering_results.csv'
Traceback (most recent call last):
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 704, in main
    clusters, indicateurs = predictor.load_data()
                            ~~~~~~~~~~~~~~~~~~~^^
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 137, in load_data
    clusters = pd.read_csv(
        self.config['clustering_results_path'],
        sep=';'
    )
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\io\parsers\readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\io\parsers\readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\io\parsers\readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\io\parsers\readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ~~~~~~~~~~^
        f,
        ^^
    ...<6 lines>...
        storage_options=self.options.get("storage_options", None),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\io\common.py", line 873, in get_handle
    handle = open(
        handle,
    ...<3 lines>...
        newline="",
    )
FileNotFoundError: [Errno 2] No such file or directory: '../results/clustering_results.csv'
2025-11-23 16:40:44,908 - __main__ - INFO - ================================================================================
2025-11-23 16:40:44,908 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 16:40:44,908 - __main__ - INFO - ================================================================================
2025-11-23 16:40:44,909 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 16:40:44,909 - __main__ - INFO - ‚ÑπÔ∏è  Module YAML non disponible, utilisation de la config par d√©faut
2025-11-23 16:40:44,909 - __main__ - INFO - ‚ÑπÔ∏è  Utilisation de la configuration par d√©faut
2025-11-23 16:40:44,909 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 16:40:44,910 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/models'}
2025-11-23 16:40:44,910 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 16:40:44,945 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 16:40:45,038 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 16:40:45,038 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 16:40:45,110 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 16:40:45,113 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 16:40:46,024 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 16:40:46,027 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 16:40:46,027 - __main__ - INFO - Nombre de features: 64
2025-11-23 16:40:46,029 - __main__ - INFO - X shape: (1415, 64), y shape: (1415,)
2025-11-23 16:40:46,029 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 16:40:46,036 - __main__ - INFO - Train: (1132, 64), Test: (283, 64)
2025-11-23 16:40:49,323 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 16:40:49,341 - __main__ - INFO - üìä Test MAE: 0.0521
2025-11-23 16:40:49,341 - __main__ - INFO - üìä Test R¬≤: 0.8316
2025-11-23 16:40:49,342 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 16:40:50,265 - __main__ - INFO - üìà Graphique sauvegard√©: results\xgb_scatter_plot.png
2025-11-23 16:40:50,594 - __main__ - INFO - üìà Graphique sauvegard√©: results\xgb_feature_importance.png
2025-11-23 16:40:50,609 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/models...
2025-11-23 16:40:50,651 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/models\xgb_to_predictor.joblib
2025-11-23 16:40:50,652 - __main__ - INFO - üíæ Scaler sauvegard√©: results/models\xgb_scaler.joblib
2025-11-23 16:40:50,652 - __main__ - INFO - üíæ Features sauvegard√©es: results/models\feature_columns.txt
2025-11-23 16:40:51,972 - __main__ - INFO - ================================================================================
2025-11-23 16:40:51,973 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 16:40:51,973 - __main__ - INFO - ================================================================================
2025-11-23 16:40:51,973 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 16:40:51,973 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 16:40:51,973 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 16:40:51,974 - __main__ - INFO -    Test MAE:  0.0521
2025-11-23 16:40:51,974 - __main__ - INFO -    Test R¬≤:   0.8316
2025-11-23 16:44:55,224 - __main__ - INFO - ================================================================================
2025-11-23 16:44:55,225 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 16:44:55,225 - __main__ - INFO - ================================================================================
2025-11-23 16:44:55,225 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 16:44:55,225 - __main__ - INFO - ‚ÑπÔ∏è  Module YAML non disponible, utilisation de la config par d√©faut
2025-11-23 16:44:55,225 - __main__ - INFO - ‚ÑπÔ∏è  Utilisation de la configuration par d√©faut
2025-11-23 16:44:55,226 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 16:44:55,226 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/models'}
2025-11-23 16:44:55,226 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 16:44:55,245 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 16:44:55,337 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 16:44:55,338 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 16:44:55,401 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 16:44:55,405 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 16:44:56,654 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 16:44:56,656 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 16:44:56,657 - __main__ - INFO - Nombre de features: 64
2025-11-23 16:44:56,658 - __main__ - INFO - X shape: (1415, 64), y shape: (1415,)
2025-11-23 16:44:56,659 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 16:44:56,664 - __main__ - INFO - Train: (1132, 64), Test: (283, 64)
2025-11-23 16:44:59,895 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 16:44:59,912 - __main__ - INFO - üìä Test MAE: 0.0521
2025-11-23 16:44:59,913 - __main__ - INFO - üìä Test R¬≤: 0.8316
2025-11-23 16:44:59,913 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 16:45:00,476 - __main__ - INFO - üìà Graphique sauvegard√©: results\xgb_scatter_plot.png
2025-11-23 16:45:00,934 - __main__ - INFO - üìà Graphique sauvegard√©: results\xgb_feature_importance.png
2025-11-23 16:45:00,953 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/models...
2025-11-23 16:45:00,995 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/models\xgb_to_predictor.joblib
2025-11-23 16:45:00,995 - __main__ - INFO - üíæ Scaler sauvegard√©: results/models\xgb_scaler.joblib
2025-11-23 16:45:00,995 - __main__ - INFO - üíæ Features sauvegard√©es: results/models\feature_columns.txt
2025-11-23 16:45:02,464 - __main__ - INFO - ================================================================================
2025-11-23 16:45:02,464 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 16:45:02,464 - __main__ - INFO - ================================================================================
2025-11-23 16:45:02,464 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 16:45:02,465 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 16:45:02,465 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 16:45:02,465 - __main__ - INFO -    Test MAE:  0.0521
2025-11-23 16:45:02,465 - __main__ - INFO -    Test R¬≤:   0.8316
2025-11-23 16:48:08,657 - __main__ - INFO - ================================================================================
2025-11-23 16:48:08,657 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 16:48:08,657 - __main__ - INFO - ================================================================================
2025-11-23 16:48:08,658 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 16:48:08,658 - __main__ - INFO - ‚ÑπÔ∏è  Module YAML non disponible, utilisation de la config par d√©faut
2025-11-23 16:48:08,658 - __main__ - INFO - ‚ÑπÔ∏è  Utilisation de la configuration par d√©faut
2025-11-23 16:48:08,658 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 16:48:08,658 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/models'}
2025-11-23 16:48:08,659 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 16:48:08,677 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 16:48:08,768 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 16:48:08,768 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 16:48:08,826 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 16:48:08,829 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 16:48:10,017 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 16:48:10,022 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 16:48:10,023 - __main__ - INFO - Nombre de features: 64
2025-11-23 16:48:10,027 - __main__ - INFO - X shape: (1415, 64), y shape: (1415,)
2025-11-23 16:48:10,027 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 16:48:10,034 - __main__ - INFO - Train: (1132, 64), Test: (283, 64)
2025-11-23 16:48:14,013 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 16:48:14,027 - __main__ - INFO - üìä Test MAE: 0.0521
2025-11-23 16:48:14,027 - __main__ - INFO - üìä Test R¬≤: 0.8316
2025-11-23 16:48:14,027 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 16:48:14,430 - __main__ - INFO - üìà Graphique sauvegard√©: results\xgb_scatter_plot.png
2025-11-23 16:48:14,709 - __main__ - INFO - üìà Graphique sauvegard√©: results\xgb_feature_importance.png
2025-11-23 16:48:14,719 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/models...
2025-11-23 16:48:14,757 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/models\xgb_to_predictor.joblib
2025-11-23 16:48:14,757 - __main__ - INFO - üíæ Scaler sauvegard√©: results/models\xgb_scaler.joblib
2025-11-23 16:48:14,757 - __main__ - INFO - üíæ Features sauvegard√©es: results/models\feature_columns.txt
2025-11-23 16:48:15,988 - __main__ - INFO - ================================================================================
2025-11-23 16:48:15,989 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 16:48:15,989 - __main__ - INFO - ================================================================================
2025-11-23 16:48:15,989 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 16:48:15,989 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 16:48:15,989 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 16:48:15,989 - __main__ - INFO -    Test MAE:  0.0521
2025-11-23 16:48:15,990 - __main__ - INFO -    Test R¬≤:   0.8316
2025-11-23 16:49:56,561 - __main__ - INFO - ================================================================================
2025-11-23 16:49:56,562 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 16:49:56,562 - __main__ - INFO - ================================================================================
2025-11-23 16:49:56,562 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 16:49:56,562 - __main__ - INFO - ‚ÑπÔ∏è  Module YAML non disponible, utilisation de la config par d√©faut
2025-11-23 16:49:56,562 - __main__ - INFO - ‚ÑπÔ∏è  Utilisation de la configuration par d√©faut
2025-11-23 16:49:56,563 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 16:49:56,563 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models'}
2025-11-23 16:49:56,563 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 16:49:56,578 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 16:49:56,656 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 16:49:56,657 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 16:49:56,702 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 16:49:56,705 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 16:49:57,486 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 16:49:57,489 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 16:49:57,489 - __main__ - INFO - Nombre de features: 64
2025-11-23 16:49:57,491 - __main__ - INFO - X shape: (1415, 64), y shape: (1415,)
2025-11-23 16:49:57,491 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 16:49:57,498 - __main__ - INFO - Train: (1132, 64), Test: (283, 64)
2025-11-23 16:50:00,469 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 16:50:00,485 - __main__ - INFO - üìä Test MAE: 0.0521
2025-11-23 16:50:00,486 - __main__ - INFO - üìä Test R¬≤: 0.8316
2025-11-23 16:50:00,486 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 16:50:00,966 - __main__ - INFO - üìà Graphique sauvegard√©: results\xgb_scatter_plot.png
2025-11-23 16:50:01,345 - __main__ - INFO - üìà Graphique sauvegard√©: results\xgb_feature_importance.png
2025-11-23 16:50:01,358 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-23 16:50:01,433 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-23 16:50:01,433 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-23 16:50:01,433 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-23 16:50:02,539 - __main__ - INFO - ================================================================================
2025-11-23 16:50:02,540 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 16:50:02,540 - __main__ - INFO - ================================================================================
2025-11-23 16:50:02,540 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 16:50:02,540 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 16:50:02,541 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 16:50:02,541 - __main__ - INFO -    Test MAE:  0.0521
2025-11-23 16:50:02,541 - __main__ - INFO -    Test R¬≤:   0.8316
2025-11-23 16:54:14,161 - __main__ - INFO - ================================================================================
2025-11-23 16:54:14,161 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 16:54:14,161 - __main__ - INFO - ================================================================================
2025-11-23 16:54:14,162 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 16:54:14,162 - __main__ - INFO - ‚ÑπÔ∏è  Module YAML non disponible, utilisation de la config par d√©faut
2025-11-23 16:54:14,162 - __main__ - INFO - ‚ÑπÔ∏è  Utilisation de la configuration par d√©faut
2025-11-23 16:54:14,162 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 16:54:14,162 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models'}
2025-11-23 16:54:14,163 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 16:54:14,177 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 16:54:14,251 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 16:54:14,251 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 16:54:14,304 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 16:54:14,307 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 16:54:15,162 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 16:54:15,165 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 16:54:15,165 - __main__ - INFO - Nombre de features: 64
2025-11-23 16:54:15,168 - __main__ - INFO - X shape: (1415, 64), y shape: (1415,)
2025-11-23 16:54:15,168 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 16:54:15,174 - __main__ - INFO - Train: (1132, 64), Test: (283, 64)
2025-11-23 16:54:18,270 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 16:54:18,286 - __main__ - INFO - üìä Test MAE: 0.0521
2025-11-23 16:54:18,286 - __main__ - INFO - üìä Test R¬≤: 0.8316
2025-11-23 16:54:18,287 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 16:54:18,787 - __main__ - INFO - üìà Graphique sauvegard√©: results\xgb_scatter_plot.png
2025-11-23 16:54:19,209 - __main__ - INFO - üìà Graphique sauvegard√©: results\xgb_feature_importance.png
2025-11-23 16:54:19,221 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-23 16:54:19,260 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-23 16:54:19,261 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-23 16:54:19,261 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-23 16:54:20,466 - __main__ - INFO - ================================================================================
2025-11-23 16:54:20,467 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 16:54:20,467 - __main__ - INFO - ================================================================================
2025-11-23 16:54:20,467 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 16:54:20,468 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 16:54:20,468 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 16:54:20,468 - __main__ - INFO -    Test MAE:  0.0521
2025-11-23 16:54:20,468 - __main__ - INFO -    Test R¬≤:   0.8316
2025-11-23 16:54:52,380 - __main__ - INFO - ================================================================================
2025-11-23 16:54:52,380 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 16:54:52,380 - __main__ - INFO - ================================================================================
2025-11-23 16:54:52,381 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 16:54:52,381 - __main__ - INFO - ‚ÑπÔ∏è  Module YAML non disponible, utilisation de la config par d√©faut
2025-11-23 16:54:52,381 - __main__ - INFO - ‚ÑπÔ∏è  Utilisation de la configuration par d√©faut
2025-11-23 16:54:52,381 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 16:54:52,381 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models'}
2025-11-23 16:54:52,382 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 16:54:52,395 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 16:54:52,474 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 16:54:52,474 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 16:54:52,520 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 16:54:52,523 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 16:54:53,302 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 16:54:53,305 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 16:54:53,306 - __main__ - INFO - Nombre de features: 64
2025-11-23 16:54:53,309 - __main__ - INFO - X shape: (1415, 64), y shape: (1415,)
2025-11-23 16:54:53,309 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 16:54:53,317 - __main__ - INFO - Train: (1132, 64), Test: (283, 64)
2025-11-23 16:54:56,078 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 16:54:56,092 - __main__ - INFO - üìä Test MAE: 0.0521
2025-11-23 16:54:56,093 - __main__ - INFO - üìä Test R¬≤: 0.8316
2025-11-23 16:54:56,093 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 16:54:56,545 - __main__ - INFO - üìà Graphique sauvegard√©: results\xgb_scatter_plot.png
2025-11-23 16:54:56,875 - __main__ - INFO - üìà Graphique sauvegard√©: results\xgb_feature_importance.png
2025-11-23 16:54:56,888 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-23 16:54:56,926 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-23 16:54:56,926 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-23 16:54:56,926 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-23 16:54:58,049 - __main__ - INFO - ================================================================================
2025-11-23 16:54:58,049 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 16:54:58,050 - __main__ - INFO - ================================================================================
2025-11-23 16:54:58,050 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 16:54:58,050 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 16:54:58,050 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 16:54:58,050 - __main__ - INFO -    Test MAE:  0.0521
2025-11-23 16:54:58,051 - __main__ - INFO -    Test R¬≤:   0.8316
2025-11-23 16:56:48,761 - __main__ - INFO - ================================================================================
2025-11-23 16:56:48,761 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 16:56:48,761 - __main__ - INFO - ================================================================================
2025-11-23 16:56:48,762 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 16:56:48,762 - __main__ - INFO - ‚ÑπÔ∏è  Module YAML non disponible, utilisation de la config par d√©faut
2025-11-23 16:56:48,762 - __main__ - INFO - ‚ÑπÔ∏è  Utilisation de la configuration par d√©faut
2025-11-23 16:56:48,762 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 16:56:48,762 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models'}
2025-11-23 16:56:48,763 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 16:56:48,782 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 16:56:48,867 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 16:56:48,867 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 16:56:48,921 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 16:56:48,924 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 16:56:49,762 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 16:56:49,767 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 16:56:49,767 - __main__ - INFO - Nombre de features: 64
2025-11-23 16:56:49,770 - __main__ - INFO - X shape: (1415, 64), y shape: (1415,)
2025-11-23 16:56:49,770 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 16:56:49,776 - __main__ - INFO - Train: (1132, 64), Test: (283, 64)
2025-11-23 16:56:52,688 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 16:56:52,705 - __main__ - INFO - üìä Test MAE: 0.0521
2025-11-23 16:56:52,705 - __main__ - INFO - üìä Test R¬≤: 0.8316
2025-11-23 16:56:52,705 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 16:56:53,180 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-23 16:56:53,562 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-23 16:56:53,576 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-23 16:56:53,611 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-23 16:56:53,611 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-23 16:56:53,611 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-23 16:56:55,093 - __main__ - INFO - ================================================================================
2025-11-23 16:56:55,093 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 16:56:55,093 - __main__ - INFO - ================================================================================
2025-11-23 16:56:55,093 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 16:56:55,093 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 16:56:55,094 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 16:56:55,094 - __main__ - INFO -    Test MAE:  0.0521
2025-11-23 16:56:55,094 - __main__ - INFO -    Test R¬≤:   0.8316
2025-11-23 16:57:40,883 - __main__ - INFO - ================================================================================
2025-11-23 16:57:40,883 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 16:57:40,884 - __main__ - INFO - ================================================================================
2025-11-23 16:57:40,884 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 16:57:40,884 - __main__ - INFO - ‚ÑπÔ∏è  Module YAML non disponible, utilisation de la config par d√©faut
2025-11-23 16:57:40,884 - __main__ - INFO - ‚ÑπÔ∏è  Utilisation de la configuration par d√©faut
2025-11-23 16:57:40,884 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 16:57:40,884 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models'}
2025-11-23 16:57:40,885 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 16:57:40,901 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 16:57:40,977 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 16:57:40,977 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 16:57:41,022 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 16:57:41,026 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 16:57:41,823 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 16:57:41,825 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 16:57:41,826 - __main__ - INFO - Nombre de features: 64
2025-11-23 16:57:41,828 - __main__ - INFO - X shape: (1415, 64), y shape: (1415,)
2025-11-23 16:57:41,828 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 16:57:41,833 - __main__ - INFO - Train: (1132, 64), Test: (283, 64)
2025-11-23 16:57:44,513 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 16:57:44,527 - __main__ - INFO - üìä Test MAE: 0.0521
2025-11-23 16:57:44,527 - __main__ - INFO - üìä Test R¬≤: 0.8316
2025-11-23 16:57:44,527 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 16:57:44,961 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-23 16:57:45,274 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-23 16:57:45,291 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-23 16:57:45,326 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-23 16:57:45,326 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-23 16:57:45,326 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-23 16:57:46,494 - __main__ - INFO - ================================================================================
2025-11-23 16:57:46,494 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 16:57:46,494 - __main__ - INFO - ================================================================================
2025-11-23 16:57:46,494 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 16:57:46,494 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 16:57:46,495 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 16:57:46,495 - __main__ - INFO -    Test MAE:  0.0521
2025-11-23 16:57:46,495 - __main__ - INFO -    Test R¬≤:   0.8316
2025-11-23 17:00:01,010 - __main__ - INFO - ================================================================================
2025-11-23 17:00:01,010 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 17:00:01,010 - __main__ - INFO - ================================================================================
2025-11-23 17:00:01,010 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 17:00:01,011 - __main__ - INFO - ‚ÑπÔ∏è  Module YAML non disponible, utilisation de la config par d√©faut
2025-11-23 17:00:01,011 - __main__ - INFO - ‚ÑπÔ∏è  Utilisation de la configuration par d√©faut
2025-11-23 17:00:01,011 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 17:00:01,011 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models'}
2025-11-23 17:00:01,011 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 17:00:01,035 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 17:00:01,114 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 17:00:01,114 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 17:00:01,181 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 17:00:01,183 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 17:00:02,096 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 17:00:02,099 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 17:00:02,100 - __main__ - INFO - --------------------------------
2025-11-23 17:00:02,100 - __main__ - INFO - Horizon: 7
2025-11-23 17:00:02,100 - __main__ - INFO - --------------------------------
2025-11-23 17:00:02,100 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'pm_J-60', 'pm_mean', 'pm_slope', 'pm_volatility', 'pm_diff_sum',
       'pm_change_ratio', 'pm_last_jump', 'pm_trend_changes', 'month',
       'dayofweek'],
      dtype='object', length=135)
2025-11-23 17:00:02,101 - __main__ - INFO - Nombre de features: 64
2025-11-23 17:00:02,104 - __main__ - INFO - X shape: (1415, 64), y shape: (1415,)
2025-11-23 17:00:02,105 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 17:00:02,112 - __main__ - INFO - Train: (1132, 64), Test: (283, 64)
2025-11-23 17:00:05,039 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 17:00:05,053 - __main__ - INFO - üìä Test MAE: 0.0521
2025-11-23 17:00:05,053 - __main__ - INFO - üìä Test R¬≤: 0.8316
2025-11-23 17:00:05,054 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 17:00:05,467 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-23 17:00:05,835 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-23 17:00:05,852 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-23 17:00:05,891 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-23 17:00:05,891 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-23 17:00:05,891 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-23 17:00:07,058 - __main__ - INFO - ================================================================================
2025-11-23 17:00:07,059 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 17:00:07,059 - __main__ - INFO - ================================================================================
2025-11-23 17:00:07,059 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 17:00:07,059 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 17:00:07,060 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 17:00:07,060 - __main__ - INFO -    Test MAE:  0.0521
2025-11-23 17:00:07,060 - __main__ - INFO -    Test R¬≤:   0.8316
2025-11-23 17:03:01,224 - __main__ - INFO - ================================================================================
2025-11-23 17:03:01,225 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 17:03:01,225 - __main__ - INFO - ================================================================================
2025-11-23 17:03:01,225 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 17:03:01,226 - __main__ - INFO - ‚ÑπÔ∏è  Module YAML non disponible, utilisation de la config par d√©faut
2025-11-23 17:03:01,226 - __main__ - INFO - ‚ÑπÔ∏è  Utilisation de la configuration par d√©faut
2025-11-23 17:03:01,226 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 17:03:01,226 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models'}
2025-11-23 17:03:01,226 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 17:03:01,246 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 17:03:01,342 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 17:03:01,342 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 17:03:01,403 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 17:03:01,405 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 17:03:02,546 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 17:03:02,549 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 17:03:02,550 - __main__ - INFO - --------------------------------
2025-11-23 17:03:02,550 - __main__ - INFO - Horizon: 7
2025-11-23 17:03:02,550 - __main__ - INFO - --------------------------------
2025-11-23 17:03:02,550 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'pm_J-60', 'pm_mean', 'pm_slope', 'pm_volatility', 'pm_diff_sum',
       'pm_change_ratio', 'pm_last_jump', 'pm_trend_changes', 'month',
       'dayofweek'],
      dtype='object', length=135)
2025-11-23 17:03:02,551 - __main__ - INFO - Nombre de features: 64
2025-11-23 17:03:02,554 - __main__ - INFO - X shape: (1415, 64), y shape: (1415,)
2025-11-23 17:03:02,554 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 17:03:02,561 - __main__ - INFO - Train: (1132, 64), Test: (283, 64)
2025-11-23 17:03:05,985 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 17:03:06,002 - __main__ - INFO - üìä Test MAE: 0.0521
2025-11-23 17:03:06,003 - __main__ - INFO - üìä Test R¬≤: 0.8316
2025-11-23 17:03:06,003 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 17:03:06,447 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-23 17:03:06,740 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-23 17:03:06,753 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-23 17:03:06,788 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-23 17:03:06,789 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-23 17:03:06,789 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-23 17:03:07,852 - __main__ - INFO - ================================================================================
2025-11-23 17:03:07,853 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 17:03:07,853 - __main__ - INFO - ================================================================================
2025-11-23 17:03:07,853 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 17:03:07,853 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 17:03:07,854 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 17:03:07,854 - __main__ - INFO -    Test MAE:  0.0521
2025-11-23 17:03:07,854 - __main__ - INFO -    Test R¬≤:   0.8316
2025-11-23 17:11:00,070 - __main__ - INFO - ================================================================================
2025-11-23 17:11:00,071 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 17:11:00,071 - __main__ - INFO - ================================================================================
2025-11-23 17:11:00,071 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 17:11:00,071 - __main__ - INFO - ‚ÑπÔ∏è  Module YAML non disponible, utilisation de la config par d√©faut
2025-11-23 17:11:00,072 - __main__ - INFO - ‚ÑπÔ∏è  Utilisation de la configuration par d√©faut
2025-11-23 17:11:00,072 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 17:11:00,072 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models'}
2025-11-23 17:11:00,072 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 17:11:00,086 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 17:11:00,168 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 17:11:00,168 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 17:11:00,215 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 17:11:00,217 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 17:11:01,126 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 17:11:01,129 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 17:11:01,129 - __main__ - INFO - --------------------------------
2025-11-23 17:11:01,129 - __main__ - INFO - Horizon: 7
2025-11-23 17:11:01,130 - __main__ - INFO - --------------------------------
2025-11-23 17:11:01,130 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'pm_J-60', 'pm_mean', 'pm_slope', 'pm_volatility', 'pm_diff_sum',
       'pm_change_ratio', 'pm_last_jump', 'pm_trend_changes', 'month',
       'dayofweek'],
      dtype='object', length=135)
2025-11-23 17:11:01,130 - __main__ - INFO - Nombre de features: 64
2025-11-23 17:11:01,132 - __main__ - INFO - X shape: (1415, 64), y shape: (1415,)
2025-11-23 17:11:01,132 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 17:11:01,140 - __main__ - INFO - Train: (1132, 64), Test: (283, 64)
2025-11-23 17:11:03,990 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 17:11:04,004 - __main__ - INFO - üìä Test MAE: 0.0521
2025-11-23 17:11:04,005 - __main__ - INFO - üìä Test R¬≤: 0.8316
2025-11-23 17:11:04,005 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 17:11:04,469 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-23 17:11:04,817 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-23 17:11:04,835 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-23 17:11:04,877 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-23 17:11:04,878 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-23 17:11:04,878 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-23 17:11:05,790 - __main__ - INFO - ================================================================================
2025-11-23 17:11:05,790 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 17:11:05,790 - __main__ - INFO - ================================================================================
2025-11-23 17:11:05,790 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 17:11:05,791 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 17:11:05,791 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 17:11:05,791 - __main__ - INFO -    Test MAE:  0.0521
2025-11-23 17:11:05,791 - __main__ - INFO -    Test R¬≤:   0.8316
2025-11-23 17:12:25,022 - __main__ - INFO - ================================================================================
2025-11-23 17:12:25,023 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 17:12:25,023 - __main__ - INFO - ================================================================================
2025-11-23 17:12:25,023 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 17:12:25,026 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-23 17:12:25,026 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 17:12:25,026 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 21, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': '../results/D09/models'}
2025-11-23 17:12:25,026 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 17:12:25,045 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 17:12:25,171 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 17:12:25,171 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 17:12:25,222 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 17:12:25,225 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 17:12:26,023 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 17:12:26,026 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 17:12:26,027 - __main__ - INFO - --------------------------------
2025-11-23 17:12:26,027 - __main__ - INFO - Horizon: 21
2025-11-23 17:12:26,027 - __main__ - INFO - --------------------------------
2025-11-23 17:12:26,027 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'pm_J-60', 'pm_mean', 'pm_slope', 'pm_volatility', 'pm_diff_sum',
       'pm_change_ratio', 'pm_last_jump', 'pm_trend_changes', 'month',
       'dayofweek'],
      dtype='object', length=135)
2025-11-23 17:12:26,028 - __main__ - INFO - Nombre de features: 50
2025-11-23 17:12:26,030 - __main__ - INFO - X shape: (1415, 50), y shape: (1415,)
2025-11-23 17:12:26,030 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 17:12:26,037 - __main__ - INFO - Train: (1132, 50), Test: (283, 50)
2025-11-23 17:12:28,314 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 17:12:28,329 - __main__ - INFO - üìä Test MAE: 0.0778
2025-11-23 17:12:28,329 - __main__ - INFO - üìä Test R¬≤: 0.6613
2025-11-23 17:12:28,330 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 17:12:28,766 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-23 17:12:29,108 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-23 17:12:29,121 - __main__ - INFO - Sauvegarde locale du mod√®le dans ../results/D09/models...
2025-11-23 17:12:29,158 - __main__ - INFO - üíæ Mod√®le sauvegard√©: ../results/D09/models\xgb_to_predictor.joblib
2025-11-23 17:12:29,159 - __main__ - INFO - üíæ Scaler sauvegard√©: ../results/D09/models\xgb_scaler.joblib
2025-11-23 17:12:29,159 - __main__ - INFO - üíæ Features sauvegard√©es: ../results/D09/models\feature_columns.txt
2025-11-23 17:12:30,256 - __main__ - INFO - ================================================================================
2025-11-23 17:12:30,257 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 17:12:30,257 - __main__ - INFO - ================================================================================
2025-11-23 17:12:30,257 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 17:12:30,257 - __main__ - INFO -    Train MAE: 0.0007
2025-11-23 17:12:30,257 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 17:12:30,257 - __main__ - INFO -    Test MAE:  0.0778
2025-11-23 17:12:30,258 - __main__ - INFO -    Test R¬≤:   0.6613
2025-11-23 17:13:35,907 - __main__ - INFO - ================================================================================
2025-11-23 17:13:35,907 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 17:13:35,907 - __main__ - INFO - ================================================================================
2025-11-23 17:13:35,908 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 17:13:35,911 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-23 17:13:35,911 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 17:13:35,911 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 3, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': '../results/D09/models'}
2025-11-23 17:13:35,911 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 17:13:35,928 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 17:13:36,009 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 17:13:36,009 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 17:13:36,065 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 17:13:36,067 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 17:13:37,006 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 17:13:37,008 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 17:13:37,009 - __main__ - INFO - --------------------------------
2025-11-23 17:13:37,009 - __main__ - INFO - Horizon: 3
2025-11-23 17:13:37,009 - __main__ - INFO - --------------------------------
2025-11-23 17:13:37,010 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'pm_J-60', 'pm_mean', 'pm_slope', 'pm_volatility', 'pm_diff_sum',
       'pm_change_ratio', 'pm_last_jump', 'pm_trend_changes', 'month',
       'dayofweek'],
      dtype='object', length=135)
2025-11-23 17:13:37,010 - __main__ - INFO - Nombre de features: 68
2025-11-23 17:13:37,012 - __main__ - INFO - X shape: (1415, 68), y shape: (1415,)
2025-11-23 17:13:37,012 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 17:13:37,020 - __main__ - INFO - Train: (1132, 68), Test: (283, 68)
2025-11-23 17:13:39,762 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 17:13:39,775 - __main__ - INFO - üìä Test MAE: 0.0429
2025-11-23 17:13:39,776 - __main__ - INFO - üìä Test R¬≤: 0.8718
2025-11-23 17:13:39,776 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 17:13:40,205 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-23 17:13:40,582 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-23 17:13:40,596 - __main__ - INFO - Sauvegarde locale du mod√®le dans ../results/D09/models...
2025-11-23 17:13:40,636 - __main__ - INFO - üíæ Mod√®le sauvegard√©: ../results/D09/models\xgb_to_predictor.joblib
2025-11-23 17:13:40,636 - __main__ - INFO - üíæ Scaler sauvegard√©: ../results/D09/models\xgb_scaler.joblib
2025-11-23 17:13:40,637 - __main__ - INFO - üíæ Features sauvegard√©es: ../results/D09/models\feature_columns.txt
2025-11-23 17:13:41,903 - __main__ - INFO - ================================================================================
2025-11-23 17:13:41,903 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 17:13:41,903 - __main__ - INFO - ================================================================================
2025-11-23 17:13:41,904 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 17:13:41,904 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 17:13:41,904 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 17:13:41,904 - __main__ - INFO -    Test MAE:  0.0429
2025-11-23 17:13:41,904 - __main__ - INFO -    Test R¬≤:   0.8718
2025-11-23 17:30:14,212 - __main__ - INFO - ================================================================================
2025-11-23 17:30:14,212 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 17:30:14,212 - __main__ - INFO - ================================================================================
2025-11-23 17:30:14,213 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 17:30:14,215 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-23 17:30:14,216 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 17:30:14,216 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': '../results/D09/models'}
2025-11-23 17:30:14,216 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 17:30:14,242 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 17:30:14,330 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 17:30:14,331 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 17:30:14,390 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 17:30:14,394 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 17:30:15,456 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 17:30:15,458 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-23 17:30:16,330 - __main__ - ERROR - ‚ùå ERREUR FATALE: Cannot compare Timestamp with datetime.date. Use ts == pd.Timestamp(date) or ts.date() == date instead.
Traceback (most recent call last):
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 742, in main
    df = predictor.prepare_data(clusters, indicateurs)
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 339, in prepare_data
    df["days_to_holiday"] = df["stay_date"].apply(distance_to_next_holiday)
                            ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\series.py", line 4943, in apply
    ).apply()
      ~~~~~^^
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\apply.py", line 1422, in apply
    return self.apply_standard()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\apply.py", line 1502, in apply_standard
    mapped = obj._map_values(
        mapper=curried, na_action=action, convert=self.convert_dtype
    )
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\base.py", line 923, in _map_values
    return arr.map(mapper, na_action=na_action)
           ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\arrays\_mixins.py", line 81, in method
    return meth(self, *args, **kwargs)
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 763, in map
    result = map_array(self, mapper, na_action=na_action)
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\algorithms.py", line 1743, in map_array
    return lib.map_infer(values, mapper, convert=convert)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2999, in pandas._libs.lib.map_infer
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 334, in distance_to_next_holiday
    upcoming = [h for h in fr_holidays if h >= date]
                                          ^^^^^^^^^
  File "pandas/_libs/tslibs/timestamps.pyx", line 377, in pandas._libs.tslibs.timestamps._Timestamp.__richcmp__
TypeError: Cannot compare Timestamp with datetime.date. Use ts == pd.Timestamp(date) or ts.date() == date instead.
2025-11-23 17:33:33,129 - __main__ - INFO - ================================================================================
2025-11-23 17:33:33,130 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 17:33:33,130 - __main__ - INFO - ================================================================================
2025-11-23 17:33:33,130 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 17:33:33,133 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-23 17:33:33,133 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 17:33:33,133 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': '../results/D09/models'}
2025-11-23 17:33:33,133 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 17:33:33,157 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 17:33:33,248 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 17:33:33,248 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 17:33:33,312 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 17:33:33,317 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 17:33:34,124 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 17:33:34,126 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-23 17:33:34,473 - __main__ - INFO - Features jours f√©ri√©s ajout√©es. Shape: (1415, 138)
2025-11-23 17:33:34,475 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 17:33:34,475 - __main__ - INFO - --------------------------------
2025-11-23 17:33:34,476 - __main__ - INFO - Horizon: 7
2025-11-23 17:33:34,476 - __main__ - INFO - --------------------------------
2025-11-23 17:33:34,476 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'pm_volatility', 'pm_diff_sum', 'pm_change_ratio', 'pm_last_jump',
       'pm_trend_changes', 'month', 'dayofweek', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday'],
      dtype='object', length=138)
2025-11-23 17:33:34,476 - __main__ - INFO - Nombre de features: 67
2025-11-23 17:33:34,478 - __main__ - INFO - X shape: (1415, 67), y shape: (1415,)
2025-11-23 17:33:34,478 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 17:33:34,482 - __main__ - INFO - Train: (1132, 67), Test: (283, 67)
2025-11-23 17:33:37,261 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 17:33:37,276 - __main__ - INFO - üìä Test MAE: 0.0521
2025-11-23 17:33:37,276 - __main__ - INFO - üìä Test R¬≤: 0.8274
2025-11-23 17:33:37,276 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 17:33:37,999 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-23 17:33:38,380 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-23 17:33:38,393 - __main__ - INFO - Sauvegarde locale du mod√®le dans ../results/D09/models...
2025-11-23 17:33:38,427 - __main__ - INFO - üíæ Mod√®le sauvegard√©: ../results/D09/models\xgb_to_predictor.joblib
2025-11-23 17:33:38,428 - __main__ - INFO - üíæ Scaler sauvegard√©: ../results/D09/models\xgb_scaler.joblib
2025-11-23 17:33:38,428 - __main__ - INFO - üíæ Features sauvegard√©es: ../results/D09/models\feature_columns.txt
2025-11-23 17:33:39,599 - __main__ - INFO - ================================================================================
2025-11-23 17:33:39,599 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 17:33:39,599 - __main__ - INFO - ================================================================================
2025-11-23 17:33:39,599 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 17:33:39,599 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 17:33:39,600 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 17:33:39,600 - __main__ - INFO -    Test MAE:  0.0521
2025-11-23 17:33:39,600 - __main__ - INFO -    Test R¬≤:   0.8274
2025-11-23 17:38:46,444 - __main__ - INFO - ================================================================================
2025-11-23 17:38:46,444 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 17:38:46,445 - __main__ - INFO - ================================================================================
2025-11-23 17:38:46,445 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 17:38:46,449 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-23 17:38:46,449 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 17:38:46,449 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': '../results/D09/models'}
2025-11-23 17:38:46,449 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 17:38:46,466 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 17:38:46,542 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 17:38:46,543 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 17:38:46,595 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 17:38:46,598 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 17:38:47,368 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 17:38:47,369 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-23 17:38:48,072 - __main__ - INFO - Features jours f√©ri√©s ajout√©es. Shape: (1415, 138)
2025-11-23 17:38:48,074 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 17:38:48,074 - __main__ - INFO - --------------------------------
2025-11-23 17:38:48,074 - __main__ - INFO - Horizon: 7
2025-11-23 17:38:48,074 - __main__ - INFO - --------------------------------
2025-11-23 17:38:48,075 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'pm_volatility', 'pm_diff_sum', 'pm_change_ratio', 'pm_last_jump',
       'pm_trend_changes', 'month', 'dayofweek', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday'],
      dtype='object', length=138)
2025-11-23 17:38:48,075 - __main__ - INFO - Nombre de features: 67
2025-11-23 17:38:48,078 - __main__ - INFO - X shape: (1415, 67), y shape: (1415,)
2025-11-23 17:38:48,078 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 17:38:48,083 - __main__ - INFO - Train: (1132, 67), Test: (283, 67)
2025-11-23 17:38:51,147 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 17:38:51,163 - __main__ - INFO - üìä Test MAE: 0.0521
2025-11-23 17:38:51,164 - __main__ - INFO - üìä Test R¬≤: 0.8274
2025-11-23 17:38:51,164 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 17:38:51,924 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-23 17:38:52,298 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-23 17:38:52,311 - __main__ - INFO - Sauvegarde locale du mod√®le dans ../results/D09/models...
2025-11-23 17:38:52,353 - __main__ - INFO - üíæ Mod√®le sauvegard√©: ../results/D09/models\xgb_to_predictor.joblib
2025-11-23 17:38:52,354 - __main__ - INFO - üíæ Scaler sauvegard√©: ../results/D09/models\xgb_scaler.joblib
2025-11-23 17:38:52,354 - __main__ - INFO - üíæ Features sauvegard√©es: ../results/D09/models\feature_columns.txt
2025-11-23 17:38:53,531 - __main__ - INFO - ================================================================================
2025-11-23 17:38:53,532 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 17:38:53,532 - __main__ - INFO - ================================================================================
2025-11-23 17:38:53,532 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 17:38:53,532 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 17:38:53,533 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 17:38:53,533 - __main__ - INFO -    Test MAE:  0.0521
2025-11-23 17:38:53,533 - __main__ - INFO -    Test R¬≤:   0.8274
2025-11-23 17:41:51,366 - __main__ - INFO - ================================================================================
2025-11-23 17:41:51,367 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 17:41:51,367 - __main__ - INFO - ================================================================================
2025-11-23 17:41:51,367 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 17:41:51,370 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-23 17:41:51,370 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 17:41:51,370 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': '../results/D09/models'}
2025-11-23 17:41:51,371 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 17:41:51,386 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 17:41:51,462 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 17:41:51,462 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 17:41:51,509 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 17:41:51,512 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 17:41:52,355 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 17:41:52,357 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-23 17:41:52,731 - __main__ - INFO - Features jours f√©ri√©s ajout√©es. Shape: (1415, 138)
2025-11-23 17:41:52,733 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 17:41:52,733 - __main__ - INFO - --------------------------------
2025-11-23 17:41:52,733 - __main__ - INFO - Horizon: 7
2025-11-23 17:41:52,733 - __main__ - INFO - --------------------------------
2025-11-23 17:41:52,734 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'pm_volatility', 'pm_diff_sum', 'pm_change_ratio', 'pm_last_jump',
       'pm_trend_changes', 'month', 'dayofweek', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday'],
      dtype='object', length=138)
2025-11-23 17:41:52,734 - __main__ - INFO - Nombre de features: 67
2025-11-23 17:41:52,736 - __main__ - INFO - X shape: (1415, 67), y shape: (1415,)
2025-11-23 17:41:52,737 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 17:41:52,742 - __main__ - INFO - Train: (1132, 67), Test: (283, 67)
2025-11-23 17:41:55,494 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 17:41:55,508 - __main__ - INFO - üìä Test MAE: 0.0521
2025-11-23 17:41:55,509 - __main__ - INFO - üìä Test R¬≤: 0.8274
2025-11-23 17:41:55,509 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 17:41:55,976 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-23 17:41:56,392 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-23 17:41:56,408 - __main__ - INFO - Sauvegarde locale du mod√®le dans ../results/D09/models...
2025-11-23 17:41:56,446 - __main__ - INFO - üíæ Mod√®le sauvegard√©: ../results/D09/models\xgb_to_predictor.joblib
2025-11-23 17:41:56,446 - __main__ - INFO - üíæ Scaler sauvegard√©: ../results/D09/models\xgb_scaler.joblib
2025-11-23 17:41:56,447 - __main__ - INFO - üíæ Features sauvegard√©es: ../results/D09/models\feature_columns.txt
2025-11-23 17:41:56,633 - __main__ - INFO - üíæ DataFrame d'entra√Ænement sauvegard√©: ../results/D09/models\training_data.csv
2025-11-23 17:41:58,468 - __main__ - INFO - ================================================================================
2025-11-23 17:41:58,468 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 17:41:58,469 - __main__ - INFO - ================================================================================
2025-11-23 17:41:58,469 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 17:41:58,469 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 17:41:58,469 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 17:41:58,470 - __main__ - INFO -    Test MAE:  0.0521
2025-11-23 17:41:58,470 - __main__ - INFO -    Test R¬≤:   0.8274
2025-11-23 17:47:38,941 - __main__ - INFO - ================================================================================
2025-11-23 17:47:38,942 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 17:47:38,942 - __main__ - INFO - ================================================================================
2025-11-23 17:47:38,942 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 17:47:38,945 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-23 17:47:38,946 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 17:47:38,946 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': '../results/D09/models'}
2025-11-23 17:47:38,946 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 17:47:38,969 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 17:47:39,046 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 17:47:39,047 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 17:47:39,097 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 17:47:39,099 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 17:47:39,920 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 17:47:39,921 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-23 17:47:40,303 - __main__ - INFO - Features jours f√©ri√©s ajout√©es. Shape: (1415, 138)
2025-11-23 17:47:40,306 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 17:47:40,306 - __main__ - INFO - --------------------------------
2025-11-23 17:47:40,306 - __main__ - INFO - Horizon: 7
2025-11-23 17:47:40,306 - __main__ - INFO - --------------------------------
2025-11-23 17:47:40,307 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'pm_volatility', 'pm_diff_sum', 'pm_change_ratio', 'pm_last_jump',
       'pm_trend_changes', 'month', 'dayofweek', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday'],
      dtype='object', length=138)
2025-11-23 17:47:40,308 - __main__ - INFO - Nombre de features: 67
2025-11-23 17:47:40,310 - __main__ - INFO - X shape: (1415, 67), y shape: (1415,)
2025-11-23 17:47:40,310 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 17:47:40,315 - __main__ - INFO - Train: (1132, 67), Test: (283, 67)
2025-11-23 17:47:43,389 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 17:47:43,407 - __main__ - INFO - üìä Test MAE: 0.0521
2025-11-23 17:47:43,407 - __main__ - INFO - üìä Test R¬≤: 0.8274
2025-11-23 17:47:43,407 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 17:47:43,971 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-23 17:47:44,377 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-23 17:47:44,392 - __main__ - INFO - Sauvegarde locale du mod√®le dans ../results/D09/models...
2025-11-23 17:47:44,432 - __main__ - INFO - üíæ Mod√®le sauvegard√©: ../results/D09/models\xgb_to_predictor.joblib
2025-11-23 17:47:44,433 - __main__ - INFO - üíæ Scaler sauvegard√©: ../results/D09/models\xgb_scaler.joblib
2025-11-23 17:47:44,433 - __main__ - INFO - üíæ Features sauvegard√©es: ../results/D09/models\feature_columns.txt
2025-11-23 17:47:44,632 - __main__ - INFO - üíæ DataFrame d'entra√Ænement sauvegard√©: ../results/D09/models\training_data.csv
2025-11-23 17:47:46,412 - __main__ - INFO - ================================================================================
2025-11-23 17:47:46,413 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 17:47:46,413 - __main__ - INFO - ================================================================================
2025-11-23 17:47:46,413 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 17:47:46,413 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 17:47:46,413 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 17:47:46,414 - __main__ - INFO -    Test MAE:  0.0521
2025-11-23 17:47:46,414 - __main__ - INFO -    Test R¬≤:   0.8274
2025-11-23 17:54:08,427 - __main__ - INFO - ================================================================================
2025-11-23 17:54:08,427 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 17:54:08,427 - __main__ - INFO - ================================================================================
2025-11-23 17:54:08,427 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 17:54:08,430 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-23 17:54:08,430 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 17:54:08,430 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models'}
2025-11-23 17:54:08,430 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 17:54:08,443 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 17:54:08,516 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 17:54:08,516 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 17:54:08,563 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 17:54:08,565 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 17:54:09,340 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 17:54:09,341 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-23 17:54:09,714 - __main__ - INFO - Features jours f√©ri√©s ajout√©es. Shape: (1415, 138)
2025-11-23 17:54:09,716 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 17:54:09,716 - __main__ - INFO - --------------------------------
2025-11-23 17:54:09,716 - __main__ - INFO - Horizon: 7
2025-11-23 17:54:09,716 - __main__ - INFO - --------------------------------
2025-11-23 17:54:09,717 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'pm_volatility', 'pm_diff_sum', 'pm_change_ratio', 'pm_last_jump',
       'pm_trend_changes', 'month', 'dayofweek', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday'],
      dtype='object', length=138)
2025-11-23 17:54:09,717 - __main__ - INFO - Nombre de features: 67
2025-11-23 17:54:09,719 - __main__ - INFO - X shape: (1415, 67), y shape: (1415,)
2025-11-23 17:54:09,719 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 17:54:09,723 - __main__ - INFO - Train: (1132, 67), Test: (283, 67)
2025-11-23 17:54:12,410 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 17:54:12,428 - __main__ - INFO - üìä Test MAE: 0.0521
2025-11-23 17:54:12,428 - __main__ - INFO - üìä Test R¬≤: 0.8274
2025-11-23 17:54:12,428 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 17:54:12,895 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-23 17:54:13,247 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-23 17:54:13,263 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-23 17:54:13,303 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-23 17:54:13,303 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-23 17:54:13,304 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-23 17:54:14,710 - __main__ - INFO - ================================================================================
2025-11-23 17:54:14,710 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 17:54:14,711 - __main__ - INFO - ================================================================================
2025-11-23 17:54:14,711 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 17:54:14,711 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 17:54:14,711 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 17:54:14,711 - __main__ - INFO -    Test MAE:  0.0521
2025-11-23 17:54:14,712 - __main__ - INFO -    Test R¬≤:   0.8274
2025-11-23 17:58:06,121 - __main__ - INFO - ================================================================================
2025-11-23 17:58:06,121 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 17:58:06,122 - __main__ - INFO - ================================================================================
2025-11-23 17:58:06,122 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 17:58:06,125 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-23 17:58:06,125 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 17:58:06,125 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models'}
2025-11-23 17:58:06,125 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 17:58:06,138 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 17:58:06,217 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 17:58:06,218 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 17:58:06,266 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 17:58:06,270 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 17:58:07,220 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 17:58:07,222 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-23 17:58:07,625 - __main__ - INFO - Features jours f√©ri√©s ajout√©es. Shape: (1415, 138)
2025-11-23 17:58:07,627 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 17:58:07,627 - __main__ - INFO - --------------------------------
2025-11-23 17:58:07,627 - __main__ - INFO - Horizon: 7
2025-11-23 17:58:07,628 - __main__ - INFO - --------------------------------
2025-11-23 17:58:07,628 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'pm_volatility', 'pm_diff_sum', 'pm_change_ratio', 'pm_last_jump',
       'pm_trend_changes', 'month', 'dayofweek', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday'],
      dtype='object', length=138)
2025-11-23 17:58:07,628 - __main__ - INFO - Nombre de features: 67
2025-11-23 17:58:07,631 - __main__ - INFO - X shape: (1415, 67), y shape: (1415,)
2025-11-23 17:58:07,631 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 17:58:07,736 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\training_data_before_scaling.csv
2025-11-23 17:58:07,736 - __main__ - INFO -    Shape: (1415, 68)
2025-11-23 17:58:07,741 - __main__ - INFO - Train: (1132, 67), Test: (283, 67)
2025-11-23 17:58:11,456 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 17:58:11,477 - __main__ - INFO - üìä Test MAE: 0.0521
2025-11-23 17:58:11,478 - __main__ - INFO - üìä Test R¬≤: 0.8274
2025-11-23 17:58:11,478 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 17:58:11,930 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-23 17:58:12,307 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-23 17:58:12,318 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-23 17:58:12,353 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-23 17:58:12,354 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-23 17:58:12,354 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-23 17:58:13,467 - __main__ - INFO - ================================================================================
2025-11-23 17:58:13,467 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 17:58:13,467 - __main__ - INFO - ================================================================================
2025-11-23 17:58:13,468 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 17:58:13,468 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 17:58:13,468 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 17:58:13,468 - __main__ - INFO -    Test MAE:  0.0521
2025-11-23 17:58:13,468 - __main__ - INFO -    Test R¬≤:   0.8274
2025-11-23 18:08:55,382 - __main__ - INFO - ================================================================================
2025-11-23 18:08:55,382 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 18:08:55,382 - __main__ - INFO - ================================================================================
2025-11-23 18:08:55,382 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 18:08:55,386 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-23 18:08:55,386 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 18:08:55,387 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models'}
2025-11-23 18:08:55,387 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 18:08:55,415 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 18:08:55,492 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 18:08:55,492 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 18:08:55,544 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 18:08:55,548 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 18:08:56,345 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 18:08:56,346 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-23 18:08:57,054 - __main__ - INFO - Jours f√©ri√©s: dict_keys([datetime.date(2024, 1, 1), datetime.date(2024, 4, 1), datetime.date(2024, 5, 20), datetime.date(2024, 5, 1), datetime.date(2024, 5, 8), datetime.date(2024, 5, 9), datetime.date(2024, 7, 14), datetime.date(2024, 8, 15), datetime.date(2024, 11, 1), datetime.date(2024, 11, 11), datetime.date(2024, 12, 25), datetime.date(2025, 1, 1), datetime.date(2025, 4, 21), datetime.date(2025, 6, 9), datetime.date(2025, 5, 1), datetime.date(2025, 5, 8), datetime.date(2025, 5, 29), datetime.date(2025, 7, 14), datetime.date(2025, 8, 15), datetime.date(2025, 11, 1), datetime.date(2025, 11, 11), datetime.date(2025, 12, 25), datetime.date(2022, 1, 1), datetime.date(2022, 4, 18), datetime.date(2022, 6, 6), datetime.date(2022, 5, 1), datetime.date(2022, 5, 8), datetime.date(2022, 5, 26), datetime.date(2022, 7, 14), datetime.date(2022, 8, 15), datetime.date(2022, 11, 1), datetime.date(2022, 11, 11), datetime.date(2022, 12, 25), datetime.date(2023, 1, 1), datetime.date(2023, 4, 10), datetime.date(2023, 5, 29), datetime.date(2023, 5, 1), datetime.date(2023, 5, 8), datetime.date(2023, 5, 18), datetime.date(2023, 7, 14), datetime.date(2023, 8, 15), datetime.date(2023, 11, 1), datetime.date(2023, 11, 11), datetime.date(2023, 12, 25)])
2025-11-23 18:08:57,075 - __main__ - INFO - Features jours f√©ri√©s ajout√©es. Shape: (1415, 138)
2025-11-23 18:08:57,077 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 18:08:57,078 - __main__ - INFO - --------------------------------
2025-11-23 18:08:57,078 - __main__ - INFO - Horizon: 7
2025-11-23 18:08:57,078 - __main__ - INFO - --------------------------------
2025-11-23 18:08:57,079 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'pm_volatility', 'pm_diff_sum', 'pm_change_ratio', 'pm_last_jump',
       'pm_trend_changes', 'month', 'dayofweek', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday'],
      dtype='object', length=138)
2025-11-23 18:08:57,079 - __main__ - INFO - Nombre de features: 67
2025-11-23 18:08:57,082 - __main__ - INFO - X shape: (1415, 67), y shape: (1415,)
2025-11-23 18:08:57,082 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 18:08:57,088 - __main__ - WARNING - ‚ö†Ô∏è  Erreur lors de la sauvegarde des donn√©es d'entra√Ænement: [Errno 13] Permission denied: 'results/D09\\training_data_before_scaling.csv'
2025-11-23 18:08:57,093 - __main__ - INFO - Train: (1132, 67), Test: (283, 67)
2025-11-23 18:08:59,666 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 18:08:59,685 - __main__ - INFO - üìä Test MAE: 0.0518
2025-11-23 18:08:59,685 - __main__ - INFO - üìä Test R¬≤: 0.8375
2025-11-23 18:08:59,686 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 18:09:00,379 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-23 18:09:00,711 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-23 18:09:00,724 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-23 18:09:00,760 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-23 18:09:00,761 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-23 18:09:00,761 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-23 18:09:01,950 - __main__ - INFO - ================================================================================
2025-11-23 18:09:01,950 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 18:09:01,951 - __main__ - INFO - ================================================================================
2025-11-23 18:09:01,951 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 18:09:01,951 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 18:09:01,951 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 18:09:01,951 - __main__ - INFO -    Test MAE:  0.0518
2025-11-23 18:09:01,952 - __main__ - INFO -    Test R¬≤:   0.8375
2025-11-23 18:09:45,752 - __main__ - INFO - ================================================================================
2025-11-23 18:09:45,752 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 18:09:45,752 - __main__ - INFO - ================================================================================
2025-11-23 18:09:45,753 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 18:09:45,757 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-23 18:09:45,757 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 18:09:45,757 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models'}
2025-11-23 18:09:45,757 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 18:09:45,773 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 18:09:45,861 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 18:09:45,861 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 18:09:45,916 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 18:09:45,919 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 18:09:47,023 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 18:09:47,024 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-23 18:09:47,430 - __main__ - INFO - Features jours f√©ri√©s ajout√©es. Shape: (1415, 138)
2025-11-23 18:09:47,432 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 18:09:47,432 - __main__ - INFO - --------------------------------
2025-11-23 18:09:47,432 - __main__ - INFO - Horizon: 7
2025-11-23 18:09:47,432 - __main__ - INFO - --------------------------------
2025-11-23 18:09:47,433 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'pm_volatility', 'pm_diff_sum', 'pm_change_ratio', 'pm_last_jump',
       'pm_trend_changes', 'month', 'dayofweek', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday'],
      dtype='object', length=138)
2025-11-23 18:09:47,433 - __main__ - INFO - Nombre de features: 67
2025-11-23 18:09:47,435 - __main__ - INFO - X shape: (1415, 67), y shape: (1415,)
2025-11-23 18:09:47,435 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 18:09:47,525 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\training_data_before_scaling.csv
2025-11-23 18:09:47,525 - __main__ - INFO -    Shape: (1415, 68)
2025-11-23 18:09:47,529 - __main__ - INFO - Train: (1132, 67), Test: (283, 67)
2025-11-23 18:09:50,880 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 18:09:50,901 - __main__ - INFO - üìä Test MAE: 0.0518
2025-11-23 18:09:50,901 - __main__ - INFO - üìä Test R¬≤: 0.8375
2025-11-23 18:09:50,901 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 18:09:51,374 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-23 18:09:51,741 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-23 18:09:51,754 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-23 18:09:51,789 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-23 18:09:51,789 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-23 18:09:51,790 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-23 18:09:52,971 - __main__ - INFO - ================================================================================
2025-11-23 18:09:52,971 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 18:09:52,971 - __main__ - INFO - ================================================================================
2025-11-23 18:09:52,971 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 18:09:52,971 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 18:09:52,972 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 18:09:52,972 - __main__ - INFO -    Test MAE:  0.0518
2025-11-23 18:09:52,972 - __main__ - INFO -    Test R¬≤:   0.8375
2025-11-23 20:06:23,755 - __main__ - INFO - ================================================================================
2025-11-23 20:06:23,756 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 20:06:23,757 - __main__ - INFO - ================================================================================
2025-11-23 20:06:23,757 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 20:06:23,760 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-23 20:06:23,760 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 20:06:23,760 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models'}
2025-11-23 20:06:23,760 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 20:06:23,806 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 20:06:23,904 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 20:06:23,905 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 20:06:23,979 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 20:06:23,982 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 20:06:24,797 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 20:06:24,804 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-23 20:06:25,659 - __main__ - INFO - Features jours f√©ri√©s ajout√©es. Shape: (1415, 138)
2025-11-23 20:06:25,659 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-23 20:06:25,660 - __main__ - INFO -    - Jours de pont: 85 (6.01%)
2025-11-23 20:06:25,660 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.2
2025-11-23 20:06:25,661 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 20:06:25,662 - __main__ - INFO - --------------------------------
2025-11-23 20:06:25,662 - __main__ - INFO - Horizon: 7
2025-11-23 20:06:25,662 - __main__ - INFO - --------------------------------
2025-11-23 20:06:25,662 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'pm_volatility', 'pm_diff_sum', 'pm_change_ratio', 'pm_last_jump',
       'pm_trend_changes', 'month', 'dayofweek', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday'],
      dtype='object', length=138)
2025-11-23 20:06:25,663 - __main__ - INFO - Nombre de features: 67
2025-11-23 20:06:25,665 - __main__ - INFO - X shape: (1415, 67), y shape: (1415,)
2025-11-23 20:06:25,665 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 20:06:25,672 - __main__ - WARNING - ‚ö†Ô∏è  Erreur lors de la sauvegarde des donn√©es d'entra√Ænement: [Errno 13] Permission denied: 'results/D09\\training_data_before_scaling.csv'
2025-11-23 20:06:25,678 - __main__ - INFO - Train: (1132, 67), Test: (283, 67)
2025-11-23 20:06:28,462 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 20:06:28,480 - __main__ - INFO - üìä Test MAE: 0.0517
2025-11-23 20:06:28,481 - __main__ - INFO - üìä Test R¬≤: 0.8334
2025-11-23 20:06:28,482 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 20:06:29,281 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-23 20:06:29,653 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-23 20:06:29,665 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-23 20:06:29,711 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-23 20:06:29,711 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-23 20:06:29,712 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-23 20:06:30,606 - __main__ - INFO - ================================================================================
2025-11-23 20:06:30,606 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 20:06:30,607 - __main__ - INFO - ================================================================================
2025-11-23 20:06:30,607 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 20:06:30,607 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 20:06:30,607 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 20:06:30,607 - __main__ - INFO -    Test MAE:  0.0517
2025-11-23 20:06:30,607 - __main__ - INFO -    Test R¬≤:   0.8334
2025-11-23 20:07:14,283 - __main__ - INFO - ================================================================================
2025-11-23 20:07:14,283 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 20:07:14,283 - __main__ - INFO - ================================================================================
2025-11-23 20:07:14,283 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 20:07:14,286 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-23 20:07:14,286 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 20:07:14,286 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models'}
2025-11-23 20:07:14,287 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 20:07:14,303 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 20:07:14,386 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 20:07:14,387 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 20:07:14,437 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 20:07:14,440 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 20:07:15,301 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 20:07:15,302 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-23 20:07:15,678 - __main__ - INFO - Features jours f√©ri√©s ajout√©es. Shape: (1415, 138)
2025-11-23 20:07:15,678 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-23 20:07:15,679 - __main__ - INFO -    - Jours de pont: 85 (6.01%)
2025-11-23 20:07:15,679 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.2
2025-11-23 20:07:15,681 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 20:07:15,681 - __main__ - INFO - --------------------------------
2025-11-23 20:07:15,681 - __main__ - INFO - Horizon: 7
2025-11-23 20:07:15,681 - __main__ - INFO - --------------------------------
2025-11-23 20:07:15,681 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'pm_volatility', 'pm_diff_sum', 'pm_change_ratio', 'pm_last_jump',
       'pm_trend_changes', 'month', 'dayofweek', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday'],
      dtype='object', length=138)
2025-11-23 20:07:15,682 - __main__ - INFO - Nombre de features: 67
2025-11-23 20:07:15,683 - __main__ - INFO - X shape: (1415, 67), y shape: (1415,)
2025-11-23 20:07:15,684 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 20:07:15,772 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\training_data_before_scaling.csv
2025-11-23 20:07:15,773 - __main__ - INFO -    Shape: (1415, 68)
2025-11-23 20:07:15,777 - __main__ - INFO - Train: (1132, 67), Test: (283, 67)
2025-11-23 20:07:19,135 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 20:07:19,151 - __main__ - INFO - üìä Test MAE: 0.0517
2025-11-23 20:07:19,151 - __main__ - INFO - üìä Test R¬≤: 0.8334
2025-11-23 20:07:19,152 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 20:07:19,629 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-23 20:07:19,991 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-23 20:07:20,003 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-23 20:07:20,042 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-23 20:07:20,043 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-23 20:07:20,043 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-23 20:07:20,960 - __main__ - INFO - ================================================================================
2025-11-23 20:07:20,960 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 20:07:20,960 - __main__ - INFO - ================================================================================
2025-11-23 20:07:20,961 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 20:07:20,961 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 20:07:20,961 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 20:07:20,962 - __main__ - INFO -    Test MAE:  0.0517
2025-11-23 20:07:20,962 - __main__ - INFO -    Test R¬≤:   0.8334
2025-11-23 20:15:18,706 - __main__ - INFO - ================================================================================
2025-11-23 20:15:18,707 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 20:15:18,707 - __main__ - INFO - ================================================================================
2025-11-23 20:15:18,707 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 20:15:18,711 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-23 20:15:18,711 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 20:15:18,711 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models'}
2025-11-23 20:15:18,711 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 20:15:18,736 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 20:15:18,838 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 20:15:18,838 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 20:15:18,925 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 20:15:18,928 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 20:15:20,188 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 20:15:20,190 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-23 20:15:20,655 - __main__ - INFO - Features jours f√©ri√©s ajout√©es. Shape: (1415, 138)
2025-11-23 20:15:20,656 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-23 20:15:20,656 - __main__ - INFO -    - Jours de pont: 85 (6.01%)
2025-11-23 20:15:20,657 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.2
2025-11-23 20:15:20,659 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 20:15:20,659 - __main__ - INFO - --------------------------------
2025-11-23 20:15:20,659 - __main__ - INFO - Horizon: 7
2025-11-23 20:15:20,659 - __main__ - INFO - --------------------------------
2025-11-23 20:15:20,660 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'pm_volatility', 'pm_diff_sum', 'pm_change_ratio', 'pm_last_jump',
       'pm_trend_changes', 'month', 'dayofweek', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday'],
      dtype='object', length=138)
2025-11-23 20:15:20,660 - __main__ - INFO - Nombre de features: 67
2025-11-23 20:15:20,862 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement brutes sauvegard√©es: results/D09\training_data_before_scaling.csv
2025-11-23 20:15:20,863 - __main__ - INFO -    Shape: (1415, 138)
2025-11-23 20:15:20,863 - __main__ - INFO -    Colonnes: 138 colonnes au total
2025-11-23 20:15:20,863 - __main__ - INFO - X shape: (1415, 67), y shape: (1415,)
2025-11-23 20:15:20,864 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 20:15:20,870 - __main__ - INFO - Train: (1132, 67), Test: (283, 67)
2025-11-23 20:15:24,325 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 20:15:24,340 - __main__ - INFO - üìä Test MAE: 0.0517
2025-11-23 20:15:24,341 - __main__ - INFO - üìä Test R¬≤: 0.8334
2025-11-23 20:15:24,341 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 20:15:24,793 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-23 20:15:25,154 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-23 20:15:25,166 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-23 20:15:25,204 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-23 20:15:25,205 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-23 20:15:25,205 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-23 20:15:26,198 - __main__ - INFO - ================================================================================
2025-11-23 20:15:26,198 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 20:15:26,199 - __main__ - INFO - ================================================================================
2025-11-23 20:15:26,199 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 20:15:26,199 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 20:15:26,200 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 20:15:26,200 - __main__ - INFO -    Test MAE:  0.0517
2025-11-23 20:15:26,200 - __main__ - INFO -    Test R¬≤:   0.8334
2025-11-23 20:28:33,678 - __main__ - INFO - ================================================================================
2025-11-23 20:28:33,679 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 20:28:33,679 - __main__ - INFO - ================================================================================
2025-11-23 20:28:33,679 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 20:28:33,682 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-23 20:28:33,682 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 20:28:33,682 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models'}
2025-11-23 20:28:33,682 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 20:28:33,700 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 20:28:33,774 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 20:28:33,774 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 20:28:33,824 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 20:28:33,828 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 20:28:34,621 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 20:28:34,622 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-23 20:28:34,993 - __main__ - INFO - Features jours f√©ri√©s ajout√©es. Shape: (1415, 138)
2025-11-23 20:28:34,993 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-23 20:28:34,994 - __main__ - INFO -    - Jours de pont: 85 (6.01%)
2025-11-23 20:28:34,994 - __main__ - INFO -    - Proximit√© au f√©ri√©: min=0.011, max=1.000, moyenne=0.110
2025-11-23 20:28:34,995 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 20:28:34,996 - __main__ - INFO - --------------------------------
2025-11-23 20:28:34,996 - __main__ - INFO - Horizon: 7
2025-11-23 20:28:34,996 - __main__ - INFO - --------------------------------
2025-11-23 20:28:34,996 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'pm_volatility', 'pm_diff_sum', 'pm_change_ratio', 'pm_last_jump',
       'pm_trend_changes', 'month', 'dayofweek', 'is_holiday_fr',
       'is_bridge_day', 'holiday_proximity_score'],
      dtype='object', length=138)
2025-11-23 20:28:34,997 - __main__ - INFO - Nombre de features: 67
2025-11-23 20:28:35,004 - __main__ - WARNING - ‚ö†Ô∏è  Erreur lors de la sauvegarde des donn√©es d'entra√Ænement: [Errno 13] Permission denied: 'results/D09\\training_data_before_scaling.csv'
2025-11-23 20:28:35,005 - __main__ - INFO - X shape: (1415, 67), y shape: (1415,)
2025-11-23 20:28:35,005 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 20:28:35,010 - __main__ - INFO - Train: (1132, 67), Test: (283, 67)
2025-11-23 20:28:38,062 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 20:28:38,075 - __main__ - INFO - üìä Test MAE: 0.0520
2025-11-23 20:28:38,076 - __main__ - INFO - üìä Test R¬≤: 0.8309
2025-11-23 20:28:38,076 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 20:28:38,555 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-23 20:28:38,964 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-23 20:28:38,978 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-23 20:28:39,016 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-23 20:28:39,017 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-23 20:28:39,017 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-23 20:28:39,877 - __main__ - INFO - ================================================================================
2025-11-23 20:28:39,877 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 20:28:39,877 - __main__ - INFO - ================================================================================
2025-11-23 20:28:39,878 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 20:28:39,878 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 20:28:39,878 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 20:28:39,878 - __main__ - INFO -    Test MAE:  0.0520
2025-11-23 20:28:39,878 - __main__ - INFO -    Test R¬≤:   0.8309
2025-11-23 20:29:22,607 - __main__ - INFO - ================================================================================
2025-11-23 20:29:22,608 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 20:29:22,608 - __main__ - INFO - ================================================================================
2025-11-23 20:29:22,608 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 20:29:22,613 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-23 20:29:22,613 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 20:29:22,614 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models'}
2025-11-23 20:29:22,614 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 20:29:22,644 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 20:29:22,769 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 20:29:22,769 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 20:29:22,855 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 20:29:22,860 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 20:29:24,407 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 20:29:24,408 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-23 20:29:25,034 - __main__ - INFO - Features jours f√©ri√©s ajout√©es. Shape: (1415, 138)
2025-11-23 20:29:25,034 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-23 20:29:25,035 - __main__ - INFO -    - Jours de pont: 85 (6.01%)
2025-11-23 20:29:25,035 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.2
2025-11-23 20:29:25,038 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 20:29:25,038 - __main__ - INFO - --------------------------------
2025-11-23 20:29:25,039 - __main__ - INFO - Horizon: 7
2025-11-23 20:29:25,039 - __main__ - INFO - --------------------------------
2025-11-23 20:29:25,039 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'pm_volatility', 'pm_diff_sum', 'pm_change_ratio', 'pm_last_jump',
       'pm_trend_changes', 'month', 'dayofweek', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday'],
      dtype='object', length=138)
2025-11-23 20:29:25,040 - __main__ - INFO - Nombre de features: 67
2025-11-23 20:29:25,263 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement brutes sauvegard√©es: results/D09\training_data_before_scaling.csv
2025-11-23 20:29:25,263 - __main__ - INFO -    Shape: (1415, 138)
2025-11-23 20:29:25,263 - __main__ - INFO -    Colonnes: 138 colonnes au total
2025-11-23 20:29:25,264 - __main__ - INFO - X shape: (1415, 67), y shape: (1415,)
2025-11-23 20:29:25,264 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 20:29:25,272 - __main__ - INFO - Train: (1132, 67), Test: (283, 67)
2025-11-23 20:29:30,525 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 20:29:30,551 - __main__ - INFO - üìä Test MAE: 0.0517
2025-11-23 20:29:30,552 - __main__ - INFO - üìä Test R¬≤: 0.8334
2025-11-23 20:29:30,552 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 20:29:31,092 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-23 20:29:31,553 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-23 20:29:31,570 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-23 20:29:31,618 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-23 20:29:31,619 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-23 20:29:31,619 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-23 20:29:32,772 - __main__ - INFO - ================================================================================
2025-11-23 20:29:32,773 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 20:29:32,773 - __main__ - INFO - ================================================================================
2025-11-23 20:29:32,773 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 20:29:32,774 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 20:29:32,774 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 20:29:32,774 - __main__ - INFO -    Test MAE:  0.0517
2025-11-23 20:29:32,774 - __main__ - INFO -    Test R¬≤:   0.8334
2025-11-23 20:34:04,742 - __main__ - INFO - ================================================================================
2025-11-23 20:34:04,743 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 20:34:04,743 - __main__ - INFO - ================================================================================
2025-11-23 20:34:04,743 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 20:34:04,746 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-23 20:34:04,746 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 20:34:04,746 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models'}
2025-11-23 20:34:04,746 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 20:34:04,761 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 20:34:04,845 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 20:34:04,845 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 20:34:04,894 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 20:34:04,898 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 20:34:05,724 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 20:34:05,726 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-23 20:34:06,118 - __main__ - INFO - Ajout des vacances scolaires...
2025-11-23 20:34:06,216 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-11-23 20:34:06,221 - __main__ - ERROR - ‚ùå ERREUR FATALE: 'datetime.date' object has no attribute 'date'
Traceback (most recent call last):
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 877, in main
    df = predictor.prepare_data(clusters, indicateurs)
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 435, in prepare_data
    df["is_long_weekend_3j"] = df["stay_date"].apply(is_long_weekend_3days)
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\series.py", line 4943, in apply
    ).apply()
      ~~~~~^^
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\apply.py", line 1422, in apply
    return self.apply_standard()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\apply.py", line 1502, in apply_standard
    mapped = obj._map_values(
        mapper=curried, na_action=action, convert=self.convert_dtype
    )
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\base.py", line 923, in _map_values
    return arr.map(mapper, na_action=na_action)
           ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\arrays\_mixins.py", line 81, in method
    return meth(self, *args, **kwargs)
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 763, in map
    result = map_array(self, mapper, na_action=na_action)
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\algorithms.py", line 1743, in map_array
    return lib.map_infer(values, mapper, convert=convert)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2999, in pandas._libs.lib.map_infer
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 393, in is_long_weekend_3days
    if dow == 5 and (d - pd.Timedelta(days=1)).date() in fr_holidays:  # Samedi apr√®s vendredi f√©ri√©
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'datetime.date' object has no attribute 'date'
2025-11-23 20:36:02,474 - __main__ - INFO - ================================================================================
2025-11-23 20:36:02,474 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 20:36:02,475 - __main__ - INFO - ================================================================================
2025-11-23 20:36:02,475 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 20:36:02,478 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-23 20:36:02,478 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 20:36:02,478 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models'}
2025-11-23 20:36:02,478 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 20:36:02,496 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 20:36:02,580 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 20:36:02,580 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 20:36:02,627 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 20:36:02,631 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 20:36:03,691 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 20:36:03,693 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-23 20:36:04,330 - __main__ - INFO - Ajout des vacances scolaires...
2025-11-23 20:36:04,455 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-11-23 20:36:04,474 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1415, 141)
2025-11-23 20:36:04,474 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-23 20:36:04,475 - __main__ - INFO -    - Jours de pont: 85 (6.01%)
2025-11-23 20:36:04,475 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.2
2025-11-23 20:36:04,476 - __main__ - INFO -    - Vacances scolaires: 590 (41.70%)
2025-11-23 20:36:04,476 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-11-23 20:36:04,477 - __main__ - INFO -    - Weekends 4j: 101 (7.14%)
2025-11-23 20:36:04,479 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 20:36:04,479 - __main__ - INFO - --------------------------------
2025-11-23 20:36:04,479 - __main__ - INFO - Horizon: 7
2025-11-23 20:36:04,480 - __main__ - INFO - --------------------------------
2025-11-23 20:36:04,480 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'pm_last_jump', 'pm_trend_changes', 'month', 'dayofweek',
       'is_holiday_fr', 'is_bridge_day', 'days_to_holiday',
       'is_vacances_scolaires', 'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=141)
2025-11-23 20:36:04,481 - __main__ - INFO - Nombre de features: 70
2025-11-23 20:36:04,652 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement brutes sauvegard√©es: results/D09\training_data_before_scaling.csv
2025-11-23 20:36:04,653 - __main__ - INFO -    Shape: (1415, 141)
2025-11-23 20:36:04,653 - __main__ - INFO -    Colonnes: 141 colonnes au total
2025-11-23 20:36:04,653 - __main__ - INFO - X shape: (1415, 70), y shape: (1415,)
2025-11-23 20:36:04,654 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 20:36:04,658 - __main__ - INFO - Train: (1132, 70), Test: (283, 70)
2025-11-23 20:36:07,957 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 20:36:07,975 - __main__ - INFO - üìä Test MAE: 0.0514
2025-11-23 20:36:07,975 - __main__ - INFO - üìä Test R¬≤: 0.8310
2025-11-23 20:36:07,976 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 20:36:08,439 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-23 20:36:08,847 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-23 20:36:08,863 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-23 20:36:08,898 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-23 20:36:08,899 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-23 20:36:08,899 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-23 20:36:09,778 - __main__ - INFO - ================================================================================
2025-11-23 20:36:09,778 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 20:36:09,778 - __main__ - INFO - ================================================================================
2025-11-23 20:36:09,778 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 20:36:09,778 - __main__ - INFO -    Train MAE: 0.0005
2025-11-23 20:36:09,779 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 20:36:09,779 - __main__ - INFO -    Test MAE:  0.0514
2025-11-23 20:36:09,779 - __main__ - INFO -    Test R¬≤:   0.8310
2025-11-23 20:54:58,320 - __main__ - INFO - ================================================================================
2025-11-23 20:54:58,321 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 20:54:58,321 - __main__ - INFO - ================================================================================
2025-11-23 20:54:58,321 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 20:54:58,326 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-23 20:54:58,326 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 20:54:58,326 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models'}
2025-11-23 20:54:58,326 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 20:54:58,342 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 20:54:58,417 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 20:54:58,417 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 20:54:58,463 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 20:54:58,466 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 20:54:59,531 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 20:54:59,532 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-11-23 20:54:59,655 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-11-23 20:54:59,655 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-11-23 20:54:59,786 - __main__ - ERROR - ‚ùå ERREUR FATALE: Cannot subtract tz-naive and tz-aware datetime-like objects.
Traceback (most recent call last):
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 1188, in _sub_datetimelike
    self._assert_tzawareness_compat(other)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\arrays\datetimes.py", line 784, in _assert_tzawareness_compat
    raise TypeError(
        "Cannot compare tz-naive and tz-aware datetime-like objects."
    )
TypeError: Cannot compare tz-naive and tz-aware datetime-like objects.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 1011, in main
    df = predictor.prepare_data(clusters, indicateurs)
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 433, in prepare_data
    df = self.prepare_competitor_features(df, df_comp)
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 217, in prepare_competitor_features
    df_comp["days_before"] = (df_comp["Date"] - df_comp["ObsDate"]).dt.days
                              ~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\arraylike.py", line 194, in __sub__
    return self._arith_method(other, operator.sub)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\series.py", line 6154, in _arith_method
    return base.IndexOpsMixin._arith_method(self, other, op)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\base.py", line 1391, in _arith_method
    result = ops.arithmetic_op(lvalues, rvalues, op)
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\ops\array_ops.py", line 273, in arithmetic_op
    res_values = op(left, right)
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 1482, in __sub__
    result = self._sub_datetime_arraylike(other)
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 1179, in _sub_datetime_arraylike
    return self._sub_datetimelike(other)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 1191, in _sub_datetimelike
    raise type(err)(new_message) from err
TypeError: Cannot subtract tz-naive and tz-aware datetime-like objects.
2025-11-23 20:56:17,552 - __main__ - INFO - ================================================================================
2025-11-23 20:56:17,552 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 20:56:17,553 - __main__ - INFO - ================================================================================
2025-11-23 20:56:17,553 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 20:56:17,557 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-23 20:56:17,557 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 20:56:17,557 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models'}
2025-11-23 20:56:17,558 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 20:56:17,581 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 20:56:17,683 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 20:56:17,684 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 20:56:17,747 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 20:56:17,752 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 20:56:18,938 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 20:56:18,938 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-11-23 20:56:19,055 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-11-23 20:56:19,055 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-11-23 20:56:20,201 - __main__ - INFO - Features concurrentes ajout√©es (6 features). Shape: (1415, 139)
2025-11-23 20:56:20,203 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-23 20:56:20,629 - __main__ - INFO - Ajout des vacances scolaires...
2025-11-23 20:56:20,732 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-11-23 20:56:20,747 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1415, 147)
2025-11-23 20:56:20,748 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-23 20:56:20,748 - __main__ - INFO -    - Jours de pont: 85 (6.01%)
2025-11-23 20:56:20,748 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.2
2025-11-23 20:56:20,749 - __main__ - INFO -    - Vacances scolaires: 590 (41.70%)
2025-11-23 20:56:20,749 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-11-23 20:56:20,749 - __main__ - INFO -    - Weekends 4j: 101 (7.14%)
2025-11-23 20:56:20,755 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 20:56:20,755 - __main__ - INFO - --------------------------------
2025-11-23 20:56:20,755 - __main__ - INFO - Horizon: 7
2025-11-23 20:56:20,755 - __main__ - INFO - --------------------------------
2025-11-23 20:56:20,755 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_last_jump', 'comp_trend_changes', 'month', 'dayofweek',
       'is_holiday_fr', 'is_bridge_day', 'days_to_holiday',
       'is_vacances_scolaires', 'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=147)
2025-11-23 20:56:20,756 - __main__ - INFO - Nombre total de features: 76
2025-11-23 20:56:20,756 - __main__ - INFO -    - TO historiques: 53
2025-11-23 20:56:20,756 - __main__ - INFO -    - Features PM: 7
2025-11-23 20:56:20,756 - __main__ - INFO -    - Features concurrents: 6
2025-11-23 20:56:20,756 - __main__ - INFO -    - Autres features: 10
2025-11-23 20:56:20,993 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement brutes sauvegard√©es: results/D09\training_data_before_scaling.csv
2025-11-23 20:56:20,993 - __main__ - INFO -    Shape: (1326, 147)
2025-11-23 20:56:20,994 - __main__ - INFO -    Colonnes: 147 colonnes au total
2025-11-23 20:56:20,994 - __main__ - INFO - X shape: (1326, 76), y shape: (1326,)
2025-11-23 20:56:20,994 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 20:56:20,998 - __main__ - INFO - Train: (1060, 76), Test: (266, 76)
2025-11-23 20:56:24,704 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 20:56:24,719 - __main__ - INFO - üìä Test MAE: 0.0504
2025-11-23 20:56:24,720 - __main__ - INFO - üìä Test R¬≤: 0.8379
2025-11-23 20:56:24,720 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 20:56:25,241 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-23 20:56:25,737 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-23 20:56:25,754 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-23 20:56:25,794 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-23 20:56:25,794 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-23 20:56:25,794 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-23 20:56:26,826 - __main__ - INFO - ================================================================================
2025-11-23 20:56:26,826 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 20:56:26,826 - __main__ - INFO - ================================================================================
2025-11-23 20:56:26,827 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 20:56:26,827 - __main__ - INFO -    Train MAE: 0.0004
2025-11-23 20:56:26,827 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-23 20:56:26,827 - __main__ - INFO -    Test MAE:  0.0504
2025-11-23 20:56:26,827 - __main__ - INFO -    Test R¬≤:   0.8379
2025-11-23 21:05:30,743 - __main__ - INFO - ================================================================================
2025-11-23 21:05:30,744 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 21:05:30,744 - __main__ - INFO - ================================================================================
2025-11-23 21:05:30,744 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 21:05:30,747 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-23 21:05:30,747 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 21:05:30,747 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models', 'hyperparam_search': {'cv_folds': 3}}
2025-11-23 21:05:30,747 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 21:05:30,762 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 21:05:30,839 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 21:05:30,839 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 21:05:30,884 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 21:05:30,887 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 21:05:32,454 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 21:05:32,454 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-11-23 21:05:32,602 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-11-23 21:05:32,602 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-11-23 21:05:33,687 - __main__ - INFO - Features concurrentes ajout√©es (6 features). Shape: (1415, 139)
2025-11-23 21:05:33,691 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-23 21:05:34,071 - __main__ - INFO - Ajout des vacances scolaires...
2025-11-23 21:05:34,164 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-11-23 21:05:34,178 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1415, 147)
2025-11-23 21:05:34,178 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-23 21:05:34,179 - __main__ - INFO -    - Jours de pont: 85 (6.01%)
2025-11-23 21:05:34,179 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.2
2025-11-23 21:05:34,179 - __main__ - INFO -    - Vacances scolaires: 590 (41.70%)
2025-11-23 21:05:34,179 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-11-23 21:05:34,179 - __main__ - INFO -    - Weekends 4j: 101 (7.14%)
2025-11-23 21:05:34,184 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 21:05:34,185 - __main__ - INFO - --------------------------------
2025-11-23 21:05:34,185 - __main__ - INFO - Horizon: 7
2025-11-23 21:05:34,185 - __main__ - INFO - --------------------------------
2025-11-23 21:05:34,186 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_last_jump', 'comp_trend_changes', 'month', 'dayofweek',
       'is_holiday_fr', 'is_bridge_day', 'days_to_holiday',
       'is_vacances_scolaires', 'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=147)
2025-11-23 21:05:34,186 - __main__ - INFO - Nombre total de features: 76
2025-11-23 21:05:34,187 - __main__ - INFO -    - TO historiques: 53
2025-11-23 21:05:34,187 - __main__ - INFO -    - Features PM: 7
2025-11-23 21:05:34,187 - __main__ - INFO -    - Features concurrents: 6
2025-11-23 21:05:34,187 - __main__ - INFO -    - Autres features: 10
2025-11-23 21:05:34,338 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement brutes sauvegard√©es: results/D09\training_data_before_scaling.csv
2025-11-23 21:05:34,338 - __main__ - INFO -    Shape: (1326, 147)
2025-11-23 21:05:34,338 - __main__ - INFO -    Colonnes: 147 colonnes au total
2025-11-23 21:05:34,339 - __main__ - INFO - X shape: (1326, 76), y shape: (1326,)
2025-11-23 21:05:34,339 - __main__ - INFO - ================================================================================
2025-11-23 21:05:34,339 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (GRID SEARCH)
2025-11-23 21:05:34,339 - __main__ - INFO - ================================================================================
2025-11-23 21:05:34,344 - __main__ - INFO - Train: (1060, 76), Validation: (266, 76)
2025-11-23 21:05:34,344 - __main__ - INFO - Configuration de la recherche:
2025-11-23 21:05:34,344 - __main__ - INFO -    - Nombre total de combinaisons: 864
2025-11-23 21:05:34,344 - __main__ - INFO -    - Cross-validation: 3 folds
2025-11-23 21:05:34,344 - __main__ - INFO -    - Nombre total d'entra√Ænements: 2592
2025-11-23 21:05:34,345 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-11-23 21:05:34,345 - __main__ - INFO - 
2025-11-23 21:05:34,345 - __main__ - INFO - ‚ö†Ô∏è  Attention : Grid Search peut prendre beaucoup de temps !
2025-11-23 21:05:34,345 - __main__ - INFO -     Pour une recherche plus rapide, r√©duisez les valeurs dans param_grid
2025-11-23 21:05:34,345 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-11-23 21:56:30,532 - __main__ - INFO - ================================================================================
2025-11-23 21:56:30,533 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 21:56:30,533 - __main__ - INFO - ================================================================================
2025-11-23 21:56:30,533 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 21:56:30,536 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-23 21:56:30,536 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 21:56:30,536 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-11-23 21:56:30,536 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 21:56:30,576 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 21:56:30,661 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 21:56:30,661 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 21:56:30,732 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 21:56:30,736 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 21:56:31,920 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 21:56:31,920 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-11-23 21:56:32,107 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-11-23 21:56:32,107 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-11-23 21:56:33,140 - __main__ - INFO - Features concurrentes ajout√©es (6 features). Shape: (1415, 139)
2025-11-23 21:56:33,143 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-23 21:56:34,010 - __main__ - INFO - Ajout des vacances scolaires...
2025-11-23 21:56:34,116 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-11-23 21:56:34,204 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1415, 147)
2025-11-23 21:56:34,205 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-23 21:56:34,205 - __main__ - INFO -    - Jours de pont: 85 (6.01%)
2025-11-23 21:56:34,205 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.2
2025-11-23 21:56:34,205 - __main__ - INFO -    - Vacances scolaires: 590 (41.70%)
2025-11-23 21:56:34,206 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-11-23 21:56:34,206 - __main__ - INFO -    - Weekends 4j: 101 (7.14%)
2025-11-23 21:56:34,210 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 21:56:34,210 - __main__ - INFO - --------------------------------
2025-11-23 21:56:34,210 - __main__ - INFO - Horizon: 7
2025-11-23 21:56:34,210 - __main__ - INFO - --------------------------------
2025-11-23 21:56:34,211 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_last_jump', 'comp_trend_changes', 'month', 'dayofweek',
       'is_holiday_fr', 'is_bridge_day', 'days_to_holiday',
       'is_vacances_scolaires', 'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=147)
2025-11-23 21:56:34,211 - __main__ - INFO - Nombre total de features: 76
2025-11-23 21:56:34,211 - __main__ - INFO -    - TO historiques: 53
2025-11-23 21:56:34,212 - __main__ - INFO -    - Features PM: 7
2025-11-23 21:56:34,212 - __main__ - INFO -    - Features concurrents: 6
2025-11-23 21:56:34,212 - __main__ - INFO -    - Autres features: 10
2025-11-23 21:56:34,356 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement brutes sauvegard√©es: results/D09\training_data_before_scaling.csv
2025-11-23 21:56:34,356 - __main__ - INFO -    Shape: (1326, 147)
2025-11-23 21:56:34,356 - __main__ - INFO -    Colonnes: 147 colonnes au total
2025-11-23 21:56:34,356 - __main__ - INFO - X shape: (1326, 76), y shape: (1326,)
2025-11-23 21:56:34,356 - __main__ - INFO - ================================================================================
2025-11-23 21:56:34,357 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-11-23 21:56:34,357 - __main__ - INFO - ================================================================================
2025-11-23 21:56:34,363 - __main__ - INFO - Train: (1060, 76), Validation: (266, 76)
2025-11-23 21:56:34,363 - __main__ - INFO - Configuration de la recherche:
2025-11-23 21:56:34,363 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-11-23 21:56:34,363 - __main__ - INFO -    - Cross-validation: 3 folds
2025-11-23 21:56:34,363 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-11-23 21:56:34,364 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-11-23 21:56:34,364 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-11-23 21:58:07,535 - __main__ - INFO - ================================================================================
2025-11-23 21:58:07,535 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-11-23 21:58:07,536 - __main__ - INFO - ================================================================================
2025-11-23 21:58:07,536 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0582
2025-11-23 21:58:07,536 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-11-23 21:58:07,537 - __main__ - INFO -    - subsample: 0.95
2025-11-23 21:58:07,537 - __main__ - INFO -    - reg_lambda: 1.0
2025-11-23 21:58:07,537 - __main__ - INFO -    - reg_alpha: 0
2025-11-23 21:58:07,537 - __main__ - INFO -    - n_estimators: 500
2025-11-23 21:58:07,538 - __main__ - INFO -    - min_child_weight: 3
2025-11-23 21:58:07,538 - __main__ - INFO -    - max_depth: 5
2025-11-23 21:58:07,538 - __main__ - INFO -    - learning_rate: 0.05
2025-11-23 21:58:07,538 - __main__ - INFO -    - colsample_bytree: 0.95
2025-11-23 21:58:07,554 - __main__ - INFO - 
Performances sur validation:
2025-11-23 21:58:07,555 - __main__ - INFO -    - MAE: 0.0479
2025-11-23 21:58:07,555 - __main__ - INFO -    - R¬≤: 0.8523
2025-11-23 21:58:07,555 - __main__ - INFO - ================================================================================
2025-11-23 21:58:07,556 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-11-23 21:58:07,556 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 21:58:07,564 - __main__ - INFO - Train: (1060, 76), Test: (266, 76)
2025-11-23 21:58:09,231 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 21:58:09,269 - __main__ - INFO - üìä Test MAE: 0.0479
2025-11-23 21:58:09,270 - __main__ - INFO - üìä Test R¬≤: 0.8523
2025-11-23 21:58:09,270 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 21:58:10,141 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-23 21:58:10,443 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-23 21:58:10,460 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-23 21:58:10,493 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-23 21:58:10,493 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-23 21:58:10,493 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-23 21:58:11,493 - __main__ - INFO - ================================================================================
2025-11-23 21:58:11,494 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 21:58:11,494 - __main__ - INFO - ================================================================================
2025-11-23 21:58:11,494 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 21:58:11,495 - __main__ - INFO -    Train MAE: 0.0054
2025-11-23 21:58:11,495 - __main__ - INFO -    Train R¬≤:  0.9983
2025-11-23 21:58:11,495 - __main__ - INFO -    Test MAE:  0.0479
2025-11-23 21:58:11,495 - __main__ - INFO -    Test R¬≤:   0.8523
2025-11-23 22:15:05,433 - __main__ - INFO - ================================================================================
2025-11-23 22:15:05,434 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-23 22:15:05,434 - __main__ - INFO - ================================================================================
2025-11-23 22:15:05,434 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-23 22:15:05,437 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-23 22:15:05,438 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-23 22:15:05,438 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-11-23 22:15:05,438 - __main__ - INFO - Chargement des donn√©es...
2025-11-23 22:15:05,454 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-23 22:15:05,531 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-23 22:15:05,532 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-23 22:15:05,583 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-23 22:15:05,587 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-23 22:15:06,982 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-23 22:15:06,983 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-11-23 22:15:07,115 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-11-23 22:15:07,115 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-11-23 22:15:08,205 - __main__ - INFO - Features concurrentes ajout√©es (6 features). Shape: (1415, 139)
2025-11-23 22:15:08,207 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-11-23 22:15:08,225 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-11-23 22:15:08,225 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-23 22:15:08,657 - __main__ - INFO - Ajout des vacances scolaires...
2025-11-23 22:15:08,758 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-11-23 22:15:08,775 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 148)
2025-11-23 22:15:08,775 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-23 22:15:08,775 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-11-23 22:15:08,776 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-11-23 22:15:08,777 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-11-23 22:15:08,777 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-11-23 22:15:08,777 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-11-23 22:15:08,782 - __main__ - INFO - Cr√©ation des features et target...
2025-11-23 22:15:08,783 - __main__ - INFO - --------------------------------
2025-11-23 22:15:08,783 - __main__ - INFO - Horizon: 7
2025-11-23 22:15:08,783 - __main__ - INFO - --------------------------------
2025-11-23 22:15:08,784 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=148)
2025-11-23 22:15:08,784 - __main__ - INFO - Nombre total de features: 77
2025-11-23 22:15:08,784 - __main__ - INFO -    - TO historiques: 53
2025-11-23 22:15:08,784 - __main__ - INFO -    - Features PM: 7
2025-11-23 22:15:08,784 - __main__ - INFO -    - Features concurrents: 6
2025-11-23 22:15:08,785 - __main__ - INFO -    - Autres features: 11
2025-11-23 22:15:08,941 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement brutes sauvegard√©es: results/D09\training_data_before_scaling.csv
2025-11-23 22:15:08,942 - __main__ - INFO -    Shape: (1327, 148)
2025-11-23 22:15:08,942 - __main__ - INFO -    Colonnes: 148 colonnes au total
2025-11-23 22:15:08,942 - __main__ - INFO - X shape: (1327, 77), y shape: (1327,)
2025-11-23 22:15:08,942 - __main__ - INFO - ================================================================================
2025-11-23 22:15:08,942 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-11-23 22:15:08,943 - __main__ - INFO - ================================================================================
2025-11-23 22:15:08,946 - __main__ - INFO - Train: (1061, 77), Validation: (266, 77)
2025-11-23 22:15:08,947 - __main__ - INFO - Configuration de la recherche:
2025-11-23 22:15:08,947 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-11-23 22:15:08,947 - __main__ - INFO -    - Cross-validation: 3 folds
2025-11-23 22:15:08,947 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-11-23 22:15:08,947 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-11-23 22:15:08,948 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-11-23 22:17:02,495 - __main__ - INFO - ================================================================================
2025-11-23 22:17:02,496 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-11-23 22:17:02,497 - __main__ - INFO - ================================================================================
2025-11-23 22:17:02,497 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0568
2025-11-23 22:17:02,497 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-11-23 22:17:02,498 - __main__ - INFO -    - subsample: 0.95
2025-11-23 22:17:02,498 - __main__ - INFO -    - reg_lambda: 1.0
2025-11-23 22:17:02,498 - __main__ - INFO -    - reg_alpha: 0.1
2025-11-23 22:17:02,498 - __main__ - INFO -    - n_estimators: 600
2025-11-23 22:17:02,499 - __main__ - INFO -    - min_child_weight: 3
2025-11-23 22:17:02,499 - __main__ - INFO -    - max_depth: 5
2025-11-23 22:17:02,500 - __main__ - INFO -    - learning_rate: 0.01
2025-11-23 22:17:02,500 - __main__ - INFO -    - colsample_bytree: 0.85
2025-11-23 22:17:02,508 - __main__ - INFO - 
Performances sur validation:
2025-11-23 22:17:02,511 - __main__ - INFO -    - MAE: 0.0501
2025-11-23 22:17:02,511 - __main__ - INFO -    - R¬≤: 0.8441
2025-11-23 22:17:02,512 - __main__ - INFO - ================================================================================
2025-11-23 22:17:02,513 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-11-23 22:17:02,514 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-23 22:17:02,527 - __main__ - INFO - Train: (1061, 77), Test: (266, 77)
2025-11-23 22:17:05,895 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-23 22:17:05,911 - __main__ - INFO - üìä Test MAE: 0.0501
2025-11-23 22:17:05,912 - __main__ - INFO - üìä Test R¬≤: 0.8441
2025-11-23 22:17:05,913 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-23 22:17:06,500 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-23 22:17:07,056 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-23 22:17:07,082 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-23 22:17:07,124 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-23 22:17:07,125 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-23 22:17:07,125 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-23 22:17:08,121 - __main__ - INFO - ================================================================================
2025-11-23 22:17:08,122 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-23 22:17:08,122 - __main__ - INFO - ================================================================================
2025-11-23 22:17:08,122 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-23 22:17:08,123 - __main__ - INFO -    Train MAE: 0.0280
2025-11-23 22:17:08,123 - __main__ - INFO -    Train R¬≤:  0.9575
2025-11-23 22:17:08,123 - __main__ - INFO -    Test MAE:  0.0501
2025-11-23 22:17:08,124 - __main__ - INFO -    Test R¬≤:   0.8441
2025-11-24 09:45:38,142 - __main__ - INFO - ================================================================================
2025-11-24 09:45:38,143 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-24 09:45:38,143 - __main__ - INFO - ================================================================================
2025-11-24 09:45:38,143 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-24 09:45:38,147 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-24 09:45:38,147 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-24 09:45:38,147 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-11-24 09:45:38,147 - __main__ - INFO - Chargement des donn√©es...
2025-11-24 09:45:38,184 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-24 09:45:38,279 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-24 09:45:38,280 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-24 09:45:38,338 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-24 09:45:38,342 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-24 09:45:39,540 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-24 09:45:39,541 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-11-24 09:45:39,676 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-11-24 09:45:39,677 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-11-24 09:45:40,632 - __main__ - INFO - Features concurrentes ajout√©es (6 features). Shape: (1415, 139)
2025-11-24 09:45:40,635 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-11-24 09:45:40,640 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-11-24 09:45:40,641 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-24 09:45:41,673 - __main__ - INFO - Ajout des vacances scolaires...
2025-11-24 09:45:41,787 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-11-24 09:45:41,803 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 148)
2025-11-24 09:45:41,804 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-24 09:45:41,805 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-11-24 09:45:41,805 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-11-24 09:45:41,806 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-11-24 09:45:41,806 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-11-24 09:45:41,806 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-11-24 09:45:41,812 - __main__ - INFO - Cr√©ation des features et target...
2025-11-24 09:45:41,812 - __main__ - INFO - --------------------------------
2025-11-24 09:45:41,812 - __main__ - INFO - Horizon: 7
2025-11-24 09:45:41,812 - __main__ - INFO - --------------------------------
2025-11-24 09:45:41,813 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=148)
2025-11-24 09:45:41,813 - __main__ - INFO - Nombre total de features: 77
2025-11-24 09:45:41,813 - __main__ - INFO -    - TO historiques: 53
2025-11-24 09:45:41,814 - __main__ - INFO -    - Features PM: 7
2025-11-24 09:45:41,814 - __main__ - INFO -    - Features concurrents: 6
2025-11-24 09:45:41,814 - __main__ - INFO -    - Autres features: 11
2025-11-24 09:45:41,971 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement brutes sauvegard√©es: results/D09\training_data_before_scaling.csv
2025-11-24 09:45:41,972 - __main__ - INFO -    Shape: (1327, 148)
2025-11-24 09:45:41,972 - __main__ - INFO -    Colonnes: 148 colonnes au total
2025-11-24 09:45:41,972 - __main__ - INFO - X shape: (1327, 77), y shape: (1327,)
2025-11-24 09:45:41,973 - __main__ - INFO - ================================================================================
2025-11-24 09:45:41,973 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-11-24 09:45:41,973 - __main__ - INFO - ================================================================================
2025-11-24 09:45:41,977 - __main__ - INFO - Train: (1061, 77), Validation: (266, 77)
2025-11-24 09:45:41,978 - __main__ - INFO - Configuration de la recherche:
2025-11-24 09:45:41,978 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-11-24 09:45:41,978 - __main__ - INFO -    - Cross-validation: 3 folds
2025-11-24 09:45:41,978 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-11-24 09:45:41,979 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-11-24 09:45:41,979 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-11-24 10:29:17,861 - __main__ - INFO - ================================================================================
2025-11-24 10:29:17,862 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-24 10:29:17,862 - __main__ - INFO - ================================================================================
2025-11-24 10:29:17,863 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-24 10:29:17,869 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-24 10:29:17,869 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-24 10:29:17,870 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-11-24 10:29:17,870 - __main__ - INFO - Chargement des donn√©es...
2025-11-24 10:29:17,915 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-24 10:29:18,089 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-24 10:29:18,090 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-24 10:29:18,218 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-24 10:29:18,226 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-24 10:29:18,227 - __main__ - INFO - Calcul des features PM sur donn√©es J-7 √† J-60 (pas de data leakage)
2025-11-24 10:29:18,228 - __main__ - INFO -    Colonnes PM utilis√©es: 54
2025-11-24 10:29:20,545 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-24 10:29:20,545 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-11-24 10:29:20,776 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-11-24 10:29:20,776 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-11-24 10:29:21,116 - __main__ - INFO -    Features concurrentes calcul√©es sur J-7 √† J-60
2025-11-24 10:29:22,668 - __main__ - INFO - Features concurrentes ajout√©es (6 features). Shape: (1415, 139)
2025-11-24 10:29:22,673 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-11-24 10:29:22,689 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-11-24 10:29:22,689 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-24 10:29:24,102 - __main__ - INFO - Ajout des vacances scolaires...
2025-11-24 10:29:24,277 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-11-24 10:29:24,312 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 148)
2025-11-24 10:29:24,313 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-24 10:29:24,313 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-11-24 10:29:24,314 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-11-24 10:29:24,314 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-11-24 10:29:24,314 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-11-24 10:29:24,315 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-11-24 10:29:24,322 - __main__ - INFO - Cr√©ation des features et target...
2025-11-24 10:29:24,322 - __main__ - INFO - --------------------------------
2025-11-24 10:29:24,322 - __main__ - INFO - Horizon: 7
2025-11-24 10:29:24,323 - __main__ - INFO - --------------------------------
2025-11-24 10:29:24,324 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=148)
2025-11-24 10:29:24,324 - __main__ - INFO - Nombre total de features: 77
2025-11-24 10:29:24,325 - __main__ - INFO -    - TO historiques: 53
2025-11-24 10:29:24,325 - __main__ - INFO -    - Features PM: 7
2025-11-24 10:29:24,325 - __main__ - INFO -    - Features concurrents: 6
2025-11-24 10:29:24,325 - __main__ - INFO -    - Autres features: 11
2025-11-24 10:29:24,499 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\training_data_before_scaling.csv
2025-11-24 10:29:24,500 - __main__ - INFO -    Shape: (1327, 80)
2025-11-24 10:29:24,500 - __main__ - INFO -    Colonnes: stay_date, hotCode, 77 features, J-0
2025-11-24 10:29:24,501 - __main__ - INFO - X shape: (1327, 77), y shape: (1327,)
2025-11-24 10:29:24,501 - __main__ - INFO - ================================================================================
2025-11-24 10:29:24,502 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-11-24 10:29:24,502 - __main__ - INFO - ================================================================================
2025-11-24 10:29:24,512 - __main__ - INFO - Train: (1061, 77), Validation: (266, 77)
2025-11-24 10:29:24,512 - __main__ - INFO - Configuration de la recherche:
2025-11-24 10:29:24,513 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-11-24 10:29:24,513 - __main__ - INFO -    - Cross-validation: 3 folds
2025-11-24 10:29:24,513 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-11-24 10:29:24,513 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-11-24 10:29:24,514 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-11-24 10:31:12,715 - __main__ - INFO - ================================================================================
2025-11-24 10:31:12,716 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-11-24 10:31:12,716 - __main__ - INFO - ================================================================================
2025-11-24 10:31:12,716 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0573
2025-11-24 10:31:12,716 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-11-24 10:31:12,716 - __main__ - INFO -    - subsample: 0.9
2025-11-24 10:31:12,716 - __main__ - INFO -    - reg_lambda: 0.5
2025-11-24 10:31:12,717 - __main__ - INFO -    - reg_alpha: 0.1
2025-11-24 10:31:12,717 - __main__ - INFO -    - n_estimators: 800
2025-11-24 10:31:12,717 - __main__ - INFO -    - min_child_weight: 3
2025-11-24 10:31:12,717 - __main__ - INFO -    - max_depth: 6
2025-11-24 10:31:12,717 - __main__ - INFO -    - learning_rate: 0.01
2025-11-24 10:31:12,717 - __main__ - INFO -    - colsample_bytree: 0.85
2025-11-24 10:31:12,724 - __main__ - INFO - 
Performances sur validation:
2025-11-24 10:31:12,725 - __main__ - INFO -    - MAE: 0.0497
2025-11-24 10:31:12,726 - __main__ - INFO -    - R¬≤: 0.8515
2025-11-24 10:31:12,726 - __main__ - INFO - ================================================================================
2025-11-24 10:31:12,728 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-11-24 10:31:12,730 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-24 10:31:12,739 - __main__ - INFO - Train: (1061, 77), Test: (266, 77)
2025-11-24 10:31:15,818 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-24 10:31:15,861 - __main__ - INFO - üìä Test MAE: 0.0497
2025-11-24 10:31:15,863 - __main__ - INFO - üìä Test R¬≤: 0.8515
2025-11-24 10:31:15,863 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-24 10:31:16,448 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-24 10:31:16,777 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-24 10:31:16,790 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-24 10:31:16,917 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-24 10:31:16,918 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-24 10:31:16,918 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-24 10:31:18,000 - __main__ - INFO - ================================================================================
2025-11-24 10:31:18,000 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-24 10:31:18,000 - __main__ - INFO - ================================================================================
2025-11-24 10:31:18,000 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-24 10:31:18,001 - __main__ - INFO -    Train MAE: 0.0163
2025-11-24 10:31:18,001 - __main__ - INFO -    Train R¬≤:  0.9851
2025-11-24 10:31:18,001 - __main__ - INFO -    Test MAE:  0.0497
2025-11-24 10:31:18,001 - __main__ - INFO -    Test R¬≤:   0.8515
2025-11-24 11:00:13,333 - __main__ - INFO - ================================================================================
2025-11-24 11:00:13,333 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-24 11:00:13,334 - __main__ - INFO - ================================================================================
2025-11-24 11:00:13,334 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-24 11:00:13,338 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-24 11:00:13,339 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-24 11:00:13,339 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-11-24 11:00:13,339 - __main__ - INFO - Chargement des donn√©es...
2025-11-24 11:00:13,358 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-24 11:00:13,452 - __main__ - INFO - Indicateurs charg√©s: (86315, 15)
2025-11-24 11:00:13,453 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-24 11:00:13,505 - __main__ - INFO - PM pivot shape: (1415, 63)
2025-11-24 11:00:13,508 - __main__ - INFO - DataFrame fusionn√©: (1415, 126)
2025-11-24 11:00:13,508 - __main__ - INFO - Calcul des features PM sur donn√©es J-7 √† J-60 (pas de data leakage)
2025-11-24 11:00:13,508 - __main__ - INFO -    Colonnes PM utilis√©es: 54
2025-11-24 11:00:14,843 - __main__ - INFO - Features PM ajout√©es: (1415, 133)
2025-11-24 11:00:14,843 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-11-24 11:00:14,971 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-11-24 11:00:14,971 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-11-24 11:00:15,132 - __main__ - INFO -    Features concurrentes calcul√©es sur J-7 √† J-60
2025-11-24 11:00:15,985 - __main__ - INFO - Features concurrentes ajout√©es (6 features). Shape: (1415, 139)
2025-11-24 11:00:15,987 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-11-24 11:00:15,993 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-11-24 11:00:15,993 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-24 11:00:16,437 - __main__ - INFO - Ajout des vacances scolaires...
2025-11-24 11:00:16,539 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-11-24 11:00:16,559 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 148)
2025-11-24 11:00:16,560 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-24 11:00:16,561 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-11-24 11:00:16,561 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-11-24 11:00:16,561 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-11-24 11:00:16,562 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-11-24 11:00:16,562 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-11-24 11:00:16,567 - __main__ - INFO - Cr√©ation des features et target...
2025-11-24 11:00:16,568 - __main__ - INFO - --------------------------------
2025-11-24 11:00:16,568 - __main__ - INFO - Horizon: 7
2025-11-24 11:00:16,568 - __main__ - INFO - --------------------------------
2025-11-24 11:00:16,569 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=148)
2025-11-24 11:00:16,569 - __main__ - INFO - Nombre total de features: 77
2025-11-24 11:00:16,569 - __main__ - INFO -    - TO historiques: 53
2025-11-24 11:00:16,570 - __main__ - INFO -    - Features PM: 7
2025-11-24 11:00:16,570 - __main__ - INFO -    - Features concurrents: 6
2025-11-24 11:00:16,570 - __main__ - INFO -    - Autres features: 11
2025-11-24 11:00:16,677 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\training_data_before_scaling.csv
2025-11-24 11:00:16,677 - __main__ - INFO -    Shape: (1327, 80)
2025-11-24 11:00:16,677 - __main__ - INFO -    Colonnes: stay_date, hotCode, 77 features, J-0
2025-11-24 11:00:16,677 - __main__ - INFO - X shape: (1327, 77), y shape: (1327,)
2025-11-24 11:00:16,678 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-24 11:00:16,682 - __main__ - INFO - Train: (1061, 77), Test: (266, 77)
2025-11-24 11:00:21,165 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-24 11:00:21,184 - __main__ - INFO - üìä Test MAE: 0.0512
2025-11-24 11:00:21,184 - __main__ - INFO - üìä Test R¬≤: 0.8374
2025-11-24 11:00:21,185 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-24 11:00:21,740 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-24 11:00:22,265 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-24 11:00:22,296 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-24 11:00:22,369 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-24 11:00:22,373 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-24 11:00:22,379 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-24 11:00:23,511 - __main__ - INFO - ================================================================================
2025-11-24 11:00:23,512 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-24 11:00:23,512 - __main__ - INFO - ================================================================================
2025-11-24 11:00:23,512 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-24 11:00:23,512 - __main__ - INFO -    Train MAE: 0.0004
2025-11-24 11:00:23,513 - __main__ - INFO -    Train R¬≤:  1.0000
2025-11-24 11:00:23,513 - __main__ - INFO -    Test MAE:  0.0512
2025-11-24 11:00:23,513 - __main__ - INFO -    Test R¬≤:   0.8374
2025-11-24 18:29:33,162 - __main__ - INFO - ================================================================================
2025-11-24 18:29:33,162 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-24 18:29:33,162 - __main__ - INFO - ================================================================================
2025-11-24 18:29:33,163 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-24 18:29:33,166 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-24 18:29:33,167 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-24 18:29:33,167 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-11-24 18:29:33,167 - __main__ - INFO - Chargement des donn√©es...
2025-11-24 18:29:33,204 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-24 18:29:33,300 - __main__ - INFO - Indicateurs charg√©s: (86803, 17)
2025-11-24 18:29:33,300 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-24 18:29:33,451 - __main__ - INFO - PM pivot shape: (1423, 63)
2025-11-24 18:29:33,472 - __main__ - INFO - Ant pivot shape: (1423, 63)
2025-11-24 18:29:33,492 - __main__ - INFO - Ds pivot shape: (1423, 63)
2025-11-24 18:29:33,502 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-11-24 18:29:33,502 - __main__ - INFO - Calcul des features PM sur donn√©es J-7 √† J-60 (pas de data leakage)
2025-11-24 18:29:33,503 - __main__ - INFO -    Colonnes PM utilis√©es: 54
2025-11-24 18:29:34,663 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-11-24 18:29:34,663 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-7 √† J-60
2025-11-24 18:29:34,664 - __main__ - INFO -    Colonnes Ant utilis√©es: 54
2025-11-24 18:29:35,426 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-11-24 18:29:35,426 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-7 √† J-60
2025-11-24 18:29:35,426 - __main__ - INFO -    Colonnes Ds utilis√©es: 54
2025-11-24 18:29:36,184 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-11-24 18:29:36,184 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-11-24 18:29:36,303 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-11-24 18:29:36,303 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-11-24 18:29:36,458 - __main__ - INFO -    Features concurrentes calcul√©es sur J-7 √† J-60
2025-11-24 18:29:37,202 - __main__ - INFO - Features concurrentes ajout√©es (6 features). Shape: (1415, 273)
2025-11-24 18:29:37,204 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-11-24 18:29:37,209 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-11-24 18:29:37,209 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-24 18:29:38,207 - __main__ - INFO - Ajout des vacances scolaires...
2025-11-24 18:29:38,303 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-11-24 18:29:38,316 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 282)
2025-11-24 18:29:38,317 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-24 18:29:38,317 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-11-24 18:29:38,318 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-11-24 18:29:38,318 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-11-24 18:29:38,319 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-11-24 18:29:38,320 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-11-24 18:29:38,325 - __main__ - INFO - Cr√©ation des features et target...
2025-11-24 18:29:38,326 - __main__ - INFO - --------------------------------
2025-11-24 18:29:38,326 - __main__ - INFO - Horizon: 7
2025-11-24 18:29:38,327 - __main__ - INFO - --------------------------------
2025-11-24 18:29:38,327 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=282)
2025-11-24 18:29:38,328 - __main__ - INFO - Nombre total de features: 89
2025-11-24 18:29:38,328 - __main__ - INFO -    - TO historiques: 53
2025-11-24 18:29:38,328 - __main__ - INFO -    - Features PM: 7
2025-11-24 18:29:38,328 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-11-24 18:29:38,328 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-11-24 18:29:38,329 - __main__ - INFO -    - Features concurrents: 6
2025-11-24 18:29:38,329 - __main__ - INFO -    - Autres features: 11
2025-11-24 18:29:38,447 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\training_data_before_scaling.csv
2025-11-24 18:29:38,447 - __main__ - INFO -    Shape: (1327, 92)
2025-11-24 18:29:38,447 - __main__ - INFO -    Colonnes: stay_date, hotCode, 89 features, J-0
2025-11-24 18:29:38,448 - __main__ - INFO - X shape: (1327, 89), y shape: (1327,)
2025-11-24 18:29:38,449 - __main__ - INFO - ================================================================================
2025-11-24 18:29:38,449 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-11-24 18:29:38,450 - __main__ - INFO - ================================================================================
2025-11-24 18:29:38,455 - __main__ - INFO - Train: (1061, 89), Validation: (266, 89)
2025-11-24 18:29:38,455 - __main__ - INFO - Configuration de la recherche:
2025-11-24 18:29:38,455 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-11-24 18:29:38,456 - __main__ - INFO -    - Cross-validation: 3 folds
2025-11-24 18:29:38,456 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-11-24 18:29:38,456 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-11-24 18:29:38,457 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-11-24 18:31:34,693 - __main__ - INFO - ================================================================================
2025-11-24 18:31:34,693 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-11-24 18:31:34,693 - __main__ - INFO - ================================================================================
2025-11-24 18:31:34,694 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0578
2025-11-24 18:31:34,694 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-11-24 18:31:34,694 - __main__ - INFO -    - subsample: 0.95
2025-11-24 18:31:34,694 - __main__ - INFO -    - reg_lambda: 1.0
2025-11-24 18:31:34,694 - __main__ - INFO -    - reg_alpha: 0
2025-11-24 18:31:34,695 - __main__ - INFO -    - n_estimators: 500
2025-11-24 18:31:34,695 - __main__ - INFO -    - min_child_weight: 3
2025-11-24 18:31:34,695 - __main__ - INFO -    - max_depth: 5
2025-11-24 18:31:34,695 - __main__ - INFO -    - learning_rate: 0.05
2025-11-24 18:31:34,695 - __main__ - INFO -    - colsample_bytree: 0.95
2025-11-24 18:31:34,700 - __main__ - INFO - 
Performances sur validation:
2025-11-24 18:31:34,700 - __main__ - INFO -    - MAE: 0.0512
2025-11-24 18:31:34,701 - __main__ - INFO -    - R¬≤: 0.8398
2025-11-24 18:31:34,701 - __main__ - INFO - ================================================================================
2025-11-24 18:31:34,701 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-11-24 18:31:34,702 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-24 18:31:34,707 - __main__ - INFO - Train: (1061, 89), Test: (266, 89)
2025-11-24 18:31:36,157 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-24 18:31:36,169 - __main__ - INFO - üìä Test MAE: 0.0512
2025-11-24 18:31:36,169 - __main__ - INFO - üìä Test R¬≤: 0.8398
2025-11-24 18:31:36,169 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-24 18:31:37,135 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-24 18:31:37,441 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-24 18:31:37,456 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-24 18:31:37,488 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-24 18:31:37,489 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-24 18:31:37,489 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-24 18:31:43,377 - __main__ - INFO - ================================================================================
2025-11-24 18:31:43,377 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-24 18:31:43,377 - __main__ - INFO - ================================================================================
2025-11-24 18:31:43,377 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-24 18:31:43,378 - __main__ - INFO -    Train MAE: 0.0041
2025-11-24 18:31:43,378 - __main__ - INFO -    Train R¬≤:  0.9990
2025-11-24 18:31:43,378 - __main__ - INFO -    Test MAE:  0.0512
2025-11-24 18:31:43,378 - __main__ - INFO -    Test R¬≤:   0.8398
2025-11-24 18:32:27,921 - __main__ - INFO - ================================================================================
2025-11-24 18:32:27,921 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-24 18:32:27,921 - __main__ - INFO - ================================================================================
2025-11-24 18:32:27,922 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-24 18:32:27,925 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-24 18:32:27,925 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-24 18:32:27,926 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 15, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-11-24 18:32:27,926 - __main__ - INFO - Chargement des donn√©es...
2025-11-24 18:32:27,942 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-24 18:32:28,019 - __main__ - INFO - Indicateurs charg√©s: (86803, 17)
2025-11-24 18:32:28,020 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-24 18:32:28,065 - __main__ - INFO - PM pivot shape: (1423, 63)
2025-11-24 18:32:28,086 - __main__ - INFO - Ant pivot shape: (1423, 63)
2025-11-24 18:32:28,108 - __main__ - INFO - Ds pivot shape: (1423, 63)
2025-11-24 18:32:28,121 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-11-24 18:32:28,121 - __main__ - INFO - Calcul des features PM sur donn√©es J-15 √† J-60 (pas de data leakage)
2025-11-24 18:32:28,122 - __main__ - INFO -    Colonnes PM utilis√©es: 46
2025-11-24 18:32:29,422 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-11-24 18:32:29,423 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-15 √† J-60
2025-11-24 18:32:29,423 - __main__ - INFO -    Colonnes Ant utilis√©es: 46
2025-11-24 18:32:30,230 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-11-24 18:32:30,230 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-15 √† J-60
2025-11-24 18:32:30,230 - __main__ - INFO -    Colonnes Ds utilis√©es: 46
2025-11-24 18:32:31,084 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-11-24 18:32:31,084 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-11-24 18:32:31,197 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-11-24 18:32:31,197 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-11-24 18:32:31,351 - __main__ - INFO -    Features concurrentes calcul√©es sur J-15 √† J-60
2025-11-24 18:32:32,131 - __main__ - INFO - Features concurrentes ajout√©es (6 features). Shape: (1415, 273)
2025-11-24 18:32:32,133 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-11-24 18:32:32,139 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-11-24 18:32:32,140 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-24 18:32:32,665 - __main__ - INFO - Ajout des vacances scolaires...
2025-11-24 18:32:32,764 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-11-24 18:32:32,778 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 282)
2025-11-24 18:32:32,779 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-24 18:32:32,779 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-11-24 18:32:32,779 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-11-24 18:32:32,780 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-11-24 18:32:32,780 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-11-24 18:32:32,781 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-11-24 18:32:32,787 - __main__ - INFO - Cr√©ation des features et target...
2025-11-24 18:32:32,787 - __main__ - INFO - --------------------------------
2025-11-24 18:32:32,787 - __main__ - INFO - Horizon: 15
2025-11-24 18:32:32,788 - __main__ - INFO - --------------------------------
2025-11-24 18:32:32,788 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=282)
2025-11-24 18:32:32,789 - __main__ - INFO - Nombre total de features: 81
2025-11-24 18:32:32,789 - __main__ - INFO -    - TO historiques: 45
2025-11-24 18:32:32,789 - __main__ - INFO -    - Features PM: 7
2025-11-24 18:32:32,790 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-11-24 18:32:32,790 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-11-24 18:32:32,790 - __main__ - INFO -    - Features concurrents: 6
2025-11-24 18:32:32,790 - __main__ - INFO -    - Autres features: 11
2025-11-24 18:32:32,805 - __main__ - WARNING - ‚ö†Ô∏è  Erreur lors de la sauvegarde des donn√©es d'entra√Ænement: [Errno 13] Permission denied: 'results/D09\\training_data_before_scaling.csv'
2025-11-24 18:32:32,805 - __main__ - INFO - X shape: (1327, 81), y shape: (1327,)
2025-11-24 18:32:32,806 - __main__ - INFO - ================================================================================
2025-11-24 18:32:32,806 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-11-24 18:32:32,807 - __main__ - INFO - ================================================================================
2025-11-24 18:32:32,811 - __main__ - INFO - Train: (1061, 81), Validation: (266, 81)
2025-11-24 18:32:32,811 - __main__ - INFO - Configuration de la recherche:
2025-11-24 18:32:32,811 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-11-24 18:32:32,811 - __main__ - INFO -    - Cross-validation: 3 folds
2025-11-24 18:32:32,812 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-11-24 18:32:32,812 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-11-24 18:32:32,812 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-11-24 18:34:15,568 - __main__ - INFO - ================================================================================
2025-11-24 18:34:15,568 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-11-24 18:34:15,569 - __main__ - INFO - ================================================================================
2025-11-24 18:34:15,569 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0702
2025-11-24 18:34:15,569 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-11-24 18:34:15,569 - __main__ - INFO -    - subsample: 0.9
2025-11-24 18:34:15,570 - __main__ - INFO -    - reg_lambda: 0.5
2025-11-24 18:34:15,570 - __main__ - INFO -    - reg_alpha: 0.1
2025-11-24 18:34:15,570 - __main__ - INFO -    - n_estimators: 800
2025-11-24 18:34:15,570 - __main__ - INFO -    - min_child_weight: 3
2025-11-24 18:34:15,570 - __main__ - INFO -    - max_depth: 6
2025-11-24 18:34:15,570 - __main__ - INFO -    - learning_rate: 0.01
2025-11-24 18:34:15,571 - __main__ - INFO -    - colsample_bytree: 0.85
2025-11-24 18:34:15,577 - __main__ - INFO - 
Performances sur validation:
2025-11-24 18:34:15,578 - __main__ - INFO -    - MAE: 0.0647
2025-11-24 18:34:15,578 - __main__ - INFO -    - R¬≤: 0.7477
2025-11-24 18:34:15,578 - __main__ - INFO - ================================================================================
2025-11-24 18:34:15,579 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-11-24 18:34:15,579 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-24 18:34:15,588 - __main__ - INFO - Train: (1061, 81), Test: (266, 81)
2025-11-24 18:34:22,215 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-24 18:34:22,238 - __main__ - INFO - üìä Test MAE: 0.0647
2025-11-24 18:34:22,239 - __main__ - INFO - üìä Test R¬≤: 0.7477
2025-11-24 18:34:22,239 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-24 18:34:22,827 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-24 18:34:23,235 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-24 18:34:23,252 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-24 18:34:23,302 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-24 18:34:23,302 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-24 18:34:23,302 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-24 18:34:44,219 - __main__ - INFO - ================================================================================
2025-11-24 18:34:44,220 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-24 18:34:44,221 - __main__ - INFO - ================================================================================
2025-11-24 18:34:44,221 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-24 18:34:44,221 - __main__ - INFO -    Train MAE: 0.0181
2025-11-24 18:34:44,221 - __main__ - INFO -    Train R¬≤:  0.9816
2025-11-24 18:34:44,222 - __main__ - INFO -    Test MAE:  0.0647
2025-11-24 18:34:44,222 - __main__ - INFO -    Test R¬≤:   0.7477
2025-11-24 18:57:26,168 - __main__ - INFO - ================================================================================
2025-11-24 18:57:26,169 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-24 18:57:26,169 - __main__ - INFO - ================================================================================
2025-11-24 18:57:26,169 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-24 18:57:26,173 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-24 18:57:26,173 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-24 18:57:26,173 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-11-24 18:57:26,173 - __main__ - INFO - Chargement des donn√©es...
2025-11-24 18:57:26,189 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-24 18:57:26,276 - __main__ - INFO - Indicateurs charg√©s: (86803, 17)
2025-11-24 18:57:26,277 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-24 18:57:26,327 - __main__ - INFO - PM pivot shape: (1423, 63)
2025-11-24 18:57:26,349 - __main__ - INFO - Ant pivot shape: (1423, 63)
2025-11-24 18:57:26,372 - __main__ - INFO - Ds pivot shape: (1423, 63)
2025-11-24 18:57:26,383 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-11-24 18:57:26,383 - __main__ - INFO - Calcul des features PM sur donn√©es J-7 √† J-60 (pas de data leakage)
2025-11-24 18:57:26,384 - __main__ - INFO -    Colonnes PM utilis√©es: 54
2025-11-24 18:57:27,759 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-11-24 18:57:27,760 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-7 √† J-60
2025-11-24 18:57:27,760 - __main__ - INFO -    Colonnes Ant utilis√©es: 54
2025-11-24 18:57:29,438 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-11-24 18:57:29,439 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-7 √† J-60
2025-11-24 18:57:29,439 - __main__ - INFO -    Colonnes Ds utilis√©es: 54
2025-11-24 18:57:30,645 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-11-24 18:57:30,645 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-11-24 18:57:30,775 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-11-24 18:57:30,776 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-11-24 18:57:30,922 - __main__ - INFO -    Features concurrentes calcul√©es sur J-7 √† J-60
2025-11-24 18:57:31,658 - __main__ - INFO - Features concurrentes ajout√©es (6 features). Shape: (1415, 273)
2025-11-24 18:57:31,661 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-11-24 18:57:31,666 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-11-24 18:57:31,666 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-24 18:57:32,110 - __main__ - INFO - Ajout des vacances scolaires...
2025-11-24 18:57:32,208 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-11-24 18:57:32,222 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 282)
2025-11-24 18:57:32,223 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-24 18:57:32,223 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-11-24 18:57:32,223 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-11-24 18:57:32,224 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-11-24 18:57:32,224 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-11-24 18:57:32,224 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-11-24 18:57:32,230 - __main__ - INFO - Cr√©ation des features et target...
2025-11-24 18:57:32,230 - __main__ - INFO - --------------------------------
2025-11-24 18:57:32,231 - __main__ - INFO - Horizon: 7
2025-11-24 18:57:32,231 - __main__ - INFO - --------------------------------
2025-11-24 18:57:32,232 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=282)
2025-11-24 18:57:32,234 - __main__ - INFO - nb_observations recalcul√© pour horizon=7
2025-11-24 18:57:32,234 - __main__ - INFO -    Minimum: 54
2025-11-24 18:57:32,235 - __main__ - INFO -    Maximum: 54
2025-11-24 18:57:32,235 - __main__ - INFO -    Moyenne: 54.0
2025-11-24 18:57:32,235 - __main__ - INFO - Nombre total de features: 89
2025-11-24 18:57:32,235 - __main__ - INFO -    - TO historiques: 53
2025-11-24 18:57:32,235 - __main__ - INFO -    - Features PM: 7
2025-11-24 18:57:32,235 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-11-24 18:57:32,236 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-11-24 18:57:32,236 - __main__ - INFO -    - Features concurrents: 6
2025-11-24 18:57:32,236 - __main__ - INFO -    - Autres features: 11
2025-11-24 18:57:32,343 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\training_data_before_scaling.csv
2025-11-24 18:57:32,343 - __main__ - INFO -    Shape: (1327, 92)
2025-11-24 18:57:32,344 - __main__ - INFO -    Colonnes: stay_date, hotCode, 89 features, J-0
2025-11-24 18:57:32,344 - __main__ - INFO - X shape: (1327, 89), y shape: (1327,)
2025-11-24 18:57:32,345 - __main__ - INFO - ================================================================================
2025-11-24 18:57:32,345 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-11-24 18:57:32,346 - __main__ - INFO - ================================================================================
2025-11-24 18:57:32,350 - __main__ - INFO - Train: (1061, 89), Validation: (266, 89)
2025-11-24 18:57:32,350 - __main__ - INFO - Configuration de la recherche:
2025-11-24 18:57:32,350 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-11-24 18:57:32,351 - __main__ - INFO -    - Cross-validation: 3 folds
2025-11-24 18:57:32,351 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-11-24 18:57:32,351 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-11-24 18:57:32,351 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-11-24 18:59:14,250 - __main__ - INFO - ================================================================================
2025-11-24 18:59:14,250 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-11-24 18:59:14,251 - __main__ - INFO - ================================================================================
2025-11-24 18:59:14,251 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0578
2025-11-24 18:59:14,251 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-11-24 18:59:14,251 - __main__ - INFO -    - subsample: 0.95
2025-11-24 18:59:14,252 - __main__ - INFO -    - reg_lambda: 1.0
2025-11-24 18:59:14,252 - __main__ - INFO -    - reg_alpha: 0
2025-11-24 18:59:14,252 - __main__ - INFO -    - n_estimators: 500
2025-11-24 18:59:14,252 - __main__ - INFO -    - min_child_weight: 3
2025-11-24 18:59:14,253 - __main__ - INFO -    - max_depth: 5
2025-11-24 18:59:14,253 - __main__ - INFO -    - learning_rate: 0.05
2025-11-24 18:59:14,253 - __main__ - INFO -    - colsample_bytree: 0.95
2025-11-24 18:59:14,257 - __main__ - INFO - 
Performances sur validation:
2025-11-24 18:59:14,261 - __main__ - INFO -    - MAE: 0.0512
2025-11-24 18:59:14,275 - __main__ - INFO -    - R¬≤: 0.8398
2025-11-24 18:59:14,280 - __main__ - INFO - ================================================================================
2025-11-24 18:59:14,283 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-11-24 18:59:14,285 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-24 18:59:14,295 - __main__ - INFO - Train: (1061, 89), Test: (266, 89)
2025-11-24 18:59:17,318 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-24 18:59:17,334 - __main__ - INFO - üìä Test MAE: 0.0512
2025-11-24 18:59:17,334 - __main__ - INFO - üìä Test R¬≤: 0.8398
2025-11-24 18:59:17,334 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-24 18:59:18,013 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-24 18:59:18,530 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-24 18:59:18,555 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-24 18:59:18,644 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-24 18:59:18,645 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-24 18:59:18,645 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-24 18:59:21,666 - __main__ - INFO - ================================================================================
2025-11-24 18:59:21,667 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-24 18:59:21,667 - __main__ - INFO - ================================================================================
2025-11-24 18:59:21,667 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-24 18:59:21,667 - __main__ - INFO -    Train MAE: 0.0041
2025-11-24 18:59:21,668 - __main__ - INFO -    Train R¬≤:  0.9990
2025-11-24 18:59:21,668 - __main__ - INFO -    Test MAE:  0.0512
2025-11-24 18:59:21,668 - __main__ - INFO -    Test R¬≤:   0.8398
2025-11-24 19:00:09,074 - __main__ - INFO - ================================================================================
2025-11-24 19:00:09,075 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-24 19:00:09,075 - __main__ - INFO - ================================================================================
2025-11-24 19:00:09,076 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-24 19:00:09,080 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-24 19:00:09,080 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-24 19:00:09,080 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 1, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-11-24 19:00:09,080 - __main__ - INFO - Chargement des donn√©es...
2025-11-24 19:00:09,097 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-24 19:00:09,186 - __main__ - INFO - Indicateurs charg√©s: (86803, 17)
2025-11-24 19:00:09,187 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-24 19:00:09,248 - __main__ - INFO - PM pivot shape: (1423, 63)
2025-11-24 19:00:09,271 - __main__ - INFO - Ant pivot shape: (1423, 63)
2025-11-24 19:00:09,295 - __main__ - INFO - Ds pivot shape: (1423, 63)
2025-11-24 19:00:09,306 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-11-24 19:00:09,307 - __main__ - INFO - Calcul des features PM sur donn√©es J-1 √† J-60 (pas de data leakage)
2025-11-24 19:00:09,307 - __main__ - INFO -    Colonnes PM utilis√©es: 60
2025-11-24 19:00:10,611 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-11-24 19:00:10,612 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-1 √† J-60
2025-11-24 19:00:10,612 - __main__ - INFO -    Colonnes Ant utilis√©es: 60
2025-11-24 19:00:11,555 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-11-24 19:00:11,555 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-1 √† J-60
2025-11-24 19:00:11,556 - __main__ - INFO -    Colonnes Ds utilis√©es: 60
2025-11-24 19:00:12,544 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-11-24 19:00:12,544 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-11-24 19:00:12,677 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-11-24 19:00:12,677 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-11-24 19:00:13,001 - __main__ - INFO -    Features concurrentes calcul√©es sur J-1 √† J-60
2025-11-24 19:00:13,897 - __main__ - INFO - Features concurrentes ajout√©es (6 features). Shape: (1415, 273)
2025-11-24 19:00:13,899 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-11-24 19:00:13,906 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-11-24 19:00:13,906 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-24 19:00:14,518 - __main__ - INFO - Ajout des vacances scolaires...
2025-11-24 19:00:14,624 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-11-24 19:00:14,644 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 282)
2025-11-24 19:00:14,645 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-24 19:00:14,645 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-11-24 19:00:14,648 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-11-24 19:00:14,648 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-11-24 19:00:14,649 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-11-24 19:00:14,649 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-11-24 19:00:14,656 - __main__ - INFO - Cr√©ation des features et target...
2025-11-24 19:00:14,656 - __main__ - INFO - --------------------------------
2025-11-24 19:00:14,657 - __main__ - INFO - Horizon: 1
2025-11-24 19:00:14,657 - __main__ - INFO - --------------------------------
2025-11-24 19:00:14,658 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=282)
2025-11-24 19:00:14,659 - __main__ - INFO - nb_observations recalcul√© pour horizon=1
2025-11-24 19:00:14,660 - __main__ - INFO -    Minimum: 60
2025-11-24 19:00:14,660 - __main__ - INFO -    Maximum: 60
2025-11-24 19:00:14,661 - __main__ - INFO -    Moyenne: 60.0
2025-11-24 19:00:14,661 - __main__ - INFO - Nombre total de features: 95
2025-11-24 19:00:14,661 - __main__ - INFO -    - TO historiques: 59
2025-11-24 19:00:14,661 - __main__ - INFO -    - Features PM: 7
2025-11-24 19:00:14,662 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-11-24 19:00:14,662 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-11-24 19:00:14,662 - __main__ - INFO -    - Features concurrents: 6
2025-11-24 19:00:14,662 - __main__ - INFO -    - Autres features: 11
2025-11-24 19:00:14,807 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\training_data_before_scaling.csv
2025-11-24 19:00:14,808 - __main__ - INFO -    Shape: (1327, 98)
2025-11-24 19:00:14,808 - __main__ - INFO -    Colonnes: stay_date, hotCode, 95 features, J-0
2025-11-24 19:00:14,808 - __main__ - INFO - X shape: (1327, 95), y shape: (1327,)
2025-11-24 19:00:14,810 - __main__ - INFO - ================================================================================
2025-11-24 19:00:14,810 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-11-24 19:00:14,810 - __main__ - INFO - ================================================================================
2025-11-24 19:00:14,816 - __main__ - INFO - Train: (1061, 95), Validation: (266, 95)
2025-11-24 19:00:14,817 - __main__ - INFO - Configuration de la recherche:
2025-11-24 19:00:14,817 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-11-24 19:00:14,817 - __main__ - INFO -    - Cross-validation: 3 folds
2025-11-24 19:00:14,817 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-11-24 19:00:14,818 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-11-24 19:00:14,818 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-11-24 19:01:55,221 - __main__ - INFO - ================================================================================
2025-11-24 19:01:55,222 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-11-24 19:01:55,222 - __main__ - INFO - ================================================================================
2025-11-24 19:01:55,222 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0296
2025-11-24 19:01:55,222 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-11-24 19:01:55,222 - __main__ - INFO -    - subsample: 0.95
2025-11-24 19:01:55,223 - __main__ - INFO -    - reg_lambda: 1.0
2025-11-24 19:01:55,223 - __main__ - INFO -    - reg_alpha: 0
2025-11-24 19:01:55,223 - __main__ - INFO -    - n_estimators: 500
2025-11-24 19:01:55,223 - __main__ - INFO -    - min_child_weight: 3
2025-11-24 19:01:55,223 - __main__ - INFO -    - max_depth: 5
2025-11-24 19:01:55,223 - __main__ - INFO -    - learning_rate: 0.05
2025-11-24 19:01:55,224 - __main__ - INFO -    - colsample_bytree: 0.95
2025-11-24 19:01:55,228 - __main__ - INFO - 
Performances sur validation:
2025-11-24 19:01:55,228 - __main__ - INFO -    - MAE: 0.0249
2025-11-24 19:01:55,229 - __main__ - INFO -    - R¬≤: 0.9611
2025-11-24 19:01:55,229 - __main__ - INFO - ================================================================================
2025-11-24 19:01:55,229 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-11-24 19:01:55,230 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-24 19:01:55,235 - __main__ - INFO - Train: (1061, 95), Test: (266, 95)
2025-11-24 19:01:56,846 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-24 19:01:56,857 - __main__ - INFO - üìä Test MAE: 0.0249
2025-11-24 19:01:56,857 - __main__ - INFO - üìä Test R¬≤: 0.9611
2025-11-24 19:01:56,857 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-24 19:01:57,369 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-24 19:01:57,685 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-24 19:01:57,702 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-24 19:01:57,733 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-24 19:01:57,733 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-24 19:01:57,733 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-24 19:01:59,854 - __main__ - INFO - ================================================================================
2025-11-24 19:01:59,854 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-24 19:01:59,854 - __main__ - INFO - ================================================================================
2025-11-24 19:01:59,855 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-24 19:01:59,855 - __main__ - INFO -    Train MAE: 0.0016
2025-11-24 19:01:59,855 - __main__ - INFO -    Train R¬≤:  0.9998
2025-11-24 19:01:59,855 - __main__ - INFO -    Test MAE:  0.0249
2025-11-24 19:01:59,855 - __main__ - INFO -    Test R¬≤:   0.9611
2025-11-24 19:02:40,703 - __main__ - INFO - ================================================================================
2025-11-24 19:02:40,703 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-24 19:02:40,703 - __main__ - INFO - ================================================================================
2025-11-24 19:02:40,703 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-24 19:02:40,706 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-24 19:02:40,707 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-24 19:02:40,707 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 30, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-11-24 19:02:40,707 - __main__ - INFO - Chargement des donn√©es...
2025-11-24 19:02:40,722 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-24 19:02:40,809 - __main__ - INFO - Indicateurs charg√©s: (86803, 17)
2025-11-24 19:02:40,810 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-24 19:02:40,859 - __main__ - INFO - PM pivot shape: (1423, 63)
2025-11-24 19:02:40,885 - __main__ - INFO - Ant pivot shape: (1423, 63)
2025-11-24 19:02:40,914 - __main__ - INFO - Ds pivot shape: (1423, 63)
2025-11-24 19:02:40,925 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-11-24 19:02:40,925 - __main__ - INFO - Calcul des features PM sur donn√©es J-30 √† J-60 (pas de data leakage)
2025-11-24 19:02:40,925 - __main__ - INFO -    Colonnes PM utilis√©es: 31
2025-11-24 19:02:42,055 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-11-24 19:02:42,056 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-30 √† J-60
2025-11-24 19:02:42,056 - __main__ - INFO -    Colonnes Ant utilis√©es: 31
2025-11-24 19:02:42,817 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-11-24 19:02:42,817 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-30 √† J-60
2025-11-24 19:02:42,817 - __main__ - INFO -    Colonnes Ds utilis√©es: 31
2025-11-24 19:02:43,605 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-11-24 19:02:43,606 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-11-24 19:02:43,724 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-11-24 19:02:43,724 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-11-24 19:02:43,875 - __main__ - INFO -    Features concurrentes calcul√©es sur J-30 √† J-60
2025-11-24 19:02:44,662 - __main__ - INFO - Features concurrentes ajout√©es (6 features). Shape: (1415, 273)
2025-11-24 19:02:44,665 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-11-24 19:02:44,672 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-11-24 19:02:44,673 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-24 19:02:45,145 - __main__ - INFO - Ajout des vacances scolaires...
2025-11-24 19:02:45,240 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-11-24 19:02:45,253 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 282)
2025-11-24 19:02:45,254 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-24 19:02:45,254 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-11-24 19:02:45,256 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-11-24 19:02:45,256 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-11-24 19:02:45,256 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-11-24 19:02:45,257 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-11-24 19:02:45,263 - __main__ - INFO - Cr√©ation des features et target...
2025-11-24 19:02:45,264 - __main__ - INFO - --------------------------------
2025-11-24 19:02:45,264 - __main__ - INFO - Horizon: 30
2025-11-24 19:02:45,264 - __main__ - INFO - --------------------------------
2025-11-24 19:02:45,265 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=282)
2025-11-24 19:02:45,266 - __main__ - INFO - nb_observations recalcul√© pour horizon=30
2025-11-24 19:02:45,267 - __main__ - INFO -    Minimum: 31
2025-11-24 19:02:45,267 - __main__ - INFO -    Maximum: 31
2025-11-24 19:02:45,267 - __main__ - INFO -    Moyenne: 31.0
2025-11-24 19:02:45,268 - __main__ - INFO - Nombre total de features: 66
2025-11-24 19:02:45,268 - __main__ - INFO -    - TO historiques: 30
2025-11-24 19:02:45,268 - __main__ - INFO -    - Features PM: 7
2025-11-24 19:02:45,268 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-11-24 19:02:45,268 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-11-24 19:02:45,268 - __main__ - INFO -    - Features concurrents: 6
2025-11-24 19:02:45,268 - __main__ - INFO -    - Autres features: 11
2025-11-24 19:02:45,348 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\training_data_before_scaling.csv
2025-11-24 19:02:45,348 - __main__ - INFO -    Shape: (1327, 69)
2025-11-24 19:02:45,348 - __main__ - INFO -    Colonnes: stay_date, hotCode, 66 features, J-0
2025-11-24 19:02:45,349 - __main__ - INFO - X shape: (1327, 66), y shape: (1327,)
2025-11-24 19:02:45,349 - __main__ - INFO - ================================================================================
2025-11-24 19:02:45,349 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-11-24 19:02:45,349 - __main__ - INFO - ================================================================================
2025-11-24 19:02:45,353 - __main__ - INFO - Train: (1061, 66), Validation: (266, 66)
2025-11-24 19:02:45,353 - __main__ - INFO - Configuration de la recherche:
2025-11-24 19:02:45,353 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-11-24 19:02:45,353 - __main__ - INFO -    - Cross-validation: 3 folds
2025-11-24 19:02:45,353 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-11-24 19:02:45,353 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-11-24 19:02:45,353 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-11-24 19:04:08,699 - __main__ - INFO - ================================================================================
2025-11-24 19:04:08,700 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-11-24 19:04:08,701 - __main__ - INFO - ================================================================================
2025-11-24 19:04:08,702 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0912
2025-11-24 19:04:08,702 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-11-24 19:04:08,703 - __main__ - INFO -    - subsample: 0.9
2025-11-24 19:04:08,703 - __main__ - INFO -    - reg_lambda: 0.5
2025-11-24 19:04:08,704 - __main__ - INFO -    - reg_alpha: 0.1
2025-11-24 19:04:08,709 - __main__ - INFO -    - n_estimators: 800
2025-11-24 19:04:08,712 - __main__ - INFO -    - min_child_weight: 3
2025-11-24 19:04:08,714 - __main__ - INFO -    - max_depth: 6
2025-11-24 19:04:08,715 - __main__ - INFO -    - learning_rate: 0.01
2025-11-24 19:04:08,715 - __main__ - INFO -    - colsample_bytree: 0.85
2025-11-24 19:04:08,722 - __main__ - INFO - 
Performances sur validation:
2025-11-24 19:04:08,722 - __main__ - INFO -    - MAE: 0.0825
2025-11-24 19:04:08,723 - __main__ - INFO -    - R¬≤: 0.5796
2025-11-24 19:04:08,724 - __main__ - INFO - ================================================================================
2025-11-24 19:04:08,725 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-11-24 19:04:08,725 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-24 19:04:08,733 - __main__ - INFO - Train: (1061, 66), Test: (266, 66)
2025-11-24 19:04:12,240 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-24 19:04:12,256 - __main__ - INFO - üìä Test MAE: 0.0825
2025-11-24 19:04:12,256 - __main__ - INFO - üìä Test R¬≤: 0.5796
2025-11-24 19:04:12,256 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-24 19:04:12,778 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-24 19:04:13,150 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-24 19:04:13,175 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-24 19:04:13,229 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-24 19:04:13,229 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-24 19:04:13,230 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-24 19:04:18,518 - __main__ - INFO - ================================================================================
2025-11-24 19:04:18,519 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-24 19:04:18,519 - __main__ - INFO - ================================================================================
2025-11-24 19:04:18,519 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-24 19:04:18,519 - __main__ - INFO -    Train MAE: 0.0220
2025-11-24 19:04:18,519 - __main__ - INFO -    Train R¬≤:  0.9743
2025-11-24 19:04:18,519 - __main__ - INFO -    Test MAE:  0.0825
2025-11-24 19:04:18,520 - __main__ - INFO -    Test R¬≤:   0.5796
2025-11-25 09:34:12,083 - __main__ - INFO - ================================================================================
2025-11-25 09:34:12,083 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-25 09:34:12,084 - __main__ - INFO - ================================================================================
2025-11-25 09:34:12,084 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-25 09:34:12,088 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-25 09:34:12,089 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-25 09:34:12,089 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 30, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-11-25 09:34:12,089 - __main__ - INFO - Chargement des donn√©es...
2025-11-25 09:34:12,124 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-25 09:34:12,213 - __main__ - INFO - Indicateurs charg√©s: (86803, 17)
2025-11-25 09:34:12,213 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-25 09:34:12,272 - __main__ - INFO - PM pivot shape: (1423, 63)
2025-11-25 09:34:12,291 - __main__ - INFO - Ant pivot shape: (1423, 63)
2025-11-25 09:34:12,311 - __main__ - INFO - Ds pivot shape: (1423, 63)
2025-11-25 09:34:12,322 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-11-25 09:34:12,322 - __main__ - INFO - Calcul des features PM sur donn√©es J-30 √† J-60 (pas de data leakage)
2025-11-25 09:34:12,323 - __main__ - INFO -    Colonnes PM utilis√©es: 31
2025-11-25 09:34:13,526 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-11-25 09:34:13,526 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-30 √† J-60
2025-11-25 09:34:13,526 - __main__ - INFO -    Colonnes Ant utilis√©es: 31
2025-11-25 09:34:14,386 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-11-25 09:34:14,387 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-30 √† J-60
2025-11-25 09:34:14,387 - __main__ - INFO -    Colonnes Ds utilis√©es: 31
2025-11-25 09:34:15,260 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-11-25 09:34:15,261 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-11-25 09:34:15,404 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-11-25 09:34:15,405 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-11-25 09:34:15,580 - __main__ - INFO -    Features concurrentes calcul√©es sur J-30 √† J-60
2025-11-25 09:34:17,055 - __main__ - INFO - Features concurrentes ajout√©es (6 features). Shape: (1415, 273)
2025-11-25 09:34:17,057 - __main__ - INFO - Calcul des features Gap et Elasticity (PM vs Concurrents)...
2025-11-25 09:34:17,058 - __main__ - WARNING - ‚ö†Ô∏è  Pas de colonnes PM ou Comp disponibles pour Gap/Elasticity
2025-11-25 09:34:17,061 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-11-25 09:34:17,072 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-11-25 09:34:17,072 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-25 09:34:18,516 - __main__ - INFO - Ajout des vacances scolaires...
2025-11-25 09:34:18,678 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-11-25 09:34:18,710 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 286)
2025-11-25 09:34:18,710 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-25 09:34:18,711 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-11-25 09:34:18,712 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-11-25 09:34:18,712 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-11-25 09:34:18,713 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-11-25 09:34:18,713 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-11-25 09:34:18,723 - __main__ - INFO - Cr√©ation des features et target...
2025-11-25 09:34:18,723 - __main__ - INFO - --------------------------------
2025-11-25 09:34:18,724 - __main__ - INFO - Horizon: 30
2025-11-25 09:34:18,724 - __main__ - INFO - --------------------------------
2025-11-25 09:34:18,725 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'elasticity_slope', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-11-25 09:34:18,727 - __main__ - INFO - nb_observations recalcul√© pour horizon=30
2025-11-25 09:34:18,727 - __main__ - INFO -    Minimum: 31
2025-11-25 09:34:18,727 - __main__ - INFO -    Maximum: 31
2025-11-25 09:34:18,728 - __main__ - INFO -    Moyenne: 31.0
2025-11-25 09:34:18,728 - __main__ - INFO - Nombre total de features: 70
2025-11-25 09:34:18,728 - __main__ - INFO -    - TO historiques: 30
2025-11-25 09:34:18,728 - __main__ - INFO -    - Features PM: 7
2025-11-25 09:34:18,728 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-11-25 09:34:18,729 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-11-25 09:34:18,729 - __main__ - INFO -    - Features concurrents: 6
2025-11-25 09:34:18,729 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-11-25 09:34:18,729 - __main__ - INFO -    - Autres features: 11
2025-11-25 09:34:18,859 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\training_data_before_scaling.csv
2025-11-25 09:34:18,860 - __main__ - INFO -    Shape: (1327, 73)
2025-11-25 09:34:18,860 - __main__ - INFO -    Colonnes: stay_date, hotCode, 70 features, J-0
2025-11-25 09:34:18,860 - __main__ - INFO - X shape: (1327, 70), y shape: (1327,)
2025-11-25 09:34:18,861 - __main__ - INFO - ================================================================================
2025-11-25 09:34:18,861 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-11-25 09:34:18,861 - __main__ - INFO - ================================================================================
2025-11-25 09:34:18,866 - __main__ - INFO - Train: (1061, 70), Validation: (266, 70)
2025-11-25 09:34:18,867 - __main__ - INFO - Configuration de la recherche:
2025-11-25 09:34:18,867 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-11-25 09:34:18,867 - __main__ - INFO -    - Cross-validation: 3 folds
2025-11-25 09:34:18,867 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-11-25 09:34:18,867 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-11-25 09:34:18,868 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-11-25 09:35:49,963 - __main__ - INFO - ================================================================================
2025-11-25 09:35:49,963 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-11-25 09:35:49,964 - __main__ - INFO - ================================================================================
2025-11-25 09:35:49,965 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0903
2025-11-25 09:35:49,965 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-11-25 09:35:49,966 - __main__ - INFO -    - subsample: 0.95
2025-11-25 09:35:49,966 - __main__ - INFO -    - reg_lambda: 1.0
2025-11-25 09:35:49,966 - __main__ - INFO -    - reg_alpha: 0
2025-11-25 09:35:49,966 - __main__ - INFO -    - n_estimators: 500
2025-11-25 09:35:49,967 - __main__ - INFO -    - min_child_weight: 3
2025-11-25 09:35:49,967 - __main__ - INFO -    - max_depth: 5
2025-11-25 09:35:49,967 - __main__ - INFO -    - learning_rate: 0.05
2025-11-25 09:35:49,967 - __main__ - INFO -    - colsample_bytree: 0.95
2025-11-25 09:35:49,973 - __main__ - INFO - 
Performances sur validation:
2025-11-25 09:35:49,973 - __main__ - INFO -    - MAE: 0.0804
2025-11-25 09:35:49,974 - __main__ - INFO -    - R¬≤: 0.5918
2025-11-25 09:35:49,974 - __main__ - INFO - ================================================================================
2025-11-25 09:35:49,975 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-11-25 09:35:49,975 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-25 09:35:49,984 - __main__ - INFO - Train: (1061, 70), Test: (266, 70)
2025-11-25 09:35:51,488 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-25 09:35:51,504 - __main__ - INFO - üìä Test MAE: 0.0804
2025-11-25 09:35:51,505 - __main__ - INFO - üìä Test R¬≤: 0.5918
2025-11-25 09:35:51,505 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-25 09:35:52,673 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-25 09:35:53,225 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-25 09:35:53,249 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-25 09:35:53,288 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-25 09:35:53,288 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-25 09:35:53,288 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-25 09:35:54,302 - __main__ - INFO - ================================================================================
2025-11-25 09:35:54,302 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-25 09:35:54,302 - __main__ - INFO - ================================================================================
2025-11-25 09:35:54,303 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-25 09:35:54,303 - __main__ - INFO -    Train MAE: 0.0074
2025-11-25 09:35:54,303 - __main__ - INFO -    Train R¬≤:  0.9969
2025-11-25 09:35:54,303 - __main__ - INFO -    Test MAE:  0.0804
2025-11-25 09:35:54,304 - __main__ - INFO -    Test R¬≤:   0.5918
2025-11-25 10:29:14,636 - __main__ - INFO - ================================================================================
2025-11-25 10:29:14,637 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-25 10:29:14,637 - __main__ - INFO - ================================================================================
2025-11-25 10:29:14,637 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-25 10:29:14,641 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-25 10:29:14,641 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-25 10:29:14,641 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 30, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-11-25 10:29:14,642 - __main__ - INFO - Chargement des donn√©es...
2025-11-25 10:29:14,664 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-25 10:29:14,781 - __main__ - INFO - Indicateurs charg√©s: (86803, 17)
2025-11-25 10:29:14,781 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-25 10:29:14,855 - __main__ - INFO - PM pivot shape: (1423, 63)
2025-11-25 10:29:14,890 - __main__ - INFO - Ant pivot shape: (1423, 63)
2025-11-25 10:29:14,926 - __main__ - INFO - Ds pivot shape: (1423, 63)
2025-11-25 10:29:14,939 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-11-25 10:29:14,940 - __main__ - INFO - Calcul des features PM sur donn√©es J-30 √† J-60 (pas de data leakage)
2025-11-25 10:29:14,940 - __main__ - INFO -    Colonnes PM utilis√©es: 31
2025-11-25 10:29:16,850 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-11-25 10:29:16,850 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-30 √† J-60
2025-11-25 10:29:16,850 - __main__ - INFO -    Colonnes Ant utilis√©es: 31
2025-11-25 10:29:18,085 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-11-25 10:29:18,085 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-30 √† J-60
2025-11-25 10:29:18,086 - __main__ - INFO -    Colonnes Ds utilis√©es: 31
2025-11-25 10:29:19,328 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-11-25 10:29:19,329 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-11-25 10:29:19,469 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-11-25 10:29:19,469 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-11-25 10:29:19,668 - __main__ - INFO -    Features concurrentes calcul√©es sur J-30 √† J-60
2025-11-25 10:29:19,683 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-11-25 10:29:22,494 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1415, 277)
2025-11-25 10:29:22,500 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-11-25 10:29:22,508 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-11-25 10:29:22,508 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-25 10:29:23,636 - __main__ - INFO - Ajout des vacances scolaires...
2025-11-25 10:29:23,791 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-11-25 10:29:23,819 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 286)
2025-11-25 10:29:23,819 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-25 10:29:23,820 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-11-25 10:29:23,820 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-11-25 10:29:23,821 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-11-25 10:29:23,821 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-11-25 10:29:23,821 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-11-25 10:29:23,829 - __main__ - INFO - Cr√©ation des features et target...
2025-11-25 10:29:23,830 - __main__ - INFO - --------------------------------
2025-11-25 10:29:23,830 - __main__ - INFO - Horizon: 30
2025-11-25 10:29:23,830 - __main__ - INFO - --------------------------------
2025-11-25 10:29:23,831 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-11-25 10:29:23,832 - __main__ - INFO - nb_observations recalcul√© pour horizon=30
2025-11-25 10:29:23,833 - __main__ - INFO -    Minimum: 31
2025-11-25 10:29:23,833 - __main__ - INFO -    Maximum: 31
2025-11-25 10:29:23,833 - __main__ - INFO -    Moyenne: 31.0
2025-11-25 10:29:23,833 - __main__ - INFO - Nombre total de features: 70
2025-11-25 10:29:23,833 - __main__ - INFO -    - TO historiques: 30
2025-11-25 10:29:23,834 - __main__ - INFO -    - Features PM: 7
2025-11-25 10:29:23,834 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-11-25 10:29:23,834 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-11-25 10:29:23,834 - __main__ - INFO -    - Features concurrents: 6
2025-11-25 10:29:23,834 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-11-25 10:29:23,835 - __main__ - INFO -    - Autres features: 11
2025-11-25 10:29:23,940 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\training_data_before_scaling.csv
2025-11-25 10:29:23,941 - __main__ - INFO -    Shape: (1416, 73)
2025-11-25 10:29:23,941 - __main__ - INFO -    Colonnes: stay_date, hotCode, 70 features, J-0
2025-11-25 10:29:23,941 - __main__ - INFO - X shape: (1416, 70), y shape: (1416,)
2025-11-25 10:29:23,941 - __main__ - INFO - ================================================================================
2025-11-25 10:29:23,942 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-11-25 10:29:23,942 - __main__ - INFO - ================================================================================
2025-11-25 10:29:23,947 - __main__ - INFO - Train: (1132, 70), Validation: (284, 70)
2025-11-25 10:29:23,947 - __main__ - INFO - Configuration de la recherche:
2025-11-25 10:29:23,947 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-11-25 10:29:23,948 - __main__ - INFO -    - Cross-validation: 3 folds
2025-11-25 10:29:23,948 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-11-25 10:29:23,948 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-11-25 10:29:23,948 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-11-25 10:31:16,288 - __main__ - INFO - ================================================================================
2025-11-25 10:31:16,289 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-11-25 10:31:16,289 - __main__ - INFO - ================================================================================
2025-11-25 10:31:16,289 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0892
2025-11-25 10:31:16,290 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-11-25 10:31:16,290 - __main__ - INFO -    - subsample: 0.95
2025-11-25 10:31:16,290 - __main__ - INFO -    - reg_lambda: 1.0
2025-11-25 10:31:16,291 - __main__ - INFO -    - reg_alpha: 0
2025-11-25 10:31:16,291 - __main__ - INFO -    - n_estimators: 500
2025-11-25 10:31:16,291 - __main__ - INFO -    - min_child_weight: 3
2025-11-25 10:31:16,292 - __main__ - INFO -    - max_depth: 5
2025-11-25 10:31:16,292 - __main__ - INFO -    - learning_rate: 0.05
2025-11-25 10:31:16,292 - __main__ - INFO -    - colsample_bytree: 0.95
2025-11-25 10:31:16,379 - __main__ - INFO - 
Performances sur validation:
2025-11-25 10:31:16,380 - __main__ - INFO -    - MAE: 0.0829
2025-11-25 10:31:16,381 - __main__ - INFO -    - R¬≤: 0.6153
2025-11-25 10:31:16,382 - __main__ - INFO - ================================================================================
2025-11-25 10:31:16,383 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-11-25 10:31:16,383 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-25 10:31:16,398 - __main__ - INFO - Train: (1132, 70), Test: (284, 70)
2025-11-25 10:31:18,262 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-25 10:31:18,318 - __main__ - INFO - üìä Test MAE: 0.0829
2025-11-25 10:31:18,318 - __main__ - INFO - üìä Test R¬≤: 0.6153
2025-11-25 10:31:18,319 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-25 10:31:19,305 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-25 10:31:19,890 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-25 10:31:19,920 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-25 10:31:19,954 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-25 10:31:19,955 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-25 10:31:19,955 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-25 10:31:21,898 - __main__ - INFO - ================================================================================
2025-11-25 10:31:21,898 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-25 10:31:21,899 - __main__ - INFO - ================================================================================
2025-11-25 10:31:21,899 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-25 10:31:21,899 - __main__ - INFO -    Train MAE: 0.0080
2025-11-25 10:31:21,899 - __main__ - INFO -    Train R¬≤:  0.9962
2025-11-25 10:31:21,900 - __main__ - INFO -    Test MAE:  0.0829
2025-11-25 10:31:21,900 - __main__ - INFO -    Test R¬≤:   0.6153
2025-11-25 10:32:55,793 - __main__ - INFO - ================================================================================
2025-11-25 10:32:55,794 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-25 10:32:55,794 - __main__ - INFO - ================================================================================
2025-11-25 10:32:55,794 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-25 10:32:55,798 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-25 10:32:55,798 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-25 10:32:55,798 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-11-25 10:32:55,798 - __main__ - INFO - Chargement des donn√©es...
2025-11-25 10:32:55,814 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-25 10:32:55,911 - __main__ - INFO - Indicateurs charg√©s: (86803, 17)
2025-11-25 10:32:55,911 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-25 10:32:55,967 - __main__ - INFO - PM pivot shape: (1423, 63)
2025-11-25 10:32:55,989 - __main__ - INFO - Ant pivot shape: (1423, 63)
2025-11-25 10:32:56,011 - __main__ - INFO - Ds pivot shape: (1423, 63)
2025-11-25 10:32:56,020 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-11-25 10:32:56,021 - __main__ - INFO - Calcul des features PM sur donn√©es J-7 √† J-60 (pas de data leakage)
2025-11-25 10:32:56,021 - __main__ - INFO -    Colonnes PM utilis√©es: 54
2025-11-25 10:32:57,256 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-11-25 10:32:57,257 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-7 √† J-60
2025-11-25 10:32:57,257 - __main__ - INFO -    Colonnes Ant utilis√©es: 54
2025-11-25 10:32:58,085 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-11-25 10:32:58,085 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-7 √† J-60
2025-11-25 10:32:58,085 - __main__ - INFO -    Colonnes Ds utilis√©es: 54
2025-11-25 10:32:58,890 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-11-25 10:32:58,890 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-11-25 10:32:59,018 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-11-25 10:32:59,018 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-11-25 10:32:59,180 - __main__ - INFO -    Features concurrentes calcul√©es sur J-7 √† J-60
2025-11-25 10:32:59,192 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-11-25 10:33:01,223 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1415, 277)
2025-11-25 10:33:01,227 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-11-25 10:33:01,234 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-11-25 10:33:01,235 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-25 10:33:01,621 - __main__ - INFO - Ajout des vacances scolaires...
2025-11-25 10:33:01,717 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-11-25 10:33:01,733 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 286)
2025-11-25 10:33:01,734 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-25 10:33:01,734 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-11-25 10:33:01,734 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-11-25 10:33:01,735 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-11-25 10:33:01,735 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-11-25 10:33:01,735 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-11-25 10:33:01,744 - __main__ - INFO - Cr√©ation des features et target...
2025-11-25 10:33:01,744 - __main__ - INFO - --------------------------------
2025-11-25 10:33:01,744 - __main__ - INFO - Horizon: 7
2025-11-25 10:33:01,745 - __main__ - INFO - --------------------------------
2025-11-25 10:33:01,745 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-11-25 10:33:01,747 - __main__ - INFO - nb_observations recalcul√© pour horizon=7
2025-11-25 10:33:01,747 - __main__ - INFO -    Minimum: 54
2025-11-25 10:33:01,747 - __main__ - INFO -    Maximum: 54
2025-11-25 10:33:01,747 - __main__ - INFO -    Moyenne: 54.0
2025-11-25 10:33:01,748 - __main__ - INFO - Nombre total de features: 93
2025-11-25 10:33:01,748 - __main__ - INFO -    - TO historiques: 53
2025-11-25 10:33:01,748 - __main__ - INFO -    - Features PM: 7
2025-11-25 10:33:01,748 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-11-25 10:33:01,749 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-11-25 10:33:01,749 - __main__ - INFO -    - Features concurrents: 6
2025-11-25 10:33:01,749 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-11-25 10:33:01,749 - __main__ - INFO -    - Autres features: 11
2025-11-25 10:33:01,759 - __main__ - WARNING - ‚ö†Ô∏è  Erreur lors de la sauvegarde des donn√©es d'entra√Ænement: [Errno 13] Permission denied: 'results/D09\\training_data_before_scaling.csv'
2025-11-25 10:33:01,760 - __main__ - INFO - X shape: (1416, 93), y shape: (1416,)
2025-11-25 10:33:01,760 - __main__ - INFO - ================================================================================
2025-11-25 10:33:01,760 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-11-25 10:33:01,760 - __main__ - INFO - ================================================================================
2025-11-25 10:33:01,765 - __main__ - INFO - Train: (1132, 93), Validation: (284, 93)
2025-11-25 10:33:01,766 - __main__ - INFO - Configuration de la recherche:
2025-11-25 10:33:01,766 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-11-25 10:33:01,766 - __main__ - INFO -    - Cross-validation: 3 folds
2025-11-25 10:33:01,766 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-11-25 10:33:01,767 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-11-25 10:33:01,767 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-11-25 10:35:08,333 - __main__ - INFO - ================================================================================
2025-11-25 10:35:08,333 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-11-25 10:35:08,334 - __main__ - INFO - ================================================================================
2025-11-25 10:35:08,334 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0573
2025-11-25 10:35:08,334 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-11-25 10:35:08,335 - __main__ - INFO -    - subsample: 0.95
2025-11-25 10:35:08,335 - __main__ - INFO -    - reg_lambda: 1.0
2025-11-25 10:35:08,335 - __main__ - INFO -    - reg_alpha: 0
2025-11-25 10:35:08,335 - __main__ - INFO -    - n_estimators: 500
2025-11-25 10:35:08,336 - __main__ - INFO -    - min_child_weight: 3
2025-11-25 10:35:08,336 - __main__ - INFO -    - max_depth: 5
2025-11-25 10:35:08,336 - __main__ - INFO -    - learning_rate: 0.05
2025-11-25 10:35:08,336 - __main__ - INFO -    - colsample_bytree: 0.95
2025-11-25 10:35:08,343 - __main__ - INFO - 
Performances sur validation:
2025-11-25 10:35:08,343 - __main__ - INFO -    - MAE: 0.0525
2025-11-25 10:35:08,344 - __main__ - INFO -    - R¬≤: 0.8352
2025-11-25 10:35:08,345 - __main__ - INFO - ================================================================================
2025-11-25 10:35:08,346 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-11-25 10:35:08,346 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-25 10:35:08,356 - __main__ - INFO - Train: (1132, 93), Test: (284, 93)
2025-11-25 10:35:10,953 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-25 10:35:10,966 - __main__ - INFO - üìä Test MAE: 0.0525
2025-11-25 10:35:10,966 - __main__ - INFO - üìä Test R¬≤: 0.8352
2025-11-25 10:35:10,967 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-25 10:35:11,537 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-25 10:35:11,928 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-25 10:35:11,946 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-25 10:35:11,981 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-25 10:35:11,981 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-25 10:35:11,981 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-25 10:35:12,729 - __main__ - INFO - ================================================================================
2025-11-25 10:35:12,729 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-25 10:35:12,729 - __main__ - INFO - ================================================================================
2025-11-25 10:35:12,729 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-25 10:35:12,730 - __main__ - INFO -    Train MAE: 0.0047
2025-11-25 10:35:12,730 - __main__ - INFO -    Train R¬≤:  0.9987
2025-11-25 10:35:12,730 - __main__ - INFO -    Test MAE:  0.0525
2025-11-25 10:35:12,730 - __main__ - INFO -    Test R¬≤:   0.8352
2025-11-25 10:37:04,513 - __main__ - INFO - ================================================================================
2025-11-25 10:37:04,514 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-25 10:37:04,514 - __main__ - INFO - ================================================================================
2025-11-25 10:37:04,514 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-25 10:37:04,519 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-25 10:37:04,520 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-25 10:37:04,520 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 45, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-11-25 10:37:04,521 - __main__ - INFO - Chargement des donn√©es...
2025-11-25 10:37:04,545 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-25 10:37:04,668 - __main__ - INFO - Indicateurs charg√©s: (86803, 17)
2025-11-25 10:37:04,668 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-25 10:37:04,740 - __main__ - INFO - PM pivot shape: (1423, 63)
2025-11-25 10:37:04,783 - __main__ - INFO - Ant pivot shape: (1423, 63)
2025-11-25 10:37:04,910 - __main__ - INFO - Ds pivot shape: (1423, 63)
2025-11-25 10:37:04,946 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-11-25 10:37:04,954 - __main__ - INFO - Calcul des features PM sur donn√©es J-45 √† J-60 (pas de data leakage)
2025-11-25 10:37:04,955 - __main__ - INFO -    Colonnes PM utilis√©es: 16
2025-11-25 10:37:07,110 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-11-25 10:37:07,110 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-45 √† J-60
2025-11-25 10:37:07,110 - __main__ - INFO -    Colonnes Ant utilis√©es: 16
2025-11-25 10:37:08,061 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-11-25 10:37:08,061 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-45 √† J-60
2025-11-25 10:37:08,061 - __main__ - INFO -    Colonnes Ds utilis√©es: 16
2025-11-25 10:37:08,867 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-11-25 10:37:08,867 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-11-25 10:37:08,988 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-11-25 10:37:08,988 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-11-25 10:37:09,140 - __main__ - INFO -    Features concurrentes calcul√©es sur J-45 √† J-60
2025-11-25 10:37:09,147 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-11-25 10:37:11,743 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1415, 277)
2025-11-25 10:37:11,748 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-11-25 10:37:11,756 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-11-25 10:37:11,756 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-25 10:37:12,317 - __main__ - INFO - Ajout des vacances scolaires...
2025-11-25 10:37:12,434 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-11-25 10:37:12,453 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 286)
2025-11-25 10:37:12,453 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-25 10:37:12,454 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-11-25 10:37:12,455 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-11-25 10:37:12,456 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-11-25 10:37:12,456 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-11-25 10:37:12,456 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-11-25 10:37:12,464 - __main__ - INFO - Cr√©ation des features et target...
2025-11-25 10:37:12,464 - __main__ - INFO - --------------------------------
2025-11-25 10:37:12,464 - __main__ - INFO - Horizon: 45
2025-11-25 10:37:12,465 - __main__ - INFO - --------------------------------
2025-11-25 10:37:12,465 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-11-25 10:37:12,467 - __main__ - INFO - nb_observations recalcul√© pour horizon=45
2025-11-25 10:37:12,468 - __main__ - INFO -    Minimum: 16
2025-11-25 10:37:12,468 - __main__ - INFO -    Maximum: 16
2025-11-25 10:37:12,469 - __main__ - INFO -    Moyenne: 16.0
2025-11-25 10:37:12,469 - __main__ - INFO - Nombre total de features: 55
2025-11-25 10:37:12,470 - __main__ - INFO -    - TO historiques: 15
2025-11-25 10:37:12,470 - __main__ - INFO -    - Features PM: 7
2025-11-25 10:37:12,471 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-11-25 10:37:12,471 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-11-25 10:37:12,471 - __main__ - INFO -    - Features concurrents: 6
2025-11-25 10:37:12,472 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-11-25 10:37:12,472 - __main__ - INFO -    - Autres features: 11
2025-11-25 10:37:12,493 - __main__ - WARNING - ‚ö†Ô∏è  Erreur lors de la sauvegarde des donn√©es d'entra√Ænement: [Errno 13] Permission denied: 'results/D09\\training_data_before_scaling.csv'
2025-11-25 10:37:12,494 - __main__ - INFO - X shape: (1416, 55), y shape: (1416,)
2025-11-25 10:37:12,494 - __main__ - INFO - ================================================================================
2025-11-25 10:37:12,494 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-11-25 10:37:12,495 - __main__ - INFO - ================================================================================
2025-11-25 10:37:12,503 - __main__ - INFO - Train: (1132, 55), Validation: (284, 55)
2025-11-25 10:37:12,503 - __main__ - INFO - Configuration de la recherche:
2025-11-25 10:37:12,504 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-11-25 10:37:12,504 - __main__ - INFO -    - Cross-validation: 3 folds
2025-11-25 10:37:12,504 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-11-25 10:37:12,504 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-11-25 10:37:12,505 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-11-25 10:38:33,266 - __main__ - INFO - ================================================================================
2025-11-25 10:38:33,267 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-11-25 10:38:33,268 - __main__ - INFO - ================================================================================
2025-11-25 10:38:33,269 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0947
2025-11-25 10:38:33,270 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-11-25 10:38:33,270 - __main__ - INFO -    - subsample: 0.9
2025-11-25 10:38:33,271 - __main__ - INFO -    - reg_lambda: 1.0
2025-11-25 10:38:33,271 - __main__ - INFO -    - reg_alpha: 0.5
2025-11-25 10:38:33,271 - __main__ - INFO -    - n_estimators: 500
2025-11-25 10:38:33,271 - __main__ - INFO -    - min_child_weight: 2
2025-11-25 10:38:33,272 - __main__ - INFO -    - max_depth: 6
2025-11-25 10:38:33,272 - __main__ - INFO -    - learning_rate: 0.05
2025-11-25 10:38:33,275 - __main__ - INFO -    - colsample_bytree: 0.95
2025-11-25 10:38:33,289 - __main__ - INFO - 
Performances sur validation:
2025-11-25 10:38:33,292 - __main__ - INFO -    - MAE: 0.0866
2025-11-25 10:38:33,293 - __main__ - INFO -    - R¬≤: 0.5542
2025-11-25 10:38:33,294 - __main__ - INFO - ================================================================================
2025-11-25 10:38:33,297 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-11-25 10:38:33,298 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-25 10:38:33,311 - __main__ - INFO - Train: (1132, 55), Test: (284, 55)
2025-11-25 10:38:39,771 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-25 10:38:39,785 - __main__ - INFO - üìä Test MAE: 0.0866
2025-11-25 10:38:39,785 - __main__ - INFO - üìä Test R¬≤: 0.5542
2025-11-25 10:38:39,786 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-25 10:38:40,462 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-25 10:38:40,916 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-25 10:38:40,936 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-25 10:38:40,973 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-25 10:38:40,973 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-25 10:38:40,974 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-25 10:38:41,946 - __main__ - INFO - ================================================================================
2025-11-25 10:38:41,947 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-25 10:38:41,947 - __main__ - INFO - ================================================================================
2025-11-25 10:38:41,947 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-25 10:38:41,947 - __main__ - INFO -    Train MAE: 0.0192
2025-11-25 10:38:41,948 - __main__ - INFO -    Train R¬≤:  0.9772
2025-11-25 10:38:41,948 - __main__ - INFO -    Test MAE:  0.0866
2025-11-25 10:38:41,948 - __main__ - INFO -    Test R¬≤:   0.5542
2025-11-25 22:41:00,261 - __main__ - INFO - ================================================================================
2025-11-25 22:41:00,261 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-25 22:41:00,261 - __main__ - INFO - ================================================================================
2025-11-25 22:41:00,262 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-25 22:41:00,265 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-25 22:41:00,265 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-25 22:41:00,266 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 55, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-11-25 22:41:00,266 - __main__ - INFO - Chargement des donn√©es...
2025-11-25 22:41:00,305 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-25 22:41:00,403 - __main__ - INFO - Indicateurs charg√©s: (86803, 17)
2025-11-25 22:41:00,404 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-25 22:41:00,463 - __main__ - INFO - PM pivot shape: (1423, 63)
2025-11-25 22:41:00,485 - __main__ - INFO - Ant pivot shape: (1423, 63)
2025-11-25 22:41:00,506 - __main__ - INFO - Ds pivot shape: (1423, 63)
2025-11-25 22:41:00,519 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-11-25 22:41:00,519 - __main__ - INFO - Calcul des features PM sur donn√©es J-55 √† J-60 (pas de data leakage)
2025-11-25 22:41:00,519 - __main__ - INFO -    Colonnes PM utilis√©es: 6
2025-11-25 22:41:01,740 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-11-25 22:41:01,740 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-55 √† J-60
2025-11-25 22:41:01,741 - __main__ - INFO -    Colonnes Ant utilis√©es: 6
2025-11-25 22:41:02,631 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-11-25 22:41:02,632 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-55 √† J-60
2025-11-25 22:41:02,632 - __main__ - INFO -    Colonnes Ds utilis√©es: 6
2025-11-25 22:41:03,503 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-11-25 22:41:03,503 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-11-25 22:41:03,630 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-11-25 22:41:03,630 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-11-25 22:41:03,792 - __main__ - INFO -    Features concurrentes calcul√©es sur J-55 √† J-60
2025-11-25 22:41:03,799 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-11-25 22:41:05,754 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1415, 277)
2025-11-25 22:41:05,760 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-11-25 22:41:05,767 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-11-25 22:41:05,767 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-25 22:41:06,809 - __main__ - INFO - Ajout des vacances scolaires...
2025-11-25 22:41:06,916 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-11-25 22:41:06,934 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 286)
2025-11-25 22:41:06,935 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-25 22:41:06,935 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-11-25 22:41:06,936 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-11-25 22:41:06,936 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-11-25 22:41:06,937 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-11-25 22:41:06,937 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-11-25 22:41:06,943 - __main__ - INFO - Cr√©ation des features et target...
2025-11-25 22:41:06,944 - __main__ - INFO - --------------------------------
2025-11-25 22:41:06,944 - __main__ - INFO - Horizon: 55
2025-11-25 22:41:06,944 - __main__ - INFO - --------------------------------
2025-11-25 22:41:06,945 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-11-25 22:41:06,947 - __main__ - INFO - nb_observations recalcul√© pour horizon=55
2025-11-25 22:41:06,948 - __main__ - INFO -    Minimum: 6
2025-11-25 22:41:06,948 - __main__ - INFO -    Maximum: 6
2025-11-25 22:41:06,949 - __main__ - INFO -    Moyenne: 6.0
2025-11-25 22:41:06,949 - __main__ - INFO - Nombre total de features: 45
2025-11-25 22:41:06,949 - __main__ - INFO -    - TO historiques: 5
2025-11-25 22:41:06,949 - __main__ - INFO -    - Features PM: 7
2025-11-25 22:41:06,950 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-11-25 22:41:06,950 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-11-25 22:41:06,950 - __main__ - INFO -    - Features concurrents: 6
2025-11-25 22:41:06,950 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-11-25 22:41:06,950 - __main__ - INFO -    - Autres features: 11
2025-11-25 22:41:07,014 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\training_data_before_scaling.csv
2025-11-25 22:41:07,015 - __main__ - INFO -    Shape: (1416, 48)
2025-11-25 22:41:07,015 - __main__ - INFO -    Colonnes: stay_date, hotCode, 45 features, J-0
2025-11-25 22:41:07,015 - __main__ - INFO - X shape: (1416, 45), y shape: (1416,)
2025-11-25 22:41:07,016 - __main__ - INFO - ================================================================================
2025-11-25 22:41:07,016 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-11-25 22:41:07,016 - __main__ - INFO - ================================================================================
2025-11-25 22:41:07,022 - __main__ - INFO - Train: (1132, 45), Validation: (284, 45)
2025-11-25 22:41:07,022 - __main__ - INFO - Configuration de la recherche:
2025-11-25 22:41:07,022 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-11-25 22:41:07,023 - __main__ - INFO -    - Cross-validation: 3 folds
2025-11-25 22:41:07,023 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-11-25 22:41:07,023 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-11-25 22:41:07,023 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-11-25 22:42:11,940 - __main__ - INFO - ================================================================================
2025-11-25 22:42:11,941 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-11-25 22:42:11,941 - __main__ - INFO - ================================================================================
2025-11-25 22:42:11,941 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0958
2025-11-25 22:42:11,941 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-11-25 22:42:11,942 - __main__ - INFO -    - subsample: 0.8
2025-11-25 22:42:11,942 - __main__ - INFO -    - reg_lambda: 1.0
2025-11-25 22:42:11,942 - __main__ - INFO -    - reg_alpha: 0.1
2025-11-25 22:42:11,942 - __main__ - INFO -    - n_estimators: 300
2025-11-25 22:42:11,942 - __main__ - INFO -    - min_child_weight: 1
2025-11-25 22:42:11,943 - __main__ - INFO -    - max_depth: 6
2025-11-25 22:42:11,943 - __main__ - INFO -    - learning_rate: 0.05
2025-11-25 22:42:11,943 - __main__ - INFO -    - colsample_bytree: 0.9
2025-11-25 22:42:11,949 - __main__ - INFO - 
Performances sur validation:
2025-11-25 22:42:11,950 - __main__ - INFO -    - MAE: 0.0875
2025-11-25 22:42:11,950 - __main__ - INFO -    - R¬≤: 0.5598
2025-11-25 22:42:11,950 - __main__ - INFO - ================================================================================
2025-11-25 22:42:11,951 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-11-25 22:42:11,951 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-25 22:42:11,958 - __main__ - INFO - Train: (1132, 45), Test: (284, 45)
2025-11-25 22:42:12,923 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-25 22:42:12,946 - __main__ - INFO - üìä Test MAE: 0.0875
2025-11-25 22:42:12,946 - __main__ - INFO - üìä Test R¬≤: 0.5598
2025-11-25 22:42:12,947 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-25 22:42:14,288 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-25 22:42:14,722 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-25 22:42:14,752 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-25 22:42:14,788 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-25 22:42:14,788 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-25 22:42:14,789 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-25 22:42:15,933 - __main__ - INFO - ================================================================================
2025-11-25 22:42:15,933 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-25 22:42:15,933 - __main__ - INFO - ================================================================================
2025-11-25 22:42:15,933 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-25 22:42:15,933 - __main__ - INFO -    Train MAE: 0.0163
2025-11-25 22:42:15,934 - __main__ - INFO -    Train R¬≤:  0.9830
2025-11-25 22:42:15,934 - __main__ - INFO -    Test MAE:  0.0875
2025-11-25 22:42:15,934 - __main__ - INFO -    Test R¬≤:   0.5598
2025-11-26 10:43:38,072 - __main__ - INFO - ================================================================================
2025-11-26 10:43:38,072 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-26 10:43:38,073 - __main__ - INFO - ================================================================================
2025-11-26 10:43:38,073 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-26 10:43:38,076 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-26 10:43:38,076 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-26 10:43:38,076 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 60, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-11-26 10:43:38,077 - __main__ - INFO - Chargement des donn√©es...
2025-11-26 10:43:38,110 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-26 10:43:38,202 - __main__ - INFO - Indicateurs charg√©s: (86803, 17)
2025-11-26 10:43:38,202 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-26 10:43:38,282 - __main__ - INFO - PM pivot shape: (1423, 63)
2025-11-26 10:43:38,299 - __main__ - INFO - Ant pivot shape: (1423, 63)
2025-11-26 10:43:38,317 - __main__ - INFO - Ds pivot shape: (1423, 63)
2025-11-26 10:43:38,325 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-11-26 10:43:38,326 - __main__ - INFO - Calcul des features PM sur donn√©es J-60 √† J-60 (pas de data leakage)
2025-11-26 10:43:38,326 - __main__ - INFO -    Colonnes PM utilis√©es: 1
2025-11-26 10:43:39,118 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-11-26 10:43:39,118 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-60 √† J-60
2025-11-26 10:43:39,118 - __main__ - INFO -    Colonnes Ant utilis√©es: 1
2025-11-26 10:43:39,654 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-11-26 10:43:39,655 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-60 √† J-60
2025-11-26 10:43:39,655 - __main__ - INFO -    Colonnes Ds utilis√©es: 1
2025-11-26 10:43:40,279 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-11-26 10:43:40,279 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-11-26 10:43:40,398 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-11-26 10:43:40,398 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-11-26 10:43:40,544 - __main__ - INFO -    Features concurrentes calcul√©es sur J-60 √† J-60
2025-11-26 10:43:40,550 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-11-26 10:43:42,000 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1415, 277)
2025-11-26 10:43:42,006 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-11-26 10:43:42,019 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-11-26 10:43:42,019 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-26 10:43:42,995 - __main__ - INFO - Ajout des vacances scolaires...
2025-11-26 10:43:43,112 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-11-26 10:43:43,132 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 286)
2025-11-26 10:43:43,133 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-26 10:43:43,134 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-11-26 10:43:43,134 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-11-26 10:43:43,134 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-11-26 10:43:43,134 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-11-26 10:43:43,135 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-11-26 10:43:43,140 - __main__ - INFO - Cr√©ation des features et target...
2025-11-26 10:43:43,141 - __main__ - INFO - --------------------------------
2025-11-26 10:43:43,141 - __main__ - INFO - Horizon: 60
2025-11-26 10:43:43,141 - __main__ - INFO - --------------------------------
2025-11-26 10:43:43,142 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-11-26 10:43:43,143 - __main__ - INFO - nb_observations recalcul√© pour horizon=60
2025-11-26 10:43:43,144 - __main__ - INFO -    Minimum: 1
2025-11-26 10:43:43,144 - __main__ - INFO -    Maximum: 1
2025-11-26 10:43:43,144 - __main__ - INFO -    Moyenne: 1.0
2025-11-26 10:43:43,145 - __main__ - INFO - Nombre total de features: 40
2025-11-26 10:43:43,145 - __main__ - INFO -    - TO historiques: 0
2025-11-26 10:43:43,145 - __main__ - INFO -    - Features PM: 7
2025-11-26 10:43:43,145 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-11-26 10:43:43,145 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-11-26 10:43:43,145 - __main__ - INFO -    - Features concurrents: 6
2025-11-26 10:43:43,145 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-11-26 10:43:43,146 - __main__ - INFO -    - Autres features: 11
2025-11-26 10:43:43,158 - __main__ - WARNING - ‚ö†Ô∏è  Erreur lors de la sauvegarde des donn√©es d'entra√Ænement: [Errno 13] Permission denied: 'results/D09\\training_data_before_scaling.csv'
2025-11-26 10:43:43,159 - __main__ - INFO - X shape: (1416, 40), y shape: (1416,)
2025-11-26 10:43:43,159 - __main__ - INFO - ================================================================================
2025-11-26 10:43:43,160 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-11-26 10:43:43,160 - __main__ - INFO - ================================================================================
2025-11-26 10:43:43,164 - __main__ - INFO - Train: (1132, 40), Validation: (284, 40)
2025-11-26 10:43:43,164 - __main__ - INFO - Configuration de la recherche:
2025-11-26 10:43:43,165 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-11-26 10:43:43,165 - __main__ - INFO -    - Cross-validation: 3 folds
2025-11-26 10:43:43,165 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-11-26 10:43:43,165 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-11-26 10:43:43,165 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-11-26 10:44:01,031 - __main__ - INFO - ================================================================================
2025-11-26 10:44:01,031 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-11-26 10:44:01,031 - __main__ - INFO - ================================================================================
2025-11-26 10:44:01,031 - __main__ - INFO - Meilleur score (MAE sur CV): 0.1010
2025-11-26 10:44:01,032 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-11-26 10:44:01,032 - __main__ - INFO -    - subsample: 0.8
2025-11-26 10:44:01,032 - __main__ - INFO -    - reg_lambda: 1.0
2025-11-26 10:44:01,032 - __main__ - INFO -    - reg_alpha: 0.1
2025-11-26 10:44:01,033 - __main__ - INFO -    - n_estimators: 300
2025-11-26 10:44:01,033 - __main__ - INFO -    - min_child_weight: 3
2025-11-26 10:44:01,033 - __main__ - INFO -    - max_depth: 9
2025-11-26 10:44:01,033 - __main__ - INFO -    - learning_rate: 0.05
2025-11-26 10:44:01,033 - __main__ - INFO -    - colsample_bytree: 0.8
2025-11-26 10:44:01,038 - __main__ - INFO - 
Performances sur validation:
2025-11-26 10:44:01,038 - __main__ - INFO -    - MAE: 0.0907
2025-11-26 10:44:01,039 - __main__ - INFO -    - R¬≤: 0.5310
2025-11-26 10:44:01,039 - __main__ - INFO - ================================================================================
2025-11-26 10:44:01,040 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-11-26 10:44:01,040 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-26 10:44:01,046 - __main__ - INFO - Train: (1132, 40), Test: (284, 40)
2025-11-26 10:44:01,771 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-26 10:44:01,784 - __main__ - INFO - üìä Test MAE: 0.0907
2025-11-26 10:44:01,784 - __main__ - INFO - üìä Test R¬≤: 0.5310
2025-11-26 10:44:01,785 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-26 10:44:02,754 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-26 10:44:03,096 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-26 10:44:03,118 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-26 10:44:03,149 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-26 10:44:03,149 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-26 10:44:03,149 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-26 10:44:03,749 - __main__ - INFO - ================================================================================
2025-11-26 10:44:03,750 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-26 10:44:03,750 - __main__ - INFO - ================================================================================
2025-11-26 10:44:03,750 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-26 10:44:03,751 - __main__ - INFO -    Train MAE: 0.0150
2025-11-26 10:44:03,751 - __main__ - INFO -    Train R¬≤:  0.9877
2025-11-26 10:44:03,751 - __main__ - INFO -    Test MAE:  0.0907
2025-11-26 10:44:03,752 - __main__ - INFO -    Test R¬≤:   0.5310
2025-11-26 10:46:42,850 - __main__ - INFO - ================================================================================
2025-11-26 10:46:42,851 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-26 10:46:42,851 - __main__ - INFO - ================================================================================
2025-11-26 10:46:42,851 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-26 10:46:42,855 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-26 10:46:42,855 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-26 10:46:42,855 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 60, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-11-26 10:46:42,856 - __main__ - INFO - Chargement des donn√©es...
2025-11-26 10:46:42,871 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-26 10:46:42,962 - __main__ - INFO - Indicateurs charg√©s: (86803, 17)
2025-11-26 10:46:42,963 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-26 10:46:43,014 - __main__ - INFO - PM pivot shape: (1423, 63)
2025-11-26 10:46:43,037 - __main__ - INFO - Ant pivot shape: (1423, 63)
2025-11-26 10:46:43,060 - __main__ - INFO - Ds pivot shape: (1423, 63)
2025-11-26 10:46:43,072 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-11-26 10:46:43,072 - __main__ - INFO - Calcul des features PM sur donn√©es J-60 √† J-60 (pas de data leakage)
2025-11-26 10:46:43,072 - __main__ - INFO -    Colonnes PM utilis√©es: 1
2025-11-26 10:46:44,347 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-11-26 10:46:44,348 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-60 √† J-60
2025-11-26 10:46:44,348 - __main__ - INFO -    Colonnes Ant utilis√©es: 1
2025-11-26 10:46:45,050 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-11-26 10:46:45,050 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-60 √† J-60
2025-11-26 10:46:45,051 - __main__ - INFO -    Colonnes Ds utilis√©es: 1
2025-11-26 10:46:45,700 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-11-26 10:46:45,700 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-11-26 10:46:45,821 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-11-26 10:46:45,821 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-11-26 10:46:45,980 - __main__ - INFO -    Features concurrentes calcul√©es sur J-60 √† J-60
2025-11-26 10:46:45,985 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-11-26 10:46:47,681 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1415, 277)
2025-11-26 10:46:47,688 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-11-26 10:46:47,697 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-11-26 10:46:47,698 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-26 10:46:48,169 - __main__ - INFO - Ajout des vacances scolaires...
2025-11-26 10:46:48,265 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-11-26 10:46:48,286 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 286)
2025-11-26 10:46:48,287 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-26 10:46:48,287 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-11-26 10:46:48,288 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-11-26 10:46:48,288 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-11-26 10:46:48,288 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-11-26 10:46:48,289 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-11-26 10:46:48,296 - __main__ - INFO - Cr√©ation des features et target...
2025-11-26 10:46:48,297 - __main__ - INFO - --------------------------------
2025-11-26 10:46:48,297 - __main__ - INFO - Horizon: 60
2025-11-26 10:46:48,297 - __main__ - INFO - --------------------------------
2025-11-26 10:46:48,298 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-11-26 10:46:48,300 - __main__ - INFO - nb_observations recalcul√© pour horizon=60
2025-11-26 10:46:48,300 - __main__ - INFO -    Minimum: 1
2025-11-26 10:46:48,300 - __main__ - INFO -    Maximum: 1
2025-11-26 10:46:48,301 - __main__ - INFO -    Moyenne: 1.0
2025-11-26 10:46:48,301 - __main__ - INFO - Nombre total de features: 40
2025-11-26 10:46:48,301 - __main__ - INFO -    - TO historiques: 0
2025-11-26 10:46:48,301 - __main__ - INFO -    - Features PM: 7
2025-11-26 10:46:48,301 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-11-26 10:46:48,301 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-11-26 10:46:48,302 - __main__ - INFO -    - Features concurrents: 6
2025-11-26 10:46:48,302 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-11-26 10:46:48,302 - __main__ - INFO -    - Autres features: 11
2025-11-26 10:46:48,313 - __main__ - WARNING - ‚ö†Ô∏è  Erreur lors de la sauvegarde des donn√©es d'entra√Ænement: [Errno 13] Permission denied: 'results/D09\\training_data_before_scaling.csv'
2025-11-26 10:46:48,313 - __main__ - INFO - X shape: (1416, 40), y shape: (1416,)
2025-11-26 10:46:48,314 - __main__ - INFO - ================================================================================
2025-11-26 10:46:48,314 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-11-26 10:46:48,314 - __main__ - INFO - ================================================================================
2025-11-26 10:46:48,320 - __main__ - INFO - Train: (1132, 40), Validation: (284, 40)
2025-11-26 10:46:48,320 - __main__ - INFO - Configuration de la recherche:
2025-11-26 10:46:48,320 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-11-26 10:46:48,320 - __main__ - INFO -    - Cross-validation: 3 folds
2025-11-26 10:46:48,321 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-11-26 10:46:48,321 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-11-26 10:46:48,321 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-11-26 10:47:12,443 - __main__ - INFO - ================================================================================
2025-11-26 10:47:12,444 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-11-26 10:47:12,445 - __main__ - INFO - ================================================================================
2025-11-26 10:47:12,445 - __main__ - INFO - Meilleur score (MAE sur CV): 0.1010
2025-11-26 10:47:12,445 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-11-26 10:47:12,446 - __main__ - INFO -    - subsample: 0.8
2025-11-26 10:47:12,446 - __main__ - INFO -    - reg_lambda: 1.0
2025-11-26 10:47:12,446 - __main__ - INFO -    - reg_alpha: 0.1
2025-11-26 10:47:12,447 - __main__ - INFO -    - n_estimators: 300
2025-11-26 10:47:12,447 - __main__ - INFO -    - min_child_weight: 3
2025-11-26 10:47:12,447 - __main__ - INFO -    - max_depth: 9
2025-11-26 10:47:12,448 - __main__ - INFO -    - learning_rate: 0.05
2025-11-26 10:47:12,448 - __main__ - INFO -    - colsample_bytree: 0.8
2025-11-26 10:47:12,454 - __main__ - INFO - 
Performances sur validation:
2025-11-26 10:47:12,454 - __main__ - INFO -    - MAE: 0.0907
2025-11-26 10:47:12,455 - __main__ - INFO -    - R¬≤: 0.5310
2025-11-26 10:47:12,455 - __main__ - INFO - ================================================================================
2025-11-26 10:47:12,456 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-11-26 10:47:12,456 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-26 10:47:12,468 - __main__ - INFO - Train: (1132, 40), Test: (284, 40)
2025-11-26 10:47:13,176 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-26 10:47:13,187 - __main__ - INFO - üìä Test MAE: 0.0907
2025-11-26 10:47:13,188 - __main__ - INFO - üìä Test R¬≤: 0.5310
2025-11-26 10:47:13,188 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-26 10:47:13,720 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-26 10:47:14,230 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-26 10:47:14,261 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-26 10:47:14,300 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-26 10:47:14,301 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-26 10:47:14,301 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-26 10:47:15,171 - __main__ - INFO - ================================================================================
2025-11-26 10:47:15,171 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-26 10:47:15,172 - __main__ - INFO - ================================================================================
2025-11-26 10:47:15,172 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-26 10:47:15,172 - __main__ - INFO -    Train MAE: 0.0150
2025-11-26 10:47:15,173 - __main__ - INFO -    Train R¬≤:  0.9877
2025-11-26 10:47:15,173 - __main__ - INFO -    Test MAE:  0.0907
2025-11-26 10:47:15,173 - __main__ - INFO -    Test R¬≤:   0.5310
2025-11-26 10:47:34,381 - __main__ - INFO - ================================================================================
2025-11-26 10:47:34,382 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-26 10:47:34,382 - __main__ - INFO - ================================================================================
2025-11-26 10:47:34,382 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-26 10:47:34,387 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-26 10:47:34,387 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-26 10:47:34,387 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 60, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-11-26 10:47:34,388 - __main__ - INFO - Chargement des donn√©es...
2025-11-26 10:47:34,415 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-26 10:47:34,529 - __main__ - INFO - Indicateurs charg√©s: (86803, 17)
2025-11-26 10:47:34,529 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-26 10:47:34,604 - __main__ - INFO - PM pivot shape: (1423, 63)
2025-11-26 10:47:34,634 - __main__ - INFO - Ant pivot shape: (1423, 63)
2025-11-26 10:47:34,675 - __main__ - INFO - Ds pivot shape: (1423, 63)
2025-11-26 10:47:34,689 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-11-26 10:47:34,690 - __main__ - INFO - Calcul des features PM sur donn√©es J-60 √† J-60 (pas de data leakage)
2025-11-26 10:47:34,690 - __main__ - INFO -    Colonnes PM utilis√©es: 1
2025-11-26 10:47:36,338 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-11-26 10:47:36,339 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-60 √† J-60
2025-11-26 10:47:36,339 - __main__ - INFO -    Colonnes Ant utilis√©es: 1
2025-11-26 10:47:37,373 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-11-26 10:47:37,374 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-60 √† J-60
2025-11-26 10:47:37,374 - __main__ - INFO -    Colonnes Ds utilis√©es: 1
2025-11-26 10:47:38,570 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-11-26 10:47:38,570 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-11-26 10:47:38,748 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-11-26 10:47:38,749 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-11-26 10:47:39,019 - __main__ - INFO -    Features concurrentes calcul√©es sur J-60 √† J-60
2025-11-26 10:47:39,028 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-11-26 10:47:41,844 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1415, 277)
2025-11-26 10:47:41,853 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-11-26 10:47:41,870 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-11-26 10:47:41,870 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-26 10:47:42,648 - __main__ - INFO - Ajout des vacances scolaires...
2025-11-26 10:47:42,800 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-11-26 10:47:42,829 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 286)
2025-11-26 10:47:42,831 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-26 10:47:42,832 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-11-26 10:47:42,834 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-11-26 10:47:42,836 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-11-26 10:47:42,837 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-11-26 10:47:42,838 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-11-26 10:47:42,853 - __main__ - INFO - Cr√©ation des features et target...
2025-11-26 10:47:42,854 - __main__ - INFO - --------------------------------
2025-11-26 10:47:42,855 - __main__ - INFO - Horizon: 60
2025-11-26 10:47:42,856 - __main__ - INFO - --------------------------------
2025-11-26 10:47:42,856 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-11-26 10:47:42,861 - __main__ - INFO - nb_observations recalcul√© pour horizon=60
2025-11-26 10:47:42,862 - __main__ - INFO -    Minimum: 1
2025-11-26 10:47:42,862 - __main__ - INFO -    Maximum: 1
2025-11-26 10:47:42,864 - __main__ - INFO -    Moyenne: 1.0
2025-11-26 10:47:42,864 - __main__ - INFO - Nombre total de features: 40
2025-11-26 10:47:42,865 - __main__ - INFO -    - TO historiques: 0
2025-11-26 10:47:42,865 - __main__ - INFO -    - Features PM: 7
2025-11-26 10:47:42,866 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-11-26 10:47:42,866 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-11-26 10:47:42,866 - __main__ - INFO -    - Features concurrents: 6
2025-11-26 10:47:42,867 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-11-26 10:47:42,868 - __main__ - INFO -    - Autres features: 11
2025-11-26 10:47:42,945 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\training_data_before_scaling.csv
2025-11-26 10:47:42,946 - __main__ - INFO -    Shape: (1416, 43)
2025-11-26 10:47:42,946 - __main__ - INFO -    Colonnes: stay_date, hotCode, 40 features, J-0
2025-11-26 10:47:42,946 - __main__ - INFO - X shape: (1416, 40), y shape: (1416,)
2025-11-26 10:47:42,947 - __main__ - INFO - ================================================================================
2025-11-26 10:47:42,947 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-11-26 10:47:42,947 - __main__ - INFO - ================================================================================
2025-11-26 10:47:42,954 - __main__ - INFO - Train: (1132, 40), Validation: (284, 40)
2025-11-26 10:47:42,955 - __main__ - INFO - Configuration de la recherche:
2025-11-26 10:47:42,955 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-11-26 10:47:42,955 - __main__ - INFO -    - Cross-validation: 3 folds
2025-11-26 10:47:42,956 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-11-26 10:47:42,956 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-11-26 10:47:42,957 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-11-26 10:48:12,954 - __main__ - INFO - ================================================================================
2025-11-26 10:48:12,954 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-11-26 10:48:12,955 - __main__ - INFO - ================================================================================
2025-11-26 10:48:12,955 - __main__ - INFO - Meilleur score (MAE sur CV): 0.1010
2025-11-26 10:48:12,955 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-11-26 10:48:12,955 - __main__ - INFO -    - subsample: 0.8
2025-11-26 10:48:12,956 - __main__ - INFO -    - reg_lambda: 1.0
2025-11-26 10:48:12,956 - __main__ - INFO -    - reg_alpha: 0.1
2025-11-26 10:48:12,956 - __main__ - INFO -    - n_estimators: 300
2025-11-26 10:48:12,956 - __main__ - INFO -    - min_child_weight: 3
2025-11-26 10:48:12,957 - __main__ - INFO -    - max_depth: 9
2025-11-26 10:48:12,957 - __main__ - INFO -    - learning_rate: 0.05
2025-11-26 10:48:12,957 - __main__ - INFO -    - colsample_bytree: 0.8
2025-11-26 10:48:12,962 - __main__ - INFO - 
Performances sur validation:
2025-11-26 10:48:12,963 - __main__ - INFO -    - MAE: 0.0907
2025-11-26 10:48:12,963 - __main__ - INFO -    - R¬≤: 0.5310
2025-11-26 10:48:12,963 - __main__ - INFO - ================================================================================
2025-11-26 10:48:12,964 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-11-26 10:48:12,964 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-26 10:48:12,970 - __main__ - INFO - Train: (1132, 40), Test: (284, 40)
2025-11-26 10:48:14,251 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-26 10:48:14,266 - __main__ - INFO - üìä Test MAE: 0.0907
2025-11-26 10:48:14,267 - __main__ - INFO - üìä Test R¬≤: 0.5310
2025-11-26 10:48:14,267 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-26 10:48:14,941 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-26 10:48:15,482 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-26 10:48:15,516 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-26 10:48:15,561 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-26 10:48:15,562 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-26 10:48:15,562 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-26 10:48:16,277 - __main__ - INFO - ================================================================================
2025-11-26 10:48:16,277 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-26 10:48:16,277 - __main__ - INFO - ================================================================================
2025-11-26 10:48:16,277 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-26 10:48:16,278 - __main__ - INFO -    Train MAE: 0.0150
2025-11-26 10:48:16,278 - __main__ - INFO -    Train R¬≤:  0.9877
2025-11-26 10:48:16,278 - __main__ - INFO -    Test MAE:  0.0907
2025-11-26 10:48:16,278 - __main__ - INFO -    Test R¬≤:   0.5310
2025-11-26 11:02:50,587 - __main__ - INFO - ================================================================================
2025-11-26 11:02:50,587 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-26 11:02:50,588 - __main__ - INFO - ================================================================================
2025-11-26 11:02:50,588 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-26 11:02:50,593 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-26 11:02:50,593 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-26 11:02:50,593 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 60, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-11-26 11:02:50,593 - __main__ - INFO - Chargement des donn√©es...
2025-11-26 11:02:50,638 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-26 11:02:50,721 - __main__ - INFO - Indicateurs charg√©s: (86803, 17)
2025-11-26 11:02:50,721 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-26 11:02:50,796 - __main__ - INFO - PM pivot shape: (1423, 63)
2025-11-26 11:02:50,817 - __main__ - INFO - Ant pivot shape: (1423, 63)
2025-11-26 11:02:50,837 - __main__ - INFO - Ds pivot shape: (1423, 63)
2025-11-26 11:02:50,849 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-11-26 11:02:50,849 - __main__ - INFO - Calcul des features PM sur donn√©es J-60 √† J-60 (pas de data leakage)
2025-11-26 11:02:50,850 - __main__ - INFO -    Colonnes PM utilis√©es: 1
2025-11-26 11:02:51,837 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-11-26 11:02:51,837 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-60 √† J-60
2025-11-26 11:02:51,838 - __main__ - INFO -    Colonnes Ant utilis√©es: 1
2025-11-26 11:02:52,493 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-11-26 11:02:52,494 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-60 √† J-60
2025-11-26 11:02:52,494 - __main__ - INFO -    Colonnes Ds utilis√©es: 1
2025-11-26 11:02:53,119 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-11-26 11:02:53,119 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-11-26 11:02:53,242 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-11-26 11:02:53,242 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-11-26 11:02:53,403 - __main__ - INFO -    Features concurrentes calcul√©es sur J-60 √† J-60
2025-11-26 11:02:53,409 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-11-26 11:02:54,911 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1415, 277)
2025-11-26 11:02:54,915 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-11-26 11:02:54,927 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-11-26 11:02:54,928 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-26 11:02:55,903 - __main__ - INFO - Ajout des vacances scolaires...
2025-11-26 11:02:56,018 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-11-26 11:02:56,034 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 286)
2025-11-26 11:02:56,034 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-26 11:02:56,035 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-11-26 11:02:56,035 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-11-26 11:02:56,036 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-11-26 11:02:56,036 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-11-26 11:02:56,036 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-11-26 11:02:56,052 - __main__ - INFO - Cr√©ation des features et target...
2025-11-26 11:02:56,053 - __main__ - INFO - --------------------------------
2025-11-26 11:02:56,054 - __main__ - INFO - Horizon: 60
2025-11-26 11:02:56,056 - __main__ - INFO - --------------------------------
2025-11-26 11:02:56,058 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-11-26 11:02:56,065 - __main__ - INFO - nb_observations recalcul√© pour horizon=60
2025-11-26 11:02:56,065 - __main__ - INFO -    Minimum: 1
2025-11-26 11:02:56,068 - __main__ - INFO -    Maximum: 1
2025-11-26 11:02:56,070 - __main__ - INFO -    Moyenne: 1.0
2025-11-26 11:02:56,071 - __main__ - INFO - Nombre total de features: 40
2025-11-26 11:02:56,071 - __main__ - INFO -    - TO historiques: 0
2025-11-26 11:02:56,071 - __main__ - INFO -    - Features PM: 7
2025-11-26 11:02:56,072 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-11-26 11:02:56,072 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-11-26 11:02:56,073 - __main__ - INFO -    - Features concurrents: 6
2025-11-26 11:02:56,073 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-11-26 11:02:56,074 - __main__ - INFO -    - Autres features: 11
2025-11-26 11:02:56,093 - __main__ - WARNING - ‚ö†Ô∏è  Erreur lors de la sauvegarde des donn√©es d'entra√Ænement: [Errno 13] Permission denied: 'results/D09\\training_data_before_scaling.csv'
2025-11-26 11:02:56,093 - __main__ - INFO - X shape: (1416, 40), y shape: (1416,)
2025-11-26 11:02:56,093 - __main__ - INFO - ================================================================================
2025-11-26 11:02:56,094 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-11-26 11:02:56,095 - __main__ - INFO - ================================================================================
2025-11-26 11:02:56,102 - __main__ - INFO - Train: (1132, 40), Validation: (284, 40)
2025-11-26 11:02:56,102 - __main__ - INFO - Configuration de la recherche:
2025-11-26 11:02:56,102 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-11-26 11:02:56,103 - __main__ - INFO -    - Cross-validation: 3 folds
2025-11-26 11:02:56,103 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-11-26 11:02:56,103 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-11-26 11:02:56,103 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-11-26 11:03:19,551 - __main__ - INFO - ================================================================================
2025-11-26 11:03:19,552 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-11-26 11:03:19,552 - __main__ - INFO - ================================================================================
2025-11-26 11:03:19,552 - __main__ - INFO - Meilleur score (MAE sur CV): 0.1010
2025-11-26 11:03:19,552 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-11-26 11:03:19,552 - __main__ - INFO -    - subsample: 0.8
2025-11-26 11:03:19,553 - __main__ - INFO -    - reg_lambda: 1.0
2025-11-26 11:03:19,553 - __main__ - INFO -    - reg_alpha: 0.1
2025-11-26 11:03:19,553 - __main__ - INFO -    - n_estimators: 300
2025-11-26 11:03:19,553 - __main__ - INFO -    - min_child_weight: 3
2025-11-26 11:03:19,553 - __main__ - INFO -    - max_depth: 9
2025-11-26 11:03:19,553 - __main__ - INFO -    - learning_rate: 0.05
2025-11-26 11:03:19,553 - __main__ - INFO -    - colsample_bytree: 0.8
2025-11-26 11:03:19,558 - __main__ - INFO - 
Performances sur validation:
2025-11-26 11:03:19,559 - __main__ - INFO -    - MAE: 0.0907
2025-11-26 11:03:19,559 - __main__ - INFO -    - R¬≤: 0.5310
2025-11-26 11:03:19,559 - __main__ - INFO - ================================================================================
2025-11-26 11:03:19,560 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-11-26 11:03:19,561 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-26 11:03:19,564 - __main__ - INFO - Train: (1132, 40), Test: (284, 40)
2025-11-26 11:03:20,094 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-26 11:03:20,130 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\test_predictions.csv
2025-11-26 11:03:20,131 - __main__ - INFO -    Shape: (284, 44)
2025-11-26 11:03:20,131 - __main__ - INFO -    Colonnes: 40 features + y_test + y_pred + error + abs_error
2025-11-26 11:03:20,131 - __main__ - INFO -    MAE moyen: 0.0907
2025-11-26 11:03:20,139 - __main__ - INFO - üìä Test MAE: 0.0907
2025-11-26 11:03:20,139 - __main__ - INFO - üìä Test R¬≤: 0.5310
2025-11-26 11:03:20,140 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-26 11:03:21,032 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-26 11:03:21,469 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-26 11:03:21,494 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-26 11:03:21,523 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-26 11:03:21,523 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-26 11:03:21,524 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-26 11:03:22,206 - __main__ - INFO - ================================================================================
2025-11-26 11:03:22,206 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-26 11:03:22,206 - __main__ - INFO - ================================================================================
2025-11-26 11:03:22,206 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-26 11:03:22,207 - __main__ - INFO -    Train MAE: 0.0150
2025-11-26 11:03:22,207 - __main__ - INFO -    Train R¬≤:  0.9877
2025-11-26 11:03:22,207 - __main__ - INFO -    Test MAE:  0.0907
2025-11-26 11:03:22,207 - __main__ - INFO -    Test R¬≤:   0.5310
2025-11-26 11:09:23,068 - __main__ - INFO - ================================================================================
2025-11-26 11:09:23,069 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-11-26 11:09:23,069 - __main__ - INFO - ================================================================================
2025-11-26 11:09:23,069 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-11-26 11:09:23,073 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-11-26 11:09:23,073 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-11-26 11:09:23,074 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 60, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'prediction-demande', 'save_to_azure': True, 'model_dir': 'results/D09/models', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-11-26 11:09:23,074 - __main__ - INFO - Chargement des donn√©es...
2025-11-26 11:09:23,089 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-11-26 11:09:23,179 - __main__ - INFO - Indicateurs charg√©s: (86803, 17)
2025-11-26 11:09:23,180 - __main__ - INFO - Pr√©paration des donn√©es...
2025-11-26 11:09:23,238 - __main__ - INFO - PM pivot shape: (1423, 63)
2025-11-26 11:09:23,266 - __main__ - INFO - Ant pivot shape: (1423, 63)
2025-11-26 11:09:23,296 - __main__ - INFO - Ds pivot shape: (1423, 63)
2025-11-26 11:09:23,306 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-11-26 11:09:23,306 - __main__ - INFO - Calcul des features PM sur donn√©es J-60 √† J-60 (pas de data leakage)
2025-11-26 11:09:23,308 - __main__ - INFO -    Colonnes PM utilis√©es: 1
2025-11-26 11:09:24,442 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-11-26 11:09:24,443 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-60 √† J-60
2025-11-26 11:09:24,443 - __main__ - INFO -    Colonnes Ant utilis√©es: 1
2025-11-26 11:09:25,120 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-11-26 11:09:25,120 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-60 √† J-60
2025-11-26 11:09:25,121 - __main__ - INFO -    Colonnes Ds utilis√©es: 1
2025-11-26 11:09:25,856 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-11-26 11:09:25,856 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-11-26 11:09:25,985 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-11-26 11:09:25,986 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-11-26 11:09:26,194 - __main__ - INFO -    Features concurrentes calcul√©es sur J-60 √† J-60
2025-11-26 11:09:26,202 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-11-26 11:09:28,678 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1415, 277)
2025-11-26 11:09:28,683 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-11-26 11:09:28,690 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-11-26 11:09:28,690 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-11-26 11:09:29,097 - __main__ - INFO - Ajout des vacances scolaires...
2025-11-26 11:09:29,200 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-11-26 11:09:29,216 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 286)
2025-11-26 11:09:29,217 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-11-26 11:09:29,217 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-11-26 11:09:29,218 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-11-26 11:09:29,218 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-11-26 11:09:29,218 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-11-26 11:09:29,219 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-11-26 11:09:29,227 - __main__ - INFO - Cr√©ation des features et target...
2025-11-26 11:09:29,228 - __main__ - INFO - --------------------------------
2025-11-26 11:09:29,228 - __main__ - INFO - Horizon: 60
2025-11-26 11:09:29,228 - __main__ - INFO - --------------------------------
2025-11-26 11:09:29,229 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-11-26 11:09:29,231 - __main__ - INFO - nb_observations recalcul√© pour horizon=60
2025-11-26 11:09:29,231 - __main__ - INFO -    Minimum: 1
2025-11-26 11:09:29,232 - __main__ - INFO -    Maximum: 1
2025-11-26 11:09:29,232 - __main__ - INFO -    Moyenne: 1.0
2025-11-26 11:09:29,232 - __main__ - INFO - Nombre total de features: 40
2025-11-26 11:09:29,232 - __main__ - INFO -    - TO historiques: 0
2025-11-26 11:09:29,233 - __main__ - INFO -    - Features PM: 7
2025-11-26 11:09:29,233 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-11-26 11:09:29,233 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-11-26 11:09:29,233 - __main__ - INFO -    - Features concurrents: 6
2025-11-26 11:09:29,233 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-11-26 11:09:29,234 - __main__ - INFO -    - Autres features: 11
2025-11-26 11:09:29,244 - __main__ - WARNING - ‚ö†Ô∏è  Erreur lors de la sauvegarde des donn√©es d'entra√Ænement: [Errno 13] Permission denied: 'results/D09\\training_data_before_scaling.csv'
2025-11-26 11:09:29,244 - __main__ - INFO - X shape: (1416, 40), y shape: (1416,)
2025-11-26 11:09:29,245 - __main__ - INFO - ================================================================================
2025-11-26 11:09:29,245 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-11-26 11:09:29,245 - __main__ - INFO - ================================================================================
2025-11-26 11:09:29,250 - __main__ - INFO - Train: (1132, 40), Validation: (284, 40)
2025-11-26 11:09:29,250 - __main__ - INFO - Configuration de la recherche:
2025-11-26 11:09:29,250 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-11-26 11:09:29,251 - __main__ - INFO -    - Cross-validation: 3 folds
2025-11-26 11:09:29,251 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-11-26 11:09:29,251 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-11-26 11:09:29,251 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-11-26 11:09:52,876 - __main__ - INFO - ================================================================================
2025-11-26 11:09:52,876 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-11-26 11:09:52,876 - __main__ - INFO - ================================================================================
2025-11-26 11:09:52,877 - __main__ - INFO - Meilleur score (MAE sur CV): 0.1010
2025-11-26 11:09:52,877 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-11-26 11:09:52,877 - __main__ - INFO -    - subsample: 0.8
2025-11-26 11:09:52,877 - __main__ - INFO -    - reg_lambda: 1.0
2025-11-26 11:09:52,878 - __main__ - INFO -    - reg_alpha: 0.1
2025-11-26 11:09:52,878 - __main__ - INFO -    - n_estimators: 300
2025-11-26 11:09:52,878 - __main__ - INFO -    - min_child_weight: 3
2025-11-26 11:09:52,878 - __main__ - INFO -    - max_depth: 9
2025-11-26 11:09:52,878 - __main__ - INFO -    - learning_rate: 0.05
2025-11-26 11:09:52,878 - __main__ - INFO -    - colsample_bytree: 0.8
2025-11-26 11:09:52,883 - __main__ - INFO - 
Performances sur validation:
2025-11-26 11:09:52,883 - __main__ - INFO -    - MAE: 0.0907
2025-11-26 11:09:52,884 - __main__ - INFO -    - R¬≤: 0.5310
2025-11-26 11:09:52,884 - __main__ - INFO - ================================================================================
2025-11-26 11:09:52,885 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-11-26 11:09:52,885 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-11-26 11:09:52,887 - __main__ - INFO - Train: (1132, 40), Test: (284, 40)
2025-11-26 11:09:53,634 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-11-26 11:09:53,688 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\test_predictions.csv
2025-11-26 11:09:53,688 - __main__ - INFO -    Shape: (284, 46)
2025-11-26 11:09:53,689 - __main__ - INFO -    Colonnes: stay_date, hotCode, 40 features + y_test + y_pred + error + abs_error
2025-11-26 11:09:53,689 - __main__ - INFO -    MAE moyen: 0.0907
2025-11-26 11:09:53,701 - __main__ - INFO - üìä Test MAE: 0.0907
2025-11-26 11:09:53,701 - __main__ - INFO - üìä Test R¬≤: 0.5310
2025-11-26 11:09:53,702 - __main__ - INFO - √âvaluation du mod√®le...
2025-11-26 11:09:54,211 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_scatter_plot.png
2025-11-26 11:09:54,631 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\xgb_feature_importance.png
2025-11-26 11:09:54,655 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09/models...
2025-11-26 11:09:54,687 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09/models\xgb_to_predictor.joblib
2025-11-26 11:09:54,688 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09/models\xgb_scaler.joblib
2025-11-26 11:09:54,688 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09/models\feature_columns.txt
2025-11-26 11:09:55,288 - __main__ - INFO - ================================================================================
2025-11-26 11:09:55,289 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-11-26 11:09:55,289 - __main__ - INFO - ================================================================================
2025-11-26 11:09:55,289 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-11-26 11:09:55,289 - __main__ - INFO -    Train MAE: 0.0150
2025-11-26 11:09:55,290 - __main__ - INFO -    Train R¬≤:  0.9877
2025-11-26 11:09:55,290 - __main__ - INFO -    Test MAE:  0.0907
2025-11-26 11:09:55,290 - __main__ - INFO -    Test R¬≤:   0.5310
2025-12-01 15:23:32,912 - __main__ - INFO - ================================================================================
2025-12-01 15:23:32,913 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 15:23:32,913 - __main__ - INFO - ================================================================================
2025-12-01 15:23:32,913 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 15:23:32,917 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 15:23:32,917 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 60
2025-12-01 15:23:32,917 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 15:23:32,917 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 15:23:32,917 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 60, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 15:23:32,917 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 15:23:32,954 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-12-01 15:23:33,234 - __main__ - INFO - Indicateurs charg√©s: (268538, 17)
2025-12-01 15:23:33,234 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 15:23:33,269 - __main__ - INFO -    Clusters filtr√©s: (1415, 65)
2025-12-01 15:23:33,269 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 15:23:33,269 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 15:23:33,426 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 15:23:33,470 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 15:23:33,512 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 15:23:33,532 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-12-01 15:23:33,532 - __main__ - INFO - Calcul des features PM sur donn√©es J-60 √† J-60 (pas de data leakage)
2025-12-01 15:23:33,532 - __main__ - INFO -    Colonnes PM utilis√©es: 1
2025-12-01 15:23:35,381 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-12-01 15:23:35,381 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-60 √† J-60
2025-12-01 15:23:35,381 - __main__ - INFO -    Colonnes Ant utilis√©es: 1
2025-12-01 15:23:36,805 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-12-01 15:23:36,805 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-60 √† J-60
2025-12-01 15:23:36,805 - __main__ - INFO -    Colonnes Ds utilis√©es: 1
2025-12-01 15:23:37,850 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-12-01 15:23:37,851 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 15:23:38,001 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 15:23:38,001 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 15:23:38,194 - __main__ - INFO -    Features concurrentes calcul√©es sur J-60 √† J-60
2025-12-01 15:23:38,199 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 15:23:40,362 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1415, 277)
2025-12-01 15:23:40,375 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 15:23:40,399 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-12-01 15:23:40,400 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 15:23:41,725 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 15:23:41,871 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 15:23:41,892 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 286)
2025-12-01 15:23:41,892 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-12-01 15:23:41,892 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-12-01 15:23:41,892 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-12-01 15:23:41,893 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-12-01 15:23:41,893 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-12-01 15:23:41,893 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-12-01 15:23:41,901 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 15:23:41,901 - __main__ - INFO - --------------------------------
2025-12-01 15:23:41,901 - __main__ - INFO - Horizon: 60
2025-12-01 15:23:41,901 - __main__ - INFO - --------------------------------
2025-12-01 15:23:41,902 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 15:23:41,904 - __main__ - INFO - nb_observations recalcul√© pour horizon=60
2025-12-01 15:23:41,905 - __main__ - INFO -    Minimum: 1
2025-12-01 15:23:41,905 - __main__ - INFO -    Maximum: 1
2025-12-01 15:23:41,905 - __main__ - INFO -    Moyenne: 1.0
2025-12-01 15:23:41,905 - __main__ - INFO - Nombre total de features: 40
2025-12-01 15:23:41,905 - __main__ - INFO -    - TO historiques: 0
2025-12-01 15:23:41,905 - __main__ - INFO -    - Features PM: 7
2025-12-01 15:23:41,906 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 15:23:41,906 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 15:23:41,906 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 15:23:41,906 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 15:23:41,906 - __main__ - INFO -    - Autres features: 11
2025-12-01 15:23:41,956 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-60\training_data_before_scaling.csv
2025-12-01 15:23:41,956 - __main__ - INFO -    Shape: (1416, 43)
2025-12-01 15:23:41,956 - __main__ - INFO -    Colonnes: stay_date, hotCode, 40 features, J-0
2025-12-01 15:23:41,956 - __main__ - INFO - X shape: (1416, 40), y shape: (1416,)
2025-12-01 15:23:41,956 - __main__ - INFO - ================================================================================
2025-12-01 15:23:41,956 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 15:23:41,956 - __main__ - INFO - ================================================================================
2025-12-01 15:23:41,962 - __main__ - INFO - Train: (1132, 40), Validation: (284, 40)
2025-12-01 15:23:41,962 - __main__ - INFO - Configuration de la recherche:
2025-12-01 15:23:41,962 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 15:23:41,962 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 15:23:41,962 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 15:23:41,962 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 15:23:41,962 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 15:24:11,303 - __main__ - INFO - ================================================================================
2025-12-01 15:24:11,303 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 15:24:11,303 - __main__ - INFO - ================================================================================
2025-12-01 15:24:11,303 - __main__ - INFO - Meilleur score (MAE sur CV): 0.1010
2025-12-01 15:24:11,303 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 15:24:11,304 - __main__ - INFO -    - subsample: 0.8
2025-12-01 15:24:11,304 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 15:24:11,304 - __main__ - INFO -    - reg_alpha: 0.1
2025-12-01 15:24:11,304 - __main__ - INFO -    - n_estimators: 300
2025-12-01 15:24:11,304 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 15:24:11,304 - __main__ - INFO -    - max_depth: 9
2025-12-01 15:24:11,304 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 15:24:11,304 - __main__ - INFO -    - colsample_bytree: 0.8
2025-12-01 15:24:11,309 - __main__ - INFO - 
Performances sur validation:
2025-12-01 15:24:11,310 - __main__ - INFO -    - MAE: 0.0907
2025-12-01 15:24:11,310 - __main__ - INFO -    - R¬≤: 0.5310
2025-12-01 15:24:11,310 - __main__ - INFO - ================================================================================
2025-12-01 15:24:11,310 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 15:24:11,310 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 15:24:11,315 - __main__ - INFO - Train: (1132, 40), Test: (284, 40)
2025-12-01 15:24:12,145 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 15:24:12,196 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-60\test_predictions.csv
2025-12-01 15:24:12,196 - __main__ - INFO -    Shape: (284, 46)
2025-12-01 15:24:12,196 - __main__ - INFO -    Colonnes: stay_date, hotCode, 40 features + y_test + y_pred + error + abs_error
2025-12-01 15:24:12,196 - __main__ - INFO -    MAE moyen: 0.0907
2025-12-01 15:24:12,207 - __main__ - INFO - üìä Test MAE: 0.0907
2025-12-01 15:24:12,207 - __main__ - INFO - üìä Test R¬≤: 0.5310
2025-12-01 15:24:12,207 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 15:24:13,087 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-60\xgb_scatter_plot.png
2025-12-01 15:24:13,528 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-60\xgb_feature_importance.png
2025-12-01 15:24:13,552 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-60\models...
2025-12-01 15:24:13,585 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-60\models\xgb_to_predictor.joblib
2025-12-01 15:24:13,585 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-60\models\xgb_scaler.joblib
2025-12-01 15:24:13,585 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-60\models\feature_columns.txt
2025-12-01 15:24:13,585 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 15:24:13,585 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 15:24:13,586 - __main__ - INFO -    Container: ml-models
2025-12-01 15:24:14,260 - __main__ - INFO -    Container existant trouv√©
2025-12-01 15:24:14,260 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-60/
2025-12-01 15:24:14,845 - __main__ - INFO -    ‚úì predictTo/D09/J-60/models/xgb_to_predictor.joblib
2025-12-01 15:24:14,862 - __main__ - INFO -    ‚úì predictTo/D09/J-60/models/xgb_scaler.joblib
2025-12-01 15:24:14,880 - __main__ - INFO -    ‚úì predictTo/D09/J-60/models/feature_columns.txt
2025-12-01 15:24:14,907 - __main__ - INFO -    ‚úì predictTo/D09/J-60/xgb_scatter_plot.png
2025-12-01 15:24:14,930 - __main__ - INFO -    ‚úì predictTo/D09/J-60/xgb_feature_importance.png
2025-12-01 15:24:15,006 - __main__ - INFO -    ‚úì predictTo/D09/J-60/training_data_before_scaling.csv
2025-12-01 15:24:15,034 - __main__ - INFO -    ‚úì predictTo/D09/J-60/test_predictions.csv
2025-12-01 15:24:15,035 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 15:24:15,035 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-60/
2025-12-01 15:24:15,037 - __main__ - INFO - ================================================================================
2025-12-01 15:24:15,037 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 15:24:15,037 - __main__ - INFO - ================================================================================
2025-12-01 15:24:15,037 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 15:24:15,037 - __main__ - INFO -    Train MAE: 0.0150
2025-12-01 15:24:15,037 - __main__ - INFO -    Train R¬≤:  0.9877
2025-12-01 15:24:15,038 - __main__ - INFO -    Test MAE:  0.0907
2025-12-01 15:24:15,038 - __main__ - INFO -    Test R¬≤:   0.5310
2025-12-01 15:24:23,158 - __main__ - INFO - ================================================================================
2025-12-01 15:24:23,159 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 15:24:23,159 - __main__ - INFO - ================================================================================
2025-12-01 15:24:23,159 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 15:24:23,164 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 15:24:23,164 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 45
2025-12-01 15:24:23,164 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 15:24:23,164 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 15:24:23,164 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 45, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 15:24:23,164 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 15:24:23,189 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-12-01 15:24:23,550 - __main__ - INFO - Indicateurs charg√©s: (268538, 17)
2025-12-01 15:24:23,551 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 15:24:23,585 - __main__ - INFO -    Clusters filtr√©s: (1415, 65)
2025-12-01 15:24:23,585 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 15:24:23,585 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 15:24:23,750 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 15:24:23,863 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 15:24:23,962 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 15:24:23,996 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-12-01 15:24:23,997 - __main__ - INFO - Calcul des features PM sur donn√©es J-45 √† J-60 (pas de data leakage)
2025-12-01 15:24:23,997 - __main__ - INFO -    Colonnes PM utilis√©es: 16
2025-12-01 15:24:26,339 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-12-01 15:24:26,339 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-45 √† J-60
2025-12-01 15:24:26,340 - __main__ - INFO -    Colonnes Ant utilis√©es: 16
2025-12-01 15:24:28,121 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-12-01 15:24:28,121 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-45 √† J-60
2025-12-01 15:24:28,122 - __main__ - INFO -    Colonnes Ds utilis√©es: 16
2025-12-01 15:24:29,679 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-12-01 15:24:29,680 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 15:24:29,848 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 15:24:29,848 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 15:24:30,106 - __main__ - INFO -    Features concurrentes calcul√©es sur J-45 √† J-60
2025-12-01 15:24:30,117 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 15:24:33,671 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1415, 277)
2025-12-01 15:24:33,679 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 15:24:33,689 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-12-01 15:24:33,689 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 15:24:34,359 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 15:24:34,503 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 15:24:34,529 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 286)
2025-12-01 15:24:34,530 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-12-01 15:24:34,530 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-12-01 15:24:34,530 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-12-01 15:24:34,530 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-12-01 15:24:34,531 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-12-01 15:24:34,531 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-12-01 15:24:34,538 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 15:24:34,538 - __main__ - INFO - --------------------------------
2025-12-01 15:24:34,539 - __main__ - INFO - Horizon: 45
2025-12-01 15:24:34,539 - __main__ - INFO - --------------------------------
2025-12-01 15:24:34,539 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 15:24:34,541 - __main__ - INFO - nb_observations recalcul√© pour horizon=45
2025-12-01 15:24:34,541 - __main__ - INFO -    Minimum: 16
2025-12-01 15:24:34,541 - __main__ - INFO -    Maximum: 16
2025-12-01 15:24:34,541 - __main__ - INFO -    Moyenne: 16.0
2025-12-01 15:24:34,541 - __main__ - INFO - Nombre total de features: 55
2025-12-01 15:24:34,541 - __main__ - INFO -    - TO historiques: 15
2025-12-01 15:24:34,541 - __main__ - INFO -    - Features PM: 7
2025-12-01 15:24:34,541 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 15:24:34,541 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 15:24:34,542 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 15:24:34,542 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 15:24:34,542 - __main__ - INFO -    - Autres features: 11
2025-12-01 15:24:34,635 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-45\training_data_before_scaling.csv
2025-12-01 15:24:34,635 - __main__ - INFO -    Shape: (1416, 58)
2025-12-01 15:24:34,635 - __main__ - INFO -    Colonnes: stay_date, hotCode, 55 features, J-0
2025-12-01 15:24:34,635 - __main__ - INFO - X shape: (1416, 55), y shape: (1416,)
2025-12-01 15:24:34,635 - __main__ - INFO - ================================================================================
2025-12-01 15:24:34,635 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 15:24:34,635 - __main__ - INFO - ================================================================================
2025-12-01 15:24:34,641 - __main__ - INFO - Train: (1132, 55), Validation: (284, 55)
2025-12-01 15:24:34,641 - __main__ - INFO - Configuration de la recherche:
2025-12-01 15:24:34,641 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 15:24:34,641 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 15:24:34,641 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 15:24:34,641 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 15:24:34,641 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 15:26:08,262 - __main__ - INFO - ================================================================================
2025-12-01 15:26:08,262 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 15:26:08,262 - __main__ - INFO - ================================================================================
2025-12-01 15:26:08,262 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0942
2025-12-01 15:26:08,262 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 15:26:08,263 - __main__ - INFO -    - subsample: 0.95
2025-12-01 15:26:08,263 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 15:26:08,263 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 15:26:08,263 - __main__ - INFO -    - n_estimators: 500
2025-12-01 15:26:08,263 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 15:26:08,263 - __main__ - INFO -    - max_depth: 5
2025-12-01 15:26:08,263 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 15:26:08,263 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 15:26:08,268 - __main__ - INFO - 
Performances sur validation:
2025-12-01 15:26:08,269 - __main__ - INFO -    - MAE: 0.0872
2025-12-01 15:26:08,269 - __main__ - INFO -    - R¬≤: 0.5571
2025-12-01 15:26:08,269 - __main__ - INFO - ================================================================================
2025-12-01 15:26:08,269 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 15:26:08,269 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 15:26:08,273 - __main__ - INFO - Train: (1132, 55), Test: (284, 55)
2025-12-01 15:26:09,774 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 15:26:09,846 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-45\test_predictions.csv
2025-12-01 15:26:09,847 - __main__ - INFO -    Shape: (284, 61)
2025-12-01 15:26:09,847 - __main__ - INFO -    Colonnes: stay_date, hotCode, 55 features + y_test + y_pred + error + abs_error
2025-12-01 15:26:09,847 - __main__ - INFO -    MAE moyen: 0.0872
2025-12-01 15:26:09,858 - __main__ - INFO - üìä Test MAE: 0.0872
2025-12-01 15:26:09,858 - __main__ - INFO - üìä Test R¬≤: 0.5571
2025-12-01 15:26:09,859 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 15:26:10,579 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-45\xgb_scatter_plot.png
2025-12-01 15:26:11,305 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-45\xgb_feature_importance.png
2025-12-01 15:26:11,333 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-45\models...
2025-12-01 15:26:11,381 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-45\models\xgb_to_predictor.joblib
2025-12-01 15:26:11,381 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-45\models\xgb_scaler.joblib
2025-12-01 15:26:11,381 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-45\models\feature_columns.txt
2025-12-01 15:26:11,381 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 15:26:11,382 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 15:26:11,382 - __main__ - INFO -    Container: ml-models
2025-12-01 15:26:12,124 - __main__ - INFO -    Container existant trouv√©
2025-12-01 15:26:12,124 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-45/
2025-12-01 15:26:12,543 - __main__ - INFO -    ‚úì predictTo/D09/J-45/models/xgb_to_predictor.joblib
2025-12-01 15:26:12,560 - __main__ - INFO -    ‚úì predictTo/D09/J-45/models/xgb_scaler.joblib
2025-12-01 15:26:12,578 - __main__ - INFO -    ‚úì predictTo/D09/J-45/models/feature_columns.txt
2025-12-01 15:26:12,606 - __main__ - INFO -    ‚úì predictTo/D09/J-45/xgb_scatter_plot.png
2025-12-01 15:26:12,628 - __main__ - INFO -    ‚úì predictTo/D09/J-45/xgb_feature_importance.png
2025-12-01 15:26:12,837 - __main__ - INFO -    ‚úì predictTo/D09/J-45/training_data_before_scaling.csv
2025-12-01 15:26:12,897 - __main__ - INFO -    ‚úì predictTo/D09/J-45/test_predictions.csv
2025-12-01 15:26:12,897 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 15:26:12,898 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-45/
2025-12-01 15:26:12,900 - __main__ - INFO - ================================================================================
2025-12-01 15:26:12,900 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 15:26:12,900 - __main__ - INFO - ================================================================================
2025-12-01 15:26:12,900 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 15:26:12,900 - __main__ - INFO -    Train MAE: 0.0099
2025-12-01 15:26:12,900 - __main__ - INFO -    Train R¬≤:  0.9938
2025-12-01 15:26:12,901 - __main__ - INFO -    Test MAE:  0.0872
2025-12-01 15:26:12,901 - __main__ - INFO -    Test R¬≤:   0.5571
2025-12-01 15:26:22,433 - __main__ - INFO - ================================================================================
2025-12-01 15:26:22,433 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 15:26:22,433 - __main__ - INFO - ================================================================================
2025-12-01 15:26:22,433 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 15:26:22,438 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 15:26:22,438 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 30
2025-12-01 15:26:22,438 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 15:26:22,438 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 15:26:22,438 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 30, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 15:26:22,438 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 15:26:22,458 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-12-01 15:26:22,754 - __main__ - INFO - Indicateurs charg√©s: (268538, 17)
2025-12-01 15:26:22,755 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 15:26:22,780 - __main__ - INFO -    Clusters filtr√©s: (1415, 65)
2025-12-01 15:26:22,781 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 15:26:22,781 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 15:26:22,894 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 15:26:22,925 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 15:26:22,957 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 15:26:22,968 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-12-01 15:26:22,968 - __main__ - INFO - Calcul des features PM sur donn√©es J-30 √† J-60 (pas de data leakage)
2025-12-01 15:26:22,969 - __main__ - INFO -    Colonnes PM utilis√©es: 31
2025-12-01 15:26:25,089 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-12-01 15:26:25,089 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-30 √† J-60
2025-12-01 15:26:25,089 - __main__ - INFO -    Colonnes Ant utilis√©es: 31
2025-12-01 15:26:26,819 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-12-01 15:26:26,819 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-30 √† J-60
2025-12-01 15:26:26,819 - __main__ - INFO -    Colonnes Ds utilis√©es: 31
2025-12-01 15:26:28,423 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-12-01 15:26:28,423 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 15:26:28,586 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 15:26:28,587 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 15:26:28,814 - __main__ - INFO -    Features concurrentes calcul√©es sur J-30 √† J-60
2025-12-01 15:26:28,828 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 15:26:32,511 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1415, 277)
2025-12-01 15:26:32,519 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 15:26:32,531 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-12-01 15:26:32,531 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 15:26:33,239 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 15:26:33,388 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 15:26:33,412 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 286)
2025-12-01 15:26:33,412 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-12-01 15:26:33,412 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-12-01 15:26:33,413 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-12-01 15:26:33,413 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-12-01 15:26:33,413 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-12-01 15:26:33,413 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-12-01 15:26:33,419 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 15:26:33,420 - __main__ - INFO - --------------------------------
2025-12-01 15:26:33,420 - __main__ - INFO - Horizon: 30
2025-12-01 15:26:33,420 - __main__ - INFO - --------------------------------
2025-12-01 15:26:33,420 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 15:26:33,422 - __main__ - INFO - nb_observations recalcul√© pour horizon=30
2025-12-01 15:26:33,423 - __main__ - INFO -    Minimum: 31
2025-12-01 15:26:33,423 - __main__ - INFO -    Maximum: 31
2025-12-01 15:26:33,423 - __main__ - INFO -    Moyenne: 31.0
2025-12-01 15:26:33,423 - __main__ - INFO - Nombre total de features: 70
2025-12-01 15:26:33,423 - __main__ - INFO -    - TO historiques: 30
2025-12-01 15:26:33,423 - __main__ - INFO -    - Features PM: 7
2025-12-01 15:26:33,423 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 15:26:33,423 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 15:26:33,423 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 15:26:33,423 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 15:26:33,423 - __main__ - INFO -    - Autres features: 11
2025-12-01 15:26:33,567 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-30\training_data_before_scaling.csv
2025-12-01 15:26:33,568 - __main__ - INFO -    Shape: (1416, 73)
2025-12-01 15:26:33,568 - __main__ - INFO -    Colonnes: stay_date, hotCode, 70 features, J-0
2025-12-01 15:26:33,568 - __main__ - INFO - X shape: (1416, 70), y shape: (1416,)
2025-12-01 15:26:33,568 - __main__ - INFO - ================================================================================
2025-12-01 15:26:33,569 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 15:26:33,569 - __main__ - INFO - ================================================================================
2025-12-01 15:26:33,577 - __main__ - INFO - Train: (1132, 70), Validation: (284, 70)
2025-12-01 15:26:33,578 - __main__ - INFO - Configuration de la recherche:
2025-12-01 15:26:33,578 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 15:26:33,578 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 15:26:33,578 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 15:26:33,578 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 15:26:33,578 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 15:28:07,048 - __main__ - INFO - ================================================================================
2025-12-01 15:28:07,048 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 15:28:07,049 - __main__ - INFO - ================================================================================
2025-12-01 15:28:07,049 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 15:28:07,052 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 15:28:07,052 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 60
2025-12-01 15:28:07,052 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 15:28:07,052 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 15:28:07,052 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 60, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 15:28:07,052 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 15:28:07,068 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-12-01 15:28:07,300 - __main__ - INFO - Indicateurs charg√©s: (268538, 17)
2025-12-01 15:28:07,300 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 15:28:07,323 - __main__ - INFO -    Clusters filtr√©s: (1415, 65)
2025-12-01 15:28:07,324 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 15:28:07,324 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 15:28:07,409 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 15:28:07,436 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 15:28:07,462 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 15:28:07,473 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-12-01 15:28:07,473 - __main__ - INFO - Calcul des features PM sur donn√©es J-60 √† J-60 (pas de data leakage)
2025-12-01 15:28:07,473 - __main__ - INFO -    Colonnes PM utilis√©es: 1
2025-12-01 15:28:08,677 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-12-01 15:28:08,678 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-60 √† J-60
2025-12-01 15:28:08,678 - __main__ - INFO -    Colonnes Ant utilis√©es: 1
2025-12-01 15:28:09,691 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-12-01 15:28:09,691 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-60 √† J-60
2025-12-01 15:28:09,691 - __main__ - INFO -    Colonnes Ds utilis√©es: 1
2025-12-01 15:28:10,485 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-12-01 15:28:10,485 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 15:28:10,615 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 15:28:10,615 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 15:28:10,782 - __main__ - INFO -    Features concurrentes calcul√©es sur J-60 √† J-60
2025-12-01 15:28:10,789 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 15:28:12,531 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1415, 277)
2025-12-01 15:28:12,537 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 15:28:12,545 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-12-01 15:28:12,546 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 15:28:12,979 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 15:28:13,120 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 15:28:13,164 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 286)
2025-12-01 15:28:13,165 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-12-01 15:28:13,165 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-12-01 15:28:13,165 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-12-01 15:28:13,165 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-12-01 15:28:13,165 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-12-01 15:28:13,165 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-12-01 15:28:13,180 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 15:28:13,180 - __main__ - INFO - --------------------------------
2025-12-01 15:28:13,180 - __main__ - INFO - Horizon: 60
2025-12-01 15:28:13,180 - __main__ - INFO - --------------------------------
2025-12-01 15:28:13,181 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 15:28:13,183 - __main__ - INFO - nb_observations recalcul√© pour horizon=60
2025-12-01 15:28:13,183 - __main__ - INFO -    Minimum: 1
2025-12-01 15:28:13,183 - __main__ - INFO -    Maximum: 1
2025-12-01 15:28:13,183 - __main__ - INFO -    Moyenne: 1.0
2025-12-01 15:28:13,183 - __main__ - INFO - Nombre total de features: 40
2025-12-01 15:28:13,183 - __main__ - INFO -    - TO historiques: 0
2025-12-01 15:28:13,183 - __main__ - INFO -    - Features PM: 7
2025-12-01 15:28:13,183 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 15:28:13,183 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 15:28:13,184 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 15:28:13,184 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 15:28:13,184 - __main__ - INFO -    - Autres features: 11
2025-12-01 15:28:13,240 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-60\training_data_before_scaling.csv
2025-12-01 15:28:13,240 - __main__ - INFO -    Shape: (1416, 43)
2025-12-01 15:28:13,240 - __main__ - INFO -    Colonnes: stay_date, hotCode, 40 features, J-0
2025-12-01 15:28:13,240 - __main__ - INFO - X shape: (1416, 40), y shape: (1416,)
2025-12-01 15:28:13,240 - __main__ - INFO - ================================================================================
2025-12-01 15:28:13,240 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 15:28:13,241 - __main__ - INFO - ================================================================================
2025-12-01 15:28:13,246 - __main__ - INFO - Train: (1132, 40), Validation: (284, 40)
2025-12-01 15:28:13,246 - __main__ - INFO - Configuration de la recherche:
2025-12-01 15:28:13,246 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 15:28:13,246 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 15:28:13,246 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 15:28:13,247 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 15:28:13,247 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 15:28:37,735 - __main__ - INFO - ================================================================================
2025-12-01 15:28:37,736 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 15:28:37,736 - __main__ - INFO - ================================================================================
2025-12-01 15:28:37,736 - __main__ - INFO - Meilleur score (MAE sur CV): 0.1010
2025-12-01 15:28:37,736 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 15:28:37,736 - __main__ - INFO -    - subsample: 0.8
2025-12-01 15:28:37,736 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 15:28:37,737 - __main__ - INFO -    - reg_alpha: 0.1
2025-12-01 15:28:37,737 - __main__ - INFO -    - n_estimators: 300
2025-12-01 15:28:37,737 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 15:28:37,737 - __main__ - INFO -    - max_depth: 9
2025-12-01 15:28:37,737 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 15:28:37,737 - __main__ - INFO -    - colsample_bytree: 0.8
2025-12-01 15:28:37,743 - __main__ - INFO - 
Performances sur validation:
2025-12-01 15:28:37,743 - __main__ - INFO -    - MAE: 0.0907
2025-12-01 15:28:37,743 - __main__ - INFO -    - R¬≤: 0.5310
2025-12-01 15:28:37,743 - __main__ - INFO - ================================================================================
2025-12-01 15:28:37,744 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 15:28:37,744 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 15:28:37,747 - __main__ - INFO - Train: (1132, 40), Test: (284, 40)
2025-12-01 15:28:38,492 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 15:28:38,538 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-60\test_predictions.csv
2025-12-01 15:28:38,538 - __main__ - INFO -    Shape: (284, 46)
2025-12-01 15:28:38,538 - __main__ - INFO -    Colonnes: stay_date, hotCode, 40 features + y_test + y_pred + error + abs_error
2025-12-01 15:28:38,539 - __main__ - INFO -    MAE moyen: 0.0907
2025-12-01 15:28:38,550 - __main__ - INFO - üìä Test MAE: 0.0907
2025-12-01 15:28:38,550 - __main__ - INFO - üìä Test R¬≤: 0.5310
2025-12-01 15:28:38,550 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 15:28:39,047 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-60\xgb_scatter_plot.png
2025-12-01 15:28:39,412 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-60\xgb_feature_importance.png
2025-12-01 15:28:39,444 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-60\models...
2025-12-01 15:28:39,473 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-60\models\xgb_to_predictor.joblib
2025-12-01 15:28:39,473 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-60\models\xgb_scaler.joblib
2025-12-01 15:28:39,473 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-60\models\feature_columns.txt
2025-12-01 15:28:39,473 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 15:28:39,473 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 15:28:39,473 - __main__ - INFO -    Container: ml-models
2025-12-01 15:28:40,089 - __main__ - INFO -    Container existant trouv√©
2025-12-01 15:28:40,089 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-60/
2025-12-01 15:28:40,499 - __main__ - INFO -    ‚úì predictTo/D09/J-60/models/xgb_to_predictor.joblib
2025-12-01 15:28:40,518 - __main__ - INFO -    ‚úì predictTo/D09/J-60/models/xgb_scaler.joblib
2025-12-01 15:28:40,536 - __main__ - INFO -    ‚úì predictTo/D09/J-60/models/feature_columns.txt
2025-12-01 15:28:40,560 - __main__ - INFO -    ‚úì predictTo/D09/J-60/xgb_scatter_plot.png
2025-12-01 15:28:40,581 - __main__ - INFO -    ‚úì predictTo/D09/J-60/xgb_feature_importance.png
2025-12-01 15:28:40,645 - __main__ - INFO -    ‚úì predictTo/D09/J-60/training_data_before_scaling.csv
2025-12-01 15:28:40,671 - __main__ - INFO -    ‚úì predictTo/D09/J-60/test_predictions.csv
2025-12-01 15:28:40,671 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 15:28:40,671 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-60/
2025-12-01 15:28:40,672 - __main__ - INFO - ================================================================================
2025-12-01 15:28:40,672 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 15:28:40,672 - __main__ - INFO - ================================================================================
2025-12-01 15:28:40,672 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 15:28:40,672 - __main__ - INFO -    Train MAE: 0.0150
2025-12-01 15:28:40,673 - __main__ - INFO -    Train R¬≤:  0.9877
2025-12-01 15:28:40,673 - __main__ - INFO -    Test MAE:  0.0907
2025-12-01 15:28:40,673 - __main__ - INFO -    Test R¬≤:   0.5310
2025-12-01 15:28:47,585 - __main__ - INFO - ================================================================================
2025-12-01 15:28:47,585 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 15:28:47,585 - __main__ - INFO - ================================================================================
2025-12-01 15:28:47,586 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 15:28:47,590 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 15:28:47,590 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 45
2025-12-01 15:28:47,590 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 15:28:47,590 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 15:28:47,590 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 45, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 15:28:47,590 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 15:28:47,607 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-12-01 15:28:47,836 - __main__ - INFO - Indicateurs charg√©s: (268538, 17)
2025-12-01 15:28:47,836 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 15:28:47,859 - __main__ - INFO -    Clusters filtr√©s: (1415, 65)
2025-12-01 15:28:47,859 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 15:28:47,859 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 15:28:47,955 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 15:28:47,985 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 15:28:48,013 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 15:28:48,028 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-12-01 15:28:48,028 - __main__ - INFO - Calcul des features PM sur donn√©es J-45 √† J-60 (pas de data leakage)
2025-12-01 15:28:48,029 - __main__ - INFO -    Colonnes PM utilis√©es: 16
2025-12-01 15:28:49,539 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-12-01 15:28:49,539 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-45 √† J-60
2025-12-01 15:28:49,539 - __main__ - INFO -    Colonnes Ant utilis√©es: 16
2025-12-01 15:28:50,554 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-12-01 15:28:50,555 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-45 √† J-60
2025-12-01 15:28:50,555 - __main__ - INFO -    Colonnes Ds utilis√©es: 16
2025-12-01 15:28:52,167 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-12-01 15:28:52,167 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 15:28:52,312 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 15:28:52,312 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 15:28:52,494 - __main__ - INFO -    Features concurrentes calcul√©es sur J-45 √† J-60
2025-12-01 15:28:52,502 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 15:28:55,795 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1415, 277)
2025-12-01 15:28:55,802 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 15:28:55,812 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-12-01 15:28:55,812 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 15:28:56,379 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 15:28:56,578 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 15:28:56,610 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 286)
2025-12-01 15:28:56,611 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-12-01 15:28:56,611 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-12-01 15:28:56,611 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-12-01 15:28:56,611 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-12-01 15:28:56,612 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-12-01 15:28:56,612 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-12-01 15:28:56,619 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 15:28:56,619 - __main__ - INFO - --------------------------------
2025-12-01 15:28:56,619 - __main__ - INFO - Horizon: 45
2025-12-01 15:28:56,619 - __main__ - INFO - --------------------------------
2025-12-01 15:28:56,620 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 15:28:56,622 - __main__ - INFO - nb_observations recalcul√© pour horizon=45
2025-12-01 15:28:56,623 - __main__ - INFO -    Minimum: 16
2025-12-01 15:28:56,623 - __main__ - INFO -    Maximum: 16
2025-12-01 15:28:56,623 - __main__ - INFO -    Moyenne: 16.0
2025-12-01 15:28:56,623 - __main__ - INFO - Nombre total de features: 55
2025-12-01 15:28:56,624 - __main__ - INFO -    - TO historiques: 15
2025-12-01 15:28:56,624 - __main__ - INFO -    - Features PM: 7
2025-12-01 15:28:56,624 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 15:28:56,624 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 15:28:56,624 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 15:28:56,624 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 15:28:56,624 - __main__ - INFO -    - Autres features: 11
2025-12-01 15:28:56,716 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-45\training_data_before_scaling.csv
2025-12-01 15:28:56,716 - __main__ - INFO -    Shape: (1416, 58)
2025-12-01 15:28:56,716 - __main__ - INFO -    Colonnes: stay_date, hotCode, 55 features, J-0
2025-12-01 15:28:56,716 - __main__ - INFO - X shape: (1416, 55), y shape: (1416,)
2025-12-01 15:28:56,717 - __main__ - INFO - ================================================================================
2025-12-01 15:28:56,717 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 15:28:56,717 - __main__ - INFO - ================================================================================
2025-12-01 15:28:56,722 - __main__ - INFO - Train: (1132, 55), Validation: (284, 55)
2025-12-01 15:28:56,722 - __main__ - INFO - Configuration de la recherche:
2025-12-01 15:28:56,722 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 15:28:56,722 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 15:28:56,723 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 15:28:56,723 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 15:28:56,723 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 15:30:19,246 - __main__ - INFO - ================================================================================
2025-12-01 15:30:19,247 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 15:30:19,247 - __main__ - INFO - ================================================================================
2025-12-01 15:30:19,247 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0942
2025-12-01 15:30:19,247 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 15:30:19,247 - __main__ - INFO -    - subsample: 0.95
2025-12-01 15:30:19,247 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 15:30:19,247 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 15:30:19,247 - __main__ - INFO -    - n_estimators: 500
2025-12-01 15:30:19,247 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 15:30:19,247 - __main__ - INFO -    - max_depth: 5
2025-12-01 15:30:19,247 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 15:30:19,248 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 15:30:19,253 - __main__ - INFO - 
Performances sur validation:
2025-12-01 15:30:19,253 - __main__ - INFO -    - MAE: 0.0872
2025-12-01 15:30:19,253 - __main__ - INFO -    - R¬≤: 0.5571
2025-12-01 15:30:19,253 - __main__ - INFO - ================================================================================
2025-12-01 15:30:19,254 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 15:30:19,254 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 15:30:19,257 - __main__ - INFO - Train: (1132, 55), Test: (284, 55)
2025-12-01 15:30:21,378 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 15:30:21,442 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-45\test_predictions.csv
2025-12-01 15:30:21,442 - __main__ - INFO -    Shape: (284, 61)
2025-12-01 15:30:21,442 - __main__ - INFO -    Colonnes: stay_date, hotCode, 55 features + y_test + y_pred + error + abs_error
2025-12-01 15:30:21,443 - __main__ - INFO -    MAE moyen: 0.0872
2025-12-01 15:30:21,450 - __main__ - INFO - üìä Test MAE: 0.0872
2025-12-01 15:30:21,451 - __main__ - INFO - üìä Test R¬≤: 0.5571
2025-12-01 15:30:21,451 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 15:30:22,298 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-45\xgb_scatter_plot.png
2025-12-01 15:30:22,729 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-45\xgb_feature_importance.png
2025-12-01 15:30:22,758 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-45\models...
2025-12-01 15:30:22,805 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-45\models\xgb_to_predictor.joblib
2025-12-01 15:30:22,805 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-45\models\xgb_scaler.joblib
2025-12-01 15:30:22,805 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-45\models\feature_columns.txt
2025-12-01 15:30:22,805 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 15:30:22,806 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 15:30:22,806 - __main__ - INFO -    Container: ml-models
2025-12-01 15:30:23,480 - __main__ - INFO -    Container existant trouv√©
2025-12-01 15:30:23,480 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-45/
2025-12-01 15:30:23,714 - __main__ - INFO -    ‚úì predictTo/D09/J-45/models/xgb_to_predictor.joblib
2025-12-01 15:30:23,729 - __main__ - INFO -    ‚úì predictTo/D09/J-45/models/xgb_scaler.joblib
2025-12-01 15:30:23,748 - __main__ - INFO -    ‚úì predictTo/D09/J-45/models/feature_columns.txt
2025-12-01 15:30:23,769 - __main__ - INFO -    ‚úì predictTo/D09/J-45/xgb_scatter_plot.png
2025-12-01 15:30:23,794 - __main__ - INFO -    ‚úì predictTo/D09/J-45/xgb_feature_importance.png
2025-12-01 15:30:23,972 - __main__ - INFO -    ‚úì predictTo/D09/J-45/training_data_before_scaling.csv
2025-12-01 15:30:24,024 - __main__ - INFO -    ‚úì predictTo/D09/J-45/test_predictions.csv
2025-12-01 15:30:24,025 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 15:30:24,025 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-45/
2025-12-01 15:30:24,027 - __main__ - INFO - ================================================================================
2025-12-01 15:30:24,027 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 15:30:24,028 - __main__ - INFO - ================================================================================
2025-12-01 15:30:24,028 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 15:30:24,028 - __main__ - INFO -    Train MAE: 0.0099
2025-12-01 15:30:24,028 - __main__ - INFO -    Train R¬≤:  0.9938
2025-12-01 15:30:24,028 - __main__ - INFO -    Test MAE:  0.0872
2025-12-01 15:30:24,028 - __main__ - INFO -    Test R¬≤:   0.5571
2025-12-01 15:30:30,316 - __main__ - INFO - ================================================================================
2025-12-01 15:30:30,316 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 15:30:30,316 - __main__ - INFO - ================================================================================
2025-12-01 15:30:30,316 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 15:30:30,320 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 15:30:30,321 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 30
2025-12-01 15:30:30,321 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 15:30:30,321 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 15:30:30,321 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 30, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 15:30:30,321 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 15:30:30,336 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-12-01 15:30:30,564 - __main__ - INFO - Indicateurs charg√©s: (268538, 17)
2025-12-01 15:30:30,564 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 15:30:30,585 - __main__ - INFO -    Clusters filtr√©s: (1415, 65)
2025-12-01 15:30:30,586 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 15:30:30,586 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 15:30:30,672 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 15:30:30,700 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 15:30:30,732 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 15:30:30,751 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-12-01 15:30:30,751 - __main__ - INFO - Calcul des features PM sur donn√©es J-30 √† J-60 (pas de data leakage)
2025-12-01 15:30:30,751 - __main__ - INFO -    Colonnes PM utilis√©es: 31
2025-12-01 15:30:32,515 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-12-01 15:30:32,515 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-30 √† J-60
2025-12-01 15:30:32,515 - __main__ - INFO -    Colonnes Ant utilis√©es: 31
2025-12-01 15:30:33,497 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-12-01 15:30:33,498 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-30 √† J-60
2025-12-01 15:30:33,498 - __main__ - INFO -    Colonnes Ds utilis√©es: 31
2025-12-01 15:30:34,622 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-12-01 15:30:34,622 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 15:30:34,743 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 15:30:34,743 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 15:30:34,903 - __main__ - INFO -    Features concurrentes calcul√©es sur J-30 √† J-60
2025-12-01 15:30:34,914 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 15:30:37,557 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1415, 277)
2025-12-01 15:30:37,563 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 15:30:37,571 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-12-01 15:30:37,571 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 15:30:38,011 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 15:30:38,131 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 15:30:38,151 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 286)
2025-12-01 15:30:38,151 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-12-01 15:30:38,151 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-12-01 15:30:38,151 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-12-01 15:30:38,151 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-12-01 15:30:38,151 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-12-01 15:30:38,152 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-12-01 15:30:38,158 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 15:30:38,158 - __main__ - INFO - --------------------------------
2025-12-01 15:30:38,158 - __main__ - INFO - Horizon: 30
2025-12-01 15:30:38,158 - __main__ - INFO - --------------------------------
2025-12-01 15:30:38,159 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 15:30:38,160 - __main__ - INFO - nb_observations recalcul√© pour horizon=30
2025-12-01 15:30:38,160 - __main__ - INFO -    Minimum: 31
2025-12-01 15:30:38,161 - __main__ - INFO -    Maximum: 31
2025-12-01 15:30:38,161 - __main__ - INFO -    Moyenne: 31.0
2025-12-01 15:30:38,161 - __main__ - INFO - Nombre total de features: 70
2025-12-01 15:30:38,161 - __main__ - INFO -    - TO historiques: 30
2025-12-01 15:30:38,161 - __main__ - INFO -    - Features PM: 7
2025-12-01 15:30:38,161 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 15:30:38,161 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 15:30:38,161 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 15:30:38,161 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 15:30:38,161 - __main__ - INFO -    - Autres features: 11
2025-12-01 15:30:38,259 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-30\training_data_before_scaling.csv
2025-12-01 15:30:38,259 - __main__ - INFO -    Shape: (1416, 73)
2025-12-01 15:30:38,259 - __main__ - INFO -    Colonnes: stay_date, hotCode, 70 features, J-0
2025-12-01 15:30:38,259 - __main__ - INFO - X shape: (1416, 70), y shape: (1416,)
2025-12-01 15:30:38,259 - __main__ - INFO - ================================================================================
2025-12-01 15:30:38,259 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 15:30:38,259 - __main__ - INFO - ================================================================================
2025-12-01 15:30:38,263 - __main__ - INFO - Train: (1132, 70), Validation: (284, 70)
2025-12-01 15:30:38,263 - __main__ - INFO - Configuration de la recherche:
2025-12-01 15:30:38,263 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 15:30:38,263 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 15:30:38,263 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 15:30:38,263 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 15:30:38,263 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 15:32:20,366 - __main__ - INFO - ================================================================================
2025-12-01 15:32:20,366 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 15:32:20,366 - __main__ - INFO - ================================================================================
2025-12-01 15:32:20,366 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0906
2025-12-01 15:32:20,367 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 15:32:20,367 - __main__ - INFO -    - subsample: 0.9
2025-12-01 15:32:20,367 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 15:32:20,367 - __main__ - INFO -    - reg_alpha: 0.5
2025-12-01 15:32:20,367 - __main__ - INFO -    - n_estimators: 500
2025-12-01 15:32:20,367 - __main__ - INFO -    - min_child_weight: 2
2025-12-01 15:32:20,367 - __main__ - INFO -    - max_depth: 6
2025-12-01 15:32:20,367 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 15:32:20,367 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 15:32:20,375 - __main__ - INFO - 
Performances sur validation:
2025-12-01 15:32:20,375 - __main__ - INFO -    - MAE: 0.0830
2025-12-01 15:32:20,376 - __main__ - INFO -    - R¬≤: 0.6057
2025-12-01 15:32:20,376 - __main__ - INFO - ================================================================================
2025-12-01 15:32:20,376 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 15:32:20,376 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 15:32:20,379 - __main__ - INFO - Train: (1132, 70), Test: (284, 70)
2025-12-01 15:32:22,693 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 15:32:22,774 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-30\test_predictions.csv
2025-12-01 15:32:22,774 - __main__ - INFO -    Shape: (284, 76)
2025-12-01 15:32:22,774 - __main__ - INFO -    Colonnes: stay_date, hotCode, 70 features + y_test + y_pred + error + abs_error
2025-12-01 15:32:22,774 - __main__ - INFO -    MAE moyen: 0.0830
2025-12-01 15:32:22,781 - __main__ - INFO - üìä Test MAE: 0.0830
2025-12-01 15:32:22,781 - __main__ - INFO - üìä Test R¬≤: 0.6057
2025-12-01 15:32:22,782 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 15:32:23,408 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-30\xgb_scatter_plot.png
2025-12-01 15:32:23,902 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-30\xgb_feature_importance.png
2025-12-01 15:32:23,917 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-30\models...
2025-12-01 15:32:23,952 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-30\models\xgb_to_predictor.joblib
2025-12-01 15:32:23,952 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-30\models\xgb_scaler.joblib
2025-12-01 15:32:23,952 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-30\models\feature_columns.txt
2025-12-01 15:32:23,953 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 15:32:23,953 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 15:32:23,953 - __main__ - INFO -    Container: ml-models
2025-12-01 15:32:24,651 - __main__ - INFO -    Container existant trouv√©
2025-12-01 15:32:24,651 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-30/
2025-12-01 15:32:24,944 - __main__ - INFO -    ‚úì predictTo/D09/J-30/models/xgb_to_predictor.joblib
2025-12-01 15:32:24,962 - __main__ - INFO -    ‚úì predictTo/D09/J-30/models/xgb_scaler.joblib
2025-12-01 15:32:24,980 - __main__ - INFO -    ‚úì predictTo/D09/J-30/models/feature_columns.txt
2025-12-01 15:32:25,004 - __main__ - INFO -    ‚úì predictTo/D09/J-30/xgb_scatter_plot.png
2025-12-01 15:32:25,023 - __main__ - INFO -    ‚úì predictTo/D09/J-30/xgb_feature_importance.png
2025-12-01 15:32:25,289 - __main__ - INFO -    ‚úì predictTo/D09/J-30/training_data_before_scaling.csv
2025-12-01 15:32:25,369 - __main__ - INFO -    ‚úì predictTo/D09/J-30/test_predictions.csv
2025-12-01 15:32:25,369 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 15:32:25,370 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-30/
2025-12-01 15:32:25,371 - __main__ - INFO - ================================================================================
2025-12-01 15:32:25,371 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 15:32:25,371 - __main__ - INFO - ================================================================================
2025-12-01 15:32:25,371 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 15:32:25,371 - __main__ - INFO -    Train MAE: 0.0175
2025-12-01 15:32:25,371 - __main__ - INFO -    Train R¬≤:  0.9827
2025-12-01 15:32:25,371 - __main__ - INFO -    Test MAE:  0.0830
2025-12-01 15:32:25,372 - __main__ - INFO -    Test R¬≤:   0.6057
2025-12-01 15:32:29,996 - __main__ - INFO - ================================================================================
2025-12-01 15:32:29,996 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 15:32:29,996 - __main__ - INFO - ================================================================================
2025-12-01 15:32:29,997 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 15:32:29,999 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 15:32:29,999 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 21
2025-12-01 15:32:29,999 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 15:32:29,999 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 15:32:29,999 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 21, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 15:32:29,999 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 15:32:30,014 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-12-01 15:32:30,256 - __main__ - INFO - Indicateurs charg√©s: (268538, 17)
2025-12-01 15:32:30,256 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 15:32:30,285 - __main__ - INFO -    Clusters filtr√©s: (1415, 65)
2025-12-01 15:32:30,285 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 15:32:30,286 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 15:32:30,382 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 15:32:30,416 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 15:32:30,448 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 15:32:30,465 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-12-01 15:32:30,465 - __main__ - INFO - Calcul des features PM sur donn√©es J-21 √† J-60 (pas de data leakage)
2025-12-01 15:32:30,466 - __main__ - INFO -    Colonnes PM utilis√©es: 40
2025-12-01 15:32:32,054 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-12-01 15:32:32,054 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-21 √† J-60
2025-12-01 15:32:32,055 - __main__ - INFO -    Colonnes Ant utilis√©es: 40
2025-12-01 15:32:33,128 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-12-01 15:32:33,129 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-21 √† J-60
2025-12-01 15:32:33,129 - __main__ - INFO -    Colonnes Ds utilis√©es: 40
2025-12-01 15:32:34,180 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-12-01 15:32:34,180 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 15:32:34,300 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 15:32:34,300 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 15:32:34,484 - __main__ - INFO -    Features concurrentes calcul√©es sur J-21 √† J-60
2025-12-01 15:32:34,497 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 15:32:36,588 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1415, 277)
2025-12-01 15:32:36,593 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 15:32:36,600 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-12-01 15:32:36,601 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 15:32:36,796 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 15:32:36,915 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 15:32:36,932 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 286)
2025-12-01 15:32:36,933 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-12-01 15:32:36,933 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-12-01 15:32:36,933 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-12-01 15:32:36,933 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-12-01 15:32:36,933 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-12-01 15:32:36,933 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-12-01 15:32:36,942 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 15:32:36,942 - __main__ - INFO - --------------------------------
2025-12-01 15:32:36,942 - __main__ - INFO - Horizon: 21
2025-12-01 15:32:36,942 - __main__ - INFO - --------------------------------
2025-12-01 15:32:36,942 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 15:32:36,943 - __main__ - INFO - nb_observations recalcul√© pour horizon=21
2025-12-01 15:32:36,943 - __main__ - INFO -    Minimum: 40
2025-12-01 15:32:36,943 - __main__ - INFO -    Maximum: 40
2025-12-01 15:32:36,944 - __main__ - INFO -    Moyenne: 40.0
2025-12-01 15:32:36,944 - __main__ - INFO - Nombre total de features: 79
2025-12-01 15:32:36,944 - __main__ - INFO -    - TO historiques: 39
2025-12-01 15:32:36,944 - __main__ - INFO -    - Features PM: 7
2025-12-01 15:32:36,944 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 15:32:36,944 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 15:32:36,944 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 15:32:36,944 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 15:32:36,944 - __main__ - INFO -    - Autres features: 11
2025-12-01 15:32:37,063 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-21\training_data_before_scaling.csv
2025-12-01 15:32:37,063 - __main__ - INFO -    Shape: (1416, 82)
2025-12-01 15:32:37,063 - __main__ - INFO -    Colonnes: stay_date, hotCode, 79 features, J-0
2025-12-01 15:32:37,064 - __main__ - INFO - X shape: (1416, 79), y shape: (1416,)
2025-12-01 15:32:37,064 - __main__ - INFO - ================================================================================
2025-12-01 15:32:37,064 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 15:32:37,064 - __main__ - INFO - ================================================================================
2025-12-01 15:32:37,072 - __main__ - INFO - Train: (1132, 79), Validation: (284, 79)
2025-12-01 15:32:37,072 - __main__ - INFO - Configuration de la recherche:
2025-12-01 15:32:37,072 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 15:32:37,072 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 15:32:37,072 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 15:32:37,072 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 15:32:37,072 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 15:34:50,601 - __main__ - INFO - ================================================================================
2025-12-01 15:34:50,601 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 15:34:50,601 - __main__ - INFO - ================================================================================
2025-12-01 15:34:50,601 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0761
2025-12-01 15:34:50,601 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 15:34:50,601 - __main__ - INFO -    - subsample: 0.95
2025-12-01 15:34:50,602 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 15:34:50,602 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 15:34:50,602 - __main__ - INFO -    - n_estimators: 500
2025-12-01 15:34:50,602 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 15:34:50,602 - __main__ - INFO -    - max_depth: 5
2025-12-01 15:34:50,602 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 15:34:50,602 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 15:34:50,607 - __main__ - INFO - 
Performances sur validation:
2025-12-01 15:34:50,607 - __main__ - INFO -    - MAE: 0.0755
2025-12-01 15:34:50,607 - __main__ - INFO -    - R¬≤: 0.6831
2025-12-01 15:34:50,607 - __main__ - INFO - ================================================================================
2025-12-01 15:34:50,608 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 15:34:50,608 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 15:34:50,610 - __main__ - INFO - Train: (1132, 79), Test: (284, 79)
2025-12-01 15:34:54,605 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 15:34:54,705 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-21\test_predictions.csv
2025-12-01 15:34:54,706 - __main__ - INFO -    Shape: (284, 85)
2025-12-01 15:34:54,706 - __main__ - INFO -    Colonnes: stay_date, hotCode, 79 features + y_test + y_pred + error + abs_error
2025-12-01 15:34:54,706 - __main__ - INFO -    MAE moyen: 0.0755
2025-12-01 15:34:54,713 - __main__ - INFO - üìä Test MAE: 0.0755
2025-12-01 15:34:54,713 - __main__ - INFO - üìä Test R¬≤: 0.6831
2025-12-01 15:34:54,714 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 15:34:55,159 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-21\xgb_scatter_plot.png
2025-12-01 15:34:55,573 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-21\xgb_feature_importance.png
2025-12-01 15:34:55,594 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-21\models...
2025-12-01 15:34:55,624 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-21\models\xgb_to_predictor.joblib
2025-12-01 15:34:55,624 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-21\models\xgb_scaler.joblib
2025-12-01 15:34:55,624 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-21\models\feature_columns.txt
2025-12-01 15:34:55,624 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 15:34:55,625 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 15:34:55,625 - __main__ - INFO -    Container: ml-models
2025-12-01 15:34:56,483 - __main__ - INFO -    Container existant trouv√©
2025-12-01 15:34:56,483 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-21/
2025-12-01 15:34:56,762 - __main__ - INFO -    ‚úì predictTo/D09/J-21/models/xgb_to_predictor.joblib
2025-12-01 15:34:56,777 - __main__ - INFO -    ‚úì predictTo/D09/J-21/models/xgb_scaler.joblib
2025-12-01 15:34:56,793 - __main__ - INFO -    ‚úì predictTo/D09/J-21/models/feature_columns.txt
2025-12-01 15:34:56,812 - __main__ - INFO -    ‚úì predictTo/D09/J-21/xgb_scatter_plot.png
2025-12-01 15:34:56,831 - __main__ - INFO -    ‚úì predictTo/D09/J-21/xgb_feature_importance.png
2025-12-01 15:34:57,173 - __main__ - INFO -    ‚úì predictTo/D09/J-21/training_data_before_scaling.csv
2025-12-01 15:34:57,239 - __main__ - INFO -    ‚úì predictTo/D09/J-21/test_predictions.csv
2025-12-01 15:34:57,240 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 15:34:57,240 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-21/
2025-12-01 15:34:57,241 - __main__ - INFO - ================================================================================
2025-12-01 15:34:57,242 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 15:34:57,242 - __main__ - INFO - ================================================================================
2025-12-01 15:34:57,242 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 15:34:57,242 - __main__ - INFO -    Train MAE: 0.0066
2025-12-01 15:34:57,242 - __main__ - INFO -    Train R¬≤:  0.9974
2025-12-01 15:34:57,242 - __main__ - INFO -    Test MAE:  0.0755
2025-12-01 15:34:57,242 - __main__ - INFO -    Test R¬≤:   0.6831
2025-12-01 15:35:08,109 - __main__ - INFO - ================================================================================
2025-12-01 15:35:08,109 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 15:35:08,109 - __main__ - INFO - ================================================================================
2025-12-01 15:35:08,109 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 15:35:08,118 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 15:35:08,119 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 15
2025-12-01 15:35:08,119 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 15:35:08,119 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 15:35:08,119 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 15, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 15:35:08,120 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 15:35:08,152 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-12-01 15:35:08,575 - __main__ - INFO - Indicateurs charg√©s: (268538, 17)
2025-12-01 15:35:08,575 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 15:35:08,622 - __main__ - INFO -    Clusters filtr√©s: (1415, 65)
2025-12-01 15:35:08,623 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 15:35:08,623 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 15:35:08,815 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 15:35:08,878 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 15:35:08,944 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 15:35:08,976 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-12-01 15:35:08,977 - __main__ - INFO - Calcul des features PM sur donn√©es J-15 √† J-60 (pas de data leakage)
2025-12-01 15:35:08,977 - __main__ - INFO -    Colonnes PM utilis√©es: 46
2025-12-01 15:35:11,356 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-12-01 15:35:11,356 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-15 √† J-60
2025-12-01 15:35:11,356 - __main__ - INFO -    Colonnes Ant utilis√©es: 46
2025-12-01 15:35:12,858 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-12-01 15:35:12,859 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-15 √† J-60
2025-12-01 15:35:12,859 - __main__ - INFO -    Colonnes Ds utilis√©es: 46
2025-12-01 15:35:14,628 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-12-01 15:35:14,628 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 15:35:14,841 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 15:35:14,842 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 15:35:15,108 - __main__ - INFO -    Features concurrentes calcul√©es sur J-15 √† J-60
2025-12-01 15:35:15,129 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 15:35:18,861 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1415, 277)
2025-12-01 15:35:18,872 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 15:35:18,883 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-12-01 15:35:18,883 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 15:35:19,531 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 15:35:19,712 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 15:35:19,749 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 286)
2025-12-01 15:35:19,749 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-12-01 15:35:19,750 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-12-01 15:35:19,750 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-12-01 15:35:19,751 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-12-01 15:35:19,751 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-12-01 15:35:19,752 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-12-01 15:35:19,762 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 15:35:19,762 - __main__ - INFO - --------------------------------
2025-12-01 15:35:19,762 - __main__ - INFO - Horizon: 15
2025-12-01 15:35:19,762 - __main__ - INFO - --------------------------------
2025-12-01 15:35:19,763 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 15:35:19,765 - __main__ - INFO - nb_observations recalcul√© pour horizon=15
2025-12-01 15:35:19,765 - __main__ - INFO -    Minimum: 46
2025-12-01 15:35:19,765 - __main__ - INFO -    Maximum: 46
2025-12-01 15:35:19,765 - __main__ - INFO -    Moyenne: 46.0
2025-12-01 15:35:19,766 - __main__ - INFO - Nombre total de features: 85
2025-12-01 15:35:19,766 - __main__ - INFO -    - TO historiques: 45
2025-12-01 15:35:19,766 - __main__ - INFO -    - Features PM: 7
2025-12-01 15:35:19,766 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 15:35:19,766 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 15:35:19,766 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 15:35:19,766 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 15:35:19,766 - __main__ - INFO -    - Autres features: 11
2025-12-01 15:35:19,961 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-15\training_data_before_scaling.csv
2025-12-01 15:35:19,962 - __main__ - INFO -    Shape: (1416, 88)
2025-12-01 15:35:19,962 - __main__ - INFO -    Colonnes: stay_date, hotCode, 85 features, J-0
2025-12-01 15:35:19,962 - __main__ - INFO - X shape: (1416, 85), y shape: (1416,)
2025-12-01 15:35:19,962 - __main__ - INFO - ================================================================================
2025-12-01 15:35:19,962 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 15:35:19,962 - __main__ - INFO - ================================================================================
2025-12-01 15:35:19,973 - __main__ - INFO - Train: (1132, 85), Validation: (284, 85)
2025-12-01 15:35:19,973 - __main__ - INFO - Configuration de la recherche:
2025-12-01 15:35:19,973 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 15:35:19,973 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 15:35:19,973 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 15:35:19,973 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 15:35:19,973 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 15:37:40,321 - __main__ - INFO - ================================================================================
2025-12-01 15:37:40,321 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 15:37:40,321 - __main__ - INFO - ================================================================================
2025-12-01 15:37:40,321 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0680
2025-12-01 15:37:40,321 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 15:37:40,321 - __main__ - INFO -    - subsample: 0.95
2025-12-01 15:37:40,321 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 15:37:40,321 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 15:37:40,322 - __main__ - INFO -    - n_estimators: 500
2025-12-01 15:37:40,322 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 15:37:40,322 - __main__ - INFO -    - max_depth: 5
2025-12-01 15:37:40,322 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 15:37:40,322 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 15:37:40,328 - __main__ - INFO - 
Performances sur validation:
2025-12-01 15:37:40,329 - __main__ - INFO -    - MAE: 0.0677
2025-12-01 15:37:40,329 - __main__ - INFO -    - R¬≤: 0.7399
2025-12-01 15:37:40,329 - __main__ - INFO - ================================================================================
2025-12-01 15:37:40,329 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 15:37:40,330 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 15:37:40,332 - __main__ - INFO - Train: (1132, 85), Test: (284, 85)
2025-12-01 15:37:44,174 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 15:37:44,314 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-15\test_predictions.csv
2025-12-01 15:37:44,315 - __main__ - INFO -    Shape: (284, 91)
2025-12-01 15:37:44,315 - __main__ - INFO -    Colonnes: stay_date, hotCode, 85 features + y_test + y_pred + error + abs_error
2025-12-01 15:37:44,315 - __main__ - INFO -    MAE moyen: 0.0677
2025-12-01 15:37:44,324 - __main__ - INFO - üìä Test MAE: 0.0677
2025-12-01 15:37:44,325 - __main__ - INFO - üìä Test R¬≤: 0.7399
2025-12-01 15:37:44,325 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 15:37:45,100 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-15\xgb_scatter_plot.png
2025-12-01 15:37:45,724 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-15\xgb_feature_importance.png
2025-12-01 15:37:45,745 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-15\models...
2025-12-01 15:37:45,780 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-15\models\xgb_to_predictor.joblib
2025-12-01 15:37:45,781 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-15\models\xgb_scaler.joblib
2025-12-01 15:37:45,781 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-15\models\feature_columns.txt
2025-12-01 15:37:45,781 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 15:37:45,781 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 15:37:45,781 - __main__ - INFO -    Container: ml-models
2025-12-01 15:37:46,688 - __main__ - INFO -    Container existant trouv√©
2025-12-01 15:37:46,689 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-15/
2025-12-01 15:37:46,882 - __main__ - INFO -    ‚úì predictTo/D09/J-15/models/xgb_to_predictor.joblib
2025-12-01 15:37:46,907 - __main__ - INFO -    ‚úì predictTo/D09/J-15/models/xgb_scaler.joblib
2025-12-01 15:37:46,928 - __main__ - INFO -    ‚úì predictTo/D09/J-15/models/feature_columns.txt
2025-12-01 15:37:46,953 - __main__ - INFO -    ‚úì predictTo/D09/J-15/xgb_scatter_plot.png
2025-12-01 15:37:46,974 - __main__ - INFO -    ‚úì predictTo/D09/J-15/xgb_feature_importance.png
2025-12-01 15:37:47,263 - __main__ - INFO -    ‚úì predictTo/D09/J-15/training_data_before_scaling.csv
2025-12-01 15:37:47,338 - __main__ - INFO -    ‚úì predictTo/D09/J-15/test_predictions.csv
2025-12-01 15:37:47,338 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 15:37:47,338 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-15/
2025-12-01 15:37:47,341 - __main__ - INFO - ================================================================================
2025-12-01 15:37:47,341 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 15:37:47,341 - __main__ - INFO - ================================================================================
2025-12-01 15:37:47,341 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 15:37:47,341 - __main__ - INFO -    Train MAE: 0.0057
2025-12-01 15:37:47,341 - __main__ - INFO -    Train R¬≤:  0.9980
2025-12-01 15:37:47,342 - __main__ - INFO -    Test MAE:  0.0677
2025-12-01 15:37:47,342 - __main__ - INFO -    Test R¬≤:   0.7399
2025-12-01 15:37:55,882 - __main__ - INFO - ================================================================================
2025-12-01 15:37:55,883 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 15:37:55,883 - __main__ - INFO - ================================================================================
2025-12-01 15:37:55,883 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 15:37:55,888 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 15:37:55,889 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 10
2025-12-01 15:37:55,889 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 15:37:55,889 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 15:37:55,889 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 10, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 15:37:55,889 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 15:37:55,912 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-12-01 15:37:56,215 - __main__ - INFO - Indicateurs charg√©s: (268538, 17)
2025-12-01 15:37:56,215 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 15:37:56,252 - __main__ - INFO -    Clusters filtr√©s: (1415, 65)
2025-12-01 15:37:56,252 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 15:37:56,252 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 15:37:56,388 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 15:37:56,427 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 15:37:56,463 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 15:37:56,480 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-12-01 15:37:56,480 - __main__ - INFO - Calcul des features PM sur donn√©es J-10 √† J-60 (pas de data leakage)
2025-12-01 15:37:56,480 - __main__ - INFO -    Colonnes PM utilis√©es: 51
2025-12-01 15:37:58,828 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-12-01 15:37:58,828 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-10 √† J-60
2025-12-01 15:37:58,828 - __main__ - INFO -    Colonnes Ant utilis√©es: 51
2025-12-01 15:38:00,387 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-12-01 15:38:00,388 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-10 √† J-60
2025-12-01 15:38:00,388 - __main__ - INFO -    Colonnes Ds utilis√©es: 51
2025-12-01 15:38:02,031 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-12-01 15:38:02,031 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 15:38:02,213 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 15:38:02,213 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 15:38:02,490 - __main__ - INFO -    Features concurrentes calcul√©es sur J-10 √† J-60
2025-12-01 15:38:02,512 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 15:38:06,641 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1415, 277)
2025-12-01 15:38:06,649 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 15:38:06,659 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-12-01 15:38:06,660 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 15:38:07,402 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 15:38:07,581 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 15:38:07,611 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 286)
2025-12-01 15:38:07,612 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-12-01 15:38:07,612 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-12-01 15:38:07,612 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-12-01 15:38:07,612 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-12-01 15:38:07,612 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-12-01 15:38:07,613 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-12-01 15:38:07,622 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 15:38:07,622 - __main__ - INFO - --------------------------------
2025-12-01 15:38:07,622 - __main__ - INFO - Horizon: 10
2025-12-01 15:38:07,622 - __main__ - INFO - --------------------------------
2025-12-01 15:38:07,623 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 15:38:07,625 - __main__ - INFO - nb_observations recalcul√© pour horizon=10
2025-12-01 15:38:07,625 - __main__ - INFO -    Minimum: 51
2025-12-01 15:38:07,625 - __main__ - INFO -    Maximum: 51
2025-12-01 15:38:07,625 - __main__ - INFO -    Moyenne: 51.0
2025-12-01 15:38:07,625 - __main__ - INFO - Nombre total de features: 90
2025-12-01 15:38:07,625 - __main__ - INFO -    - TO historiques: 50
2025-12-01 15:38:07,626 - __main__ - INFO -    - Features PM: 7
2025-12-01 15:38:07,626 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 15:38:07,626 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 15:38:07,626 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 15:38:07,626 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 15:38:07,626 - __main__ - INFO -    - Autres features: 11
2025-12-01 15:38:07,798 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-10\training_data_before_scaling.csv
2025-12-01 15:38:07,798 - __main__ - INFO -    Shape: (1416, 93)
2025-12-01 15:38:07,798 - __main__ - INFO -    Colonnes: stay_date, hotCode, 90 features, J-0
2025-12-01 15:38:07,798 - __main__ - INFO - X shape: (1416, 90), y shape: (1416,)
2025-12-01 15:38:07,799 - __main__ - INFO - ================================================================================
2025-12-01 15:38:07,799 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 15:38:07,799 - __main__ - INFO - ================================================================================
2025-12-01 15:38:07,807 - __main__ - INFO - Train: (1132, 90), Validation: (284, 90)
2025-12-01 15:38:07,807 - __main__ - INFO - Configuration de la recherche:
2025-12-01 15:38:07,807 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 15:38:07,807 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 15:38:07,807 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 15:38:07,808 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 15:38:07,808 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 15:40:32,043 - __main__ - INFO - ================================================================================
2025-12-01 15:40:32,043 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 15:40:32,043 - __main__ - INFO - ================================================================================
2025-12-01 15:40:32,043 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0625
2025-12-01 15:40:32,043 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 15:40:32,044 - __main__ - INFO -    - subsample: 0.9
2025-12-01 15:40:32,044 - __main__ - INFO -    - reg_lambda: 1.5
2025-12-01 15:40:32,044 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 15:40:32,044 - __main__ - INFO -    - n_estimators: 800
2025-12-01 15:40:32,044 - __main__ - INFO -    - min_child_weight: 2
2025-12-01 15:40:32,044 - __main__ - INFO -    - max_depth: 8
2025-12-01 15:40:32,044 - __main__ - INFO -    - learning_rate: 0.03
2025-12-01 15:40:32,044 - __main__ - INFO -    - colsample_bytree: 0.85
2025-12-01 15:40:32,051 - __main__ - INFO - 
Performances sur validation:
2025-12-01 15:40:32,051 - __main__ - INFO -    - MAE: 0.0596
2025-12-01 15:40:32,051 - __main__ - INFO -    - R¬≤: 0.7901
2025-12-01 15:40:32,052 - __main__ - INFO - ================================================================================
2025-12-01 15:40:32,053 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 15:40:32,053 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 15:40:32,057 - __main__ - INFO - Train: (1132, 90), Test: (284, 90)
2025-12-01 15:40:42,210 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 15:40:42,318 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-10\test_predictions.csv
2025-12-01 15:40:42,318 - __main__ - INFO -    Shape: (284, 96)
2025-12-01 15:40:42,318 - __main__ - INFO -    Colonnes: stay_date, hotCode, 90 features + y_test + y_pred + error + abs_error
2025-12-01 15:40:42,319 - __main__ - INFO -    MAE moyen: 0.0596
2025-12-01 15:40:42,327 - __main__ - INFO - üìä Test MAE: 0.0596
2025-12-01 15:40:42,328 - __main__ - INFO - üìä Test R¬≤: 0.7901
2025-12-01 15:40:42,328 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 15:40:42,987 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-10\xgb_scatter_plot.png
2025-12-01 15:40:43,552 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-10\xgb_feature_importance.png
2025-12-01 15:40:43,571 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-10\models...
2025-12-01 15:40:43,619 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-10\models\xgb_to_predictor.joblib
2025-12-01 15:40:43,619 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-10\models\xgb_scaler.joblib
2025-12-01 15:40:43,619 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-10\models\feature_columns.txt
2025-12-01 15:40:43,619 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 15:40:43,620 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 15:40:43,620 - __main__ - INFO -    Container: ml-models
2025-12-01 15:40:44,436 - __main__ - INFO -    Container existant trouv√©
2025-12-01 15:40:44,436 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-10/
2025-12-01 15:40:45,065 - __main__ - INFO -    ‚úì predictTo/D09/J-10/models/xgb_to_predictor.joblib
2025-12-01 15:40:45,088 - __main__ - INFO -    ‚úì predictTo/D09/J-10/models/xgb_scaler.joblib
2025-12-01 15:40:45,107 - __main__ - INFO -    ‚úì predictTo/D09/J-10/models/feature_columns.txt
2025-12-01 15:40:45,132 - __main__ - INFO -    ‚úì predictTo/D09/J-10/xgb_scatter_plot.png
2025-12-01 15:40:45,157 - __main__ - INFO -    ‚úì predictTo/D09/J-10/xgb_feature_importance.png
2025-12-01 15:40:45,465 - __main__ - INFO -    ‚úì predictTo/D09/J-10/training_data_before_scaling.csv
2025-12-01 15:40:45,548 - __main__ - INFO -    ‚úì predictTo/D09/J-10/test_predictions.csv
2025-12-01 15:40:45,548 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 15:40:45,548 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-10/
2025-12-01 15:40:45,550 - __main__ - INFO - ================================================================================
2025-12-01 15:40:45,550 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 15:40:45,550 - __main__ - INFO - ================================================================================
2025-12-01 15:40:45,550 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 15:40:45,550 - __main__ - INFO -    Train MAE: 0.0004
2025-12-01 15:40:45,550 - __main__ - INFO -    Train R¬≤:  1.0000
2025-12-01 15:40:45,550 - __main__ - INFO -    Test MAE:  0.0596
2025-12-01 15:40:45,550 - __main__ - INFO -    Test R¬≤:   0.7901
2025-12-01 15:40:53,574 - __main__ - INFO - ================================================================================
2025-12-01 15:40:53,574 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 15:40:53,575 - __main__ - INFO - ================================================================================
2025-12-01 15:40:53,575 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 15:40:53,589 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 15:40:53,590 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 7
2025-12-01 15:40:53,590 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 15:40:53,590 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 15:40:53,590 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 15:40:53,590 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 15:40:53,642 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-12-01 15:40:54,245 - __main__ - INFO - Indicateurs charg√©s: (268538, 17)
2025-12-01 15:40:54,246 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 15:40:54,288 - __main__ - INFO -    Clusters filtr√©s: (1415, 65)
2025-12-01 15:40:54,288 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 15:40:54,289 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 15:40:54,448 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 15:40:54,492 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 15:40:54,532 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 15:40:54,551 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-12-01 15:40:54,551 - __main__ - INFO - Calcul des features PM sur donn√©es J-7 √† J-60 (pas de data leakage)
2025-12-01 15:40:54,551 - __main__ - INFO -    Colonnes PM utilis√©es: 54
2025-12-01 15:40:57,489 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-12-01 15:40:57,489 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-7 √† J-60
2025-12-01 15:40:57,489 - __main__ - INFO -    Colonnes Ant utilis√©es: 54
2025-12-01 15:40:59,445 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-12-01 15:40:59,445 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-7 √† J-60
2025-12-01 15:40:59,445 - __main__ - INFO -    Colonnes Ds utilis√©es: 54
2025-12-01 15:41:01,462 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-12-01 15:41:01,463 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 15:41:01,666 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 15:41:01,667 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 15:41:01,984 - __main__ - INFO -    Features concurrentes calcul√©es sur J-7 √† J-60
2025-12-01 15:41:02,025 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 15:41:06,790 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1415, 277)
2025-12-01 15:41:06,798 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 15:41:06,811 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-12-01 15:41:06,812 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 15:41:07,582 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 15:41:07,774 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 15:41:07,805 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 286)
2025-12-01 15:41:07,806 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-12-01 15:41:07,806 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-12-01 15:41:07,806 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-12-01 15:41:07,807 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-12-01 15:41:07,807 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-12-01 15:41:07,807 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-12-01 15:41:07,816 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 15:41:07,816 - __main__ - INFO - --------------------------------
2025-12-01 15:41:07,816 - __main__ - INFO - Horizon: 7
2025-12-01 15:41:07,816 - __main__ - INFO - --------------------------------
2025-12-01 15:41:07,817 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 15:41:07,820 - __main__ - INFO - nb_observations recalcul√© pour horizon=7
2025-12-01 15:41:07,820 - __main__ - INFO -    Minimum: 54
2025-12-01 15:41:07,820 - __main__ - INFO -    Maximum: 54
2025-12-01 15:41:07,821 - __main__ - INFO -    Moyenne: 54.0
2025-12-01 15:41:07,821 - __main__ - INFO - Nombre total de features: 93
2025-12-01 15:41:07,821 - __main__ - INFO -    - TO historiques: 53
2025-12-01 15:41:07,821 - __main__ - INFO -    - Features PM: 7
2025-12-01 15:41:07,821 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 15:41:07,821 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 15:41:07,821 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 15:41:07,821 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 15:41:07,821 - __main__ - INFO -    - Autres features: 11
2025-12-01 15:41:08,037 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-7\training_data_before_scaling.csv
2025-12-01 15:41:08,037 - __main__ - INFO -    Shape: (1416, 96)
2025-12-01 15:41:08,037 - __main__ - INFO -    Colonnes: stay_date, hotCode, 93 features, J-0
2025-12-01 15:41:08,037 - __main__ - INFO - X shape: (1416, 93), y shape: (1416,)
2025-12-01 15:41:08,038 - __main__ - INFO - ================================================================================
2025-12-01 15:41:08,038 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 15:41:08,038 - __main__ - INFO - ================================================================================
2025-12-01 15:41:08,048 - __main__ - INFO - Train: (1132, 93), Validation: (284, 93)
2025-12-01 15:41:08,048 - __main__ - INFO - Configuration de la recherche:
2025-12-01 15:41:08,048 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 15:41:08,048 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 15:41:08,049 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 15:41:08,049 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 15:41:08,049 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 15:43:36,787 - __main__ - INFO - ================================================================================
2025-12-01 15:43:36,787 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 15:43:36,787 - __main__ - INFO - ================================================================================
2025-12-01 15:43:36,788 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0577
2025-12-01 15:43:36,788 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 15:43:36,788 - __main__ - INFO -    - subsample: 0.95
2025-12-01 15:43:36,788 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 15:43:36,788 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 15:43:36,788 - __main__ - INFO -    - n_estimators: 500
2025-12-01 15:43:36,788 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 15:43:36,788 - __main__ - INFO -    - max_depth: 5
2025-12-01 15:43:36,789 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 15:43:36,789 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 15:43:36,793 - __main__ - INFO - 
Performances sur validation:
2025-12-01 15:43:36,794 - __main__ - INFO -    - MAE: 0.0519
2025-12-01 15:43:36,794 - __main__ - INFO -    - R¬≤: 0.8370
2025-12-01 15:43:36,794 - __main__ - INFO - ================================================================================
2025-12-01 15:43:36,794 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 15:43:36,795 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 15:43:36,799 - __main__ - INFO - Train: (1132, 93), Test: (284, 93)
2025-12-01 15:43:39,159 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 15:43:39,287 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-7\test_predictions.csv
2025-12-01 15:43:39,288 - __main__ - INFO -    Shape: (284, 99)
2025-12-01 15:43:39,288 - __main__ - INFO -    Colonnes: stay_date, hotCode, 93 features + y_test + y_pred + error + abs_error
2025-12-01 15:43:39,288 - __main__ - INFO -    MAE moyen: 0.0519
2025-12-01 15:43:39,295 - __main__ - INFO - üìä Test MAE: 0.0519
2025-12-01 15:43:39,296 - __main__ - INFO - üìä Test R¬≤: 0.8370
2025-12-01 15:43:39,296 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 15:43:39,955 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-7\xgb_scatter_plot.png
2025-12-01 15:43:40,417 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-7\xgb_feature_importance.png
2025-12-01 15:43:40,433 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-7\models...
2025-12-01 15:43:40,464 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-7\models\xgb_to_predictor.joblib
2025-12-01 15:43:40,464 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-7\models\xgb_scaler.joblib
2025-12-01 15:43:40,464 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-7\models\feature_columns.txt
2025-12-01 15:43:40,464 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 15:43:40,464 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 15:43:40,464 - __main__ - INFO -    Container: ml-models
2025-12-01 15:43:41,267 - __main__ - INFO -    Container existant trouv√©
2025-12-01 15:43:41,267 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-7/
2025-12-01 15:43:41,613 - __main__ - INFO -    ‚úì predictTo/D09/J-7/models/xgb_to_predictor.joblib
2025-12-01 15:43:41,631 - __main__ - INFO -    ‚úì predictTo/D09/J-7/models/xgb_scaler.joblib
2025-12-01 15:43:41,657 - __main__ - INFO -    ‚úì predictTo/D09/J-7/models/feature_columns.txt
2025-12-01 15:43:41,680 - __main__ - INFO -    ‚úì predictTo/D09/J-7/xgb_scatter_plot.png
2025-12-01 15:43:41,704 - __main__ - INFO -    ‚úì predictTo/D09/J-7/xgb_feature_importance.png
2025-12-01 15:43:42,095 - __main__ - INFO -    ‚úì predictTo/D09/J-7/training_data_before_scaling.csv
2025-12-01 15:43:42,186 - __main__ - INFO -    ‚úì predictTo/D09/J-7/test_predictions.csv
2025-12-01 15:43:42,186 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 15:43:42,186 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-7/
2025-12-01 15:43:42,187 - __main__ - INFO - ================================================================================
2025-12-01 15:43:42,188 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 15:43:42,188 - __main__ - INFO - ================================================================================
2025-12-01 15:43:42,188 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 15:43:42,188 - __main__ - INFO -    Train MAE: 0.0049
2025-12-01 15:43:42,188 - __main__ - INFO -    Train R¬≤:  0.9986
2025-12-01 15:43:42,188 - __main__ - INFO -    Test MAE:  0.0519
2025-12-01 15:43:42,188 - __main__ - INFO -    Test R¬≤:   0.8370
2025-12-01 15:43:49,445 - __main__ - INFO - ================================================================================
2025-12-01 15:43:49,446 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 15:43:49,446 - __main__ - INFO - ================================================================================
2025-12-01 15:43:49,446 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 15:43:49,451 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 15:43:49,452 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 5
2025-12-01 15:43:49,452 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 15:43:49,452 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 15:43:49,452 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 5, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 15:43:49,452 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 15:43:49,478 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-12-01 15:43:49,757 - __main__ - INFO - Indicateurs charg√©s: (268538, 17)
2025-12-01 15:43:49,758 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 15:43:49,788 - __main__ - INFO -    Clusters filtr√©s: (1415, 65)
2025-12-01 15:43:49,788 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 15:43:49,789 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 15:43:49,904 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 15:43:49,943 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 15:43:49,982 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 15:43:50,000 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-12-01 15:43:50,001 - __main__ - INFO - Calcul des features PM sur donn√©es J-5 √† J-60 (pas de data leakage)
2025-12-01 15:43:50,001 - __main__ - INFO -    Colonnes PM utilis√©es: 56
2025-12-01 15:43:51,932 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-12-01 15:43:51,933 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-5 √† J-60
2025-12-01 15:43:51,933 - __main__ - INFO -    Colonnes Ant utilis√©es: 56
2025-12-01 15:43:54,179 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-12-01 15:43:54,180 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-5 √† J-60
2025-12-01 15:43:54,180 - __main__ - INFO -    Colonnes Ds utilis√©es: 56
2025-12-01 15:43:56,301 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-12-01 15:43:56,302 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 15:43:56,491 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 15:43:56,492 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 15:43:56,764 - __main__ - INFO -    Features concurrentes calcul√©es sur J-5 √† J-60
2025-12-01 15:43:56,788 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 15:44:00,314 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1415, 277)
2025-12-01 15:44:00,324 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 15:44:00,333 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-12-01 15:44:00,334 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 15:44:00,952 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 15:44:01,116 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 15:44:01,144 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 286)
2025-12-01 15:44:01,145 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-12-01 15:44:01,145 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-12-01 15:44:01,145 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-12-01 15:44:01,145 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-12-01 15:44:01,146 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-12-01 15:44:01,146 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-12-01 15:44:01,157 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 15:44:01,158 - __main__ - INFO - --------------------------------
2025-12-01 15:44:01,158 - __main__ - INFO - Horizon: 5
2025-12-01 15:44:01,158 - __main__ - INFO - --------------------------------
2025-12-01 15:44:01,158 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 15:44:01,161 - __main__ - INFO - nb_observations recalcul√© pour horizon=5
2025-12-01 15:44:01,161 - __main__ - INFO -    Minimum: 56
2025-12-01 15:44:01,161 - __main__ - INFO -    Maximum: 56
2025-12-01 15:44:01,162 - __main__ - INFO -    Moyenne: 56.0
2025-12-01 15:44:01,162 - __main__ - INFO - Nombre total de features: 95
2025-12-01 15:44:01,162 - __main__ - INFO -    - TO historiques: 55
2025-12-01 15:44:01,162 - __main__ - INFO -    - Features PM: 7
2025-12-01 15:44:01,162 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 15:44:01,162 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 15:44:01,162 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 15:44:01,162 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 15:44:01,162 - __main__ - INFO -    - Autres features: 11
2025-12-01 15:44:01,334 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-5\training_data_before_scaling.csv
2025-12-01 15:44:01,334 - __main__ - INFO -    Shape: (1416, 98)
2025-12-01 15:44:01,334 - __main__ - INFO -    Colonnes: stay_date, hotCode, 95 features, J-0
2025-12-01 15:44:01,334 - __main__ - INFO - X shape: (1416, 95), y shape: (1416,)
2025-12-01 15:44:01,335 - __main__ - INFO - ================================================================================
2025-12-01 15:44:01,335 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 15:44:01,335 - __main__ - INFO - ================================================================================
2025-12-01 15:44:01,345 - __main__ - INFO - Train: (1132, 95), Validation: (284, 95)
2025-12-01 15:44:01,346 - __main__ - INFO - Configuration de la recherche:
2025-12-01 15:44:01,346 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 15:44:01,346 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 15:44:01,346 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 15:44:01,346 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 15:44:01,346 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 15:46:44,627 - __main__ - INFO - ================================================================================
2025-12-01 15:46:44,628 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 15:46:44,628 - __main__ - INFO - ================================================================================
2025-12-01 15:46:44,628 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0534
2025-12-01 15:46:44,628 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 15:46:44,628 - __main__ - INFO -    - subsample: 0.95
2025-12-01 15:46:44,628 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 15:46:44,628 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 15:46:44,628 - __main__ - INFO -    - n_estimators: 500
2025-12-01 15:46:44,628 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 15:46:44,629 - __main__ - INFO -    - max_depth: 5
2025-12-01 15:46:44,629 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 15:46:44,629 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 15:46:44,635 - __main__ - INFO - 
Performances sur validation:
2025-12-01 15:46:44,635 - __main__ - INFO -    - MAE: 0.0470
2025-12-01 15:46:44,635 - __main__ - INFO -    - R¬≤: 0.8630
2025-12-01 15:46:44,635 - __main__ - INFO - ================================================================================
2025-12-01 15:46:44,636 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 15:46:44,636 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 15:46:44,639 - __main__ - INFO - Train: (1132, 95), Test: (284, 95)
2025-12-01 15:46:47,424 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 15:46:47,539 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-5\test_predictions.csv
2025-12-01 15:46:47,540 - __main__ - INFO -    Shape: (284, 101)
2025-12-01 15:46:47,540 - __main__ - INFO -    Colonnes: stay_date, hotCode, 95 features + y_test + y_pred + error + abs_error
2025-12-01 15:46:47,540 - __main__ - INFO -    MAE moyen: 0.0470
2025-12-01 15:46:47,553 - __main__ - INFO - üìä Test MAE: 0.0470
2025-12-01 15:46:47,554 - __main__ - INFO - üìä Test R¬≤: 0.8630
2025-12-01 15:46:47,554 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 15:46:48,343 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-5\xgb_scatter_plot.png
2025-12-01 15:46:48,937 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-5\xgb_feature_importance.png
2025-12-01 15:46:48,962 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-5\models...
2025-12-01 15:46:49,005 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-5\models\xgb_to_predictor.joblib
2025-12-01 15:46:49,006 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-5\models\xgb_scaler.joblib
2025-12-01 15:46:49,006 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-5\models\feature_columns.txt
2025-12-01 15:46:49,006 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 15:46:49,006 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 15:46:49,006 - __main__ - INFO -    Container: ml-models
2025-12-01 15:46:49,825 - __main__ - INFO -    Container existant trouv√©
2025-12-01 15:46:49,825 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-5/
2025-12-01 15:46:50,094 - __main__ - INFO -    ‚úì predictTo/D09/J-5/models/xgb_to_predictor.joblib
2025-12-01 15:46:50,112 - __main__ - INFO -    ‚úì predictTo/D09/J-5/models/xgb_scaler.joblib
2025-12-01 15:46:50,133 - __main__ - INFO -    ‚úì predictTo/D09/J-5/models/feature_columns.txt
2025-12-01 15:46:50,159 - __main__ - INFO -    ‚úì predictTo/D09/J-5/xgb_scatter_plot.png
2025-12-01 15:46:50,181 - __main__ - INFO -    ‚úì predictTo/D09/J-5/xgb_feature_importance.png
2025-12-01 15:46:50,662 - __main__ - INFO -    ‚úì predictTo/D09/J-5/training_data_before_scaling.csv
2025-12-01 15:46:50,762 - __main__ - INFO -    ‚úì predictTo/D09/J-5/test_predictions.csv
2025-12-01 15:46:50,762 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 15:46:50,763 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-5/
2025-12-01 15:46:50,765 - __main__ - INFO - ================================================================================
2025-12-01 15:46:50,765 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 15:46:50,765 - __main__ - INFO - ================================================================================
2025-12-01 15:46:50,765 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 15:46:50,765 - __main__ - INFO -    Train MAE: 0.0043
2025-12-01 15:46:50,766 - __main__ - INFO -    Train R¬≤:  0.9989
2025-12-01 15:46:50,766 - __main__ - INFO -    Test MAE:  0.0470
2025-12-01 15:46:50,766 - __main__ - INFO -    Test R¬≤:   0.8630
2025-12-01 15:46:59,358 - __main__ - INFO - ================================================================================
2025-12-01 15:46:59,358 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 15:46:59,358 - __main__ - INFO - ================================================================================
2025-12-01 15:46:59,358 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 15:46:59,363 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 15:46:59,363 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 3
2025-12-01 15:46:59,363 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 15:46:59,363 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 15:46:59,363 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 3, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 15:46:59,363 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 15:46:59,388 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-12-01 15:46:59,698 - __main__ - INFO - Indicateurs charg√©s: (268538, 17)
2025-12-01 15:46:59,699 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 15:46:59,735 - __main__ - INFO -    Clusters filtr√©s: (1415, 65)
2025-12-01 15:46:59,735 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 15:46:59,736 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 15:46:59,869 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 15:46:59,910 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 15:46:59,956 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 15:46:59,974 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-12-01 15:46:59,974 - __main__ - INFO - Calcul des features PM sur donn√©es J-3 √† J-60 (pas de data leakage)
2025-12-01 15:46:59,975 - __main__ - INFO -    Colonnes PM utilis√©es: 58
2025-12-01 15:47:02,244 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-12-01 15:47:02,244 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-3 √† J-60
2025-12-01 15:47:02,244 - __main__ - INFO -    Colonnes Ant utilis√©es: 58
2025-12-01 15:47:04,207 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-12-01 15:47:04,207 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-3 √† J-60
2025-12-01 15:47:04,208 - __main__ - INFO -    Colonnes Ds utilis√©es: 58
2025-12-01 15:47:05,802 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-12-01 15:47:05,802 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 15:47:05,958 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 15:47:05,959 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 15:47:06,203 - __main__ - INFO -    Features concurrentes calcul√©es sur J-3 √† J-60
2025-12-01 15:47:06,229 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 15:47:09,510 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1415, 277)
2025-12-01 15:47:09,519 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 15:47:09,528 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-12-01 15:47:09,528 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 15:47:10,139 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 15:47:10,303 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 15:47:10,336 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 286)
2025-12-01 15:47:10,336 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-12-01 15:47:10,336 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-12-01 15:47:10,337 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-12-01 15:47:10,337 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-12-01 15:47:10,337 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-12-01 15:47:10,337 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-12-01 15:47:10,345 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 15:47:10,345 - __main__ - INFO - --------------------------------
2025-12-01 15:47:10,346 - __main__ - INFO - Horizon: 3
2025-12-01 15:47:10,346 - __main__ - INFO - --------------------------------
2025-12-01 15:47:10,346 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 15:47:10,348 - __main__ - INFO - nb_observations recalcul√© pour horizon=3
2025-12-01 15:47:10,348 - __main__ - INFO -    Minimum: 58
2025-12-01 15:47:10,348 - __main__ - INFO -    Maximum: 58
2025-12-01 15:47:10,348 - __main__ - INFO -    Moyenne: 58.0
2025-12-01 15:47:10,348 - __main__ - INFO - Nombre total de features: 97
2025-12-01 15:47:10,349 - __main__ - INFO -    - TO historiques: 57
2025-12-01 15:47:10,349 - __main__ - INFO -    - Features PM: 7
2025-12-01 15:47:10,349 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 15:47:10,349 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 15:47:10,349 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 15:47:10,349 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 15:47:10,349 - __main__ - INFO -    - Autres features: 11
2025-12-01 15:47:10,534 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-3\training_data_before_scaling.csv
2025-12-01 15:47:10,534 - __main__ - INFO -    Shape: (1416, 100)
2025-12-01 15:47:10,534 - __main__ - INFO -    Colonnes: stay_date, hotCode, 97 features, J-0
2025-12-01 15:47:10,534 - __main__ - INFO - X shape: (1416, 97), y shape: (1416,)
2025-12-01 15:47:10,534 - __main__ - INFO - ================================================================================
2025-12-01 15:47:10,534 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 15:47:10,534 - __main__ - INFO - ================================================================================
2025-12-01 15:47:10,542 - __main__ - INFO - Train: (1132, 97), Validation: (284, 97)
2025-12-01 15:47:10,542 - __main__ - INFO - Configuration de la recherche:
2025-12-01 15:47:10,542 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 15:47:10,542 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 15:47:10,542 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 15:47:10,542 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 15:47:10,542 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 15:50:20,088 - __main__ - INFO - ================================================================================
2025-12-01 15:50:20,088 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 15:50:20,088 - __main__ - INFO - ================================================================================
2025-12-01 15:50:20,088 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0478
2025-12-01 15:50:20,088 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 15:50:20,088 - __main__ - INFO -    - subsample: 0.95
2025-12-01 15:50:20,088 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 15:50:20,089 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 15:50:20,089 - __main__ - INFO -    - n_estimators: 500
2025-12-01 15:50:20,089 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 15:50:20,089 - __main__ - INFO -    - max_depth: 5
2025-12-01 15:50:20,089 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 15:50:20,089 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 15:50:20,095 - __main__ - INFO - 
Performances sur validation:
2025-12-01 15:50:20,095 - __main__ - INFO -    - MAE: 0.0452
2025-12-01 15:50:20,095 - __main__ - INFO -    - R¬≤: 0.8604
2025-12-01 15:50:20,096 - __main__ - INFO - ================================================================================
2025-12-01 15:50:20,096 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 15:50:20,097 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 15:50:20,099 - __main__ - INFO - Train: (1132, 97), Test: (284, 97)
2025-12-01 15:50:22,262 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 15:50:22,367 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-3\test_predictions.csv
2025-12-01 15:50:22,368 - __main__ - INFO -    Shape: (284, 103)
2025-12-01 15:50:22,368 - __main__ - INFO -    Colonnes: stay_date, hotCode, 97 features + y_test + y_pred + error + abs_error
2025-12-01 15:50:22,368 - __main__ - INFO -    MAE moyen: 0.0452
2025-12-01 15:50:22,374 - __main__ - INFO - üìä Test MAE: 0.0452
2025-12-01 15:50:22,374 - __main__ - INFO - üìä Test R¬≤: 0.8604
2025-12-01 15:50:22,374 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 15:50:22,991 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-3\xgb_scatter_plot.png
2025-12-01 15:50:23,435 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-3\xgb_feature_importance.png
2025-12-01 15:50:23,448 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-3\models...
2025-12-01 15:50:23,476 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-3\models\xgb_to_predictor.joblib
2025-12-01 15:50:23,477 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-3\models\xgb_scaler.joblib
2025-12-01 15:50:23,477 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-3\models\feature_columns.txt
2025-12-01 15:50:23,477 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 15:50:23,477 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 15:50:23,477 - __main__ - INFO -    Container: ml-models
2025-12-01 15:50:24,227 - __main__ - INFO -    Container existant trouv√©
2025-12-01 15:50:24,227 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-3/
2025-12-01 15:50:24,441 - __main__ - INFO -    ‚úì predictTo/D09/J-3/models/xgb_to_predictor.joblib
2025-12-01 15:50:24,459 - __main__ - INFO -    ‚úì predictTo/D09/J-3/models/xgb_scaler.joblib
2025-12-01 15:50:24,480 - __main__ - INFO -    ‚úì predictTo/D09/J-3/models/feature_columns.txt
2025-12-01 15:50:24,528 - __main__ - INFO -    ‚úì predictTo/D09/J-3/xgb_scatter_plot.png
2025-12-01 15:50:24,559 - __main__ - INFO -    ‚úì predictTo/D09/J-3/xgb_feature_importance.png
2025-12-01 15:50:25,002 - __main__ - INFO -    ‚úì predictTo/D09/J-3/training_data_before_scaling.csv
2025-12-01 15:50:25,100 - __main__ - INFO -    ‚úì predictTo/D09/J-3/test_predictions.csv
2025-12-01 15:50:25,101 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 15:50:25,101 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-3/
2025-12-01 15:50:25,102 - __main__ - INFO - ================================================================================
2025-12-01 15:50:25,102 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 15:50:25,103 - __main__ - INFO - ================================================================================
2025-12-01 15:50:25,103 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 15:50:25,103 - __main__ - INFO -    Train MAE: 0.0036
2025-12-01 15:50:25,103 - __main__ - INFO -    Train R¬≤:  0.9992
2025-12-01 15:50:25,103 - __main__ - INFO -    Test MAE:  0.0452
2025-12-01 15:50:25,103 - __main__ - INFO -    Test R¬≤:   0.8604
2025-12-01 15:50:32,323 - __main__ - INFO - ================================================================================
2025-12-01 15:50:32,323 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 15:50:32,323 - __main__ - INFO - ================================================================================
2025-12-01 15:50:32,324 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 15:50:32,328 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 15:50:32,328 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 1
2025-12-01 15:50:32,328 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 15:50:32,328 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 15:50:32,328 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 1, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 15:50:32,329 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 15:50:32,353 - __main__ - INFO - Clusters charg√©s: (1415, 65)
2025-12-01 15:50:32,644 - __main__ - INFO - Indicateurs charg√©s: (268538, 17)
2025-12-01 15:50:32,644 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 15:50:32,670 - __main__ - INFO -    Clusters filtr√©s: (1415, 65)
2025-12-01 15:50:32,670 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 15:50:32,670 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 15:50:32,797 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 15:50:32,833 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 15:50:32,874 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 15:50:32,889 - __main__ - INFO - DataFrame fusionn√©: (1415, 248)
2025-12-01 15:50:32,889 - __main__ - INFO - Calcul des features PM sur donn√©es J-1 √† J-60 (pas de data leakage)
2025-12-01 15:50:32,890 - __main__ - INFO -    Colonnes PM utilis√©es: 60
2025-12-01 15:50:34,769 - __main__ - INFO - Features PM ajout√©es: (1415, 255)
2025-12-01 15:50:34,770 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-1 √† J-60
2025-12-01 15:50:34,770 - __main__ - INFO -    Colonnes Ant utilis√©es: 60
2025-12-01 15:50:36,120 - __main__ - INFO - Features Ant ajout√©es: (1415, 261)
2025-12-01 15:50:36,120 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-1 √† J-60
2025-12-01 15:50:36,120 - __main__ - INFO -    Colonnes Ds utilis√©es: 60
2025-12-01 15:50:37,626 - __main__ - INFO - Features Ds ajout√©es: (1415, 267)
2025-12-01 15:50:37,626 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 15:50:37,790 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 15:50:37,790 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 15:50:38,038 - __main__ - INFO -    Features concurrentes calcul√©es sur J-1 √† J-60
2025-12-01 15:50:38,059 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 15:50:42,020 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1415, 277)
2025-12-01 15:50:42,028 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 15:50:42,041 - __main__ - INFO -    ToF1 ajout√© : 1050 valeurs non-nulles sur 1416
2025-12-01 15:50:42,041 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 15:50:42,704 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 15:50:42,879 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 15:50:42,910 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1416, 286)
2025-12-01 15:50:42,910 - __main__ - INFO -    - Jours f√©ri√©s: 43 (3.04%)
2025-12-01 15:50:42,910 - __main__ - INFO -    - Jours de pont: 85 (6.00%)
2025-12-01 15:50:42,911 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=30.3
2025-12-01 15:50:42,911 - __main__ - INFO -    - Vacances scolaires: 591 (41.74%)
2025-12-01 15:50:42,911 - __main__ - INFO -    - Weekends 3j: 57 (4.03%)
2025-12-01 15:50:42,911 - __main__ - INFO -    - Weekends 4j: 101 (7.13%)
2025-12-01 15:50:42,922 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 15:50:42,922 - __main__ - INFO - --------------------------------
2025-12-01 15:50:42,922 - __main__ - INFO - Horizon: 1
2025-12-01 15:50:42,922 - __main__ - INFO - --------------------------------
2025-12-01 15:50:42,923 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 15:50:42,925 - __main__ - INFO - nb_observations recalcul√© pour horizon=1
2025-12-01 15:50:42,926 - __main__ - INFO -    Minimum: 60
2025-12-01 15:50:42,926 - __main__ - INFO -    Maximum: 60
2025-12-01 15:50:42,926 - __main__ - INFO -    Moyenne: 60.0
2025-12-01 15:50:42,927 - __main__ - INFO - Nombre total de features: 99
2025-12-01 15:50:42,927 - __main__ - INFO -    - TO historiques: 59
2025-12-01 15:50:42,927 - __main__ - INFO -    - Features PM: 7
2025-12-01 15:50:42,927 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 15:50:42,928 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 15:50:42,928 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 15:50:42,928 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 15:50:42,928 - __main__ - INFO -    - Autres features: 11
2025-12-01 15:50:43,114 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-1\training_data_before_scaling.csv
2025-12-01 15:50:43,115 - __main__ - INFO -    Shape: (1416, 102)
2025-12-01 15:50:43,115 - __main__ - INFO -    Colonnes: stay_date, hotCode, 99 features, J-0
2025-12-01 15:50:43,115 - __main__ - INFO - X shape: (1416, 99), y shape: (1416,)
2025-12-01 15:50:43,115 - __main__ - INFO - ================================================================================
2025-12-01 15:50:43,115 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 15:50:43,115 - __main__ - INFO - ================================================================================
2025-12-01 15:50:43,123 - __main__ - INFO - Train: (1132, 99), Validation: (284, 99)
2025-12-01 15:50:43,123 - __main__ - INFO - Configuration de la recherche:
2025-12-01 15:50:43,123 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 15:50:43,123 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 15:50:43,123 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 15:50:43,123 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 15:50:43,123 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 15:53:06,760 - __main__ - INFO - ================================================================================
2025-12-01 15:53:06,761 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 15:53:06,761 - __main__ - INFO - ================================================================================
2025-12-01 15:53:06,761 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0277
2025-12-01 15:53:06,761 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 15:53:06,761 - __main__ - INFO -    - subsample: 0.95
2025-12-01 15:53:06,761 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 15:53:06,761 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 15:53:06,761 - __main__ - INFO -    - n_estimators: 500
2025-12-01 15:53:06,762 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 15:53:06,762 - __main__ - INFO -    - max_depth: 5
2025-12-01 15:53:06,762 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 15:53:06,762 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 15:53:06,767 - __main__ - INFO - 
Performances sur validation:
2025-12-01 15:53:06,768 - __main__ - INFO -    - MAE: 0.0263
2025-12-01 15:53:06,768 - __main__ - INFO -    - R¬≤: 0.9440
2025-12-01 15:53:06,768 - __main__ - INFO - ================================================================================
2025-12-01 15:53:06,768 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 15:53:06,769 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 15:53:06,772 - __main__ - INFO - Train: (1132, 99), Test: (284, 99)
2025-12-01 15:53:09,275 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 15:53:09,390 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-1\test_predictions.csv
2025-12-01 15:53:09,391 - __main__ - INFO -    Shape: (284, 105)
2025-12-01 15:53:09,391 - __main__ - INFO -    Colonnes: stay_date, hotCode, 99 features + y_test + y_pred + error + abs_error
2025-12-01 15:53:09,391 - __main__ - INFO -    MAE moyen: 0.0263
2025-12-01 15:53:09,398 - __main__ - INFO - üìä Test MAE: 0.0263
2025-12-01 15:53:09,398 - __main__ - INFO - üìä Test R¬≤: 0.9440
2025-12-01 15:53:09,398 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 15:53:10,050 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-1\xgb_scatter_plot.png
2025-12-01 15:53:10,564 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-1\xgb_feature_importance.png
2025-12-01 15:53:10,581 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-1\models...
2025-12-01 15:53:10,614 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-1\models\xgb_to_predictor.joblib
2025-12-01 15:53:10,615 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-1\models\xgb_scaler.joblib
2025-12-01 15:53:10,615 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-1\models\feature_columns.txt
2025-12-01 15:53:10,615 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 15:53:10,615 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 15:53:10,615 - __main__ - INFO -    Container: ml-models
2025-12-01 15:53:11,425 - __main__ - INFO -    Container existant trouv√©
2025-12-01 15:53:11,425 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-1/
2025-12-01 15:53:11,735 - __main__ - INFO -    ‚úì predictTo/D09/J-1/models/xgb_to_predictor.joblib
2025-12-01 15:53:11,754 - __main__ - INFO -    ‚úì predictTo/D09/J-1/models/xgb_scaler.joblib
2025-12-01 15:53:11,776 - __main__ - INFO -    ‚úì predictTo/D09/J-1/models/feature_columns.txt
2025-12-01 15:53:11,806 - __main__ - INFO -    ‚úì predictTo/D09/J-1/xgb_scatter_plot.png
2025-12-01 15:53:11,831 - __main__ - INFO -    ‚úì predictTo/D09/J-1/xgb_feature_importance.png
2025-12-01 15:53:12,378 - __main__ - INFO -    ‚úì predictTo/D09/J-1/training_data_before_scaling.csv
2025-12-01 15:53:12,477 - __main__ - INFO -    ‚úì predictTo/D09/J-1/test_predictions.csv
2025-12-01 15:53:12,478 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 15:53:12,478 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-1/
2025-12-01 15:53:12,480 - __main__ - INFO - ================================================================================
2025-12-01 15:53:12,481 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 15:53:12,481 - __main__ - INFO - ================================================================================
2025-12-01 15:53:12,481 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 15:53:12,481 - __main__ - INFO -    Train MAE: 0.0015
2025-12-01 15:53:12,481 - __main__ - INFO -    Train R¬≤:  0.9999
2025-12-01 15:53:12,481 - __main__ - INFO -    Test MAE:  0.0263
2025-12-01 15:53:12,481 - __main__ - INFO -    Test R¬≤:   0.9440
2025-12-01 15:53:21,365 - __main__ - INFO - ================================================================================
2025-12-01 15:53:21,366 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 15:53:21,366 - __main__ - INFO - ================================================================================
2025-12-01 15:53:21,366 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 15:53:21,372 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 15:53:21,372 - __main__ - ERROR - ‚ùå L'horizon doit √™tre un entier positif
2025-12-01 19:49:47,048 - __main__ - INFO - ================================================================================
2025-12-01 19:49:47,049 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 19:49:47,049 - __main__ - INFO - ================================================================================
2025-12-01 19:49:47,049 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 19:49:47,055 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 19:49:47,055 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 7
2025-12-01 19:49:47,055 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 19:49:47,055 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 19:49:47,055 - __main__ - INFO - Configuration: {'clustering_results_path': '../results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 19:49:47,055 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 19:49:47,057 - __main__ - ERROR - Erreur lors du chargement des donn√©es: [Errno 2] No such file or directory: '../results/D09/clustering_results.csv'
2025-12-01 19:49:47,058 - __main__ - ERROR - ‚ùå ERREUR FATALE: [Errno 2] No such file or directory: '../results/D09/clustering_results.csv'
Traceback (most recent call last):
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 1542, in main
    clusters, indicateurs = predictor.load_data()
                            ~~~~~~~~~~~~~~~~~~~^^
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 169, in load_data
    clusters = pd.read_csv(
        self.config['clustering_results_path'],
        sep=';'
    )
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\io\parsers\readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\io\parsers\readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\io\parsers\readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\io\parsers\readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ~~~~~~~~~~^
        f,
        ^^
    ...<6 lines>...
        storage_options=self.options.get("storage_options", None),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\github\ml-demande\.venv_ml\Lib\site-packages\pandas\io\common.py", line 873, in get_handle
    handle = open(
        handle,
    ...<3 lines>...
        newline="",
    )
FileNotFoundError: [Errno 2] No such file or directory: '../results/D09/clustering_results.csv'
2025-12-01 19:55:10,156 - __main__ - INFO - ================================================================================
2025-12-01 19:55:10,156 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 19:55:10,156 - __main__ - INFO - ================================================================================
2025-12-01 19:55:10,156 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 19:55:10,161 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 19:55:10,161 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 7
2025-12-01 19:55:10,161 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 19:55:10,161 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 19:55:10,161 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 19:55:10,161 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 19:55:10,161 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 19:55:10,184 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 19:55:10,468 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 19:55:10,468 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 19:55:10,508 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 19:55:10,508 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 19:55:10,508 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 19:55:10,628 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 19:55:10,655 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 19:55:10,684 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 19:55:10,703 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 19:55:10,704 - __main__ - INFO - Calcul des features PM sur donn√©es J-7 √† J-60 (pas de data leakage)
2025-12-01 19:55:10,704 - __main__ - INFO -    Colonnes PM utilis√©es: 54
2025-12-01 19:55:12,207 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 19:55:12,207 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-7 √† J-60
2025-12-01 19:55:12,207 - __main__ - INFO -    Colonnes Ant utilis√©es: 54
2025-12-01 19:55:13,133 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 19:55:13,133 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-7 √† J-60
2025-12-01 19:55:13,133 - __main__ - INFO -    Colonnes Ds utilis√©es: 54
2025-12-01 19:55:14,056 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 19:55:14,057 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 19:55:14,197 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 19:55:14,197 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 19:55:14,379 - __main__ - INFO -    Features concurrentes calcul√©es sur J-7 √† J-60
2025-12-01 19:55:14,397 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 19:55:16,978 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 19:55:16,984 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 19:55:17,001 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 19:55:17,001 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 19:55:18,777 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 19:55:18,973 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 19:55:19,040 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 19:55:19,040 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 19:55:19,040 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 19:55:19,040 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 19:55:19,040 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 19:55:19,041 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 19:55:19,041 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 19:55:19,049 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 19:55:19,049 - __main__ - INFO - --------------------------------
2025-12-01 19:55:19,049 - __main__ - INFO - Horizon: 7
2025-12-01 19:55:19,049 - __main__ - INFO - --------------------------------
2025-12-01 19:55:19,050 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 19:55:19,051 - __main__ - INFO - nb_observations recalcul√© pour horizon=7
2025-12-01 19:55:19,052 - __main__ - INFO -    Minimum: 54
2025-12-01 19:55:19,052 - __main__ - INFO -    Maximum: 54
2025-12-01 19:55:19,052 - __main__ - INFO -    Moyenne: 54.0
2025-12-01 19:55:19,052 - __main__ - INFO - Nombre total de features: 93
2025-12-01 19:55:19,052 - __main__ - INFO -    - TO historiques: 53
2025-12-01 19:55:19,052 - __main__ - INFO -    - Features PM: 7
2025-12-01 19:55:19,052 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 19:55:19,052 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 19:55:19,052 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 19:55:19,052 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 19:55:19,052 - __main__ - INFO -    - Autres features: 11
2025-12-01 19:55:19,202 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-7\training_data_before_scaling.csv
2025-12-01 19:55:19,203 - __main__ - INFO -    Shape: (1463, 96)
2025-12-01 19:55:19,203 - __main__ - INFO -    Colonnes: stay_date, hotCode, 93 features, J-0
2025-12-01 19:55:19,203 - __main__ - INFO - X shape: (1463, 93), y shape: (1463,)
2025-12-01 19:55:19,203 - __main__ - INFO - ================================================================================
2025-12-01 19:55:19,203 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 19:55:19,203 - __main__ - INFO - ================================================================================
2025-12-01 19:55:19,211 - __main__ - INFO - Train: (1170, 93), Validation: (293, 93)
2025-12-01 19:55:19,211 - __main__ - INFO - Configuration de la recherche:
2025-12-01 19:55:19,211 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 19:55:19,211 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 19:55:19,211 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 19:55:19,211 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 19:55:19,211 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 19:57:11,065 - __main__ - INFO - ================================================================================
2025-12-01 19:57:11,065 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 19:57:11,065 - __main__ - INFO - ================================================================================
2025-12-01 19:57:11,065 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0566
2025-12-01 19:57:11,065 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 19:57:11,065 - __main__ - INFO -    - subsample: 0.95
2025-12-01 19:57:11,065 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 19:57:11,065 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 19:57:11,066 - __main__ - INFO -    - n_estimators: 500
2025-12-01 19:57:11,066 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 19:57:11,066 - __main__ - INFO -    - max_depth: 5
2025-12-01 19:57:11,066 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 19:57:11,066 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 19:57:11,116 - __main__ - INFO - 
Performances sur validation:
2025-12-01 19:57:11,117 - __main__ - INFO -    - MAE: 0.0591
2025-12-01 19:57:11,117 - __main__ - INFO -    - R¬≤: 0.8196
2025-12-01 19:57:11,117 - __main__ - INFO - ================================================================================
2025-12-01 19:57:11,117 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 19:57:11,118 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 19:57:11,121 - __main__ - INFO - Train: (1170, 93), Test: (293, 93)
2025-12-01 19:57:12,743 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 19:57:12,834 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-7\test_predictions.csv
2025-12-01 19:57:12,834 - __main__ - INFO -    Shape: (293, 99)
2025-12-01 19:57:12,834 - __main__ - INFO -    Colonnes: stay_date, hotCode, 93 features + y_test + y_pred + error + abs_error
2025-12-01 19:57:12,835 - __main__ - INFO -    MAE moyen: 0.0591
2025-12-01 19:57:12,845 - __main__ - INFO - üìä Test MAE: 0.0591
2025-12-01 19:57:12,846 - __main__ - INFO - üìä Test R¬≤: 0.8196
2025-12-01 19:57:12,846 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 19:57:13,607 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-7\xgb_scatter_plot.png
2025-12-01 19:57:14,151 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-7\xgb_feature_importance.png
2025-12-01 19:57:14,173 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-7\models...
2025-12-01 19:57:14,202 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-7\models\xgb_to_predictor.joblib
2025-12-01 19:57:14,202 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-7\models\xgb_scaler.joblib
2025-12-01 19:57:14,202 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-7\models\feature_columns.txt
2025-12-01 19:57:14,202 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 19:57:14,202 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 19:57:14,202 - __main__ - INFO -    Container: ml-models
2025-12-01 19:57:15,150 - __main__ - INFO -    Container existant trouv√©
2025-12-01 19:57:15,150 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-7/
2025-12-01 19:57:21,337 - __main__ - INFO -    ‚úì predictTo/D09/J-7/models/xgb_to_predictor.joblib
2025-12-01 19:57:21,398 - __main__ - INFO -    ‚úì predictTo/D09/J-7/models/xgb_scaler.joblib
2025-12-01 19:57:21,466 - __main__ - INFO -    ‚úì predictTo/D09/J-7/models/feature_columns.txt
2025-12-01 19:57:21,822 - __main__ - INFO -    ‚úì predictTo/D09/J-7/xgb_scatter_plot.png
2025-12-01 19:57:22,019 - __main__ - INFO -    ‚úì predictTo/D09/J-7/xgb_feature_importance.png
2025-12-01 19:57:34,720 - __main__ - INFO -    ‚úì predictTo/D09/J-7/training_data_before_scaling.csv
2025-12-01 19:57:37,942 - __main__ - INFO -    ‚úì predictTo/D09/J-7/test_predictions.csv
2025-12-01 19:57:37,942 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 19:57:37,942 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-7/
2025-12-01 19:57:37,943 - __main__ - INFO - ================================================================================
2025-12-01 19:57:37,943 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 19:57:37,943 - __main__ - INFO - ================================================================================
2025-12-01 19:57:37,943 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 19:57:37,944 - __main__ - INFO -    Train MAE: 0.0049
2025-12-01 19:57:37,944 - __main__ - INFO -    Train R¬≤:  0.9985
2025-12-01 19:57:37,944 - __main__ - INFO -    Test MAE:  0.0591
2025-12-01 19:57:37,944 - __main__ - INFO -    Test R¬≤:   0.8196
2025-12-01 20:06:42,884 - __main__ - INFO - ================================================================================
2025-12-01 20:06:42,884 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 20:06:42,884 - __main__ - INFO - ================================================================================
2025-12-01 20:06:42,884 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 20:06:42,888 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 20:06:42,888 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 7
2025-12-01 20:06:42,888 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 20:06:42,888 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 20:06:42,888 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 20:06:42,888 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 20:06:42,888 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 20:06:42,912 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 20:06:43,116 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 20:06:43,116 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 20:06:43,135 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 20:06:43,135 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 20:06:43,136 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 20:06:43,209 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 20:06:43,231 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 20:06:43,255 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 20:06:43,264 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 20:06:43,264 - __main__ - INFO - Calcul des features PM sur donn√©es J-7 √† J-60 (pas de data leakage)
2025-12-01 20:06:43,264 - __main__ - INFO -    Colonnes PM utilis√©es: 54
2025-12-01 20:06:44,575 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 20:06:44,575 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-7 √† J-60
2025-12-01 20:06:44,575 - __main__ - INFO -    Colonnes Ant utilis√©es: 54
2025-12-01 20:06:45,459 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 20:06:45,459 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-7 √† J-60
2025-12-01 20:06:45,460 - __main__ - INFO -    Colonnes Ds utilis√©es: 54
2025-12-01 20:06:46,287 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 20:06:46,287 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 20:06:46,391 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 20:06:46,391 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 20:06:46,538 - __main__ - INFO -    Features concurrentes calcul√©es sur J-7 √† J-60
2025-12-01 20:06:46,550 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 20:06:48,401 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 20:06:48,406 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 20:06:48,413 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 20:06:48,413 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 20:06:49,204 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 20:06:49,353 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 20:06:49,370 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 20:06:49,370 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 20:06:49,371 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 20:06:49,371 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 20:06:49,371 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 20:06:49,371 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 20:06:49,371 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 20:06:49,377 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 20:06:49,378 - __main__ - INFO - --------------------------------
2025-12-01 20:06:49,378 - __main__ - INFO - Horizon: 7
2025-12-01 20:06:49,378 - __main__ - INFO - --------------------------------
2025-12-01 20:06:49,378 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 20:06:49,379 - __main__ - INFO - nb_observations recalcul√© pour horizon=7
2025-12-01 20:06:49,380 - __main__ - INFO -    Minimum: 54
2025-12-01 20:06:49,380 - __main__ - INFO -    Maximum: 54
2025-12-01 20:06:49,380 - __main__ - INFO -    Moyenne: 54.0
2025-12-01 20:06:49,380 - __main__ - INFO - Nombre total de features: 93
2025-12-01 20:06:49,380 - __main__ - INFO -    - TO historiques: 53
2025-12-01 20:06:49,380 - __main__ - INFO -    - Features PM: 7
2025-12-01 20:06:49,380 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 20:06:49,380 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 20:06:49,380 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 20:06:49,380 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 20:06:49,380 - __main__ - INFO -    - Autres features: 11
2025-12-01 20:06:49,504 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-7\training_data_before_scaling.csv
2025-12-01 20:06:49,504 - __main__ - INFO -    Shape: (1463, 96)
2025-12-01 20:06:49,504 - __main__ - INFO -    Colonnes: stay_date, hotCode, 93 features, J-0
2025-12-01 20:06:49,504 - __main__ - INFO - X shape: (1463, 93), y shape: (1463,)
2025-12-01 20:06:49,504 - __main__ - INFO - ================================================================================
2025-12-01 20:06:49,504 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 20:06:49,504 - __main__ - INFO - ================================================================================
2025-12-01 20:06:49,508 - __main__ - INFO - Train: (1170, 93), Validation: (293, 93)
2025-12-01 20:06:49,509 - __main__ - INFO - Configuration de la recherche:
2025-12-01 20:06:49,509 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 20:06:49,509 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 20:06:49,509 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 20:06:49,509 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 20:06:49,509 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 20:08:50,817 - __main__ - INFO - ================================================================================
2025-12-01 20:08:50,818 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 20:08:50,818 - __main__ - INFO - ================================================================================
2025-12-01 20:08:50,818 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0566
2025-12-01 20:08:50,818 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 20:08:50,818 - __main__ - INFO -    - subsample: 0.95
2025-12-01 20:08:50,818 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 20:08:50,818 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 20:08:50,818 - __main__ - INFO -    - n_estimators: 500
2025-12-01 20:08:50,818 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 20:08:50,818 - __main__ - INFO -    - max_depth: 5
2025-12-01 20:08:50,819 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 20:08:50,819 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 20:08:50,826 - __main__ - INFO - 
Performances sur validation:
2025-12-01 20:08:50,826 - __main__ - INFO -    - MAE: 0.0591
2025-12-01 20:08:50,826 - __main__ - INFO -    - R¬≤: 0.8196
2025-12-01 20:08:50,826 - __main__ - INFO - ================================================================================
2025-12-01 20:08:50,827 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 20:08:50,827 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 20:08:50,830 - __main__ - INFO - Train: (1170, 93), Test: (293, 93)
2025-12-01 20:08:53,465 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 20:08:53,560 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-7\test_predictions.csv
2025-12-01 20:08:53,560 - __main__ - INFO -    Shape: (293, 99)
2025-12-01 20:08:53,560 - __main__ - INFO -    Colonnes: stay_date, hotCode, 93 features + y_test + y_pred + error + abs_error
2025-12-01 20:08:53,561 - __main__ - INFO -    MAE moyen: 0.0591
2025-12-01 20:08:53,570 - __main__ - INFO - üìä Test MAE: 0.0591
2025-12-01 20:08:53,570 - __main__ - INFO - üìä Test R¬≤: 0.8196
2025-12-01 20:08:53,570 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 20:08:54,402 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-7\xgb_scatter_plot.png
2025-12-01 20:08:54,735 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-7\xgb_feature_importance.png
2025-12-01 20:08:54,750 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-7\models...
2025-12-01 20:08:54,779 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-7\models\xgb_to_predictor.joblib
2025-12-01 20:08:54,779 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-7\models\xgb_scaler.joblib
2025-12-01 20:08:54,779 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-7\models\feature_columns.txt
2025-12-01 20:08:54,779 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 20:08:54,779 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 20:08:54,779 - __main__ - INFO -    Container: ml-models
2025-12-01 20:08:57,315 - __main__ - INFO -    Container existant trouv√©
2025-12-01 20:08:57,315 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-7/
2025-12-01 20:09:02,266 - __main__ - INFO -    ‚úì predictTo/D09/J-7/models/xgb_to_predictor.joblib
2025-12-01 20:09:02,345 - __main__ - INFO -    ‚úì predictTo/D09/J-7/models/xgb_scaler.joblib
2025-12-01 20:09:02,411 - __main__ - INFO -    ‚úì predictTo/D09/J-7/models/feature_columns.txt
2025-12-01 20:09:02,652 - __main__ - INFO -    ‚úì predictTo/D09/J-7/xgb_scatter_plot.png
2025-12-01 20:09:02,829 - __main__ - INFO -    ‚úì predictTo/D09/J-7/xgb_feature_importance.png
2025-12-01 20:09:11,304 - __main__ - INFO -    ‚úì predictTo/D09/J-7/training_data_before_scaling.csv
2025-12-01 20:09:13,104 - __main__ - INFO -    ‚úì predictTo/D09/J-7/test_predictions.csv
2025-12-01 20:09:13,104 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 20:09:13,104 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-7/
2025-12-01 20:09:13,107 - __main__ - INFO - ================================================================================
2025-12-01 20:09:13,107 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 20:09:13,107 - __main__ - INFO - ================================================================================
2025-12-01 20:09:13,107 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 20:09:13,107 - __main__ - INFO -    Train MAE:  0.0049
2025-12-01 20:09:13,107 - __main__ - INFO -    Train RMSE: 0.0067
2025-12-01 20:09:13,107 - __main__ - INFO -    Train R¬≤:   0.9985
2025-12-01 20:09:13,107 - __main__ - INFO -    Test MAE:   0.0591
2025-12-01 20:09:13,107 - __main__ - INFO -    Test RMSE:  0.0794
2025-12-01 20:09:13,107 - __main__ - INFO -    Test R¬≤:    0.8196
2025-12-01 22:00:07,683 - __main__ - INFO - ================================================================================
2025-12-01 22:00:07,683 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 22:00:07,683 - __main__ - INFO - ================================================================================
2025-12-01 22:00:07,683 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 22:00:07,688 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 22:00:07,689 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 7
2025-12-01 22:00:07,689 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 22:00:07,689 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 22:00:07,689 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 22:00:07,689 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 22:00:07,689 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 22:00:07,705 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 22:00:07,930 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 22:00:07,930 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 22:00:07,954 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 22:00:07,954 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 22:00:07,954 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 22:00:08,040 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 22:00:08,062 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 22:00:08,085 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 22:00:08,095 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 22:00:08,095 - __main__ - INFO - Calcul des features PM sur donn√©es J-7 √† J-60 (pas de data leakage)
2025-12-01 22:00:08,096 - __main__ - INFO -    Colonnes PM utilis√©es: 54
2025-12-01 22:00:09,083 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 22:00:09,083 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-7 √† J-60
2025-12-01 22:00:09,083 - __main__ - INFO -    Colonnes Ant utilis√©es: 54
2025-12-01 22:00:10,003 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 22:00:10,003 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-7 √† J-60
2025-12-01 22:00:10,003 - __main__ - INFO -    Colonnes Ds utilis√©es: 54
2025-12-01 22:00:10,745 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 22:00:10,745 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 22:00:10,912 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 22:00:10,912 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 22:00:11,059 - __main__ - INFO -    Features concurrentes calcul√©es sur J-7 √† J-60
2025-12-01 22:00:11,070 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 22:00:12,956 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 22:00:12,963 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 22:00:12,973 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 22:00:12,973 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 22:00:14,347 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 22:00:14,479 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 22:00:14,496 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 22:00:14,496 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 22:00:14,496 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 22:00:14,497 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 22:00:14,497 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 22:00:14,497 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 22:00:14,497 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 22:00:14,506 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 22:00:14,506 - __main__ - INFO - --------------------------------
2025-12-01 22:00:14,506 - __main__ - INFO - Horizon: 7
2025-12-01 22:00:14,506 - __main__ - INFO - --------------------------------
2025-12-01 22:00:14,507 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 22:00:14,510 - __main__ - INFO - nb_observations recalcul√© pour horizon=7
2025-12-01 22:00:14,510 - __main__ - INFO -    Minimum: 54
2025-12-01 22:00:14,510 - __main__ - INFO -    Maximum: 54
2025-12-01 22:00:14,510 - __main__ - INFO -    Moyenne: 54.0
2025-12-01 22:00:14,511 - __main__ - INFO - Nombre total de features: 93
2025-12-01 22:00:14,511 - __main__ - INFO -    - TO historiques: 53
2025-12-01 22:00:14,511 - __main__ - INFO -    - Features PM: 7
2025-12-01 22:00:14,511 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 22:00:14,511 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 22:00:14,511 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 22:00:14,511 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 22:00:14,511 - __main__ - INFO -    - Autres features: 11
2025-12-01 22:00:14,688 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-7\training_data_before_scaling.csv
2025-12-01 22:00:14,689 - __main__ - INFO -    Shape: (1463, 96)
2025-12-01 22:00:14,689 - __main__ - INFO -    Colonnes: stay_date, hotCode, 93 features, J-0
2025-12-01 22:00:14,689 - __main__ - INFO - X shape: (1463, 93), y shape: (1463,)
2025-12-01 22:00:14,689 - __main__ - INFO - ================================================================================
2025-12-01 22:00:14,689 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 22:00:14,689 - __main__ - INFO - ================================================================================
2025-12-01 22:00:14,696 - __main__ - INFO - Train: (1170, 93), Validation: (293, 93)
2025-12-01 22:00:14,697 - __main__ - INFO - Configuration de la recherche:
2025-12-01 22:00:14,697 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 22:00:14,697 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 22:00:14,697 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 22:00:14,697 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 22:00:14,697 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 22:03:54,225 - __main__ - INFO - ================================================================================
2025-12-01 22:03:54,225 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 22:03:54,225 - __main__ - INFO - ================================================================================
2025-12-01 22:03:54,225 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0599
2025-12-01 22:03:54,225 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 22:03:54,225 - __main__ - INFO -    - subsample: 0.95
2025-12-01 22:03:54,225 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 22:03:54,226 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 22:03:54,226 - __main__ - INFO -    - n_estimators: 500
2025-12-01 22:03:54,226 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 22:03:54,226 - __main__ - INFO -    - max_depth: 5
2025-12-01 22:03:54,226 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 22:03:54,226 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 22:03:54,234 - __main__ - INFO - 
Performances sur validation:
2025-12-01 22:03:54,234 - __main__ - INFO -    - MAE: 0.0646
2025-12-01 22:03:54,234 - __main__ - INFO -    - R¬≤: 0.8043
2025-12-01 22:03:54,234 - __main__ - INFO - ================================================================================
2025-12-01 22:03:54,235 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 22:03:54,235 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 22:03:54,239 - __main__ - INFO - Train: (1170, 93), Test: (293, 93)
2025-12-01 22:03:58,228 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 22:03:58,328 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-7\test_predictions.csv
2025-12-01 22:03:58,328 - __main__ - INFO -    Shape: (293, 99)
2025-12-01 22:03:58,329 - __main__ - INFO -    Colonnes: stay_date, hotCode, 93 features + y_test + y_pred + error + abs_error
2025-12-01 22:03:58,329 - __main__ - INFO -    MAE moyen: 0.0646
2025-12-01 22:03:58,338 - __main__ - INFO - üìä Test MAE: 0.0646
2025-12-01 22:03:58,339 - __main__ - INFO - üìä Test R¬≤: 0.8043
2025-12-01 22:03:58,339 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 22:03:59,637 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-7\xgb_scatter_plot.png
2025-12-01 22:04:00,354 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-7\xgb_feature_importance.png
2025-12-01 22:04:00,379 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-7\models...
2025-12-01 22:04:00,421 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-7\models\xgb_to_predictor.joblib
2025-12-01 22:04:00,421 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-7\models\xgb_scaler.joblib
2025-12-01 22:04:00,421 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-7\models\feature_columns.txt
2025-12-01 22:04:00,422 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 22:04:00,422 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 22:04:00,422 - __main__ - INFO -    Container: ml-models
2025-12-01 22:04:01,248 - __main__ - INFO -    Container existant trouv√©
2025-12-01 22:04:01,248 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-7/
2025-12-01 22:04:01,358 - __main__ - INFO -    ‚úì predictTo/D09/J-7/models/xgb_to_predictor.joblib
2025-12-01 22:04:01,378 - __main__ - INFO -    ‚úì predictTo/D09/J-7/models/xgb_scaler.joblib
2025-12-01 22:04:01,396 - __main__ - INFO -    ‚úì predictTo/D09/J-7/models/feature_columns.txt
2025-12-01 22:04:01,415 - __main__ - INFO -    ‚úì predictTo/D09/J-7/xgb_scatter_plot.png
2025-12-01 22:04:01,435 - __main__ - INFO -    ‚úì predictTo/D09/J-7/xgb_feature_importance.png
2025-12-01 22:04:01,531 - __main__ - INFO -    ‚úì predictTo/D09/J-7/training_data_before_scaling.csv
2025-12-01 22:04:01,573 - __main__ - INFO -    ‚úì predictTo/D09/J-7/test_predictions.csv
2025-12-01 22:04:01,573 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 22:04:01,573 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-7/
2025-12-01 22:04:01,574 - __main__ - INFO - ================================================================================
2025-12-01 22:04:01,575 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 22:04:01,575 - __main__ - INFO - ================================================================================
2025-12-01 22:04:01,575 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 22:04:01,575 - __main__ - INFO -    Train MAE:  0.0050
2025-12-01 22:04:01,575 - __main__ - INFO -    Train RMSE: 0.0068
2025-12-01 22:04:01,575 - __main__ - INFO -    Train R¬≤:   0.9984
2025-12-01 22:04:01,575 - __main__ - INFO -    Test MAE:   0.0646
2025-12-01 22:04:01,575 - __main__ - INFO -    Test RMSE:  0.0827
2025-12-01 22:04:01,575 - __main__ - INFO -    Test R¬≤:    0.8043
2025-12-01 22:12:56,478 - __main__ - INFO - ================================================================================
2025-12-01 22:12:56,478 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 22:12:56,478 - __main__ - INFO - ================================================================================
2025-12-01 22:12:56,479 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 22:12:56,482 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 22:12:56,482 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 60
2025-12-01 22:12:56,482 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 22:12:56,482 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 22:12:56,482 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 60, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 22:12:56,482 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 22:12:56,482 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 22:12:56,497 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 22:12:56,721 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 22:12:56,722 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 22:12:56,743 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 22:12:56,744 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 22:12:56,744 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 22:12:56,887 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 22:12:56,910 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 22:12:56,932 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 22:12:56,942 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 22:12:56,942 - __main__ - INFO - Calcul des features PM sur donn√©es J-60 √† J-60 (pas de data leakage)
2025-12-01 22:12:56,942 - __main__ - INFO -    Colonnes PM utilis√©es: 1
2025-12-01 22:12:58,051 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 22:12:58,051 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-60 √† J-60
2025-12-01 22:12:58,051 - __main__ - INFO -    Colonnes Ant utilis√©es: 1
2025-12-01 22:12:58,661 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 22:12:58,661 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-60 √† J-60
2025-12-01 22:12:58,661 - __main__ - INFO -    Colonnes Ds utilis√©es: 1
2025-12-01 22:12:59,250 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 22:12:59,250 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 22:12:59,387 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 22:12:59,387 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 22:12:59,596 - __main__ - INFO -    Features concurrentes calcul√©es sur J-60 √† J-60
2025-12-01 22:12:59,602 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 22:13:01,343 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 22:13:01,349 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 22:13:01,356 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 22:13:01,356 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 22:13:01,940 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 22:13:02,040 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 22:13:02,056 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 22:13:02,057 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 22:13:02,057 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 22:13:02,057 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 22:13:02,057 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 22:13:02,057 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 22:13:02,058 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 22:13:02,064 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 22:13:02,064 - __main__ - INFO - --------------------------------
2025-12-01 22:13:02,064 - __main__ - INFO - Horizon: 60
2025-12-01 22:13:02,064 - __main__ - INFO - --------------------------------
2025-12-01 22:13:02,065 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 22:13:02,066 - __main__ - INFO - nb_observations recalcul√© pour horizon=60
2025-12-01 22:13:02,066 - __main__ - INFO -    Minimum: 1
2025-12-01 22:13:02,066 - __main__ - INFO -    Maximum: 1
2025-12-01 22:13:02,066 - __main__ - INFO -    Moyenne: 1.0
2025-12-01 22:13:02,066 - __main__ - INFO - Nombre total de features: 40
2025-12-01 22:13:02,066 - __main__ - INFO -    - TO historiques: 0
2025-12-01 22:13:02,066 - __main__ - INFO -    - Features PM: 7
2025-12-01 22:13:02,066 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 22:13:02,066 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 22:13:02,066 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 22:13:02,066 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 22:13:02,066 - __main__ - INFO -    - Autres features: 11
2025-12-01 22:13:02,117 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-60\training_data_before_scaling.csv
2025-12-01 22:13:02,117 - __main__ - INFO -    Shape: (1463, 43)
2025-12-01 22:13:02,117 - __main__ - INFO -    Colonnes: stay_date, hotCode, 40 features, J-0
2025-12-01 22:13:02,117 - __main__ - INFO - X shape: (1463, 40), y shape: (1463,)
2025-12-01 22:13:02,117 - __main__ - INFO - ================================================================================
2025-12-01 22:13:02,117 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 22:13:02,117 - __main__ - INFO - ================================================================================
2025-12-01 22:13:02,121 - __main__ - INFO - Train: (1170, 40), Validation: (293, 40)
2025-12-01 22:13:02,121 - __main__ - INFO - Configuration de la recherche:
2025-12-01 22:13:02,121 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 22:13:02,121 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 22:13:02,121 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 22:13:02,121 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 22:13:02,121 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 22:13:23,409 - __main__ - INFO - ================================================================================
2025-12-01 22:13:23,409 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 22:13:23,410 - __main__ - INFO - ================================================================================
2025-12-01 22:13:23,410 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0967
2025-12-01 22:13:23,410 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 22:13:23,410 - __main__ - INFO -    - subsample: 0.8
2025-12-01 22:13:23,410 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 22:13:23,410 - __main__ - INFO -    - reg_alpha: 0.1
2025-12-01 22:13:23,410 - __main__ - INFO -    - n_estimators: 300
2025-12-01 22:13:23,410 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 22:13:23,410 - __main__ - INFO -    - max_depth: 9
2025-12-01 22:13:23,410 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 22:13:23,410 - __main__ - INFO -    - colsample_bytree: 0.8
2025-12-01 22:13:23,415 - __main__ - INFO - 
Performances sur validation:
2025-12-01 22:13:23,415 - __main__ - INFO -    - MAE: 0.0976
2025-12-01 22:13:23,415 - __main__ - INFO -    - R¬≤: 0.5218
2025-12-01 22:13:23,415 - __main__ - INFO - ================================================================================
2025-12-01 22:13:23,416 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 22:13:23,416 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 22:13:23,418 - __main__ - INFO - Train: (1170, 40), Test: (293, 40)
2025-12-01 22:13:24,010 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 22:13:24,056 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-60\test_predictions.csv
2025-12-01 22:13:24,056 - __main__ - INFO -    Shape: (293, 46)
2025-12-01 22:13:24,056 - __main__ - INFO -    Colonnes: stay_date, hotCode, 40 features + y_test + y_pred + error + abs_error
2025-12-01 22:13:24,056 - __main__ - INFO -    MAE moyen: 0.0976
2025-12-01 22:13:24,063 - __main__ - INFO - üìä Test MAE: 0.0976
2025-12-01 22:13:24,063 - __main__ - INFO - üìä Test R¬≤: 0.5218
2025-12-01 22:13:24,063 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 22:13:24,749 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-60\xgb_scatter_plot.png
2025-12-01 22:13:25,085 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-60\xgb_feature_importance.png
2025-12-01 22:13:25,108 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-60\models...
2025-12-01 22:13:25,135 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-60\models\xgb_to_predictor.joblib
2025-12-01 22:13:25,135 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-60\models\xgb_scaler.joblib
2025-12-01 22:13:25,135 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-60\models\feature_columns.txt
2025-12-01 22:13:25,135 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 22:13:25,135 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 22:13:25,135 - __main__ - INFO -    Container: ml-models
2025-12-01 22:13:25,753 - __main__ - INFO -    Container existant trouv√©
2025-12-01 22:13:25,753 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-60/
2025-12-01 22:13:26,024 - __main__ - INFO -    ‚úì predictTo/D09/J-60/models/xgb_to_predictor.joblib
2025-12-01 22:13:26,050 - __main__ - INFO -    ‚úì predictTo/D09/J-60/models/xgb_scaler.joblib
2025-12-01 22:13:26,078 - __main__ - INFO -    ‚úì predictTo/D09/J-60/models/feature_columns.txt
2025-12-01 22:13:26,106 - __main__ - INFO -    ‚úì predictTo/D09/J-60/xgb_scatter_plot.png
2025-12-01 22:13:26,128 - __main__ - INFO -    ‚úì predictTo/D09/J-60/xgb_feature_importance.png
2025-12-01 22:13:26,158 - __main__ - INFO -    ‚úì predictTo/D09/J-60/training_data_before_scaling.csv
2025-12-01 22:13:26,178 - __main__ - INFO -    ‚úì predictTo/D09/J-60/test_predictions.csv
2025-12-01 22:13:26,179 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 22:13:26,179 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-60/
2025-12-01 22:13:26,180 - __main__ - INFO - ================================================================================
2025-12-01 22:13:26,180 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 22:13:26,180 - __main__ - INFO - ================================================================================
2025-12-01 22:13:26,180 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 22:13:26,180 - __main__ - INFO -    Train MAE:  0.0155
2025-12-01 22:13:26,180 - __main__ - INFO -    Train RMSE: 0.0201
2025-12-01 22:13:26,181 - __main__ - INFO -    Train R¬≤:   0.9859
2025-12-01 22:13:26,181 - __main__ - INFO -    Test MAE:   0.0976
2025-12-01 22:13:26,181 - __main__ - INFO -    Test RMSE:  0.1292
2025-12-01 22:13:26,181 - __main__ - INFO -    Test R¬≤:    0.5218
2025-12-01 22:13:31,977 - __main__ - INFO - ================================================================================
2025-12-01 22:13:31,977 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 22:13:31,977 - __main__ - INFO - ================================================================================
2025-12-01 22:13:31,977 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 22:13:31,981 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 22:13:31,981 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 45
2025-12-01 22:13:31,981 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 22:13:31,981 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 22:13:31,981 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 45, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 22:13:31,981 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 22:13:31,981 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 22:13:31,997 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 22:13:32,207 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 22:13:32,208 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 22:13:32,228 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 22:13:32,228 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 22:13:32,228 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 22:13:32,312 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 22:13:32,336 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 22:13:32,359 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 22:13:32,368 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 22:13:32,368 - __main__ - INFO - Calcul des features PM sur donn√©es J-45 √† J-60 (pas de data leakage)
2025-12-01 22:13:32,368 - __main__ - INFO -    Colonnes PM utilis√©es: 16
2025-12-01 22:13:33,625 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 22:13:33,625 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-45 √† J-60
2025-12-01 22:13:33,625 - __main__ - INFO -    Colonnes Ant utilis√©es: 16
2025-12-01 22:13:34,772 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 22:13:34,772 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-45 √† J-60
2025-12-01 22:13:34,772 - __main__ - INFO -    Colonnes Ds utilis√©es: 16
2025-12-01 22:13:35,846 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 22:13:35,846 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 22:13:35,969 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 22:13:35,969 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 22:13:36,135 - __main__ - INFO -    Features concurrentes calcul√©es sur J-45 √† J-60
2025-12-01 22:13:36,144 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 22:13:38,362 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 22:13:38,367 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 22:13:38,375 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 22:13:38,376 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 22:13:38,802 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 22:13:38,908 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 22:13:38,927 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 22:13:38,928 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 22:13:38,928 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 22:13:38,928 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 22:13:38,928 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 22:13:38,928 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 22:13:38,928 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 22:13:38,937 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 22:13:38,937 - __main__ - INFO - --------------------------------
2025-12-01 22:13:38,937 - __main__ - INFO - Horizon: 45
2025-12-01 22:13:38,937 - __main__ - INFO - --------------------------------
2025-12-01 22:13:38,938 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 22:13:38,939 - __main__ - INFO - nb_observations recalcul√© pour horizon=45
2025-12-01 22:13:38,940 - __main__ - INFO -    Minimum: 16
2025-12-01 22:13:38,940 - __main__ - INFO -    Maximum: 16
2025-12-01 22:13:38,940 - __main__ - INFO -    Moyenne: 16.0
2025-12-01 22:13:38,940 - __main__ - INFO - Nombre total de features: 55
2025-12-01 22:13:38,940 - __main__ - INFO -    - TO historiques: 15
2025-12-01 22:13:38,940 - __main__ - INFO -    - Features PM: 7
2025-12-01 22:13:38,940 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 22:13:38,940 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 22:13:38,940 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 22:13:38,940 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 22:13:38,940 - __main__ - INFO -    - Autres features: 11
2025-12-01 22:13:39,012 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-45\training_data_before_scaling.csv
2025-12-01 22:13:39,012 - __main__ - INFO -    Shape: (1463, 58)
2025-12-01 22:13:39,012 - __main__ - INFO -    Colonnes: stay_date, hotCode, 55 features, J-0
2025-12-01 22:13:39,012 - __main__ - INFO - X shape: (1463, 55), y shape: (1463,)
2025-12-01 22:13:39,012 - __main__ - INFO - ================================================================================
2025-12-01 22:13:39,012 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 22:13:39,012 - __main__ - INFO - ================================================================================
2025-12-01 22:13:39,016 - __main__ - INFO - Train: (1170, 55), Validation: (293, 55)
2025-12-01 22:13:39,016 - __main__ - INFO - Configuration de la recherche:
2025-12-01 22:13:39,016 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 22:13:39,016 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 22:13:39,016 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 22:13:39,016 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 22:13:39,016 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 22:14:51,216 - __main__ - INFO - ================================================================================
2025-12-01 22:14:51,217 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 22:14:51,217 - __main__ - INFO - ================================================================================
2025-12-01 22:14:51,217 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0917
2025-12-01 22:14:51,217 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 22:14:51,217 - __main__ - INFO -    - subsample: 0.9
2025-12-01 22:14:51,217 - __main__ - INFO -    - reg_lambda: 0.5
2025-12-01 22:14:51,217 - __main__ - INFO -    - reg_alpha: 0.1
2025-12-01 22:14:51,217 - __main__ - INFO -    - n_estimators: 800
2025-12-01 22:14:51,217 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 22:14:51,218 - __main__ - INFO -    - max_depth: 6
2025-12-01 22:14:51,218 - __main__ - INFO -    - learning_rate: 0.01
2025-12-01 22:14:51,218 - __main__ - INFO -    - colsample_bytree: 0.85
2025-12-01 22:14:51,228 - __main__ - INFO - 
Performances sur validation:
2025-12-01 22:14:51,229 - __main__ - INFO -    - MAE: 0.0984
2025-12-01 22:14:51,229 - __main__ - INFO -    - R¬≤: 0.5450
2025-12-01 22:14:51,229 - __main__ - INFO - ================================================================================
2025-12-01 22:14:51,229 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 22:14:51,230 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 22:14:51,232 - __main__ - INFO - Train: (1170, 55), Test: (293, 55)
2025-12-01 22:14:53,633 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 22:14:53,704 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-45\test_predictions.csv
2025-12-01 22:14:53,704 - __main__ - INFO -    Shape: (293, 61)
2025-12-01 22:14:53,705 - __main__ - INFO -    Colonnes: stay_date, hotCode, 55 features + y_test + y_pred + error + abs_error
2025-12-01 22:14:53,705 - __main__ - INFO -    MAE moyen: 0.0984
2025-12-01 22:14:53,713 - __main__ - INFO - üìä Test MAE: 0.0984
2025-12-01 22:14:53,714 - __main__ - INFO - üìä Test R¬≤: 0.5450
2025-12-01 22:14:53,714 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 22:14:54,303 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-45\xgb_scatter_plot.png
2025-12-01 22:14:54,781 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-45\xgb_feature_importance.png
2025-12-01 22:14:54,795 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-45\models...
2025-12-01 22:14:54,842 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-45\models\xgb_to_predictor.joblib
2025-12-01 22:14:54,843 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-45\models\xgb_scaler.joblib
2025-12-01 22:14:54,843 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-45\models\feature_columns.txt
2025-12-01 22:14:54,843 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 22:14:54,843 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 22:14:54,843 - __main__ - INFO -    Container: ml-models
2025-12-01 22:14:55,394 - __main__ - INFO -    Container existant trouv√©
2025-12-01 22:14:55,394 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-45/
2025-12-01 22:14:55,573 - __main__ - INFO -    ‚úì predictTo/D09/J-45/models/xgb_to_predictor.joblib
2025-12-01 22:14:55,592 - __main__ - INFO -    ‚úì predictTo/D09/J-45/models/xgb_scaler.joblib
2025-12-01 22:14:55,619 - __main__ - INFO -    ‚úì predictTo/D09/J-45/models/feature_columns.txt
2025-12-01 22:14:55,635 - __main__ - INFO -    ‚úì predictTo/D09/J-45/xgb_scatter_plot.png
2025-12-01 22:14:55,653 - __main__ - INFO -    ‚úì predictTo/D09/J-45/xgb_feature_importance.png
2025-12-01 22:14:55,751 - __main__ - INFO -    ‚úì predictTo/D09/J-45/training_data_before_scaling.csv
2025-12-01 22:14:55,781 - __main__ - INFO -    ‚úì predictTo/D09/J-45/test_predictions.csv
2025-12-01 22:14:55,781 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 22:14:55,781 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-45/
2025-12-01 22:14:55,783 - __main__ - INFO - ================================================================================
2025-12-01 22:14:55,783 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 22:14:55,783 - __main__ - INFO - ================================================================================
2025-12-01 22:14:55,783 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 22:14:55,783 - __main__ - INFO -    Train MAE:  0.0263
2025-12-01 22:14:55,783 - __main__ - INFO -    Train RMSE: 0.0346
2025-12-01 22:14:55,784 - __main__ - INFO -    Train R¬≤:   0.9582
2025-12-01 22:14:55,784 - __main__ - INFO -    Test MAE:   0.0984
2025-12-01 22:14:55,784 - __main__ - INFO -    Test RMSE:  0.1261
2025-12-01 22:14:55,784 - __main__ - INFO -    Test R¬≤:    0.5450
2025-12-01 22:15:02,321 - __main__ - INFO - ================================================================================
2025-12-01 22:15:02,321 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 22:15:02,321 - __main__ - INFO - ================================================================================
2025-12-01 22:15:02,322 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 22:15:02,327 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 22:15:02,327 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 30
2025-12-01 22:15:02,327 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 22:15:02,327 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 22:15:02,327 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 30, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 22:15:02,327 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 22:15:02,327 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 22:15:02,349 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 22:15:02,604 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 22:15:02,605 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 22:15:02,633 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 22:15:02,633 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 22:15:02,633 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 22:15:02,730 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 22:15:02,760 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 22:15:02,788 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 22:15:02,802 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 22:15:02,802 - __main__ - INFO - Calcul des features PM sur donn√©es J-30 √† J-60 (pas de data leakage)
2025-12-01 22:15:02,802 - __main__ - INFO -    Colonnes PM utilis√©es: 31
2025-12-01 22:15:04,186 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 22:15:04,186 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-30 √† J-60
2025-12-01 22:15:04,186 - __main__ - INFO -    Colonnes Ant utilis√©es: 31
2025-12-01 22:15:05,153 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 22:15:05,153 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-30 √† J-60
2025-12-01 22:15:05,154 - __main__ - INFO -    Colonnes Ds utilis√©es: 31
2025-12-01 22:15:06,167 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 22:15:06,167 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 22:15:06,281 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 22:15:06,281 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 22:15:06,434 - __main__ - INFO -    Features concurrentes calcul√©es sur J-30 √† J-60
2025-12-01 22:15:06,444 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 22:15:08,438 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 22:15:08,443 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 22:15:08,449 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 22:15:08,449 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 22:15:08,801 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 22:15:08,898 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 22:15:08,914 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 22:15:08,914 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 22:15:08,914 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 22:15:08,914 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 22:15:08,915 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 22:15:08,915 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 22:15:08,915 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 22:15:08,920 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 22:15:08,920 - __main__ - INFO - --------------------------------
2025-12-01 22:15:08,920 - __main__ - INFO - Horizon: 30
2025-12-01 22:15:08,920 - __main__ - INFO - --------------------------------
2025-12-01 22:15:08,920 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 22:15:08,921 - __main__ - INFO - nb_observations recalcul√© pour horizon=30
2025-12-01 22:15:08,922 - __main__ - INFO -    Minimum: 31
2025-12-01 22:15:08,922 - __main__ - INFO -    Maximum: 31
2025-12-01 22:15:08,922 - __main__ - INFO -    Moyenne: 31.0
2025-12-01 22:15:08,922 - __main__ - INFO - Nombre total de features: 70
2025-12-01 22:15:08,922 - __main__ - INFO -    - TO historiques: 30
2025-12-01 22:15:08,922 - __main__ - INFO -    - Features PM: 7
2025-12-01 22:15:08,922 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 22:15:08,922 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 22:15:08,922 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 22:15:08,922 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 22:15:08,922 - __main__ - INFO -    - Autres features: 11
2025-12-01 22:15:09,004 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-30\training_data_before_scaling.csv
2025-12-01 22:15:09,004 - __main__ - INFO -    Shape: (1463, 73)
2025-12-01 22:15:09,004 - __main__ - INFO -    Colonnes: stay_date, hotCode, 70 features, J-0
2025-12-01 22:15:09,005 - __main__ - INFO - X shape: (1463, 70), y shape: (1463,)
2025-12-01 22:15:09,005 - __main__ - INFO - ================================================================================
2025-12-01 22:15:09,005 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 22:15:09,005 - __main__ - INFO - ================================================================================
2025-12-01 22:15:09,010 - __main__ - INFO - Train: (1170, 70), Validation: (293, 70)
2025-12-01 22:15:09,010 - __main__ - INFO - Configuration de la recherche:
2025-12-01 22:15:09,010 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 22:15:09,010 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 22:15:09,010 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 22:15:09,010 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 22:15:09,010 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 22:16:39,083 - __main__ - INFO - ================================================================================
2025-12-01 22:16:39,083 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 22:16:39,083 - __main__ - INFO - ================================================================================
2025-12-01 22:16:39,083 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0847
2025-12-01 22:16:39,083 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 22:16:39,083 - __main__ - INFO -    - subsample: 0.9
2025-12-01 22:16:39,083 - __main__ - INFO -    - reg_lambda: 0.5
2025-12-01 22:16:39,083 - __main__ - INFO -    - reg_alpha: 0.1
2025-12-01 22:16:39,083 - __main__ - INFO -    - n_estimators: 800
2025-12-01 22:16:39,083 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 22:16:39,083 - __main__ - INFO -    - max_depth: 6
2025-12-01 22:16:39,083 - __main__ - INFO -    - learning_rate: 0.01
2025-12-01 22:16:39,084 - __main__ - INFO -    - colsample_bytree: 0.85
2025-12-01 22:16:39,089 - __main__ - INFO - 
Performances sur validation:
2025-12-01 22:16:39,089 - __main__ - INFO -    - MAE: 0.0907
2025-12-01 22:16:39,089 - __main__ - INFO -    - R¬≤: 0.6070
2025-12-01 22:16:39,089 - __main__ - INFO - ================================================================================
2025-12-01 22:16:39,089 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 22:16:39,089 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 22:16:39,091 - __main__ - INFO - Train: (1170, 70), Test: (293, 70)
2025-12-01 22:16:41,852 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 22:16:41,925 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-30\test_predictions.csv
2025-12-01 22:16:41,925 - __main__ - INFO -    Shape: (293, 76)
2025-12-01 22:16:41,925 - __main__ - INFO -    Colonnes: stay_date, hotCode, 70 features + y_test + y_pred + error + abs_error
2025-12-01 22:16:41,925 - __main__ - INFO -    MAE moyen: 0.0907
2025-12-01 22:16:41,930 - __main__ - INFO - üìä Test MAE: 0.0907
2025-12-01 22:16:41,930 - __main__ - INFO - üìä Test R¬≤: 0.6070
2025-12-01 22:16:41,931 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 22:16:42,427 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-30\xgb_scatter_plot.png
2025-12-01 22:16:42,780 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-30\xgb_feature_importance.png
2025-12-01 22:16:42,794 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-30\models...
2025-12-01 22:16:42,841 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-30\models\xgb_to_predictor.joblib
2025-12-01 22:16:42,841 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-30\models\xgb_scaler.joblib
2025-12-01 22:16:42,841 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-30\models\feature_columns.txt
2025-12-01 22:16:42,841 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 22:16:42,841 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 22:16:42,842 - __main__ - INFO -    Container: ml-models
2025-12-01 22:16:43,364 - __main__ - INFO -    Container existant trouv√©
2025-12-01 22:16:43,364 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-30/
2025-12-01 22:16:43,492 - __main__ - INFO -    ‚úì predictTo/D09/J-30/models/xgb_to_predictor.joblib
2025-12-01 22:16:43,510 - __main__ - INFO -    ‚úì predictTo/D09/J-30/models/xgb_scaler.joblib
2025-12-01 22:16:43,528 - __main__ - INFO -    ‚úì predictTo/D09/J-30/models/feature_columns.txt
2025-12-01 22:16:43,547 - __main__ - INFO -    ‚úì predictTo/D09/J-30/xgb_scatter_plot.png
2025-12-01 22:16:43,567 - __main__ - INFO -    ‚úì predictTo/D09/J-30/xgb_feature_importance.png
2025-12-01 22:16:43,695 - __main__ - INFO -    ‚úì predictTo/D09/J-30/training_data_before_scaling.csv
2025-12-01 22:16:43,731 - __main__ - INFO -    ‚úì predictTo/D09/J-30/test_predictions.csv
2025-12-01 22:16:43,732 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 22:16:43,732 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-30/
2025-12-01 22:16:43,733 - __main__ - INFO - ================================================================================
2025-12-01 22:16:43,733 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 22:16:43,733 - __main__ - INFO - ================================================================================
2025-12-01 22:16:43,733 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 22:16:43,733 - __main__ - INFO -    Train MAE:  0.0222
2025-12-01 22:16:43,733 - __main__ - INFO -    Train RMSE: 0.0292
2025-12-01 22:16:43,733 - __main__ - INFO -    Train R¬≤:   0.9704
2025-12-01 22:16:43,734 - __main__ - INFO -    Test MAE:   0.0907
2025-12-01 22:16:43,734 - __main__ - INFO -    Test RMSE:  0.1172
2025-12-01 22:16:43,734 - __main__ - INFO -    Test R¬≤:    0.6070
2025-12-01 22:16:49,405 - __main__ - INFO - ================================================================================
2025-12-01 22:16:49,406 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 22:16:49,406 - __main__ - INFO - ================================================================================
2025-12-01 22:16:49,406 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 22:16:49,410 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 22:16:49,410 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 21
2025-12-01 22:16:49,410 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 22:16:49,410 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 22:16:49,410 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 21, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 22:16:49,410 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 22:16:49,410 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 22:16:49,425 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 22:16:49,629 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 22:16:49,629 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 22:16:49,649 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 22:16:49,649 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 22:16:49,649 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 22:16:49,728 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 22:16:49,750 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 22:16:49,773 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 22:16:49,782 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 22:16:49,782 - __main__ - INFO - Calcul des features PM sur donn√©es J-21 √† J-60 (pas de data leakage)
2025-12-01 22:16:49,782 - __main__ - INFO -    Colonnes PM utilis√©es: 40
2025-12-01 22:16:51,095 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 22:16:51,095 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-21 √† J-60
2025-12-01 22:16:51,095 - __main__ - INFO -    Colonnes Ant utilis√©es: 40
2025-12-01 22:16:51,992 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 22:16:51,992 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-21 √† J-60
2025-12-01 22:16:51,992 - __main__ - INFO -    Colonnes Ds utilis√©es: 40
2025-12-01 22:16:52,842 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 22:16:52,842 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 22:16:52,948 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 22:16:52,949 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 22:16:53,103 - __main__ - INFO -    Features concurrentes calcul√©es sur J-21 √† J-60
2025-12-01 22:16:53,115 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 22:16:54,922 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 22:16:54,928 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 22:16:54,934 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 22:16:54,934 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 22:16:55,316 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 22:16:55,415 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 22:16:55,434 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 22:16:55,434 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 22:16:55,434 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 22:16:55,435 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 22:16:55,435 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 22:16:55,435 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 22:16:55,435 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 22:16:55,443 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 22:16:55,443 - __main__ - INFO - --------------------------------
2025-12-01 22:16:55,443 - __main__ - INFO - Horizon: 21
2025-12-01 22:16:55,443 - __main__ - INFO - --------------------------------
2025-12-01 22:16:55,444 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 22:16:55,445 - __main__ - INFO - nb_observations recalcul√© pour horizon=21
2025-12-01 22:16:55,445 - __main__ - INFO -    Minimum: 40
2025-12-01 22:16:55,445 - __main__ - INFO -    Maximum: 40
2025-12-01 22:16:55,445 - __main__ - INFO -    Moyenne: 40.0
2025-12-01 22:16:55,445 - __main__ - INFO - Nombre total de features: 79
2025-12-01 22:16:55,445 - __main__ - INFO -    - TO historiques: 39
2025-12-01 22:16:55,445 - __main__ - INFO -    - Features PM: 7
2025-12-01 22:16:55,445 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 22:16:55,445 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 22:16:55,445 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 22:16:55,445 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 22:16:55,445 - __main__ - INFO -    - Autres features: 11
2025-12-01 22:16:55,545 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-21\training_data_before_scaling.csv
2025-12-01 22:16:55,545 - __main__ - INFO -    Shape: (1463, 82)
2025-12-01 22:16:55,545 - __main__ - INFO -    Colonnes: stay_date, hotCode, 79 features, J-0
2025-12-01 22:16:55,545 - __main__ - INFO - X shape: (1463, 79), y shape: (1463,)
2025-12-01 22:16:55,545 - __main__ - INFO - ================================================================================
2025-12-01 22:16:55,545 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 22:16:55,545 - __main__ - INFO - ================================================================================
2025-12-01 22:16:55,549 - __main__ - INFO - Train: (1170, 79), Validation: (293, 79)
2025-12-01 22:16:55,550 - __main__ - INFO - Configuration de la recherche:
2025-12-01 22:16:55,550 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 22:16:55,550 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 22:16:55,550 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 22:16:55,550 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 22:16:55,550 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 22:18:44,192 - __main__ - INFO - ================================================================================
2025-12-01 22:18:44,193 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 22:18:44,193 - __main__ - INFO - ================================================================================
2025-12-01 22:18:44,193 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0784
2025-12-01 22:18:44,193 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 22:18:44,193 - __main__ - INFO -    - subsample: 0.95
2025-12-01 22:18:44,193 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 22:18:44,193 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 22:18:44,193 - __main__ - INFO -    - n_estimators: 500
2025-12-01 22:18:44,193 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 22:18:44,193 - __main__ - INFO -    - max_depth: 5
2025-12-01 22:18:44,193 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 22:18:44,194 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 22:18:44,202 - __main__ - INFO - 
Performances sur validation:
2025-12-01 22:18:44,203 - __main__ - INFO -    - MAE: 0.0815
2025-12-01 22:18:44,203 - __main__ - INFO -    - R¬≤: 0.6731
2025-12-01 22:18:44,203 - __main__ - INFO - ================================================================================
2025-12-01 22:18:44,204 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 22:18:44,204 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 22:18:44,207 - __main__ - INFO - Train: (1170, 79), Test: (293, 79)
2025-12-01 22:18:47,119 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 22:18:47,210 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-21\test_predictions.csv
2025-12-01 22:18:47,211 - __main__ - INFO -    Shape: (293, 85)
2025-12-01 22:18:47,211 - __main__ - INFO -    Colonnes: stay_date, hotCode, 79 features + y_test + y_pred + error + abs_error
2025-12-01 22:18:47,211 - __main__ - INFO -    MAE moyen: 0.0815
2025-12-01 22:18:47,217 - __main__ - INFO - üìä Test MAE: 0.0815
2025-12-01 22:18:47,217 - __main__ - INFO - üìä Test R¬≤: 0.6731
2025-12-01 22:18:47,217 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 22:18:47,878 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-21\xgb_scatter_plot.png
2025-12-01 22:18:48,275 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-21\xgb_feature_importance.png
2025-12-01 22:18:48,289 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-21\models...
2025-12-01 22:18:48,323 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-21\models\xgb_to_predictor.joblib
2025-12-01 22:18:48,323 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-21\models\xgb_scaler.joblib
2025-12-01 22:18:48,324 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-21\models\feature_columns.txt
2025-12-01 22:18:48,324 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 22:18:48,324 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 22:18:48,324 - __main__ - INFO -    Container: ml-models
2025-12-01 22:18:48,899 - __main__ - INFO -    Container existant trouv√©
2025-12-01 22:18:48,899 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-21/
2025-12-01 22:18:48,972 - __main__ - INFO -    ‚úì predictTo/D09/J-21/models/xgb_to_predictor.joblib
2025-12-01 22:18:48,990 - __main__ - INFO -    ‚úì predictTo/D09/J-21/models/xgb_scaler.joblib
2025-12-01 22:18:49,007 - __main__ - INFO -    ‚úì predictTo/D09/J-21/models/feature_columns.txt
2025-12-01 22:18:49,024 - __main__ - INFO -    ‚úì predictTo/D09/J-21/xgb_scatter_plot.png
2025-12-01 22:18:49,042 - __main__ - INFO -    ‚úì predictTo/D09/J-21/xgb_feature_importance.png
2025-12-01 22:18:49,112 - __main__ - INFO -    ‚úì predictTo/D09/J-21/training_data_before_scaling.csv
2025-12-01 22:18:49,147 - __main__ - INFO -    ‚úì predictTo/D09/J-21/test_predictions.csv
2025-12-01 22:18:49,148 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 22:18:49,148 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-21/
2025-12-01 22:18:49,149 - __main__ - INFO - ================================================================================
2025-12-01 22:18:49,149 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 22:18:49,149 - __main__ - INFO - ================================================================================
2025-12-01 22:18:49,149 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 22:18:49,149 - __main__ - INFO -    Train MAE:  0.0072
2025-12-01 22:18:49,149 - __main__ - INFO -    Train RMSE: 0.0096
2025-12-01 22:18:49,149 - __main__ - INFO -    Train R¬≤:   0.9968
2025-12-01 22:18:49,149 - __main__ - INFO -    Test MAE:   0.0815
2025-12-01 22:18:49,149 - __main__ - INFO -    Test RMSE:  0.1069
2025-12-01 22:18:49,149 - __main__ - INFO -    Test R¬≤:    0.6731
2025-12-01 22:18:55,441 - __main__ - INFO - ================================================================================
2025-12-01 22:18:55,441 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 22:18:55,441 - __main__ - INFO - ================================================================================
2025-12-01 22:18:55,441 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 22:18:55,444 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 22:18:55,445 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 15
2025-12-01 22:18:55,445 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 22:18:55,445 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 22:18:55,445 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 15, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 22:18:55,445 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 22:18:55,445 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 22:18:55,460 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 22:18:55,684 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 22:18:55,684 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 22:18:55,708 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 22:18:55,708 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 22:18:55,709 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 22:18:55,807 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 22:18:55,838 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 22:18:55,862 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 22:18:55,875 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 22:18:55,875 - __main__ - INFO - Calcul des features PM sur donn√©es J-15 √† J-60 (pas de data leakage)
2025-12-01 22:18:55,875 - __main__ - INFO -    Colonnes PM utilis√©es: 46
2025-12-01 22:18:57,158 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 22:18:57,158 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-15 √† J-60
2025-12-01 22:18:57,158 - __main__ - INFO -    Colonnes Ant utilis√©es: 46
2025-12-01 22:18:58,057 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 22:18:58,057 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-15 √† J-60
2025-12-01 22:18:58,057 - __main__ - INFO -    Colonnes Ds utilis√©es: 46
2025-12-01 22:18:58,888 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 22:18:58,888 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 22:18:58,994 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 22:18:58,994 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 22:18:59,143 - __main__ - INFO -    Features concurrentes calcul√©es sur J-15 √† J-60
2025-12-01 22:18:59,155 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 22:19:01,263 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 22:19:01,269 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 22:19:01,276 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 22:19:01,276 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 22:19:01,673 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 22:19:01,793 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 22:19:01,811 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 22:19:01,811 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 22:19:01,811 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 22:19:01,812 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 22:19:01,812 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 22:19:01,812 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 22:19:01,812 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 22:19:01,820 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 22:19:01,820 - __main__ - INFO - --------------------------------
2025-12-01 22:19:01,820 - __main__ - INFO - Horizon: 15
2025-12-01 22:19:01,820 - __main__ - INFO - --------------------------------
2025-12-01 22:19:01,821 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 22:19:01,822 - __main__ - INFO - nb_observations recalcul√© pour horizon=15
2025-12-01 22:19:01,823 - __main__ - INFO -    Minimum: 46
2025-12-01 22:19:01,823 - __main__ - INFO -    Maximum: 46
2025-12-01 22:19:01,823 - __main__ - INFO -    Moyenne: 46.0
2025-12-01 22:19:01,823 - __main__ - INFO - Nombre total de features: 85
2025-12-01 22:19:01,823 - __main__ - INFO -    - TO historiques: 45
2025-12-01 22:19:01,823 - __main__ - INFO -    - Features PM: 7
2025-12-01 22:19:01,823 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 22:19:01,823 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 22:19:01,823 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 22:19:01,824 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 22:19:01,824 - __main__ - INFO -    - Autres features: 11
2025-12-01 22:19:01,938 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-15\training_data_before_scaling.csv
2025-12-01 22:19:01,939 - __main__ - INFO -    Shape: (1463, 88)
2025-12-01 22:19:01,939 - __main__ - INFO -    Colonnes: stay_date, hotCode, 85 features, J-0
2025-12-01 22:19:01,939 - __main__ - INFO - X shape: (1463, 85), y shape: (1463,)
2025-12-01 22:19:01,939 - __main__ - INFO - ================================================================================
2025-12-01 22:19:01,939 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 22:19:01,939 - __main__ - INFO - ================================================================================
2025-12-01 22:19:01,944 - __main__ - INFO - Train: (1170, 85), Validation: (293, 85)
2025-12-01 22:19:01,944 - __main__ - INFO - Configuration de la recherche:
2025-12-01 22:19:01,944 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 22:19:01,944 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 22:19:01,944 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 22:19:01,944 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 22:19:01,944 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 22:20:53,720 - __main__ - INFO - ================================================================================
2025-12-01 22:20:53,720 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 22:20:53,720 - __main__ - INFO - ================================================================================
2025-12-01 22:20:53,720 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0741
2025-12-01 22:20:53,720 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 22:20:53,720 - __main__ - INFO -    - subsample: 0.95
2025-12-01 22:20:53,720 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 22:20:53,720 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 22:20:53,720 - __main__ - INFO -    - n_estimators: 500
2025-12-01 22:20:53,720 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 22:20:53,720 - __main__ - INFO -    - max_depth: 5
2025-12-01 22:20:53,721 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 22:20:53,721 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 22:20:53,725 - __main__ - INFO - 
Performances sur validation:
2025-12-01 22:20:53,725 - __main__ - INFO -    - MAE: 0.0756
2025-12-01 22:20:53,725 - __main__ - INFO -    - R¬≤: 0.7411
2025-12-01 22:20:53,725 - __main__ - INFO - ================================================================================
2025-12-01 22:20:53,726 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 22:20:53,726 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 22:20:53,728 - __main__ - INFO - Train: (1170, 85), Test: (293, 85)
2025-12-01 22:20:55,596 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 22:20:55,707 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-15\test_predictions.csv
2025-12-01 22:20:55,707 - __main__ - INFO -    Shape: (293, 91)
2025-12-01 22:20:55,707 - __main__ - INFO -    Colonnes: stay_date, hotCode, 85 features + y_test + y_pred + error + abs_error
2025-12-01 22:20:55,708 - __main__ - INFO -    MAE moyen: 0.0756
2025-12-01 22:20:55,713 - __main__ - INFO - üìä Test MAE: 0.0756
2025-12-01 22:20:55,713 - __main__ - INFO - üìä Test R¬≤: 0.7411
2025-12-01 22:20:55,714 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 22:20:56,281 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-15\xgb_scatter_plot.png
2025-12-01 22:20:56,657 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-15\xgb_feature_importance.png
2025-12-01 22:20:56,670 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-15\models...
2025-12-01 22:20:56,701 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-15\models\xgb_to_predictor.joblib
2025-12-01 22:20:56,701 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-15\models\xgb_scaler.joblib
2025-12-01 22:20:56,701 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-15\models\feature_columns.txt
2025-12-01 22:20:56,701 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 22:20:56,701 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 22:20:56,702 - __main__ - INFO -    Container: ml-models
2025-12-01 22:20:57,265 - __main__ - INFO -    Container existant trouv√©
2025-12-01 22:20:57,265 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-15/
2025-12-01 22:20:57,404 - __main__ - INFO -    ‚úì predictTo/D09/J-15/models/xgb_to_predictor.joblib
2025-12-01 22:20:57,428 - __main__ - INFO -    ‚úì predictTo/D09/J-15/models/xgb_scaler.joblib
2025-12-01 22:20:57,453 - __main__ - INFO -    ‚úì predictTo/D09/J-15/models/feature_columns.txt
2025-12-01 22:20:57,472 - __main__ - INFO -    ‚úì predictTo/D09/J-15/xgb_scatter_plot.png
2025-12-01 22:20:57,491 - __main__ - INFO -    ‚úì predictTo/D09/J-15/xgb_feature_importance.png
2025-12-01 22:20:57,575 - __main__ - INFO -    ‚úì predictTo/D09/J-15/training_data_before_scaling.csv
2025-12-01 22:20:57,616 - __main__ - INFO -    ‚úì predictTo/D09/J-15/test_predictions.csv
2025-12-01 22:20:57,616 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 22:20:57,616 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-15/
2025-12-01 22:20:57,617 - __main__ - INFO - ================================================================================
2025-12-01 22:20:57,617 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 22:20:57,617 - __main__ - INFO - ================================================================================
2025-12-01 22:20:57,618 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 22:20:57,618 - __main__ - INFO -    Train MAE:  0.0067
2025-12-01 22:20:57,618 - __main__ - INFO -    Train RMSE: 0.0091
2025-12-01 22:20:57,618 - __main__ - INFO -    Train R¬≤:   0.9971
2025-12-01 22:20:57,618 - __main__ - INFO -    Test MAE:   0.0756
2025-12-01 22:20:57,618 - __main__ - INFO -    Test RMSE:  0.0951
2025-12-01 22:20:57,618 - __main__ - INFO -    Test R¬≤:    0.7411
2025-12-01 22:21:03,756 - __main__ - INFO - ================================================================================
2025-12-01 22:21:03,756 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 22:21:03,756 - __main__ - INFO - ================================================================================
2025-12-01 22:21:03,756 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 22:21:03,760 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 22:21:03,760 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 10
2025-12-01 22:21:03,760 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 22:21:03,760 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 22:21:03,760 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 10, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 22:21:03,760 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 22:21:03,760 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 22:21:03,774 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 22:21:04,009 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 22:21:04,009 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 22:21:04,029 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 22:21:04,029 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 22:21:04,029 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 22:21:04,111 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 22:21:04,137 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 22:21:04,167 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 22:21:04,179 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 22:21:04,179 - __main__ - INFO - Calcul des features PM sur donn√©es J-10 √† J-60 (pas de data leakage)
2025-12-01 22:21:04,179 - __main__ - INFO -    Colonnes PM utilis√©es: 51
2025-12-01 22:21:05,628 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 22:21:05,629 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-10 √† J-60
2025-12-01 22:21:05,629 - __main__ - INFO -    Colonnes Ant utilis√©es: 51
2025-12-01 22:21:06,474 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 22:21:06,474 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-10 √† J-60
2025-12-01 22:21:06,475 - __main__ - INFO -    Colonnes Ds utilis√©es: 51
2025-12-01 22:21:07,320 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 22:21:07,320 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 22:21:07,419 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 22:21:07,420 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 22:21:07,589 - __main__ - INFO -    Features concurrentes calcul√©es sur J-10 √† J-60
2025-12-01 22:21:07,600 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 22:21:09,403 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 22:21:09,408 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 22:21:09,414 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 22:21:09,414 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 22:21:09,796 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 22:21:09,905 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 22:21:09,926 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 22:21:09,926 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 22:21:09,927 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 22:21:09,927 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 22:21:09,928 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 22:21:09,928 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 22:21:09,928 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 22:21:09,934 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 22:21:09,934 - __main__ - INFO - --------------------------------
2025-12-01 22:21:09,934 - __main__ - INFO - Horizon: 10
2025-12-01 22:21:09,934 - __main__ - INFO - --------------------------------
2025-12-01 22:21:09,935 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 22:21:09,938 - __main__ - INFO - nb_observations recalcul√© pour horizon=10
2025-12-01 22:21:09,939 - __main__ - INFO -    Minimum: 51
2025-12-01 22:21:09,939 - __main__ - INFO -    Maximum: 51
2025-12-01 22:21:09,939 - __main__ - INFO -    Moyenne: 51.0
2025-12-01 22:21:09,939 - __main__ - INFO - Nombre total de features: 90
2025-12-01 22:21:09,939 - __main__ - INFO -    - TO historiques: 50
2025-12-01 22:21:09,939 - __main__ - INFO -    - Features PM: 7
2025-12-01 22:21:09,939 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 22:21:09,939 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 22:21:09,940 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 22:21:09,940 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 22:21:09,940 - __main__ - INFO -    - Autres features: 11
2025-12-01 22:21:10,051 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-10\training_data_before_scaling.csv
2025-12-01 22:21:10,052 - __main__ - INFO -    Shape: (1463, 93)
2025-12-01 22:21:10,052 - __main__ - INFO -    Colonnes: stay_date, hotCode, 90 features, J-0
2025-12-01 22:21:10,052 - __main__ - INFO - X shape: (1463, 90), y shape: (1463,)
2025-12-01 22:21:10,052 - __main__ - INFO - ================================================================================
2025-12-01 22:21:10,052 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 22:21:10,052 - __main__ - INFO - ================================================================================
2025-12-01 22:21:10,057 - __main__ - INFO - Train: (1170, 90), Validation: (293, 90)
2025-12-01 22:21:10,057 - __main__ - INFO - Configuration de la recherche:
2025-12-01 22:21:10,057 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 22:21:10,057 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 22:21:10,057 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 22:21:10,057 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 22:21:10,057 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 22:23:08,574 - __main__ - INFO - ================================================================================
2025-12-01 22:23:08,574 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 22:23:08,574 - __main__ - INFO - ================================================================================
2025-12-01 22:23:08,574 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0652
2025-12-01 22:23:08,575 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 22:23:08,575 - __main__ - INFO -    - subsample: 0.95
2025-12-01 22:23:08,575 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 22:23:08,575 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 22:23:08,575 - __main__ - INFO -    - n_estimators: 500
2025-12-01 22:23:08,575 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 22:23:08,575 - __main__ - INFO -    - max_depth: 5
2025-12-01 22:23:08,575 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 22:23:08,575 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 22:23:08,579 - __main__ - INFO - 
Performances sur validation:
2025-12-01 22:23:08,579 - __main__ - INFO -    - MAE: 0.0662
2025-12-01 22:23:08,580 - __main__ - INFO -    - R¬≤: 0.7984
2025-12-01 22:23:08,580 - __main__ - INFO - ================================================================================
2025-12-01 22:23:08,580 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 22:23:08,580 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 22:23:08,583 - __main__ - INFO - Train: (1170, 90), Test: (293, 90)
2025-12-01 22:23:10,379 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 22:23:10,478 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-10\test_predictions.csv
2025-12-01 22:23:10,479 - __main__ - INFO -    Shape: (293, 96)
2025-12-01 22:23:10,479 - __main__ - INFO -    Colonnes: stay_date, hotCode, 90 features + y_test + y_pred + error + abs_error
2025-12-01 22:23:10,479 - __main__ - INFO -    MAE moyen: 0.0662
2025-12-01 22:23:10,485 - __main__ - INFO - üìä Test MAE: 0.0662
2025-12-01 22:23:10,485 - __main__ - INFO - üìä Test R¬≤: 0.7984
2025-12-01 22:23:10,486 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 22:23:10,941 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-10\xgb_scatter_plot.png
2025-12-01 22:23:11,258 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-10\xgb_feature_importance.png
2025-12-01 22:23:11,272 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-10\models...
2025-12-01 22:23:11,303 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-10\models\xgb_to_predictor.joblib
2025-12-01 22:23:11,303 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-10\models\xgb_scaler.joblib
2025-12-01 22:23:11,303 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-10\models\feature_columns.txt
2025-12-01 22:23:11,303 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 22:23:11,304 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 22:23:11,304 - __main__ - INFO -    Container: ml-models
2025-12-01 22:23:11,810 - __main__ - INFO -    Container existant trouv√©
2025-12-01 22:23:11,810 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-10/
2025-12-01 22:23:11,899 - __main__ - INFO -    ‚úì predictTo/D09/J-10/models/xgb_to_predictor.joblib
2025-12-01 22:23:11,916 - __main__ - INFO -    ‚úì predictTo/D09/J-10/models/xgb_scaler.joblib
2025-12-01 22:23:11,931 - __main__ - INFO -    ‚úì predictTo/D09/J-10/models/feature_columns.txt
2025-12-01 22:23:11,950 - __main__ - INFO -    ‚úì predictTo/D09/J-10/xgb_scatter_plot.png
2025-12-01 22:23:11,967 - __main__ - INFO -    ‚úì predictTo/D09/J-10/xgb_feature_importance.png
2025-12-01 22:23:12,087 - __main__ - INFO -    ‚úì predictTo/D09/J-10/training_data_before_scaling.csv
2025-12-01 22:23:12,125 - __main__ - INFO -    ‚úì predictTo/D09/J-10/test_predictions.csv
2025-12-01 22:23:12,125 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 22:23:12,125 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-10/
2025-12-01 22:23:12,127 - __main__ - INFO - ================================================================================
2025-12-01 22:23:12,127 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 22:23:12,127 - __main__ - INFO - ================================================================================
2025-12-01 22:23:12,127 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 22:23:12,127 - __main__ - INFO -    Train MAE:  0.0051
2025-12-01 22:23:12,127 - __main__ - INFO -    Train RMSE: 0.0070
2025-12-01 22:23:12,127 - __main__ - INFO -    Train R¬≤:   0.9983
2025-12-01 22:23:12,127 - __main__ - INFO -    Test MAE:   0.0662
2025-12-01 22:23:12,127 - __main__ - INFO -    Test RMSE:  0.0839
2025-12-01 22:23:12,127 - __main__ - INFO -    Test R¬≤:    0.7984
2025-12-01 22:23:17,854 - __main__ - INFO - ================================================================================
2025-12-01 22:23:17,855 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 22:23:17,855 - __main__ - INFO - ================================================================================
2025-12-01 22:23:17,855 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 22:23:17,861 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 22:23:17,861 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 7
2025-12-01 22:23:17,861 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 22:23:17,861 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 22:23:17,861 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 22:23:17,861 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 22:23:17,861 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 22:23:17,882 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 22:23:18,105 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 22:23:18,105 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 22:23:18,125 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 22:23:18,125 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 22:23:18,125 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 22:23:18,208 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 22:23:18,232 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 22:23:18,258 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 22:23:18,270 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 22:23:18,270 - __main__ - INFO - Calcul des features PM sur donn√©es J-7 √† J-60 (pas de data leakage)
2025-12-01 22:23:18,270 - __main__ - INFO -    Colonnes PM utilis√©es: 54
2025-12-01 22:23:19,589 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 22:23:19,590 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-7 √† J-60
2025-12-01 22:23:19,590 - __main__ - INFO -    Colonnes Ant utilis√©es: 54
2025-12-01 22:23:20,457 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 22:23:20,457 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-7 √† J-60
2025-12-01 22:23:20,457 - __main__ - INFO -    Colonnes Ds utilis√©es: 54
2025-12-01 22:23:21,301 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 22:23:21,301 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 22:23:21,416 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 22:23:21,416 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 22:23:21,558 - __main__ - INFO -    Features concurrentes calcul√©es sur J-7 √† J-60
2025-12-01 22:23:21,576 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 22:23:23,456 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 22:23:23,462 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 22:23:23,468 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 22:23:23,468 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 22:23:23,898 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 22:23:23,994 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 22:23:24,009 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 22:23:24,009 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 22:23:24,009 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 22:23:24,009 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 22:23:24,009 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 22:23:24,010 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 22:23:24,010 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 22:23:24,017 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 22:23:24,017 - __main__ - INFO - --------------------------------
2025-12-01 22:23:24,017 - __main__ - INFO - Horizon: 7
2025-12-01 22:23:24,017 - __main__ - INFO - --------------------------------
2025-12-01 22:23:24,017 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 22:23:24,018 - __main__ - INFO - nb_observations recalcul√© pour horizon=7
2025-12-01 22:23:24,019 - __main__ - INFO -    Minimum: 54
2025-12-01 22:23:24,019 - __main__ - INFO -    Maximum: 54
2025-12-01 22:23:24,019 - __main__ - INFO -    Moyenne: 54.0
2025-12-01 22:23:24,019 - __main__ - INFO - Nombre total de features: 93
2025-12-01 22:23:24,019 - __main__ - INFO -    - TO historiques: 53
2025-12-01 22:23:24,019 - __main__ - INFO -    - Features PM: 7
2025-12-01 22:23:24,019 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 22:23:24,019 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 22:23:24,019 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 22:23:24,019 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 22:23:24,019 - __main__ - INFO -    - Autres features: 11
2025-12-01 22:23:24,138 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-7\training_data_before_scaling.csv
2025-12-01 22:23:24,138 - __main__ - INFO -    Shape: (1463, 96)
2025-12-01 22:23:24,138 - __main__ - INFO -    Colonnes: stay_date, hotCode, 93 features, J-0
2025-12-01 22:23:24,138 - __main__ - INFO - X shape: (1463, 93), y shape: (1463,)
2025-12-01 22:23:24,138 - __main__ - INFO - ================================================================================
2025-12-01 22:23:24,138 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 22:23:24,138 - __main__ - INFO - ================================================================================
2025-12-01 22:23:24,143 - __main__ - INFO - Train: (1170, 93), Validation: (293, 93)
2025-12-01 22:23:24,143 - __main__ - INFO - Configuration de la recherche:
2025-12-01 22:23:24,143 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 22:23:24,143 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 22:23:24,143 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 22:23:24,143 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 22:23:24,143 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 22:25:23,931 - __main__ - INFO - ================================================================================
2025-12-01 22:25:23,931 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 22:25:23,931 - __main__ - INFO - ================================================================================
2025-12-01 22:25:23,932 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0599
2025-12-01 22:25:23,932 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 22:25:23,932 - __main__ - INFO -    - subsample: 0.95
2025-12-01 22:25:23,932 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 22:25:23,932 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 22:25:23,932 - __main__ - INFO -    - n_estimators: 500
2025-12-01 22:25:23,932 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 22:25:23,932 - __main__ - INFO -    - max_depth: 5
2025-12-01 22:25:23,932 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 22:25:23,932 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 22:25:23,937 - __main__ - INFO - 
Performances sur validation:
2025-12-01 22:25:23,937 - __main__ - INFO -    - MAE: 0.0646
2025-12-01 22:25:23,937 - __main__ - INFO -    - R¬≤: 0.8043
2025-12-01 22:25:23,937 - __main__ - INFO - ================================================================================
2025-12-01 22:25:23,938 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 22:25:23,938 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 22:25:23,941 - __main__ - INFO - Train: (1170, 93), Test: (293, 93)
2025-12-01 22:25:25,777 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 22:25:25,874 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-7\test_predictions.csv
2025-12-01 22:25:25,874 - __main__ - INFO -    Shape: (293, 99)
2025-12-01 22:25:25,874 - __main__ - INFO -    Colonnes: stay_date, hotCode, 93 features + y_test + y_pred + error + abs_error
2025-12-01 22:25:25,875 - __main__ - INFO -    MAE moyen: 0.0646
2025-12-01 22:25:25,881 - __main__ - INFO - üìä Test MAE: 0.0646
2025-12-01 22:25:25,881 - __main__ - INFO - üìä Test R¬≤: 0.8043
2025-12-01 22:25:25,882 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 22:25:26,423 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-7\xgb_scatter_plot.png
2025-12-01 22:25:26,802 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-7\xgb_feature_importance.png
2025-12-01 22:25:26,817 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-7\models...
2025-12-01 22:25:26,848 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-7\models\xgb_to_predictor.joblib
2025-12-01 22:25:26,849 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-7\models\xgb_scaler.joblib
2025-12-01 22:25:26,849 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-7\models\feature_columns.txt
2025-12-01 22:25:26,849 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 22:25:26,849 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 22:25:26,849 - __main__ - INFO -    Container: ml-models
2025-12-01 22:25:27,447 - __main__ - INFO -    Container existant trouv√©
2025-12-01 22:25:27,447 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-7/
2025-12-01 22:25:27,525 - __main__ - INFO -    ‚úì predictTo/D09/J-7/models/xgb_to_predictor.joblib
2025-12-01 22:25:27,543 - __main__ - INFO -    ‚úì predictTo/D09/J-7/models/xgb_scaler.joblib
2025-12-01 22:25:27,560 - __main__ - INFO -    ‚úì predictTo/D09/J-7/models/feature_columns.txt
2025-12-01 22:25:27,578 - __main__ - INFO -    ‚úì predictTo/D09/J-7/xgb_scatter_plot.png
2025-12-01 22:25:27,597 - __main__ - INFO -    ‚úì predictTo/D09/J-7/xgb_feature_importance.png
2025-12-01 22:25:27,690 - __main__ - INFO -    ‚úì predictTo/D09/J-7/training_data_before_scaling.csv
2025-12-01 22:25:27,732 - __main__ - INFO -    ‚úì predictTo/D09/J-7/test_predictions.csv
2025-12-01 22:25:27,733 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 22:25:27,733 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-7/
2025-12-01 22:25:27,734 - __main__ - INFO - ================================================================================
2025-12-01 22:25:27,734 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 22:25:27,734 - __main__ - INFO - ================================================================================
2025-12-01 22:25:27,734 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 22:25:27,734 - __main__ - INFO -    Train MAE:  0.0050
2025-12-01 22:25:27,734 - __main__ - INFO -    Train RMSE: 0.0068
2025-12-01 22:25:27,734 - __main__ - INFO -    Train R¬≤:   0.9984
2025-12-01 22:25:27,734 - __main__ - INFO -    Test MAE:   0.0646
2025-12-01 22:25:27,734 - __main__ - INFO -    Test RMSE:  0.0827
2025-12-01 22:25:27,734 - __main__ - INFO -    Test R¬≤:    0.8043
2025-12-01 22:25:33,994 - __main__ - INFO - ================================================================================
2025-12-01 22:25:33,994 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 22:25:33,994 - __main__ - INFO - ================================================================================
2025-12-01 22:25:33,994 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 22:25:33,999 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 22:25:33,999 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 5
2025-12-01 22:25:33,999 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 22:25:33,999 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 22:25:33,999 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 5, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 22:25:33,999 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 22:25:33,999 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 22:25:34,012 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 22:25:34,219 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 22:25:34,219 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 22:25:34,240 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 22:25:34,240 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 22:25:34,240 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 22:25:34,323 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 22:25:34,349 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 22:25:34,374 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 22:25:34,386 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 22:25:34,386 - __main__ - INFO - Calcul des features PM sur donn√©es J-5 √† J-60 (pas de data leakage)
2025-12-01 22:25:34,386 - __main__ - INFO -    Colonnes PM utilis√©es: 56
2025-12-01 22:25:35,585 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 22:25:35,585 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-5 √† J-60
2025-12-01 22:25:35,585 - __main__ - INFO -    Colonnes Ant utilis√©es: 56
2025-12-01 22:25:36,386 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 22:25:36,387 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-5 √† J-60
2025-12-01 22:25:36,387 - __main__ - INFO -    Colonnes Ds utilis√©es: 56
2025-12-01 22:25:37,273 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 22:25:37,273 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 22:25:37,376 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 22:25:37,376 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 22:25:37,514 - __main__ - INFO -    Features concurrentes calcul√©es sur J-5 √† J-60
2025-12-01 22:25:37,526 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 22:25:39,339 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 22:25:39,344 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 22:25:39,350 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 22:25:39,350 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 22:25:39,762 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 22:25:39,877 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 22:25:39,901 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 22:25:39,902 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 22:25:39,902 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 22:25:39,903 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 22:25:39,903 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 22:25:39,903 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 22:25:39,903 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 22:25:39,909 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 22:25:39,909 - __main__ - INFO - --------------------------------
2025-12-01 22:25:39,909 - __main__ - INFO - Horizon: 5
2025-12-01 22:25:39,909 - __main__ - INFO - --------------------------------
2025-12-01 22:25:39,910 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 22:25:39,911 - __main__ - INFO - nb_observations recalcul√© pour horizon=5
2025-12-01 22:25:39,911 - __main__ - INFO -    Minimum: 56
2025-12-01 22:25:39,911 - __main__ - INFO -    Maximum: 56
2025-12-01 22:25:39,912 - __main__ - INFO -    Moyenne: 56.0
2025-12-01 22:25:39,912 - __main__ - INFO - Nombre total de features: 95
2025-12-01 22:25:39,912 - __main__ - INFO -    - TO historiques: 55
2025-12-01 22:25:39,912 - __main__ - INFO -    - Features PM: 7
2025-12-01 22:25:39,912 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 22:25:39,912 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 22:25:39,912 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 22:25:39,912 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 22:25:39,912 - __main__ - INFO -    - Autres features: 11
2025-12-01 22:25:40,046 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-5\training_data_before_scaling.csv
2025-12-01 22:25:40,046 - __main__ - INFO -    Shape: (1463, 98)
2025-12-01 22:25:40,046 - __main__ - INFO -    Colonnes: stay_date, hotCode, 95 features, J-0
2025-12-01 22:25:40,047 - __main__ - INFO - X shape: (1463, 95), y shape: (1463,)
2025-12-01 22:25:40,047 - __main__ - INFO - ================================================================================
2025-12-01 22:25:40,047 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 22:25:40,047 - __main__ - INFO - ================================================================================
2025-12-01 22:25:40,053 - __main__ - INFO - Train: (1170, 95), Validation: (293, 95)
2025-12-01 22:25:40,053 - __main__ - INFO - Configuration de la recherche:
2025-12-01 22:25:40,054 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 22:25:40,054 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 22:25:40,054 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 22:25:40,054 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 22:25:40,054 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 22:27:38,591 - __main__ - INFO - ================================================================================
2025-12-01 22:27:38,591 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 22:27:38,591 - __main__ - INFO - ================================================================================
2025-12-01 22:27:38,591 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0539
2025-12-01 22:27:38,591 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 22:27:38,591 - __main__ - INFO -    - subsample: 0.95
2025-12-01 22:27:38,591 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 22:27:38,591 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 22:27:38,591 - __main__ - INFO -    - n_estimators: 500
2025-12-01 22:27:38,591 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 22:27:38,592 - __main__ - INFO -    - max_depth: 5
2025-12-01 22:27:38,592 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 22:27:38,592 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 22:27:38,596 - __main__ - INFO - 
Performances sur validation:
2025-12-01 22:27:38,596 - __main__ - INFO -    - MAE: 0.0598
2025-12-01 22:27:38,597 - __main__ - INFO -    - R¬≤: 0.8347
2025-12-01 22:27:38,597 - __main__ - INFO - ================================================================================
2025-12-01 22:27:38,597 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 22:27:38,597 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 22:27:38,599 - __main__ - INFO - Train: (1170, 95), Test: (293, 95)
2025-12-01 22:27:40,448 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 22:27:40,547 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-5\test_predictions.csv
2025-12-01 22:27:40,547 - __main__ - INFO -    Shape: (293, 101)
2025-12-01 22:27:40,547 - __main__ - INFO -    Colonnes: stay_date, hotCode, 95 features + y_test + y_pred + error + abs_error
2025-12-01 22:27:40,548 - __main__ - INFO -    MAE moyen: 0.0598
2025-12-01 22:27:40,554 - __main__ - INFO - üìä Test MAE: 0.0598
2025-12-01 22:27:40,555 - __main__ - INFO - üìä Test R¬≤: 0.8347
2025-12-01 22:27:40,555 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 22:27:41,087 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-5\xgb_scatter_plot.png
2025-12-01 22:27:41,409 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-5\xgb_feature_importance.png
2025-12-01 22:27:41,420 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-5\models...
2025-12-01 22:27:41,449 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-5\models\xgb_to_predictor.joblib
2025-12-01 22:27:41,449 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-5\models\xgb_scaler.joblib
2025-12-01 22:27:41,449 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-5\models\feature_columns.txt
2025-12-01 22:27:41,449 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 22:27:41,450 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 22:27:41,450 - __main__ - INFO -    Container: ml-models
2025-12-01 22:27:41,959 - __main__ - INFO -    Container existant trouv√©
2025-12-01 22:27:41,959 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-5/
2025-12-01 22:27:42,067 - __main__ - INFO -    ‚úì predictTo/D09/J-5/models/xgb_to_predictor.joblib
2025-12-01 22:27:42,086 - __main__ - INFO -    ‚úì predictTo/D09/J-5/models/xgb_scaler.joblib
2025-12-01 22:27:42,104 - __main__ - INFO -    ‚úì predictTo/D09/J-5/models/feature_columns.txt
2025-12-01 22:27:42,121 - __main__ - INFO -    ‚úì predictTo/D09/J-5/xgb_scatter_plot.png
2025-12-01 22:27:42,137 - __main__ - INFO -    ‚úì predictTo/D09/J-5/xgb_feature_importance.png
2025-12-01 22:27:42,301 - __main__ - INFO -    ‚úì predictTo/D09/J-5/training_data_before_scaling.csv
2025-12-01 22:27:42,343 - __main__ - INFO -    ‚úì predictTo/D09/J-5/test_predictions.csv
2025-12-01 22:27:42,344 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 22:27:42,344 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-5/
2025-12-01 22:27:42,345 - __main__ - INFO - ================================================================================
2025-12-01 22:27:42,345 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 22:27:42,345 - __main__ - INFO - ================================================================================
2025-12-01 22:27:42,345 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 22:27:42,345 - __main__ - INFO -    Train MAE:  0.0045
2025-12-01 22:27:42,345 - __main__ - INFO -    Train RMSE: 0.0061
2025-12-01 22:27:42,345 - __main__ - INFO -    Train R¬≤:   0.9987
2025-12-01 22:27:42,345 - __main__ - INFO -    Test MAE:   0.0598
2025-12-01 22:27:42,345 - __main__ - INFO -    Test RMSE:  0.0760
2025-12-01 22:27:42,345 - __main__ - INFO -    Test R¬≤:    0.8347
2025-12-01 22:27:48,004 - __main__ - INFO - ================================================================================
2025-12-01 22:27:48,005 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 22:27:48,005 - __main__ - INFO - ================================================================================
2025-12-01 22:27:48,005 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 22:27:48,008 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 22:27:48,008 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 3
2025-12-01 22:27:48,008 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 22:27:48,008 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 22:27:48,008 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 3, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 22:27:48,008 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 22:27:48,008 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 22:27:48,023 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 22:27:48,243 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 22:27:48,243 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 22:27:48,262 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 22:27:48,263 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 22:27:48,263 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 22:27:48,336 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 22:27:48,359 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 22:27:48,381 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 22:27:48,392 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 22:27:48,392 - __main__ - INFO - Calcul des features PM sur donn√©es J-3 √† J-60 (pas de data leakage)
2025-12-01 22:27:48,392 - __main__ - INFO -    Colonnes PM utilis√©es: 58
2025-12-01 22:27:49,507 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 22:27:49,507 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-3 √† J-60
2025-12-01 22:27:49,507 - __main__ - INFO -    Colonnes Ant utilis√©es: 58
2025-12-01 22:27:50,310 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 22:27:50,310 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-3 √† J-60
2025-12-01 22:27:50,310 - __main__ - INFO -    Colonnes Ds utilis√©es: 58
2025-12-01 22:27:51,138 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 22:27:51,138 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 22:27:51,244 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 22:27:51,244 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 22:27:51,391 - __main__ - INFO -    Features concurrentes calcul√©es sur J-3 √† J-60
2025-12-01 22:27:51,402 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 22:27:53,322 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 22:27:53,327 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 22:27:53,333 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 22:27:53,334 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 22:27:53,724 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 22:27:53,836 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 22:27:53,857 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 22:27:53,857 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 22:27:53,857 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 22:27:53,857 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 22:27:53,857 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 22:27:53,858 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 22:27:53,858 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 22:27:53,866 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 22:27:53,866 - __main__ - INFO - --------------------------------
2025-12-01 22:27:53,866 - __main__ - INFO - Horizon: 3
2025-12-01 22:27:53,866 - __main__ - INFO - --------------------------------
2025-12-01 22:27:53,866 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 22:27:53,868 - __main__ - INFO - nb_observations recalcul√© pour horizon=3
2025-12-01 22:27:53,868 - __main__ - INFO -    Minimum: 58
2025-12-01 22:27:53,868 - __main__ - INFO -    Maximum: 58
2025-12-01 22:27:53,868 - __main__ - INFO -    Moyenne: 58.0
2025-12-01 22:27:53,868 - __main__ - INFO - Nombre total de features: 97
2025-12-01 22:27:53,868 - __main__ - INFO -    - TO historiques: 57
2025-12-01 22:27:53,868 - __main__ - INFO -    - Features PM: 7
2025-12-01 22:27:53,868 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 22:27:53,868 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 22:27:53,868 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 22:27:53,868 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 22:27:53,868 - __main__ - INFO -    - Autres features: 11
2025-12-01 22:27:53,998 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-3\training_data_before_scaling.csv
2025-12-01 22:27:53,999 - __main__ - INFO -    Shape: (1463, 100)
2025-12-01 22:27:53,999 - __main__ - INFO -    Colonnes: stay_date, hotCode, 97 features, J-0
2025-12-01 22:27:53,999 - __main__ - INFO - X shape: (1463, 97), y shape: (1463,)
2025-12-01 22:27:53,999 - __main__ - INFO - ================================================================================
2025-12-01 22:27:53,999 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 22:27:53,999 - __main__ - INFO - ================================================================================
2025-12-01 22:27:54,004 - __main__ - INFO - Train: (1170, 97), Validation: (293, 97)
2025-12-01 22:27:54,004 - __main__ - INFO - Configuration de la recherche:
2025-12-01 22:27:54,004 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 22:27:54,004 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 22:27:54,004 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 22:27:54,004 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 22:27:54,004 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 22:29:47,452 - __main__ - INFO - ================================================================================
2025-12-01 22:29:47,452 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 22:29:47,452 - __main__ - INFO - ================================================================================
2025-12-01 22:29:47,453 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0496
2025-12-01 22:29:47,453 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 22:29:47,453 - __main__ - INFO -    - subsample: 0.95
2025-12-01 22:29:47,453 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 22:29:47,453 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 22:29:47,453 - __main__ - INFO -    - n_estimators: 500
2025-12-01 22:29:47,453 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 22:29:47,454 - __main__ - INFO -    - max_depth: 5
2025-12-01 22:29:47,454 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 22:29:47,454 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 22:29:47,459 - __main__ - INFO - 
Performances sur validation:
2025-12-01 22:29:47,459 - __main__ - INFO -    - MAE: 0.0497
2025-12-01 22:29:47,459 - __main__ - INFO -    - R¬≤: 0.8765
2025-12-01 22:29:47,459 - __main__ - INFO - ================================================================================
2025-12-01 22:29:47,460 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 22:29:47,460 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 22:29:47,462 - __main__ - INFO - Train: (1170, 97), Test: (293, 97)
2025-12-01 22:29:49,235 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 22:29:49,334 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-3\test_predictions.csv
2025-12-01 22:29:49,334 - __main__ - INFO -    Shape: (293, 103)
2025-12-01 22:29:49,334 - __main__ - INFO -    Colonnes: stay_date, hotCode, 97 features + y_test + y_pred + error + abs_error
2025-12-01 22:29:49,335 - __main__ - INFO -    MAE moyen: 0.0497
2025-12-01 22:29:49,341 - __main__ - INFO - üìä Test MAE: 0.0497
2025-12-01 22:29:49,341 - __main__ - INFO - üìä Test R¬≤: 0.8765
2025-12-01 22:29:49,341 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 22:29:49,790 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-3\xgb_scatter_plot.png
2025-12-01 22:29:50,114 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-3\xgb_feature_importance.png
2025-12-01 22:29:50,126 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-3\models...
2025-12-01 22:29:50,154 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-3\models\xgb_to_predictor.joblib
2025-12-01 22:29:50,155 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-3\models\xgb_scaler.joblib
2025-12-01 22:29:50,155 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-3\models\feature_columns.txt
2025-12-01 22:29:50,155 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 22:29:50,155 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 22:29:50,155 - __main__ - INFO -    Container: ml-models
2025-12-01 22:29:50,680 - __main__ - INFO -    Container existant trouv√©
2025-12-01 22:29:50,680 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-3/
2025-12-01 22:29:50,800 - __main__ - INFO -    ‚úì predictTo/D09/J-3/models/xgb_to_predictor.joblib
2025-12-01 22:29:50,820 - __main__ - INFO -    ‚úì predictTo/D09/J-3/models/xgb_scaler.joblib
2025-12-01 22:29:50,839 - __main__ - INFO -    ‚úì predictTo/D09/J-3/models/feature_columns.txt
2025-12-01 22:29:50,857 - __main__ - INFO -    ‚úì predictTo/D09/J-3/xgb_scatter_plot.png
2025-12-01 22:29:50,873 - __main__ - INFO -    ‚úì predictTo/D09/J-3/xgb_feature_importance.png
2025-12-01 22:29:51,038 - __main__ - INFO -    ‚úì predictTo/D09/J-3/training_data_before_scaling.csv
2025-12-01 22:29:51,071 - __main__ - INFO -    ‚úì predictTo/D09/J-3/test_predictions.csv
2025-12-01 22:29:51,071 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 22:29:51,071 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-3/
2025-12-01 22:29:51,072 - __main__ - INFO - ================================================================================
2025-12-01 22:29:51,072 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 22:29:51,072 - __main__ - INFO - ================================================================================
2025-12-01 22:29:51,072 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 22:29:51,072 - __main__ - INFO -    Train MAE:  0.0040
2025-12-01 22:29:51,072 - __main__ - INFO -    Train RMSE: 0.0053
2025-12-01 22:29:51,072 - __main__ - INFO -    Train R¬≤:   0.9990
2025-12-01 22:29:51,072 - __main__ - INFO -    Test MAE:   0.0497
2025-12-01 22:29:51,072 - __main__ - INFO -    Test RMSE:  0.0657
2025-12-01 22:29:51,073 - __main__ - INFO -    Test R¬≤:    0.8765
2025-12-01 22:29:57,172 - __main__ - INFO - ================================================================================
2025-12-01 22:29:57,172 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 22:29:57,172 - __main__ - INFO - ================================================================================
2025-12-01 22:29:57,172 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 22:29:57,175 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 22:29:57,175 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 1
2025-12-01 22:29:57,175 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 22:29:57,175 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 22:29:57,175 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 1, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 22:29:57,175 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 22:29:57,175 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 22:29:57,189 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 22:29:57,405 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 22:29:57,405 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 22:29:57,425 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 22:29:57,425 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 22:29:57,425 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 22:29:57,507 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 22:29:57,533 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 22:29:57,558 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 22:29:57,570 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 22:29:57,571 - __main__ - INFO - Calcul des features PM sur donn√©es J-1 √† J-60 (pas de data leakage)
2025-12-01 22:29:57,571 - __main__ - INFO -    Colonnes PM utilis√©es: 60
2025-12-01 22:29:58,956 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 22:29:58,956 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-1 √† J-60
2025-12-01 22:29:58,957 - __main__ - INFO -    Colonnes Ant utilis√©es: 60
2025-12-01 22:29:59,960 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 22:29:59,960 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-1 √† J-60
2025-12-01 22:29:59,960 - __main__ - INFO -    Colonnes Ds utilis√©es: 60
2025-12-01 22:30:01,159 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 22:30:01,159 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 22:30:01,279 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 22:30:01,279 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 22:30:01,449 - __main__ - INFO -    Features concurrentes calcul√©es sur J-1 √† J-60
2025-12-01 22:30:01,466 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 22:30:03,863 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 22:30:03,869 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 22:30:03,877 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 22:30:03,877 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 22:30:04,352 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 22:30:04,456 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 22:30:04,472 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 22:30:04,472 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 22:30:04,472 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 22:30:04,472 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 22:30:04,472 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 22:30:04,473 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 22:30:04,473 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 22:30:04,478 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 22:30:04,478 - __main__ - INFO - --------------------------------
2025-12-01 22:30:04,478 - __main__ - INFO - Horizon: 1
2025-12-01 22:30:04,478 - __main__ - INFO - --------------------------------
2025-12-01 22:30:04,479 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 22:30:04,480 - __main__ - INFO - nb_observations recalcul√© pour horizon=1
2025-12-01 22:30:04,480 - __main__ - INFO -    Minimum: 60
2025-12-01 22:30:04,480 - __main__ - INFO -    Maximum: 60
2025-12-01 22:30:04,480 - __main__ - INFO -    Moyenne: 60.0
2025-12-01 22:30:04,480 - __main__ - INFO - Nombre total de features: 99
2025-12-01 22:30:04,480 - __main__ - INFO -    - TO historiques: 59
2025-12-01 22:30:04,480 - __main__ - INFO -    - Features PM: 7
2025-12-01 22:30:04,480 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 22:30:04,481 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 22:30:04,481 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 22:30:04,481 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 22:30:04,481 - __main__ - INFO -    - Autres features: 11
2025-12-01 22:30:04,617 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-1\training_data_before_scaling.csv
2025-12-01 22:30:04,618 - __main__ - INFO -    Shape: (1463, 102)
2025-12-01 22:30:04,618 - __main__ - INFO -    Colonnes: stay_date, hotCode, 99 features, J-0
2025-12-01 22:30:04,618 - __main__ - INFO - X shape: (1463, 99), y shape: (1463,)
2025-12-01 22:30:04,618 - __main__ - INFO - ================================================================================
2025-12-01 22:30:04,618 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 22:30:04,618 - __main__ - INFO - ================================================================================
2025-12-01 22:30:04,624 - __main__ - INFO - Train: (1170, 99), Validation: (293, 99)
2025-12-01 22:30:04,624 - __main__ - INFO - Configuration de la recherche:
2025-12-01 22:30:04,624 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 22:30:04,624 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 22:30:04,624 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 22:30:04,624 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 22:30:04,624 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 22:31:54,260 - __main__ - INFO - ================================================================================
2025-12-01 22:31:54,260 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 22:31:54,260 - __main__ - INFO - ================================================================================
2025-12-01 22:31:54,260 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0281
2025-12-01 22:31:54,260 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 22:31:54,260 - __main__ - INFO -    - subsample: 0.95
2025-12-01 22:31:54,261 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 22:31:54,261 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 22:31:54,261 - __main__ - INFO -    - n_estimators: 500
2025-12-01 22:31:54,261 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 22:31:54,261 - __main__ - INFO -    - max_depth: 5
2025-12-01 22:31:54,261 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 22:31:54,261 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 22:31:54,265 - __main__ - INFO - 
Performances sur validation:
2025-12-01 22:31:54,265 - __main__ - INFO -    - MAE: 0.0280
2025-12-01 22:31:54,265 - __main__ - INFO -    - R¬≤: 0.9576
2025-12-01 22:31:54,265 - __main__ - INFO - ================================================================================
2025-12-01 22:31:54,265 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 22:31:54,266 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 22:31:54,267 - __main__ - INFO - Train: (1170, 99), Test: (293, 99)
2025-12-01 22:31:56,086 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 22:31:56,197 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-1\test_predictions.csv
2025-12-01 22:31:56,197 - __main__ - INFO -    Shape: (293, 105)
2025-12-01 22:31:56,197 - __main__ - INFO -    Colonnes: stay_date, hotCode, 99 features + y_test + y_pred + error + abs_error
2025-12-01 22:31:56,198 - __main__ - INFO -    MAE moyen: 0.0280
2025-12-01 22:31:56,203 - __main__ - INFO - üìä Test MAE: 0.0280
2025-12-01 22:31:56,203 - __main__ - INFO - üìä Test R¬≤: 0.9576
2025-12-01 22:31:56,204 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 22:31:56,682 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-1\xgb_scatter_plot.png
2025-12-01 22:31:57,019 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-1\xgb_feature_importance.png
2025-12-01 22:31:57,033 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-1\models...
2025-12-01 22:31:57,061 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-1\models\xgb_to_predictor.joblib
2025-12-01 22:31:57,061 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-1\models\xgb_scaler.joblib
2025-12-01 22:31:57,061 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-1\models\feature_columns.txt
2025-12-01 22:31:57,062 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 22:31:57,062 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 22:31:57,062 - __main__ - INFO -    Container: ml-models
2025-12-01 22:31:57,628 - __main__ - INFO -    Container existant trouv√©
2025-12-01 22:31:57,628 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-1/
2025-12-01 22:31:57,747 - __main__ - INFO -    ‚úì predictTo/D09/J-1/models/xgb_to_predictor.joblib
2025-12-01 22:31:57,765 - __main__ - INFO -    ‚úì predictTo/D09/J-1/models/xgb_scaler.joblib
2025-12-01 22:31:57,784 - __main__ - INFO -    ‚úì predictTo/D09/J-1/models/feature_columns.txt
2025-12-01 22:31:57,802 - __main__ - INFO -    ‚úì predictTo/D09/J-1/xgb_scatter_plot.png
2025-12-01 22:31:57,822 - __main__ - INFO -    ‚úì predictTo/D09/J-1/xgb_feature_importance.png
2025-12-01 22:31:57,966 - __main__ - INFO -    ‚úì predictTo/D09/J-1/training_data_before_scaling.csv
2025-12-01 22:31:58,006 - __main__ - INFO -    ‚úì predictTo/D09/J-1/test_predictions.csv
2025-12-01 22:31:58,006 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 22:31:58,006 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-1/
2025-12-01 22:31:58,007 - __main__ - INFO - ================================================================================
2025-12-01 22:31:58,007 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 22:31:58,007 - __main__ - INFO - ================================================================================
2025-12-01 22:31:58,007 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 22:31:58,007 - __main__ - INFO -    Train MAE:  0.0019
2025-12-01 22:31:58,007 - __main__ - INFO -    Train RMSE: 0.0025
2025-12-01 22:31:58,007 - __main__ - INFO -    Train R¬≤:   0.9998
2025-12-01 22:31:58,007 - __main__ - INFO -    Test MAE:   0.0280
2025-12-01 22:31:58,007 - __main__ - INFO -    Test RMSE:  0.0385
2025-12-01 22:31:58,007 - __main__ - INFO -    Test R¬≤:    0.9576
2025-12-01 22:32:03,774 - __main__ - INFO - ================================================================================
2025-12-01 22:32:03,774 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 22:32:03,774 - __main__ - INFO - ================================================================================
2025-12-01 22:32:03,774 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 22:32:03,778 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 22:32:03,778 - __main__ - ERROR - ‚ùå L'horizon doit √™tre un entier positif
2025-12-01 22:44:45,956 - __main__ - INFO - ================================================================================
2025-12-01 22:44:45,956 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 22:44:45,956 - __main__ - INFO - ================================================================================
2025-12-01 22:44:45,956 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 22:44:45,959 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 22:44:45,959 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 60
2025-12-01 22:44:45,959 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 22:44:45,959 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 22:44:45,959 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 60, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 22:44:45,959 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 22:44:45,959 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 22:44:45,973 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 22:44:46,166 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 22:44:46,166 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 22:44:46,187 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 22:44:46,187 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 22:44:46,187 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 22:44:46,257 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 22:44:46,274 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 22:44:46,293 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 22:44:46,302 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 22:44:46,302 - __main__ - INFO - Calcul des features PM sur donn√©es J-61 √† J-60 (pas de data leakage)
2025-12-01 22:44:46,302 - __main__ - INFO -    Colonnes PM utilis√©es: 0
2025-12-01 22:44:46,302 - __main__ - ERROR - ‚ùå Aucune colonne PM disponible pour horizon=60
2025-12-01 22:44:46,302 - __main__ - ERROR -    Colonnes PM existantes: ['pm_J-0', 'pm_J-1', 'pm_J-2', 'pm_J-3', 'pm_J-4']
2025-12-01 22:44:46,302 - __main__ - ERROR - ‚ùå ERREUR FATALE: Pas de donn√©es PM disponibles pour horizon=60
Traceback (most recent call last):
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 1609, in main
    df = predictor.prepare_data(clusters, indicateurs)
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 593, in prepare_data
    raise ValueError(f"Pas de donn√©es PM disponibles pour horizon={horizon}")
ValueError: Pas de donn√©es PM disponibles pour horizon=60
2025-12-01 22:44:50,771 - __main__ - INFO - ================================================================================
2025-12-01 22:44:50,771 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 22:44:50,771 - __main__ - INFO - ================================================================================
2025-12-01 22:44:50,772 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 22:44:50,775 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 22:44:50,775 - __main__ - INFO - üîß Override de l'horizon: 60 ‚Üí 45
2025-12-01 22:44:50,775 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 22:44:50,775 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 22:44:50,775 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 45, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 22:44:50,775 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 22:44:50,775 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 22:44:50,794 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 22:44:51,003 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 22:44:51,003 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 22:44:51,025 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 22:44:51,026 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 22:44:51,026 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 22:44:51,104 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 22:44:51,127 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 22:44:51,150 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 22:44:51,160 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 22:44:51,160 - __main__ - INFO - Calcul des features PM sur donn√©es J-46 √† J-60 (pas de data leakage)
2025-12-01 22:44:51,160 - __main__ - INFO -    Colonnes PM utilis√©es: 15
2025-12-01 22:44:52,333 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 22:44:52,333 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-46 √† J-60
2025-12-01 22:44:52,333 - __main__ - INFO -    Colonnes Ant utilis√©es: 15
2025-12-01 22:44:53,202 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 22:44:53,202 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-46 √† J-60
2025-12-01 22:44:53,202 - __main__ - INFO -    Colonnes Ds utilis√©es: 15
2025-12-01 22:44:54,014 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 22:44:54,014 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 22:44:54,121 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 22:44:54,121 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 22:44:54,272 - __main__ - INFO -    Features concurrentes calcul√©es sur J-46 √† J-60
2025-12-01 22:44:54,279 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 22:44:56,201 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 22:44:56,207 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 22:44:56,214 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 22:44:56,214 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 22:44:56,637 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 22:44:56,733 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 22:44:56,748 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 22:44:56,748 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 22:44:56,748 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 22:44:56,749 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 22:44:56,749 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 22:44:56,749 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 22:44:56,749 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 22:44:56,755 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 22:44:56,755 - __main__ - INFO - --------------------------------
2025-12-01 22:44:56,755 - __main__ - INFO - Horizon: 45
2025-12-01 22:44:56,755 - __main__ - INFO - --------------------------------
2025-12-01 22:44:56,755 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 22:44:56,756 - __main__ - INFO - nb_observations recalcul√© pour horizon=45
2025-12-01 22:44:56,756 - __main__ - INFO -    Colonnes TO compt√©es: J-60 √† J-46 (15 colonnes)
2025-12-01 22:44:56,757 - __main__ - INFO -    Minimum: 15
2025-12-01 22:44:56,757 - __main__ - INFO -    Maximum: 15
2025-12-01 22:44:56,757 - __main__ - INFO -    Moyenne: 15.0
2025-12-01 22:44:56,757 - __main__ - INFO - Features TO historiques: J-60 √† J-46 (15 colonnes)
2025-12-01 22:44:56,757 - __main__ - INFO - Nombre total de features: 55
2025-12-01 22:44:56,757 - __main__ - INFO -    - TO historiques: 15
2025-12-01 22:44:56,757 - __main__ - INFO -    - Features PM: 7
2025-12-01 22:44:56,757 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 22:44:56,757 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 22:44:56,757 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 22:44:56,757 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 22:44:56,757 - __main__ - INFO -    - Autres features: 11
2025-12-01 22:44:56,824 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-45\training_data_before_scaling.csv
2025-12-01 22:44:56,824 - __main__ - INFO -    Shape: (1463, 58)
2025-12-01 22:44:56,824 - __main__ - INFO -    Colonnes: stay_date, hotCode, 55 features, J-0
2025-12-01 22:44:56,824 - __main__ - INFO - X shape: (1463, 55), y shape: (1463,)
2025-12-01 22:44:56,824 - __main__ - INFO - ================================================================================
2025-12-01 22:44:56,824 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 22:44:56,824 - __main__ - INFO - ================================================================================
2025-12-01 22:44:56,828 - __main__ - INFO - Train: (1170, 55), Validation: (293, 55)
2025-12-01 22:44:56,828 - __main__ - INFO - Configuration de la recherche:
2025-12-01 22:44:56,828 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 22:44:56,828 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 22:44:56,828 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 22:44:56,828 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 22:44:56,828 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 22:50:51,308 - __main__ - INFO - ================================================================================
2025-12-01 22:50:51,309 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 22:50:51,309 - __main__ - INFO - ================================================================================
2025-12-01 22:50:51,309 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 22:50:51,312 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 22:50:51,312 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 59
2025-12-01 22:50:51,312 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 22:50:51,312 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 22:50:51,312 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 59, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 22:50:51,312 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 22:50:51,312 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 22:50:51,337 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 22:50:51,543 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 22:50:51,543 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 22:50:51,563 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 22:50:51,563 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 22:50:51,563 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 22:50:51,633 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 22:50:51,651 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 22:50:51,671 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 22:50:51,678 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 22:50:51,678 - __main__ - INFO - Calcul des features PM sur donn√©es J-60 √† J-60 (pas de data leakage)
2025-12-01 22:50:51,678 - __main__ - INFO -    Colonnes PM utilis√©es: 1
2025-12-01 22:50:52,711 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 22:50:52,711 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-60 √† J-60
2025-12-01 22:50:52,712 - __main__ - INFO -    Colonnes Ant utilis√©es: 1
2025-12-01 22:50:53,420 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 22:50:53,420 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-60 √† J-60
2025-12-01 22:50:53,420 - __main__ - INFO -    Colonnes Ds utilis√©es: 1
2025-12-01 22:50:54,091 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 22:50:54,091 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 22:50:54,216 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 22:50:54,216 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 22:50:54,362 - __main__ - INFO -    Features concurrentes calcul√©es sur J-60 √† J-60
2025-12-01 22:50:54,368 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 22:50:55,845 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 22:50:55,851 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 22:50:55,858 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 22:50:55,858 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 22:50:56,684 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 22:50:56,787 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 22:50:56,803 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 22:50:56,803 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 22:50:56,803 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 22:50:56,804 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 22:50:56,804 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 22:50:56,804 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 22:50:56,804 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 22:50:56,809 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 22:50:56,810 - __main__ - INFO - --------------------------------
2025-12-01 22:50:56,810 - __main__ - INFO - Horizon: 59
2025-12-01 22:50:56,810 - __main__ - INFO - --------------------------------
2025-12-01 22:50:56,810 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 22:50:56,811 - __main__ - INFO - nb_observations recalcul√© pour horizon=59
2025-12-01 22:50:56,811 - __main__ - INFO -    Colonnes TO compt√©es: J-60 √† J-60 (1 colonnes)
2025-12-01 22:50:56,811 - __main__ - INFO -    Minimum: 1
2025-12-01 22:50:56,811 - __main__ - INFO -    Maximum: 1
2025-12-01 22:50:56,811 - __main__ - INFO -    Moyenne: 1.0
2025-12-01 22:50:56,811 - __main__ - INFO - Features TO historiques: J-60 √† J-60 (1 colonnes)
2025-12-01 22:50:56,811 - __main__ - INFO - Nombre total de features: 41
2025-12-01 22:50:56,811 - __main__ - INFO -    - TO historiques: 1
2025-12-01 22:50:56,811 - __main__ - INFO -    - Features PM: 7
2025-12-01 22:50:56,811 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 22:50:56,811 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 22:50:56,812 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 22:50:56,812 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 22:50:56,812 - __main__ - INFO -    - Autres features: 11
2025-12-01 22:50:56,849 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-59\training_data_before_scaling.csv
2025-12-01 22:50:56,849 - __main__ - INFO -    Shape: (1463, 44)
2025-12-01 22:50:56,849 - __main__ - INFO -    Colonnes: stay_date, hotCode, 41 features, J-0
2025-12-01 22:50:56,849 - __main__ - INFO - X shape: (1463, 41), y shape: (1463,)
2025-12-01 22:50:56,849 - __main__ - INFO - ================================================================================
2025-12-01 22:50:56,849 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 22:50:56,849 - __main__ - INFO - ================================================================================
2025-12-01 22:50:56,853 - __main__ - INFO - Train: (1170, 41), Validation: (293, 41)
2025-12-01 22:50:56,853 - __main__ - INFO - Configuration de la recherche:
2025-12-01 22:50:56,853 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 22:50:56,853 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 22:50:56,853 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 22:50:56,853 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 22:50:56,853 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 22:51:22,864 - __main__ - INFO - ================================================================================
2025-12-01 22:51:22,864 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 22:51:22,865 - __main__ - INFO - ================================================================================
2025-12-01 22:51:22,865 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0904
2025-12-01 22:51:22,865 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 22:51:22,865 - __main__ - INFO -    - subsample: 0.9
2025-12-01 22:51:22,865 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 22:51:22,865 - __main__ - INFO -    - reg_alpha: 0.5
2025-12-01 22:51:22,865 - __main__ - INFO -    - n_estimators: 500
2025-12-01 22:51:22,865 - __main__ - INFO -    - min_child_weight: 2
2025-12-01 22:51:22,865 - __main__ - INFO -    - max_depth: 8
2025-12-01 22:51:22,866 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 22:51:22,866 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 22:51:22,870 - __main__ - INFO - 
Performances sur validation:
2025-12-01 22:51:22,871 - __main__ - INFO -    - MAE: 0.0945
2025-12-01 22:51:22,871 - __main__ - INFO -    - R¬≤: 0.5654
2025-12-01 22:51:22,871 - __main__ - INFO - ================================================================================
2025-12-01 22:51:22,871 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 22:51:22,872 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 22:51:22,874 - __main__ - INFO - Train: (1170, 41), Test: (293, 41)
2025-12-01 22:51:23,732 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 22:51:23,782 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-59\test_predictions.csv
2025-12-01 22:51:23,782 - __main__ - INFO -    Shape: (293, 47)
2025-12-01 22:51:23,783 - __main__ - INFO -    Colonnes: stay_date, hotCode, 41 features + y_test + y_pred + error + abs_error
2025-12-01 22:51:23,783 - __main__ - INFO -    MAE moyen: 0.0945
2025-12-01 22:51:23,790 - __main__ - INFO - üìä Test MAE: 0.0945
2025-12-01 22:51:23,790 - __main__ - INFO - üìä Test R¬≤: 0.5654
2025-12-01 22:51:23,790 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 22:51:24,870 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-59\xgb_scatter_plot.png
2025-12-01 22:51:25,217 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-59\xgb_feature_importance.png
2025-12-01 22:51:25,261 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-59\models...
2025-12-01 22:51:25,301 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-59\models\xgb_to_predictor.joblib
2025-12-01 22:51:25,301 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-59\models\xgb_scaler.joblib
2025-12-01 22:51:25,301 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-59\models\feature_columns.txt
2025-12-01 22:51:25,301 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 22:51:25,302 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 22:51:25,302 - __main__ - INFO -    Container: ml-models
2025-12-01 22:51:25,905 - __main__ - INFO -    Container existant trouv√©
2025-12-01 22:51:25,905 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-59/
2025-12-01 22:51:26,045 - __main__ - INFO -    ‚úì predictTo/D09/J-59/models/xgb_to_predictor.joblib
2025-12-01 22:51:26,060 - __main__ - INFO -    ‚úì predictTo/D09/J-59/models/xgb_scaler.joblib
2025-12-01 22:51:26,076 - __main__ - INFO -    ‚úì predictTo/D09/J-59/models/feature_columns.txt
2025-12-01 22:51:26,093 - __main__ - INFO -    ‚úì predictTo/D09/J-59/xgb_scatter_plot.png
2025-12-01 22:51:26,110 - __main__ - INFO -    ‚úì predictTo/D09/J-59/xgb_feature_importance.png
2025-12-01 22:51:26,142 - __main__ - INFO -    ‚úì predictTo/D09/J-59/training_data_before_scaling.csv
2025-12-01 22:51:26,160 - __main__ - INFO -    ‚úì predictTo/D09/J-59/test_predictions.csv
2025-12-01 22:51:26,160 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 22:51:26,160 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-59/
2025-12-01 22:51:26,161 - __main__ - INFO - ================================================================================
2025-12-01 22:51:26,161 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 22:51:26,162 - __main__ - INFO - ================================================================================
2025-12-01 22:51:26,162 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 22:51:26,162 - __main__ - INFO -    Train MAE:  0.0291
2025-12-01 22:51:26,162 - __main__ - INFO -    Train RMSE: 0.0380
2025-12-01 22:51:26,162 - __main__ - INFO -    Train R¬≤:   0.9498
2025-12-01 22:51:26,162 - __main__ - INFO -    Test MAE:   0.0945
2025-12-01 22:51:26,162 - __main__ - INFO -    Test RMSE:  0.1232
2025-12-01 22:51:26,162 - __main__ - INFO -    Test R¬≤:    0.5654
2025-12-01 22:51:32,591 - __main__ - INFO - ================================================================================
2025-12-01 22:51:32,591 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 22:51:32,591 - __main__ - INFO - ================================================================================
2025-12-01 22:51:32,592 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 22:51:32,595 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 22:51:32,595 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 45
2025-12-01 22:51:32,595 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 22:51:32,595 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 22:51:32,596 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 45, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 22:51:32,596 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 22:51:32,596 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 22:51:32,614 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 22:51:32,823 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 22:51:32,823 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 22:51:32,850 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 22:51:32,850 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 22:51:32,850 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 22:51:32,953 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 22:51:32,985 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 22:51:33,016 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 22:51:33,033 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 22:51:33,033 - __main__ - INFO - Calcul des features PM sur donn√©es J-46 √† J-60 (pas de data leakage)
2025-12-01 22:51:33,033 - __main__ - INFO -    Colonnes PM utilis√©es: 15
2025-12-01 22:51:34,666 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 22:51:34,666 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-46 √† J-60
2025-12-01 22:51:34,666 - __main__ - INFO -    Colonnes Ant utilis√©es: 15
2025-12-01 22:51:35,586 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 22:51:35,586 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-46 √† J-60
2025-12-01 22:51:35,586 - __main__ - INFO -    Colonnes Ds utilis√©es: 15
2025-12-01 22:51:36,426 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 22:51:36,426 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 22:51:36,540 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 22:51:36,540 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 22:51:36,690 - __main__ - INFO -    Features concurrentes calcul√©es sur J-46 √† J-60
2025-12-01 22:51:36,699 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 22:51:38,922 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 22:51:38,928 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 22:51:38,937 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 22:51:38,938 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 22:51:39,599 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 22:51:39,737 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 22:51:39,755 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 22:51:39,756 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 22:51:39,756 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 22:51:39,756 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 22:51:39,756 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 22:51:39,756 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 22:51:39,756 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 22:51:39,764 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 22:51:39,764 - __main__ - INFO - --------------------------------
2025-12-01 22:51:39,764 - __main__ - INFO - Horizon: 45
2025-12-01 22:51:39,764 - __main__ - INFO - --------------------------------
2025-12-01 22:51:39,765 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 22:51:39,766 - __main__ - INFO - nb_observations recalcul√© pour horizon=45
2025-12-01 22:51:39,767 - __main__ - INFO -    Colonnes TO compt√©es: J-60 √† J-46 (15 colonnes)
2025-12-01 22:51:39,767 - __main__ - INFO -    Minimum: 15
2025-12-01 22:51:39,767 - __main__ - INFO -    Maximum: 15
2025-12-01 22:51:39,767 - __main__ - INFO -    Moyenne: 15.0
2025-12-01 22:51:39,767 - __main__ - INFO - Features TO historiques: J-60 √† J-46 (15 colonnes)
2025-12-01 22:51:39,768 - __main__ - INFO - Nombre total de features: 55
2025-12-01 22:51:39,768 - __main__ - INFO -    - TO historiques: 15
2025-12-01 22:51:39,768 - __main__ - INFO -    - Features PM: 7
2025-12-01 22:51:39,768 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 22:51:39,768 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 22:51:39,768 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 22:51:39,768 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 22:51:39,768 - __main__ - INFO -    - Autres features: 11
2025-12-01 22:51:39,850 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-45\training_data_before_scaling.csv
2025-12-01 22:51:39,850 - __main__ - INFO -    Shape: (1463, 58)
2025-12-01 22:51:39,850 - __main__ - INFO -    Colonnes: stay_date, hotCode, 55 features, J-0
2025-12-01 22:51:39,850 - __main__ - INFO - X shape: (1463, 55), y shape: (1463,)
2025-12-01 22:51:39,850 - __main__ - INFO - ================================================================================
2025-12-01 22:51:39,850 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 22:51:39,850 - __main__ - INFO - ================================================================================
2025-12-01 22:51:39,855 - __main__ - INFO - Train: (1170, 55), Validation: (293, 55)
2025-12-01 22:51:39,855 - __main__ - INFO - Configuration de la recherche:
2025-12-01 22:51:39,855 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 22:51:39,855 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 22:51:39,855 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 22:51:39,855 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 22:51:39,855 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 22:52:48,757 - __main__ - INFO - ================================================================================
2025-12-01 22:52:48,757 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 22:52:48,757 - __main__ - INFO - ================================================================================
2025-12-01 22:52:48,757 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0916
2025-12-01 22:52:48,757 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 22:52:48,758 - __main__ - INFO -    - subsample: 0.95
2025-12-01 22:52:48,758 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 22:52:48,758 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 22:52:48,758 - __main__ - INFO -    - n_estimators: 500
2025-12-01 22:52:48,758 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 22:52:48,758 - __main__ - INFO -    - max_depth: 5
2025-12-01 22:52:48,758 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 22:52:48,758 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 22:52:48,762 - __main__ - INFO - 
Performances sur validation:
2025-12-01 22:52:48,763 - __main__ - INFO -    - MAE: 0.0960
2025-12-01 22:52:48,763 - __main__ - INFO -    - R¬≤: 0.5540
2025-12-01 22:52:48,763 - __main__ - INFO - ================================================================================
2025-12-01 22:52:48,763 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 22:52:48,764 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 22:52:48,766 - __main__ - INFO - Train: (1170, 55), Test: (293, 55)
2025-12-01 22:52:49,745 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 22:52:49,806 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-45\test_predictions.csv
2025-12-01 22:52:49,806 - __main__ - INFO -    Shape: (293, 61)
2025-12-01 22:52:49,806 - __main__ - INFO -    Colonnes: stay_date, hotCode, 55 features + y_test + y_pred + error + abs_error
2025-12-01 22:52:49,807 - __main__ - INFO -    MAE moyen: 0.0960
2025-12-01 22:52:49,814 - __main__ - INFO - üìä Test MAE: 0.0960
2025-12-01 22:52:49,814 - __main__ - INFO - üìä Test R¬≤: 0.5540
2025-12-01 22:52:49,814 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 22:52:50,259 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-45\xgb_scatter_plot.png
2025-12-01 22:52:50,574 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-45\xgb_feature_importance.png
2025-12-01 22:52:50,587 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-45\models...
2025-12-01 22:52:50,612 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-45\models\xgb_to_predictor.joblib
2025-12-01 22:52:50,612 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-45\models\xgb_scaler.joblib
2025-12-01 22:52:50,613 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-45\models\feature_columns.txt
2025-12-01 22:52:50,613 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 22:52:50,613 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 22:52:50,613 - __main__ - INFO -    Container: ml-models
2025-12-01 22:52:51,246 - __main__ - INFO -    Container existant trouv√©
2025-12-01 22:52:51,246 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-45/
2025-12-01 22:52:51,326 - __main__ - INFO -    ‚úì predictTo/D09/J-45/models/xgb_to_predictor.joblib
2025-12-01 22:52:51,344 - __main__ - INFO -    ‚úì predictTo/D09/J-45/models/xgb_scaler.joblib
2025-12-01 22:52:51,362 - __main__ - INFO -    ‚úì predictTo/D09/J-45/models/feature_columns.txt
2025-12-01 22:52:51,380 - __main__ - INFO -    ‚úì predictTo/D09/J-45/xgb_scatter_plot.png
2025-12-01 22:52:51,402 - __main__ - INFO -    ‚úì predictTo/D09/J-45/xgb_feature_importance.png
2025-12-01 22:52:51,495 - __main__ - INFO -    ‚úì predictTo/D09/J-45/training_data_before_scaling.csv
2025-12-01 22:52:51,524 - __main__ - INFO -    ‚úì predictTo/D09/J-45/test_predictions.csv
2025-12-01 22:52:51,525 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 22:52:51,525 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-45/
2025-12-01 22:52:51,526 - __main__ - INFO - ================================================================================
2025-12-01 22:52:51,526 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 22:52:51,526 - __main__ - INFO - ================================================================================
2025-12-01 22:52:51,526 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 22:52:51,526 - __main__ - INFO -    Train MAE:  0.0102
2025-12-01 22:52:51,526 - __main__ - INFO -    Train RMSE: 0.0142
2025-12-01 22:52:51,526 - __main__ - INFO -    Train R¬≤:   0.9930
2025-12-01 22:52:51,526 - __main__ - INFO -    Test MAE:   0.0960
2025-12-01 22:52:51,526 - __main__ - INFO -    Test RMSE:  0.1248
2025-12-01 22:52:51,526 - __main__ - INFO -    Test R¬≤:    0.5540
2025-12-01 22:52:57,655 - __main__ - INFO - ================================================================================
2025-12-01 22:52:57,656 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 22:52:57,656 - __main__ - INFO - ================================================================================
2025-12-01 22:52:57,656 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 22:52:57,660 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 22:52:57,660 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 30
2025-12-01 22:52:57,660 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 22:52:57,660 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 22:52:57,660 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 30, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 22:52:57,660 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 22:52:57,660 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 22:52:57,676 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 22:52:57,907 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 22:52:57,907 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 22:52:57,927 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 22:52:57,928 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 22:52:57,928 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 22:52:58,006 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 22:52:58,034 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 22:52:58,058 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 22:52:58,068 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 22:52:58,068 - __main__ - INFO - Calcul des features PM sur donn√©es J-31 √† J-60 (pas de data leakage)
2025-12-01 22:52:58,068 - __main__ - INFO -    Colonnes PM utilis√©es: 30
2025-12-01 22:52:59,398 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 22:52:59,399 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-31 √† J-60
2025-12-01 22:52:59,399 - __main__ - INFO -    Colonnes Ant utilis√©es: 30
2025-12-01 22:53:00,416 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 22:53:00,416 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-31 √† J-60
2025-12-01 22:53:00,416 - __main__ - INFO -    Colonnes Ds utilis√©es: 30
2025-12-01 22:53:01,561 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 22:53:01,562 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 22:53:01,696 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 22:53:01,696 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 22:53:01,878 - __main__ - INFO -    Features concurrentes calcul√©es sur J-31 √† J-60
2025-12-01 22:53:01,888 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 22:53:04,159 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 22:53:04,166 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 22:53:04,174 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 22:53:04,174 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 22:53:04,665 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 22:53:04,790 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 22:53:04,811 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 22:53:04,812 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 22:53:04,812 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 22:53:04,812 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 22:53:04,812 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 22:53:04,812 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 22:53:04,812 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 22:53:04,819 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 22:53:04,819 - __main__ - INFO - --------------------------------
2025-12-01 22:53:04,819 - __main__ - INFO - Horizon: 30
2025-12-01 22:53:04,819 - __main__ - INFO - --------------------------------
2025-12-01 22:53:04,819 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 22:53:04,821 - __main__ - INFO - nb_observations recalcul√© pour horizon=30
2025-12-01 22:53:04,821 - __main__ - INFO -    Colonnes TO compt√©es: J-60 √† J-31 (30 colonnes)
2025-12-01 22:53:04,821 - __main__ - INFO -    Minimum: 30
2025-12-01 22:53:04,822 - __main__ - INFO -    Maximum: 30
2025-12-01 22:53:04,822 - __main__ - INFO -    Moyenne: 30.0
2025-12-01 22:53:04,822 - __main__ - INFO - Features TO historiques: J-60 √† J-31 (30 colonnes)
2025-12-01 22:53:04,822 - __main__ - INFO - Nombre total de features: 70
2025-12-01 22:53:04,822 - __main__ - INFO -    - TO historiques: 30
2025-12-01 22:53:04,822 - __main__ - INFO -    - Features PM: 7
2025-12-01 22:53:04,822 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 22:53:04,822 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 22:53:04,822 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 22:53:04,822 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 22:53:04,822 - __main__ - INFO -    - Autres features: 11
2025-12-01 22:53:04,930 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-30\training_data_before_scaling.csv
2025-12-01 22:53:04,931 - __main__ - INFO -    Shape: (1463, 73)
2025-12-01 22:53:04,931 - __main__ - INFO -    Colonnes: stay_date, hotCode, 70 features, J-0
2025-12-01 22:53:04,931 - __main__ - INFO - X shape: (1463, 70), y shape: (1463,)
2025-12-01 22:53:04,931 - __main__ - INFO - ================================================================================
2025-12-01 22:53:04,931 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 22:53:04,931 - __main__ - INFO - ================================================================================
2025-12-01 22:53:04,938 - __main__ - INFO - Train: (1170, 70), Validation: (293, 70)
2025-12-01 22:53:04,938 - __main__ - INFO - Configuration de la recherche:
2025-12-01 22:53:04,938 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 22:53:04,938 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 22:53:04,938 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 22:53:04,938 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 22:53:04,938 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 22:54:39,403 - __main__ - INFO - ================================================================================
2025-12-01 22:54:39,403 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 22:54:39,403 - __main__ - INFO - ================================================================================
2025-12-01 22:54:39,403 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0848
2025-12-01 22:54:39,403 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 22:54:39,403 - __main__ - INFO -    - subsample: 0.9
2025-12-01 22:54:39,403 - __main__ - INFO -    - reg_lambda: 0.5
2025-12-01 22:54:39,403 - __main__ - INFO -    - reg_alpha: 0.1
2025-12-01 22:54:39,403 - __main__ - INFO -    - n_estimators: 800
2025-12-01 22:54:39,403 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 22:54:39,403 - __main__ - INFO -    - max_depth: 6
2025-12-01 22:54:39,404 - __main__ - INFO -    - learning_rate: 0.01
2025-12-01 22:54:39,404 - __main__ - INFO -    - colsample_bytree: 0.85
2025-12-01 22:54:39,412 - __main__ - INFO - 
Performances sur validation:
2025-12-01 22:54:39,412 - __main__ - INFO -    - MAE: 0.0905
2025-12-01 22:54:39,412 - __main__ - INFO -    - R¬≤: 0.6107
2025-12-01 22:54:39,412 - __main__ - INFO - ================================================================================
2025-12-01 22:54:39,413 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 22:54:39,413 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 22:54:39,417 - __main__ - INFO - Train: (1170, 70), Test: (293, 70)
2025-12-01 22:54:42,733 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 22:54:42,806 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-30\test_predictions.csv
2025-12-01 22:54:42,806 - __main__ - INFO -    Shape: (293, 76)
2025-12-01 22:54:42,806 - __main__ - INFO -    Colonnes: stay_date, hotCode, 70 features + y_test + y_pred + error + abs_error
2025-12-01 22:54:42,807 - __main__ - INFO -    MAE moyen: 0.0905
2025-12-01 22:54:42,812 - __main__ - INFO - üìä Test MAE: 0.0905
2025-12-01 22:54:42,812 - __main__ - INFO - üìä Test R¬≤: 0.6107
2025-12-01 22:54:42,812 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 22:54:43,269 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-30\xgb_scatter_plot.png
2025-12-01 22:54:43,588 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-30\xgb_feature_importance.png
2025-12-01 22:54:43,600 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-30\models...
2025-12-01 22:54:43,633 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-30\models\xgb_to_predictor.joblib
2025-12-01 22:54:43,633 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-30\models\xgb_scaler.joblib
2025-12-01 22:54:43,633 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-30\models\feature_columns.txt
2025-12-01 22:54:43,633 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 22:54:43,633 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 22:54:43,633 - __main__ - INFO -    Container: ml-models
2025-12-01 22:54:44,148 - __main__ - INFO -    Container existant trouv√©
2025-12-01 22:54:44,148 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-30/
2025-12-01 22:54:44,267 - __main__ - INFO -    ‚úì predictTo/D09/J-30/models/xgb_to_predictor.joblib
2025-12-01 22:54:44,285 - __main__ - INFO -    ‚úì predictTo/D09/J-30/models/xgb_scaler.joblib
2025-12-01 22:54:44,304 - __main__ - INFO -    ‚úì predictTo/D09/J-30/models/feature_columns.txt
2025-12-01 22:54:44,322 - __main__ - INFO -    ‚úì predictTo/D09/J-30/xgb_scatter_plot.png
2025-12-01 22:54:44,339 - __main__ - INFO -    ‚úì predictTo/D09/J-30/xgb_feature_importance.png
2025-12-01 22:54:44,418 - __main__ - INFO -    ‚úì predictTo/D09/J-30/training_data_before_scaling.csv
2025-12-01 22:54:44,451 - __main__ - INFO -    ‚úì predictTo/D09/J-30/test_predictions.csv
2025-12-01 22:54:44,452 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 22:54:44,452 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-30/
2025-12-01 22:54:44,453 - __main__ - INFO - ================================================================================
2025-12-01 22:54:44,453 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 22:54:44,453 - __main__ - INFO - ================================================================================
2025-12-01 22:54:44,453 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 22:54:44,453 - __main__ - INFO -    Train MAE:  0.0221
2025-12-01 22:54:44,453 - __main__ - INFO -    Train RMSE: 0.0289
2025-12-01 22:54:44,453 - __main__ - INFO -    Train R¬≤:   0.9709
2025-12-01 22:54:44,453 - __main__ - INFO -    Test MAE:   0.0905
2025-12-01 22:54:44,453 - __main__ - INFO -    Test RMSE:  0.1166
2025-12-01 22:54:44,453 - __main__ - INFO -    Test R¬≤:    0.6107
2025-12-01 22:54:50,134 - __main__ - INFO - ================================================================================
2025-12-01 22:54:50,134 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 22:54:50,134 - __main__ - INFO - ================================================================================
2025-12-01 22:54:50,134 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 22:54:50,138 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 22:54:50,138 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 21
2025-12-01 22:54:50,138 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 22:54:50,138 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 22:54:50,138 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 21, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 22:54:50,138 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 22:54:50,138 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 22:54:50,154 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 22:54:50,363 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 22:54:50,363 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 22:54:50,386 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 22:54:50,386 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 22:54:50,386 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 22:54:50,468 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 22:54:50,493 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 22:54:50,525 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 22:54:50,538 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 22:54:50,538 - __main__ - INFO - Calcul des features PM sur donn√©es J-22 √† J-60 (pas de data leakage)
2025-12-01 22:54:50,538 - __main__ - INFO -    Colonnes PM utilis√©es: 39
2025-12-01 22:54:51,766 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 22:54:51,766 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-22 √† J-60
2025-12-01 22:54:51,766 - __main__ - INFO -    Colonnes Ant utilis√©es: 39
2025-12-01 22:54:52,652 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 22:54:52,653 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-22 √† J-60
2025-12-01 22:54:52,653 - __main__ - INFO -    Colonnes Ds utilis√©es: 39
2025-12-01 22:54:53,510 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 22:54:53,510 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 22:54:53,620 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 22:54:53,621 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 22:54:53,765 - __main__ - INFO -    Features concurrentes calcul√©es sur J-22 √† J-60
2025-12-01 22:54:53,776 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 22:54:55,650 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 22:54:55,656 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 22:54:55,663 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 22:54:55,663 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 22:54:56,057 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 22:54:56,156 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 22:54:56,172 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 22:54:56,172 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 22:54:56,172 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 22:54:56,172 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 22:54:56,173 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 22:54:56,173 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 22:54:56,173 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 22:54:56,178 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 22:54:56,178 - __main__ - INFO - --------------------------------
2025-12-01 22:54:56,178 - __main__ - INFO - Horizon: 21
2025-12-01 22:54:56,178 - __main__ - INFO - --------------------------------
2025-12-01 22:54:56,179 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 22:54:56,180 - __main__ - INFO - nb_observations recalcul√© pour horizon=21
2025-12-01 22:54:56,180 - __main__ - INFO -    Colonnes TO compt√©es: J-60 √† J-22 (39 colonnes)
2025-12-01 22:54:56,180 - __main__ - INFO -    Minimum: 39
2025-12-01 22:54:56,180 - __main__ - INFO -    Maximum: 39
2025-12-01 22:54:56,180 - __main__ - INFO -    Moyenne: 39.0
2025-12-01 22:54:56,180 - __main__ - INFO - Features TO historiques: J-60 √† J-22 (39 colonnes)
2025-12-01 22:54:56,180 - __main__ - INFO - Nombre total de features: 79
2025-12-01 22:54:56,180 - __main__ - INFO -    - TO historiques: 39
2025-12-01 22:54:56,180 - __main__ - INFO -    - Features PM: 7
2025-12-01 22:54:56,180 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 22:54:56,180 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 22:54:56,180 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 22:54:56,180 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 22:54:56,180 - __main__ - INFO -    - Autres features: 11
2025-12-01 22:54:56,282 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-21\training_data_before_scaling.csv
2025-12-01 22:54:56,283 - __main__ - INFO -    Shape: (1463, 82)
2025-12-01 22:54:56,283 - __main__ - INFO -    Colonnes: stay_date, hotCode, 79 features, J-0
2025-12-01 22:54:56,283 - __main__ - INFO - X shape: (1463, 79), y shape: (1463,)
2025-12-01 22:54:56,283 - __main__ - INFO - ================================================================================
2025-12-01 22:54:56,283 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 22:54:56,283 - __main__ - INFO - ================================================================================
2025-12-01 22:54:56,288 - __main__ - INFO - Train: (1170, 79), Validation: (293, 79)
2025-12-01 22:54:56,288 - __main__ - INFO - Configuration de la recherche:
2025-12-01 22:54:56,288 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 22:54:56,288 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 22:54:56,288 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 22:54:56,288 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 22:54:56,288 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 22:56:38,292 - __main__ - INFO - ================================================================================
2025-12-01 22:56:38,293 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 22:56:38,293 - __main__ - INFO - ================================================================================
2025-12-01 22:56:38,293 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0777
2025-12-01 22:56:38,293 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 22:56:38,293 - __main__ - INFO -    - subsample: 0.95
2025-12-01 22:56:38,293 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 22:56:38,293 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 22:56:38,293 - __main__ - INFO -    - n_estimators: 500
2025-12-01 22:56:38,293 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 22:56:38,293 - __main__ - INFO -    - max_depth: 5
2025-12-01 22:56:38,293 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 22:56:38,293 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 22:56:38,298 - __main__ - INFO - 
Performances sur validation:
2025-12-01 22:56:38,298 - __main__ - INFO -    - MAE: 0.0811
2025-12-01 22:56:38,298 - __main__ - INFO -    - R¬≤: 0.6776
2025-12-01 22:56:38,298 - __main__ - INFO - ================================================================================
2025-12-01 22:56:38,298 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 22:56:38,299 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 22:56:38,301 - __main__ - INFO - Train: (1170, 79), Test: (293, 79)
2025-12-01 22:56:39,753 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 22:56:39,826 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-21\test_predictions.csv
2025-12-01 22:56:39,826 - __main__ - INFO -    Shape: (293, 85)
2025-12-01 22:56:39,826 - __main__ - INFO -    Colonnes: stay_date, hotCode, 79 features + y_test + y_pred + error + abs_error
2025-12-01 22:56:39,827 - __main__ - INFO -    MAE moyen: 0.0811
2025-12-01 22:56:39,832 - __main__ - INFO - üìä Test MAE: 0.0811
2025-12-01 22:56:39,833 - __main__ - INFO - üìä Test R¬≤: 0.6776
2025-12-01 22:56:39,833 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 22:56:40,342 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-21\xgb_scatter_plot.png
2025-12-01 22:56:40,706 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-21\xgb_feature_importance.png
2025-12-01 22:56:40,720 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-21\models...
2025-12-01 22:56:40,747 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-21\models\xgb_to_predictor.joblib
2025-12-01 22:56:40,748 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-21\models\xgb_scaler.joblib
2025-12-01 22:56:40,748 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-21\models\feature_columns.txt
2025-12-01 22:56:40,748 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 22:56:40,748 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 22:56:40,748 - __main__ - INFO -    Container: ml-models
2025-12-01 22:56:41,307 - __main__ - INFO -    Container existant trouv√©
2025-12-01 22:56:41,307 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-21/
2025-12-01 22:56:41,417 - __main__ - INFO -    ‚úì predictTo/D09/J-21/models/xgb_to_predictor.joblib
2025-12-01 22:56:41,433 - __main__ - INFO -    ‚úì predictTo/D09/J-21/models/xgb_scaler.joblib
2025-12-01 22:56:41,451 - __main__ - INFO -    ‚úì predictTo/D09/J-21/models/feature_columns.txt
2025-12-01 22:56:41,468 - __main__ - INFO -    ‚úì predictTo/D09/J-21/xgb_scatter_plot.png
2025-12-01 22:56:41,484 - __main__ - INFO -    ‚úì predictTo/D09/J-21/xgb_feature_importance.png
2025-12-01 22:56:41,559 - __main__ - INFO -    ‚úì predictTo/D09/J-21/training_data_before_scaling.csv
2025-12-01 22:56:41,592 - __main__ - INFO -    ‚úì predictTo/D09/J-21/test_predictions.csv
2025-12-01 22:56:41,593 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 22:56:41,593 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-21/
2025-12-01 22:56:41,594 - __main__ - INFO - ================================================================================
2025-12-01 22:56:41,594 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 22:56:41,594 - __main__ - INFO - ================================================================================
2025-12-01 22:56:41,594 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 22:56:41,594 - __main__ - INFO -    Train MAE:  0.0072
2025-12-01 22:56:41,594 - __main__ - INFO -    Train RMSE: 0.0097
2025-12-01 22:56:41,594 - __main__ - INFO -    Train R¬≤:   0.9967
2025-12-01 22:56:41,594 - __main__ - INFO -    Test MAE:   0.0811
2025-12-01 22:56:41,594 - __main__ - INFO -    Test RMSE:  0.1061
2025-12-01 22:56:41,594 - __main__ - INFO -    Test R¬≤:    0.6776
2025-12-01 22:56:47,103 - __main__ - INFO - ================================================================================
2025-12-01 22:56:47,103 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 22:56:47,103 - __main__ - INFO - ================================================================================
2025-12-01 22:56:47,103 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 22:56:47,106 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 22:56:47,106 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 15
2025-12-01 22:56:47,106 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 22:56:47,106 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 22:56:47,106 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 15, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 22:56:47,106 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 22:56:47,106 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 22:56:47,121 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 22:56:47,326 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 22:56:47,327 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 22:56:47,345 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 22:56:47,345 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 22:56:47,345 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 22:56:47,423 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 22:56:47,451 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 22:56:47,480 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 22:56:47,491 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 22:56:47,491 - __main__ - INFO - Calcul des features PM sur donn√©es J-16 √† J-60 (pas de data leakage)
2025-12-01 22:56:47,491 - __main__ - INFO -    Colonnes PM utilis√©es: 45
2025-12-01 22:56:48,865 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 22:56:48,865 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-16 √† J-60
2025-12-01 22:56:48,865 - __main__ - INFO -    Colonnes Ant utilis√©es: 45
2025-12-01 22:56:49,778 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 22:56:49,778 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-16 √† J-60
2025-12-01 22:56:49,778 - __main__ - INFO -    Colonnes Ds utilis√©es: 45
2025-12-01 22:56:50,670 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 22:56:50,670 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 22:56:50,781 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 22:56:50,782 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 22:56:50,933 - __main__ - INFO -    Features concurrentes calcul√©es sur J-16 √† J-60
2025-12-01 22:56:50,944 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 22:56:52,820 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 22:56:52,824 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 22:56:52,830 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 22:56:52,830 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 22:56:53,179 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 22:56:53,269 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 22:56:53,284 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 22:56:53,285 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 22:56:53,285 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 22:56:53,285 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 22:56:53,285 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 22:56:53,285 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 22:56:53,285 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 22:56:53,290 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 22:56:53,290 - __main__ - INFO - --------------------------------
2025-12-01 22:56:53,290 - __main__ - INFO - Horizon: 15
2025-12-01 22:56:53,290 - __main__ - INFO - --------------------------------
2025-12-01 22:56:53,290 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 22:56:53,292 - __main__ - INFO - nb_observations recalcul√© pour horizon=15
2025-12-01 22:56:53,293 - __main__ - INFO -    Colonnes TO compt√©es: J-60 √† J-16 (45 colonnes)
2025-12-01 22:56:53,293 - __main__ - INFO -    Minimum: 45
2025-12-01 22:56:53,293 - __main__ - INFO -    Maximum: 45
2025-12-01 22:56:53,294 - __main__ - INFO -    Moyenne: 45.0
2025-12-01 22:56:53,294 - __main__ - INFO - Features TO historiques: J-60 √† J-16 (45 colonnes)
2025-12-01 22:56:53,294 - __main__ - INFO - Nombre total de features: 85
2025-12-01 22:56:53,294 - __main__ - INFO -    - TO historiques: 45
2025-12-01 22:56:53,294 - __main__ - INFO -    - Features PM: 7
2025-12-01 22:56:53,294 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 22:56:53,294 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 22:56:53,294 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 22:56:53,294 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 22:56:53,294 - __main__ - INFO -    - Autres features: 11
2025-12-01 22:56:53,409 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-15\training_data_before_scaling.csv
2025-12-01 22:56:53,409 - __main__ - INFO -    Shape: (1463, 88)
2025-12-01 22:56:53,409 - __main__ - INFO -    Colonnes: stay_date, hotCode, 85 features, J-0
2025-12-01 22:56:53,409 - __main__ - INFO - X shape: (1463, 85), y shape: (1463,)
2025-12-01 22:56:53,409 - __main__ - INFO - ================================================================================
2025-12-01 22:56:53,409 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 22:56:53,409 - __main__ - INFO - ================================================================================
2025-12-01 22:56:53,413 - __main__ - INFO - Train: (1170, 85), Validation: (293, 85)
2025-12-01 22:56:53,413 - __main__ - INFO - Configuration de la recherche:
2025-12-01 22:56:53,413 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 22:56:53,413 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 22:56:53,413 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 22:56:53,413 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 22:56:53,413 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 22:58:44,818 - __main__ - INFO - ================================================================================
2025-12-01 22:58:44,818 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 22:58:44,818 - __main__ - INFO - ================================================================================
2025-12-01 22:58:44,819 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0728
2025-12-01 22:58:44,819 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 22:58:44,819 - __main__ - INFO -    - subsample: 0.95
2025-12-01 22:58:44,819 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 22:58:44,819 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 22:58:44,819 - __main__ - INFO -    - n_estimators: 500
2025-12-01 22:58:44,819 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 22:58:44,819 - __main__ - INFO -    - max_depth: 5
2025-12-01 22:58:44,819 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 22:58:44,819 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 22:58:44,825 - __main__ - INFO - 
Performances sur validation:
2025-12-01 22:58:44,826 - __main__ - INFO -    - MAE: 0.0741
2025-12-01 22:58:44,826 - __main__ - INFO -    - R¬≤: 0.7509
2025-12-01 22:58:44,826 - __main__ - INFO - ================================================================================
2025-12-01 22:58:44,827 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 22:58:44,827 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 22:58:44,830 - __main__ - INFO - Train: (1170, 85), Test: (293, 85)
2025-12-01 22:58:46,504 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 22:58:46,593 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-15\test_predictions.csv
2025-12-01 22:58:46,594 - __main__ - INFO -    Shape: (293, 91)
2025-12-01 22:58:46,594 - __main__ - INFO -    Colonnes: stay_date, hotCode, 85 features + y_test + y_pred + error + abs_error
2025-12-01 22:58:46,594 - __main__ - INFO -    MAE moyen: 0.0741
2025-12-01 22:58:46,600 - __main__ - INFO - üìä Test MAE: 0.0741
2025-12-01 22:58:46,601 - __main__ - INFO - üìä Test R¬≤: 0.7509
2025-12-01 22:58:46,601 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 22:58:47,098 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-15\xgb_scatter_plot.png
2025-12-01 22:58:47,430 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-15\xgb_feature_importance.png
2025-12-01 22:58:47,442 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-15\models...
2025-12-01 22:58:47,470 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-15\models\xgb_to_predictor.joblib
2025-12-01 22:58:47,470 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-15\models\xgb_scaler.joblib
2025-12-01 22:58:47,470 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-15\models\feature_columns.txt
2025-12-01 22:58:47,470 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 22:58:47,471 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 22:58:47,471 - __main__ - INFO -    Container: ml-models
2025-12-01 22:58:47,998 - __main__ - INFO -    Container existant trouv√©
2025-12-01 22:58:47,998 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-15/
2025-12-01 22:58:48,077 - __main__ - INFO -    ‚úì predictTo/D09/J-15/models/xgb_to_predictor.joblib
2025-12-01 22:58:48,094 - __main__ - INFO -    ‚úì predictTo/D09/J-15/models/xgb_scaler.joblib
2025-12-01 22:58:48,117 - __main__ - INFO -    ‚úì predictTo/D09/J-15/models/feature_columns.txt
2025-12-01 22:58:48,136 - __main__ - INFO -    ‚úì predictTo/D09/J-15/xgb_scatter_plot.png
2025-12-01 22:58:48,154 - __main__ - INFO -    ‚úì predictTo/D09/J-15/xgb_feature_importance.png
2025-12-01 22:58:48,291 - __main__ - INFO -    ‚úì predictTo/D09/J-15/training_data_before_scaling.csv
2025-12-01 22:58:48,328 - __main__ - INFO -    ‚úì predictTo/D09/J-15/test_predictions.csv
2025-12-01 22:58:48,328 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 22:58:48,328 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-15/
2025-12-01 22:58:48,329 - __main__ - INFO - ================================================================================
2025-12-01 22:58:48,329 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 22:58:48,329 - __main__ - INFO - ================================================================================
2025-12-01 22:58:48,330 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 22:58:48,330 - __main__ - INFO -    Train MAE:  0.0062
2025-12-01 22:58:48,330 - __main__ - INFO -    Train RMSE: 0.0085
2025-12-01 22:58:48,330 - __main__ - INFO -    Train R¬≤:   0.9975
2025-12-01 22:58:48,330 - __main__ - INFO -    Test MAE:   0.0741
2025-12-01 22:58:48,330 - __main__ - INFO -    Test RMSE:  0.0933
2025-12-01 22:58:48,330 - __main__ - INFO -    Test R¬≤:    0.7509
2025-12-01 22:58:54,213 - __main__ - INFO - ================================================================================
2025-12-01 22:58:54,214 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 22:58:54,214 - __main__ - INFO - ================================================================================
2025-12-01 22:58:54,214 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 22:58:54,217 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 22:58:54,217 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 10
2025-12-01 22:58:54,218 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 22:58:54,218 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 22:58:54,218 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 10, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 22:58:54,218 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 22:58:54,218 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 22:58:54,232 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 22:58:54,449 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 22:58:54,449 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 22:58:54,471 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 22:58:54,471 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 22:58:54,471 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 22:58:54,549 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 22:58:54,577 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 22:58:54,599 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 22:58:54,609 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 22:58:54,610 - __main__ - INFO - Calcul des features PM sur donn√©es J-11 √† J-60 (pas de data leakage)
2025-12-01 22:58:54,610 - __main__ - INFO -    Colonnes PM utilis√©es: 50
2025-12-01 22:58:55,863 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 22:58:55,863 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-11 √† J-60
2025-12-01 22:58:55,863 - __main__ - INFO -    Colonnes Ant utilis√©es: 50
2025-12-01 22:58:56,859 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 22:58:56,859 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-11 √† J-60
2025-12-01 22:58:56,859 - __main__ - INFO -    Colonnes Ds utilis√©es: 50
2025-12-01 22:58:57,693 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 22:58:57,694 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 22:58:57,806 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 22:58:57,807 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 22:58:57,968 - __main__ - INFO -    Features concurrentes calcul√©es sur J-11 √† J-60
2025-12-01 22:58:57,978 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 22:58:59,928 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 22:58:59,932 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 22:58:59,939 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 22:58:59,939 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 22:59:00,320 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 22:59:00,411 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 22:59:00,429 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 22:59:00,429 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 22:59:00,429 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 22:59:00,430 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 22:59:00,430 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 22:59:00,430 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 22:59:00,430 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 22:59:00,435 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 22:59:00,436 - __main__ - INFO - --------------------------------
2025-12-01 22:59:00,436 - __main__ - INFO - Horizon: 10
2025-12-01 22:59:00,436 - __main__ - INFO - --------------------------------
2025-12-01 22:59:00,436 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 22:59:00,437 - __main__ - INFO - nb_observations recalcul√© pour horizon=10
2025-12-01 22:59:00,437 - __main__ - INFO -    Colonnes TO compt√©es: J-60 √† J-11 (50 colonnes)
2025-12-01 22:59:00,437 - __main__ - INFO -    Minimum: 50
2025-12-01 22:59:00,438 - __main__ - INFO -    Maximum: 50
2025-12-01 22:59:00,438 - __main__ - INFO -    Moyenne: 50.0
2025-12-01 22:59:00,438 - __main__ - INFO - Features TO historiques: J-60 √† J-11 (50 colonnes)
2025-12-01 22:59:00,438 - __main__ - INFO - Nombre total de features: 90
2025-12-01 22:59:00,438 - __main__ - INFO -    - TO historiques: 50
2025-12-01 22:59:00,438 - __main__ - INFO -    - Features PM: 7
2025-12-01 22:59:00,438 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 22:59:00,438 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 22:59:00,438 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 22:59:00,438 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 22:59:00,438 - __main__ - INFO -    - Autres features: 11
2025-12-01 22:59:00,548 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-10\training_data_before_scaling.csv
2025-12-01 22:59:00,548 - __main__ - INFO -    Shape: (1463, 93)
2025-12-01 22:59:00,548 - __main__ - INFO -    Colonnes: stay_date, hotCode, 90 features, J-0
2025-12-01 22:59:00,548 - __main__ - INFO - X shape: (1463, 90), y shape: (1463,)
2025-12-01 22:59:00,548 - __main__ - INFO - ================================================================================
2025-12-01 22:59:00,548 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 22:59:00,548 - __main__ - INFO - ================================================================================
2025-12-01 22:59:00,553 - __main__ - INFO - Train: (1170, 90), Validation: (293, 90)
2025-12-01 22:59:00,553 - __main__ - INFO - Configuration de la recherche:
2025-12-01 22:59:00,553 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 22:59:00,553 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 22:59:00,554 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 22:59:00,554 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 22:59:00,554 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 23:01:00,123 - __main__ - INFO - ================================================================================
2025-12-01 23:01:00,123 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 23:01:00,123 - __main__ - INFO - ================================================================================
2025-12-01 23:01:00,123 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0646
2025-12-01 23:01:00,123 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 23:01:00,123 - __main__ - INFO -    - subsample: 0.95
2025-12-01 23:01:00,123 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 23:01:00,123 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 23:01:00,124 - __main__ - INFO -    - n_estimators: 500
2025-12-01 23:01:00,124 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 23:01:00,124 - __main__ - INFO -    - max_depth: 5
2025-12-01 23:01:00,124 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 23:01:00,124 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 23:01:00,128 - __main__ - INFO - 
Performances sur validation:
2025-12-01 23:01:00,128 - __main__ - INFO -    - MAE: 0.0658
2025-12-01 23:01:00,128 - __main__ - INFO -    - R¬≤: 0.7980
2025-12-01 23:01:00,128 - __main__ - INFO - ================================================================================
2025-12-01 23:01:00,129 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 23:01:00,129 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 23:01:00,132 - __main__ - INFO - Train: (1170, 90), Test: (293, 90)
2025-12-01 23:01:02,313 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 23:01:02,406 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-10\test_predictions.csv
2025-12-01 23:01:02,407 - __main__ - INFO -    Shape: (293, 96)
2025-12-01 23:01:02,407 - __main__ - INFO -    Colonnes: stay_date, hotCode, 90 features + y_test + y_pred + error + abs_error
2025-12-01 23:01:02,407 - __main__ - INFO -    MAE moyen: 0.0658
2025-12-01 23:01:02,413 - __main__ - INFO - üìä Test MAE: 0.0658
2025-12-01 23:01:02,413 - __main__ - INFO - üìä Test R¬≤: 0.7980
2025-12-01 23:01:02,413 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 23:01:02,849 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-10\xgb_scatter_plot.png
2025-12-01 23:01:03,175 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-10\xgb_feature_importance.png
2025-12-01 23:01:03,187 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-10\models...
2025-12-01 23:01:03,216 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-10\models\xgb_to_predictor.joblib
2025-12-01 23:01:03,216 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-10\models\xgb_scaler.joblib
2025-12-01 23:01:03,216 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-10\models\feature_columns.txt
2025-12-01 23:01:03,216 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 23:01:03,217 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 23:01:03,217 - __main__ - INFO -    Container: ml-models
2025-12-01 23:01:03,777 - __main__ - INFO -    Container existant trouv√©
2025-12-01 23:01:03,777 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-10/
2025-12-01 23:01:03,876 - __main__ - INFO -    ‚úì predictTo/D09/J-10/models/xgb_to_predictor.joblib
2025-12-01 23:01:03,894 - __main__ - INFO -    ‚úì predictTo/D09/J-10/models/xgb_scaler.joblib
2025-12-01 23:01:03,928 - __main__ - INFO -    ‚úì predictTo/D09/J-10/models/feature_columns.txt
2025-12-01 23:01:03,944 - __main__ - INFO -    ‚úì predictTo/D09/J-10/xgb_scatter_plot.png
2025-12-01 23:01:03,962 - __main__ - INFO -    ‚úì predictTo/D09/J-10/xgb_feature_importance.png
2025-12-01 23:01:04,112 - __main__ - INFO -    ‚úì predictTo/D09/J-10/training_data_before_scaling.csv
2025-12-01 23:01:04,148 - __main__ - INFO -    ‚úì predictTo/D09/J-10/test_predictions.csv
2025-12-01 23:01:04,148 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 23:01:04,148 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-10/
2025-12-01 23:01:04,149 - __main__ - INFO - ================================================================================
2025-12-01 23:01:04,149 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 23:01:04,149 - __main__ - INFO - ================================================================================
2025-12-01 23:01:04,149 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 23:01:04,149 - __main__ - INFO -    Train MAE:  0.0055
2025-12-01 23:01:04,149 - __main__ - INFO -    Train RMSE: 0.0076
2025-12-01 23:01:04,149 - __main__ - INFO -    Train R¬≤:   0.9980
2025-12-01 23:01:04,149 - __main__ - INFO -    Test MAE:   0.0658
2025-12-01 23:01:04,149 - __main__ - INFO -    Test RMSE:  0.0840
2025-12-01 23:01:04,149 - __main__ - INFO -    Test R¬≤:    0.7980
2025-12-01 23:01:09,934 - __main__ - INFO - ================================================================================
2025-12-01 23:01:09,935 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 23:01:09,935 - __main__ - INFO - ================================================================================
2025-12-01 23:01:09,935 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 23:01:09,939 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 23:01:09,939 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 7
2025-12-01 23:01:09,939 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 23:01:09,939 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 23:01:09,939 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 23:01:09,939 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 23:01:09,939 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 23:01:09,956 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 23:01:10,169 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 23:01:10,169 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 23:01:10,190 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 23:01:10,190 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 23:01:10,190 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 23:01:10,279 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 23:01:10,308 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 23:01:10,336 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 23:01:10,350 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 23:01:10,351 - __main__ - INFO - Calcul des features PM sur donn√©es J-8 √† J-60 (pas de data leakage)
2025-12-01 23:01:10,351 - __main__ - INFO -    Colonnes PM utilis√©es: 53
2025-12-01 23:01:12,086 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 23:01:12,086 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-8 √† J-60
2025-12-01 23:01:12,086 - __main__ - INFO -    Colonnes Ant utilis√©es: 53
2025-12-01 23:01:12,979 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 23:01:12,979 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-8 √† J-60
2025-12-01 23:01:12,979 - __main__ - INFO -    Colonnes Ds utilis√©es: 53
2025-12-01 23:01:13,789 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 23:01:13,789 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 23:01:13,896 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 23:01:13,896 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 23:01:14,042 - __main__ - INFO -    Features concurrentes calcul√©es sur J-8 √† J-60
2025-12-01 23:01:14,054 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 23:01:15,857 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 23:01:15,862 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 23:01:15,868 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 23:01:15,868 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 23:01:16,264 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 23:01:16,357 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 23:01:16,372 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 23:01:16,372 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 23:01:16,372 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 23:01:16,372 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 23:01:16,372 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 23:01:16,372 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 23:01:16,372 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 23:01:16,377 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 23:01:16,378 - __main__ - INFO - --------------------------------
2025-12-01 23:01:16,378 - __main__ - INFO - Horizon: 7
2025-12-01 23:01:16,378 - __main__ - INFO - --------------------------------
2025-12-01 23:01:16,378 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 23:01:16,379 - __main__ - INFO - nb_observations recalcul√© pour horizon=7
2025-12-01 23:01:16,379 - __main__ - INFO -    Colonnes TO compt√©es: J-60 √† J-8 (53 colonnes)
2025-12-01 23:01:16,379 - __main__ - INFO -    Minimum: 53
2025-12-01 23:01:16,379 - __main__ - INFO -    Maximum: 53
2025-12-01 23:01:16,379 - __main__ - INFO -    Moyenne: 53.0
2025-12-01 23:01:16,379 - __main__ - INFO - Features TO historiques: J-60 √† J-8 (53 colonnes)
2025-12-01 23:01:16,379 - __main__ - INFO - Nombre total de features: 93
2025-12-01 23:01:16,380 - __main__ - INFO -    - TO historiques: 53
2025-12-01 23:01:16,380 - __main__ - INFO -    - Features PM: 7
2025-12-01 23:01:16,380 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 23:01:16,380 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 23:01:16,380 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 23:01:16,380 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 23:01:16,380 - __main__ - INFO -    - Autres features: 11
2025-12-01 23:01:16,497 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-7\training_data_before_scaling.csv
2025-12-01 23:01:16,497 - __main__ - INFO -    Shape: (1463, 96)
2025-12-01 23:01:16,497 - __main__ - INFO -    Colonnes: stay_date, hotCode, 93 features, J-0
2025-12-01 23:01:16,498 - __main__ - INFO - X shape: (1463, 93), y shape: (1463,)
2025-12-01 23:01:16,498 - __main__ - INFO - ================================================================================
2025-12-01 23:01:16,498 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 23:01:16,498 - __main__ - INFO - ================================================================================
2025-12-01 23:01:16,502 - __main__ - INFO - Train: (1170, 93), Validation: (293, 93)
2025-12-01 23:01:16,503 - __main__ - INFO - Configuration de la recherche:
2025-12-01 23:01:16,503 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 23:01:16,503 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 23:01:16,503 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 23:01:16,503 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 23:01:16,503 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 23:03:14,761 - __main__ - INFO - ================================================================================
2025-12-01 23:03:14,761 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 23:03:14,761 - __main__ - INFO - ================================================================================
2025-12-01 23:03:14,762 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0598
2025-12-01 23:03:14,762 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 23:03:14,762 - __main__ - INFO -    - subsample: 0.95
2025-12-01 23:03:14,762 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 23:03:14,762 - __main__ - INFO -    - reg_alpha: 0.1
2025-12-01 23:03:14,762 - __main__ - INFO -    - n_estimators: 600
2025-12-01 23:03:14,762 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 23:03:14,762 - __main__ - INFO -    - max_depth: 5
2025-12-01 23:03:14,762 - __main__ - INFO -    - learning_rate: 0.01
2025-12-01 23:03:14,762 - __main__ - INFO -    - colsample_bytree: 0.85
2025-12-01 23:03:14,769 - __main__ - INFO - 
Performances sur validation:
2025-12-01 23:03:14,769 - __main__ - INFO -    - MAE: 0.0648
2025-12-01 23:03:14,769 - __main__ - INFO -    - R¬≤: 0.7994
2025-12-01 23:03:14,770 - __main__ - INFO - ================================================================================
2025-12-01 23:03:14,770 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 23:03:14,770 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 23:03:14,773 - __main__ - INFO - Train: (1170, 93), Test: (293, 93)
2025-12-01 23:03:17,043 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 23:03:17,146 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-7\test_predictions.csv
2025-12-01 23:03:17,146 - __main__ - INFO -    Shape: (293, 99)
2025-12-01 23:03:17,146 - __main__ - INFO -    Colonnes: stay_date, hotCode, 93 features + y_test + y_pred + error + abs_error
2025-12-01 23:03:17,147 - __main__ - INFO -    MAE moyen: 0.0648
2025-12-01 23:03:17,153 - __main__ - INFO - üìä Test MAE: 0.0648
2025-12-01 23:03:17,154 - __main__ - INFO - üìä Test R¬≤: 0.7994
2025-12-01 23:03:17,154 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 23:03:17,577 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-7\xgb_scatter_plot.png
2025-12-01 23:03:17,898 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-7\xgb_feature_importance.png
2025-12-01 23:03:17,914 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-7\models...
2025-12-01 23:03:17,946 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-7\models\xgb_to_predictor.joblib
2025-12-01 23:03:17,946 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-7\models\xgb_scaler.joblib
2025-12-01 23:03:17,947 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-7\models\feature_columns.txt
2025-12-01 23:03:17,947 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 23:03:17,947 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 23:03:17,947 - __main__ - INFO -    Container: ml-models
2025-12-01 23:03:18,479 - __main__ - INFO -    Container existant trouv√©
2025-12-01 23:03:18,479 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-7/
2025-12-01 23:03:18,652 - __main__ - INFO -    ‚úì predictTo/D09/J-7/models/xgb_to_predictor.joblib
2025-12-01 23:03:18,668 - __main__ - INFO -    ‚úì predictTo/D09/J-7/models/xgb_scaler.joblib
2025-12-01 23:03:18,684 - __main__ - INFO -    ‚úì predictTo/D09/J-7/models/feature_columns.txt
2025-12-01 23:03:18,701 - __main__ - INFO -    ‚úì predictTo/D09/J-7/xgb_scatter_plot.png
2025-12-01 23:03:18,719 - __main__ - INFO -    ‚úì predictTo/D09/J-7/xgb_feature_importance.png
2025-12-01 23:03:18,859 - __main__ - INFO -    ‚úì predictTo/D09/J-7/training_data_before_scaling.csv
2025-12-01 23:03:18,896 - __main__ - INFO -    ‚úì predictTo/D09/J-7/test_predictions.csv
2025-12-01 23:03:18,896 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 23:03:18,896 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-7/
2025-12-01 23:03:18,897 - __main__ - INFO - ================================================================================
2025-12-01 23:03:18,897 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 23:03:18,897 - __main__ - INFO - ================================================================================
2025-12-01 23:03:18,897 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 23:03:18,897 - __main__ - INFO -    Train MAE:  0.0287
2025-12-01 23:03:18,897 - __main__ - INFO -    Train RMSE: 0.0370
2025-12-01 23:03:18,897 - __main__ - INFO -    Train R¬≤:   0.9523
2025-12-01 23:03:18,897 - __main__ - INFO -    Test MAE:   0.0648
2025-12-01 23:03:18,897 - __main__ - INFO -    Test RMSE:  0.0837
2025-12-01 23:03:18,897 - __main__ - INFO -    Test R¬≤:    0.7994
2025-12-01 23:03:24,505 - __main__ - INFO - ================================================================================
2025-12-01 23:03:24,505 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 23:03:24,505 - __main__ - INFO - ================================================================================
2025-12-01 23:03:24,505 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 23:03:24,509 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 23:03:24,509 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 5
2025-12-01 23:03:24,509 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 23:03:24,509 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 23:03:24,509 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 5, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 23:03:24,509 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 23:03:24,509 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 23:03:24,524 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 23:03:24,754 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 23:03:24,755 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 23:03:24,775 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 23:03:24,775 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 23:03:24,775 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 23:03:24,857 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 23:03:24,883 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 23:03:24,912 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 23:03:24,923 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 23:03:24,924 - __main__ - INFO - Calcul des features PM sur donn√©es J-6 √† J-60 (pas de data leakage)
2025-12-01 23:03:24,924 - __main__ - INFO -    Colonnes PM utilis√©es: 55
2025-12-01 23:03:26,273 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 23:03:26,273 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-6 √† J-60
2025-12-01 23:03:26,273 - __main__ - INFO -    Colonnes Ant utilis√©es: 55
2025-12-01 23:03:27,329 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 23:03:27,329 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-6 √† J-60
2025-12-01 23:03:27,329 - __main__ - INFO -    Colonnes Ds utilis√©es: 55
2025-12-01 23:03:28,209 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 23:03:28,210 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 23:03:28,320 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 23:03:28,320 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 23:03:28,459 - __main__ - INFO -    Features concurrentes calcul√©es sur J-6 √† J-60
2025-12-01 23:03:28,471 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 23:03:30,352 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 23:03:30,357 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 23:03:30,363 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 23:03:30,363 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 23:03:30,748 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 23:03:30,860 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 23:03:30,877 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 23:03:30,877 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 23:03:30,877 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 23:03:30,877 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 23:03:30,877 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 23:03:30,878 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 23:03:30,878 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 23:03:30,885 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 23:03:30,885 - __main__ - INFO - --------------------------------
2025-12-01 23:03:30,885 - __main__ - INFO - Horizon: 5
2025-12-01 23:03:30,885 - __main__ - INFO - --------------------------------
2025-12-01 23:03:30,886 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 23:03:30,888 - __main__ - INFO - nb_observations recalcul√© pour horizon=5
2025-12-01 23:03:30,888 - __main__ - INFO -    Colonnes TO compt√©es: J-60 √† J-6 (55 colonnes)
2025-12-01 23:03:30,888 - __main__ - INFO -    Minimum: 55
2025-12-01 23:03:30,889 - __main__ - INFO -    Maximum: 55
2025-12-01 23:03:30,889 - __main__ - INFO -    Moyenne: 55.0
2025-12-01 23:03:30,889 - __main__ - INFO - Features TO historiques: J-60 √† J-6 (55 colonnes)
2025-12-01 23:03:30,889 - __main__ - INFO - Nombre total de features: 95
2025-12-01 23:03:30,889 - __main__ - INFO -    - TO historiques: 55
2025-12-01 23:03:30,889 - __main__ - INFO -    - Features PM: 7
2025-12-01 23:03:30,889 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 23:03:30,889 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 23:03:30,889 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 23:03:30,889 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 23:03:30,889 - __main__ - INFO -    - Autres features: 11
2025-12-01 23:03:31,019 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-5\training_data_before_scaling.csv
2025-12-01 23:03:31,019 - __main__ - INFO -    Shape: (1463, 98)
2025-12-01 23:03:31,019 - __main__ - INFO -    Colonnes: stay_date, hotCode, 95 features, J-0
2025-12-01 23:03:31,019 - __main__ - INFO - X shape: (1463, 95), y shape: (1463,)
2025-12-01 23:03:31,020 - __main__ - INFO - ================================================================================
2025-12-01 23:03:31,020 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 23:03:31,020 - __main__ - INFO - ================================================================================
2025-12-01 23:03:31,024 - __main__ - INFO - Train: (1170, 95), Validation: (293, 95)
2025-12-01 23:03:31,024 - __main__ - INFO - Configuration de la recherche:
2025-12-01 23:03:31,024 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 23:03:31,024 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 23:03:31,024 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 23:03:31,024 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 23:03:31,024 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 23:05:26,883 - __main__ - INFO - ================================================================================
2025-12-01 23:05:26,883 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 23:05:26,883 - __main__ - INFO - ================================================================================
2025-12-01 23:05:26,883 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0540
2025-12-01 23:05:26,883 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 23:05:26,883 - __main__ - INFO -    - subsample: 0.95
2025-12-01 23:05:26,883 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 23:05:26,883 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 23:05:26,883 - __main__ - INFO -    - n_estimators: 500
2025-12-01 23:05:26,884 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 23:05:26,884 - __main__ - INFO -    - max_depth: 5
2025-12-01 23:05:26,884 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 23:05:26,884 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 23:05:26,888 - __main__ - INFO - 
Performances sur validation:
2025-12-01 23:05:26,888 - __main__ - INFO -    - MAE: 0.0590
2025-12-01 23:05:26,889 - __main__ - INFO -    - R¬≤: 0.8319
2025-12-01 23:05:26,889 - __main__ - INFO - ================================================================================
2025-12-01 23:05:26,889 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 23:05:26,889 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 23:05:26,892 - __main__ - INFO - Train: (1170, 95), Test: (293, 95)
2025-12-01 23:05:28,636 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 23:05:28,733 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-5\test_predictions.csv
2025-12-01 23:05:28,734 - __main__ - INFO -    Shape: (293, 101)
2025-12-01 23:05:28,734 - __main__ - INFO -    Colonnes: stay_date, hotCode, 95 features + y_test + y_pred + error + abs_error
2025-12-01 23:05:28,734 - __main__ - INFO -    MAE moyen: 0.0590
2025-12-01 23:05:28,740 - __main__ - INFO - üìä Test MAE: 0.0590
2025-12-01 23:05:28,740 - __main__ - INFO - üìä Test R¬≤: 0.8319
2025-12-01 23:05:28,741 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 23:05:29,147 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-5\xgb_scatter_plot.png
2025-12-01 23:05:29,452 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-5\xgb_feature_importance.png
2025-12-01 23:05:29,468 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-5\models...
2025-12-01 23:05:29,498 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-5\models\xgb_to_predictor.joblib
2025-12-01 23:05:29,498 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-5\models\xgb_scaler.joblib
2025-12-01 23:05:29,498 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-5\models\feature_columns.txt
2025-12-01 23:05:29,498 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 23:05:29,498 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 23:05:29,499 - __main__ - INFO -    Container: ml-models
2025-12-01 23:05:29,980 - __main__ - INFO -    Container existant trouv√©
2025-12-01 23:05:29,980 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-5/
2025-12-01 23:05:30,055 - __main__ - INFO -    ‚úì predictTo/D09/J-5/models/xgb_to_predictor.joblib
2025-12-01 23:05:30,072 - __main__ - INFO -    ‚úì predictTo/D09/J-5/models/xgb_scaler.joblib
2025-12-01 23:05:30,088 - __main__ - INFO -    ‚úì predictTo/D09/J-5/models/feature_columns.txt
2025-12-01 23:05:30,103 - __main__ - INFO -    ‚úì predictTo/D09/J-5/xgb_scatter_plot.png
2025-12-01 23:05:30,120 - __main__ - INFO -    ‚úì predictTo/D09/J-5/xgb_feature_importance.png
2025-12-01 23:05:30,246 - __main__ - INFO -    ‚úì predictTo/D09/J-5/training_data_before_scaling.csv
2025-12-01 23:05:30,289 - __main__ - INFO -    ‚úì predictTo/D09/J-5/test_predictions.csv
2025-12-01 23:05:30,290 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 23:05:30,290 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-5/
2025-12-01 23:05:30,291 - __main__ - INFO - ================================================================================
2025-12-01 23:05:30,291 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 23:05:30,291 - __main__ - INFO - ================================================================================
2025-12-01 23:05:30,291 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 23:05:30,291 - __main__ - INFO -    Train MAE:  0.0045
2025-12-01 23:05:30,291 - __main__ - INFO -    Train RMSE: 0.0060
2025-12-01 23:05:30,291 - __main__ - INFO -    Train R¬≤:   0.9987
2025-12-01 23:05:30,291 - __main__ - INFO -    Test MAE:   0.0590
2025-12-01 23:05:30,291 - __main__ - INFO -    Test RMSE:  0.0766
2025-12-01 23:05:30,291 - __main__ - INFO -    Test R¬≤:    0.8319
2025-12-01 23:05:35,558 - __main__ - INFO - ================================================================================
2025-12-01 23:05:35,558 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 23:05:35,558 - __main__ - INFO - ================================================================================
2025-12-01 23:05:35,558 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 23:05:35,562 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 23:05:35,562 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 3
2025-12-01 23:05:35,562 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 23:05:35,562 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 23:05:35,562 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 3, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 23:05:35,562 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 23:05:35,562 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 23:05:35,576 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 23:05:35,771 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 23:05:35,771 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 23:05:35,789 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 23:05:35,789 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 23:05:35,789 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 23:05:35,865 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 23:05:35,885 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 23:05:35,904 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 23:05:35,910 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 23:05:35,911 - __main__ - INFO - Calcul des features PM sur donn√©es J-4 √† J-60 (pas de data leakage)
2025-12-01 23:05:35,911 - __main__ - INFO -    Colonnes PM utilis√©es: 57
2025-12-01 23:05:37,056 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 23:05:37,056 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-4 √† J-60
2025-12-01 23:05:37,056 - __main__ - INFO -    Colonnes Ant utilis√©es: 57
2025-12-01 23:05:37,887 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 23:05:37,887 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-4 √† J-60
2025-12-01 23:05:37,887 - __main__ - INFO -    Colonnes Ds utilis√©es: 57
2025-12-01 23:05:38,720 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 23:05:38,720 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 23:05:38,832 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 23:05:38,832 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 23:05:38,972 - __main__ - INFO -    Features concurrentes calcul√©es sur J-4 √† J-60
2025-12-01 23:05:38,984 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 23:05:41,071 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 23:05:41,076 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 23:05:41,083 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 23:05:41,083 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 23:05:41,506 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 23:05:41,600 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 23:05:41,614 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 23:05:41,615 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 23:05:41,615 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 23:05:41,615 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 23:05:41,615 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 23:05:41,615 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 23:05:41,615 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 23:05:41,620 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 23:05:41,620 - __main__ - INFO - --------------------------------
2025-12-01 23:05:41,620 - __main__ - INFO - Horizon: 3
2025-12-01 23:05:41,620 - __main__ - INFO - --------------------------------
2025-12-01 23:05:41,621 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 23:05:41,622 - __main__ - INFO - nb_observations recalcul√© pour horizon=3
2025-12-01 23:05:41,622 - __main__ - INFO -    Colonnes TO compt√©es: J-60 √† J-4 (57 colonnes)
2025-12-01 23:05:41,622 - __main__ - INFO -    Minimum: 57
2025-12-01 23:05:41,622 - __main__ - INFO -    Maximum: 57
2025-12-01 23:05:41,622 - __main__ - INFO -    Moyenne: 57.0
2025-12-01 23:05:41,623 - __main__ - INFO - Features TO historiques: J-60 √† J-4 (57 colonnes)
2025-12-01 23:05:41,623 - __main__ - INFO - Nombre total de features: 97
2025-12-01 23:05:41,623 - __main__ - INFO -    - TO historiques: 57
2025-12-01 23:05:41,623 - __main__ - INFO -    - Features PM: 7
2025-12-01 23:05:41,623 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 23:05:41,623 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 23:05:41,623 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 23:05:41,623 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 23:05:41,623 - __main__ - INFO -    - Autres features: 11
2025-12-01 23:05:41,753 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-3\training_data_before_scaling.csv
2025-12-01 23:05:41,753 - __main__ - INFO -    Shape: (1463, 100)
2025-12-01 23:05:41,753 - __main__ - INFO -    Colonnes: stay_date, hotCode, 97 features, J-0
2025-12-01 23:05:41,753 - __main__ - INFO - X shape: (1463, 97), y shape: (1463,)
2025-12-01 23:05:41,753 - __main__ - INFO - ================================================================================
2025-12-01 23:05:41,753 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 23:05:41,753 - __main__ - INFO - ================================================================================
2025-12-01 23:05:41,758 - __main__ - INFO - Train: (1170, 97), Validation: (293, 97)
2025-12-01 23:05:41,758 - __main__ - INFO - Configuration de la recherche:
2025-12-01 23:05:41,758 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 23:05:41,758 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 23:05:41,758 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 23:05:41,758 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 23:05:41,758 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 23:07:40,801 - __main__ - INFO - ================================================================================
2025-12-01 23:07:40,801 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 23:07:40,801 - __main__ - INFO - ================================================================================
2025-12-01 23:07:40,801 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0490
2025-12-01 23:07:40,801 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 23:07:40,801 - __main__ - INFO -    - subsample: 0.95
2025-12-01 23:07:40,801 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 23:07:40,802 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 23:07:40,802 - __main__ - INFO -    - n_estimators: 500
2025-12-01 23:07:40,802 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 23:07:40,802 - __main__ - INFO -    - max_depth: 5
2025-12-01 23:07:40,802 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 23:07:40,802 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 23:07:40,807 - __main__ - INFO - 
Performances sur validation:
2025-12-01 23:07:40,807 - __main__ - INFO -    - MAE: 0.0502
2025-12-01 23:07:40,807 - __main__ - INFO -    - R¬≤: 0.8784
2025-12-01 23:07:40,807 - __main__ - INFO - ================================================================================
2025-12-01 23:07:40,808 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 23:07:40,808 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 23:07:40,811 - __main__ - INFO - Train: (1170, 97), Test: (293, 97)
2025-12-01 23:07:42,844 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 23:07:42,953 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-3\test_predictions.csv
2025-12-01 23:07:42,953 - __main__ - INFO -    Shape: (293, 103)
2025-12-01 23:07:42,953 - __main__ - INFO -    Colonnes: stay_date, hotCode, 97 features + y_test + y_pred + error + abs_error
2025-12-01 23:07:42,954 - __main__ - INFO -    MAE moyen: 0.0502
2025-12-01 23:07:42,960 - __main__ - INFO - üìä Test MAE: 0.0502
2025-12-01 23:07:42,960 - __main__ - INFO - üìä Test R¬≤: 0.8784
2025-12-01 23:07:42,961 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 23:07:43,432 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-3\xgb_scatter_plot.png
2025-12-01 23:07:43,786 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-3\xgb_feature_importance.png
2025-12-01 23:07:43,797 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-3\models...
2025-12-01 23:07:43,824 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-3\models\xgb_to_predictor.joblib
2025-12-01 23:07:43,824 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-3\models\xgb_scaler.joblib
2025-12-01 23:07:43,824 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-3\models\feature_columns.txt
2025-12-01 23:07:43,824 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 23:07:43,824 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 23:07:43,825 - __main__ - INFO -    Container: ml-models
2025-12-01 23:07:44,349 - __main__ - INFO -    Container existant trouv√©
2025-12-01 23:07:44,349 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-3/
2025-12-01 23:07:44,431 - __main__ - INFO -    ‚úì predictTo/D09/J-3/models/xgb_to_predictor.joblib
2025-12-01 23:07:44,446 - __main__ - INFO -    ‚úì predictTo/D09/J-3/models/xgb_scaler.joblib
2025-12-01 23:07:44,464 - __main__ - INFO -    ‚úì predictTo/D09/J-3/models/feature_columns.txt
2025-12-01 23:07:44,481 - __main__ - INFO -    ‚úì predictTo/D09/J-3/xgb_scatter_plot.png
2025-12-01 23:07:44,499 - __main__ - INFO -    ‚úì predictTo/D09/J-3/xgb_feature_importance.png
2025-12-01 23:07:44,648 - __main__ - INFO -    ‚úì predictTo/D09/J-3/training_data_before_scaling.csv
2025-12-01 23:07:44,686 - __main__ - INFO -    ‚úì predictTo/D09/J-3/test_predictions.csv
2025-12-01 23:07:44,686 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 23:07:44,686 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-3/
2025-12-01 23:07:44,687 - __main__ - INFO - ================================================================================
2025-12-01 23:07:44,687 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 23:07:44,687 - __main__ - INFO - ================================================================================
2025-12-01 23:07:44,687 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 23:07:44,687 - __main__ - INFO -    Train MAE:  0.0040
2025-12-01 23:07:44,687 - __main__ - INFO -    Train RMSE: 0.0053
2025-12-01 23:07:44,687 - __main__ - INFO -    Train R¬≤:   0.9990
2025-12-01 23:07:44,687 - __main__ - INFO -    Test MAE:   0.0502
2025-12-01 23:07:44,687 - __main__ - INFO -    Test RMSE:  0.0652
2025-12-01 23:07:44,687 - __main__ - INFO -    Test R¬≤:    0.8784
2025-12-01 23:07:50,436 - __main__ - INFO - ================================================================================
2025-12-01 23:07:50,436 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 23:07:50,437 - __main__ - INFO - ================================================================================
2025-12-01 23:07:50,437 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 23:07:50,440 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 23:07:50,440 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 1
2025-12-01 23:07:50,440 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 23:07:50,440 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 23:07:50,440 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 1, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 23:07:50,440 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 23:07:50,440 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 23:07:50,454 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 23:07:50,660 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 23:07:50,660 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 23:07:50,682 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 23:07:50,682 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 23:07:50,682 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 23:07:50,762 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 23:07:50,786 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 23:07:50,812 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 23:07:50,823 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 23:07:50,823 - __main__ - INFO - Calcul des features PM sur donn√©es J-2 √† J-60 (pas de data leakage)
2025-12-01 23:07:50,823 - __main__ - INFO -    Colonnes PM utilis√©es: 59
2025-12-01 23:07:52,033 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 23:07:52,033 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-2 √† J-60
2025-12-01 23:07:52,033 - __main__ - INFO -    Colonnes Ant utilis√©es: 59
2025-12-01 23:07:52,931 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 23:07:52,932 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-2 √† J-60
2025-12-01 23:07:52,932 - __main__ - INFO -    Colonnes Ds utilis√©es: 59
2025-12-01 23:07:53,784 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 23:07:53,784 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 23:07:53,907 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 23:07:53,907 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 23:07:54,050 - __main__ - INFO -    Features concurrentes calcul√©es sur J-2 √† J-60
2025-12-01 23:07:54,062 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 23:07:56,129 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 23:07:56,134 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 23:07:56,140 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 23:07:56,140 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 23:07:56,624 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 23:07:56,738 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 23:07:56,755 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 23:07:56,756 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 23:07:56,756 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 23:07:56,756 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 23:07:56,756 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 23:07:56,756 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 23:07:56,756 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 23:07:56,764 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 23:07:56,764 - __main__ - INFO - --------------------------------
2025-12-01 23:07:56,764 - __main__ - INFO - Horizon: 1
2025-12-01 23:07:56,764 - __main__ - INFO - --------------------------------
2025-12-01 23:07:56,766 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 23:07:56,768 - __main__ - INFO - nb_observations recalcul√© pour horizon=1
2025-12-01 23:07:56,768 - __main__ - INFO -    Colonnes TO compt√©es: J-60 √† J-2 (59 colonnes)
2025-12-01 23:07:56,769 - __main__ - INFO -    Minimum: 59
2025-12-01 23:07:56,769 - __main__ - INFO -    Maximum: 59
2025-12-01 23:07:56,769 - __main__ - INFO -    Moyenne: 59.0
2025-12-01 23:07:56,769 - __main__ - INFO - Features TO historiques: J-60 √† J-2 (59 colonnes)
2025-12-01 23:07:56,769 - __main__ - INFO - Nombre total de features: 99
2025-12-01 23:07:56,769 - __main__ - INFO -    - TO historiques: 59
2025-12-01 23:07:56,769 - __main__ - INFO -    - Features PM: 7
2025-12-01 23:07:56,769 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 23:07:56,769 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 23:07:56,769 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 23:07:56,769 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 23:07:56,769 - __main__ - INFO -    - Autres features: 11
2025-12-01 23:07:56,913 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-1\training_data_before_scaling.csv
2025-12-01 23:07:56,913 - __main__ - INFO -    Shape: (1463, 102)
2025-12-01 23:07:56,913 - __main__ - INFO -    Colonnes: stay_date, hotCode, 99 features, J-0
2025-12-01 23:07:56,913 - __main__ - INFO - X shape: (1463, 99), y shape: (1463,)
2025-12-01 23:07:56,913 - __main__ - INFO - ================================================================================
2025-12-01 23:07:56,913 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 23:07:56,913 - __main__ - INFO - ================================================================================
2025-12-01 23:07:56,919 - __main__ - INFO - Train: (1170, 99), Validation: (293, 99)
2025-12-01 23:07:56,919 - __main__ - INFO - Configuration de la recherche:
2025-12-01 23:07:56,919 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 23:07:56,919 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 23:07:56,919 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 23:07:56,919 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 23:07:56,919 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 23:09:46,801 - __main__ - INFO - ================================================================================
2025-12-01 23:09:46,801 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 23:09:46,801 - __main__ - INFO - ================================================================================
2025-12-01 23:09:46,801 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0285
2025-12-01 23:09:46,801 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 23:09:46,801 - __main__ - INFO -    - subsample: 0.95
2025-12-01 23:09:46,802 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 23:09:46,802 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 23:09:46,802 - __main__ - INFO -    - n_estimators: 500
2025-12-01 23:09:46,802 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 23:09:46,802 - __main__ - INFO -    - max_depth: 5
2025-12-01 23:09:46,802 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 23:09:46,802 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 23:09:46,809 - __main__ - INFO - 
Performances sur validation:
2025-12-01 23:09:46,809 - __main__ - INFO -    - MAE: 0.0274
2025-12-01 23:09:46,809 - __main__ - INFO -    - R¬≤: 0.9599
2025-12-01 23:09:46,809 - __main__ - INFO - ================================================================================
2025-12-01 23:09:46,809 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 23:09:46,809 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 23:09:46,812 - __main__ - INFO - Train: (1170, 99), Test: (293, 99)
2025-12-01 23:09:48,586 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 23:09:48,672 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-1\test_predictions.csv
2025-12-01 23:09:48,672 - __main__ - INFO -    Shape: (293, 105)
2025-12-01 23:09:48,672 - __main__ - INFO -    Colonnes: stay_date, hotCode, 99 features + y_test + y_pred + error + abs_error
2025-12-01 23:09:48,672 - __main__ - INFO -    MAE moyen: 0.0274
2025-12-01 23:09:48,677 - __main__ - INFO - üìä Test MAE: 0.0274
2025-12-01 23:09:48,677 - __main__ - INFO - üìä Test R¬≤: 0.9599
2025-12-01 23:09:48,678 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 23:09:49,103 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-1\xgb_scatter_plot.png
2025-12-01 23:09:49,428 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-1\xgb_feature_importance.png
2025-12-01 23:09:49,440 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-1\models...
2025-12-01 23:09:49,469 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-1\models\xgb_to_predictor.joblib
2025-12-01 23:09:49,469 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-1\models\xgb_scaler.joblib
2025-12-01 23:09:49,469 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-1\models\feature_columns.txt
2025-12-01 23:09:49,469 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 23:09:49,469 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 23:09:49,469 - __main__ - INFO -    Container: ml-models
2025-12-01 23:09:50,026 - __main__ - INFO -    Container existant trouv√©
2025-12-01 23:09:50,026 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-1/
2025-12-01 23:09:50,164 - __main__ - INFO -    ‚úì predictTo/D09/J-1/models/xgb_to_predictor.joblib
2025-12-01 23:09:50,181 - __main__ - INFO -    ‚úì predictTo/D09/J-1/models/xgb_scaler.joblib
2025-12-01 23:09:50,197 - __main__ - INFO -    ‚úì predictTo/D09/J-1/models/feature_columns.txt
2025-12-01 23:09:50,216 - __main__ - INFO -    ‚úì predictTo/D09/J-1/xgb_scatter_plot.png
2025-12-01 23:09:50,235 - __main__ - INFO -    ‚úì predictTo/D09/J-1/xgb_feature_importance.png
2025-12-01 23:09:50,380 - __main__ - INFO -    ‚úì predictTo/D09/J-1/training_data_before_scaling.csv
2025-12-01 23:09:50,420 - __main__ - INFO -    ‚úì predictTo/D09/J-1/test_predictions.csv
2025-12-01 23:09:50,420 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 23:09:50,420 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-1/
2025-12-01 23:09:50,421 - __main__ - INFO - ================================================================================
2025-12-01 23:09:50,421 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 23:09:50,421 - __main__ - INFO - ================================================================================
2025-12-01 23:09:50,421 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 23:09:50,421 - __main__ - INFO -    Train MAE:  0.0019
2025-12-01 23:09:50,422 - __main__ - INFO -    Train RMSE: 0.0024
2025-12-01 23:09:50,422 - __main__ - INFO -    Train R¬≤:   0.9998
2025-12-01 23:09:50,422 - __main__ - INFO -    Test MAE:   0.0274
2025-12-01 23:09:50,422 - __main__ - INFO -    Test RMSE:  0.0374
2025-12-01 23:09:50,422 - __main__ - INFO -    Test R¬≤:    0.9599
2025-12-01 23:09:56,055 - __main__ - INFO - ================================================================================
2025-12-01 23:09:56,055 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-01 23:09:56,056 - __main__ - INFO - ================================================================================
2025-12-01 23:09:56,056 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-01 23:09:56,059 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-01 23:09:56,059 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 0
2025-12-01 23:09:56,059 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-01 23:09:56,059 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel D09
2025-12-01 23:09:56,059 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 0, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-01 23:09:56,060 - __main__ - INFO - Chargement des donn√©es...
2025-12-01 23:09:56,060 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\D09\clustering_results.csv
2025-12-01 23:09:56,075 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-01 23:09:56,295 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-01 23:09:56,295 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: D09
2025-12-01 23:09:56,318 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-01 23:09:56,318 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-01 23:09:56,318 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-01 23:09:56,409 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-01 23:09:56,434 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-01 23:09:56,459 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-01 23:09:56,472 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-01 23:09:56,472 - __main__ - INFO - Calcul des features PM sur donn√©es J-1 √† J-60 (pas de data leakage)
2025-12-01 23:09:56,472 - __main__ - INFO -    Colonnes PM utilis√©es: 60
2025-12-01 23:09:57,935 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-01 23:09:57,935 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-1 √† J-60
2025-12-01 23:09:57,935 - __main__ - INFO -    Colonnes Ant utilis√©es: 60
2025-12-01 23:09:58,837 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-01 23:09:58,837 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-1 √† J-60
2025-12-01 23:09:58,837 - __main__ - INFO -    Colonnes Ds utilis√©es: 60
2025-12-01 23:09:59,702 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-01 23:09:59,702 - __main__ - INFO - Chargement des prix concurrents depuis ../data/D09/rateShopper.csv...
2025-12-01 23:09:59,808 - __main__ - INFO - Prix concurrents charg√©s: (175820, 7)
2025-12-01 23:09:59,808 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-01 23:09:59,943 - __main__ - INFO -    Features concurrentes calcul√©es sur J-1 √† J-60
2025-12-01 23:09:59,955 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-01 23:10:02,115 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-01 23:10:02,120 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-01 23:10:02,126 - __main__ - INFO -    ToF1 ajout√© : 1097 valeurs non-nulles sur 1463
2025-12-01 23:10:02,126 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-01 23:10:02,493 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-01 23:10:02,592 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-01 23:10:02,614 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-01 23:10:02,615 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-01 23:10:02,615 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-01 23:10:02,615 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-01 23:10:02,615 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-01 23:10:02,615 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-01 23:10:02,616 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-01 23:10:02,623 - __main__ - INFO - Cr√©ation des features et target...
2025-12-01 23:10:02,623 - __main__ - INFO - --------------------------------
2025-12-01 23:10:02,623 - __main__ - INFO - Horizon: 0
2025-12-01 23:10:02,623 - __main__ - INFO - --------------------------------
2025-12-01 23:10:02,623 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-01 23:10:02,625 - __main__ - INFO - nb_observations recalcul√© pour horizon=0
2025-12-01 23:10:02,625 - __main__ - INFO -    Colonnes TO compt√©es: J-60 √† J-1 (60 colonnes)
2025-12-01 23:10:02,625 - __main__ - INFO -    Minimum: 60
2025-12-01 23:10:02,625 - __main__ - INFO -    Maximum: 60
2025-12-01 23:10:02,625 - __main__ - INFO -    Moyenne: 60.0
2025-12-01 23:10:02,625 - __main__ - INFO - Features TO historiques: J-60 √† J-1 (60 colonnes)
2025-12-01 23:10:02,625 - __main__ - INFO - Nombre total de features: 100
2025-12-01 23:10:02,625 - __main__ - INFO -    - TO historiques: 60
2025-12-01 23:10:02,625 - __main__ - INFO -    - Features PM: 7
2025-12-01 23:10:02,625 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-01 23:10:02,625 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-01 23:10:02,625 - __main__ - INFO -    - Features concurrents: 6
2025-12-01 23:10:02,625 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-01 23:10:02,625 - __main__ - INFO -    - Autres features: 11
2025-12-01 23:10:02,757 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results/D09\D09\J-0\training_data_before_scaling.csv
2025-12-01 23:10:02,757 - __main__ - INFO -    Shape: (1463, 103)
2025-12-01 23:10:02,757 - __main__ - INFO -    Colonnes: stay_date, hotCode, 100 features, J-0
2025-12-01 23:10:02,757 - __main__ - INFO - X shape: (1463, 100), y shape: (1463,)
2025-12-01 23:10:02,757 - __main__ - INFO - ================================================================================
2025-12-01 23:10:02,757 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-01 23:10:02,757 - __main__ - INFO - ================================================================================
2025-12-01 23:10:02,762 - __main__ - INFO - Train: (1170, 100), Validation: (293, 100)
2025-12-01 23:10:02,762 - __main__ - INFO - Configuration de la recherche:
2025-12-01 23:10:02,762 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-01 23:10:02,762 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-01 23:10:02,762 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-01 23:10:02,762 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-01 23:10:02,762 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-01 23:11:51,649 - __main__ - INFO - ================================================================================
2025-12-01 23:11:51,649 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-01 23:11:51,649 - __main__ - INFO - ================================================================================
2025-12-01 23:11:51,649 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0133
2025-12-01 23:11:51,649 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-01 23:11:51,649 - __main__ - INFO -    - subsample: 0.95
2025-12-01 23:11:51,650 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-01 23:11:51,650 - __main__ - INFO -    - reg_alpha: 0
2025-12-01 23:11:51,650 - __main__ - INFO -    - n_estimators: 500
2025-12-01 23:11:51,650 - __main__ - INFO -    - min_child_weight: 3
2025-12-01 23:11:51,650 - __main__ - INFO -    - max_depth: 5
2025-12-01 23:11:51,650 - __main__ - INFO -    - learning_rate: 0.05
2025-12-01 23:11:51,650 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-01 23:11:51,655 - __main__ - INFO - 
Performances sur validation:
2025-12-01 23:11:51,655 - __main__ - INFO -    - MAE: 0.0124
2025-12-01 23:11:51,655 - __main__ - INFO -    - R¬≤: 0.9907
2025-12-01 23:11:51,655 - __main__ - INFO - ================================================================================
2025-12-01 23:11:51,655 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-01 23:11:51,655 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-01 23:11:51,658 - __main__ - INFO - Train: (1170, 100), Test: (293, 100)
2025-12-01 23:11:53,356 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-01 23:11:53,440 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results/D09\D09\J-0\test_predictions.csv
2025-12-01 23:11:53,440 - __main__ - INFO -    Shape: (293, 106)
2025-12-01 23:11:53,440 - __main__ - INFO -    Colonnes: stay_date, hotCode, 100 features + y_test + y_pred + error + abs_error
2025-12-01 23:11:53,441 - __main__ - INFO -    MAE moyen: 0.0124
2025-12-01 23:11:53,445 - __main__ - INFO - üìä Test MAE: 0.0124
2025-12-01 23:11:53,445 - __main__ - INFO - üìä Test R¬≤: 0.9907
2025-12-01 23:11:53,446 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-01 23:11:53,883 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-0\xgb_scatter_plot.png
2025-12-01 23:11:54,195 - __main__ - INFO - üìà Graphique sauvegard√©: results/D09\D09\J-0\xgb_feature_importance.png
2025-12-01 23:11:54,209 - __main__ - INFO - Sauvegarde locale du mod√®le dans results/D09\D09\J-0\models...
2025-12-01 23:11:54,238 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results/D09\D09\J-0\models\xgb_to_predictor.joblib
2025-12-01 23:11:54,238 - __main__ - INFO - üíæ Scaler sauvegard√©: results/D09\D09\J-0\models\xgb_scaler.joblib
2025-12-01 23:11:54,238 - __main__ - INFO - üíæ Features sauvegard√©es: results/D09\D09\J-0\models\feature_columns.txt
2025-12-01 23:11:54,238 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-01 23:11:54,238 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-01 23:11:54,238 - __main__ - INFO -    Container: ml-models
2025-12-01 23:11:54,784 - __main__ - INFO -    Container existant trouv√©
2025-12-01 23:11:54,784 - __main__ - INFO -    Chemin Azure: predictTo/D09/J-0/
2025-12-01 23:11:54,865 - __main__ - INFO -    ‚úì predictTo/D09/J-0/models/xgb_to_predictor.joblib
2025-12-01 23:11:54,883 - __main__ - INFO -    ‚úì predictTo/D09/J-0/models/xgb_scaler.joblib
2025-12-01 23:11:54,908 - __main__ - INFO -    ‚úì predictTo/D09/J-0/models/feature_columns.txt
2025-12-01 23:11:54,925 - __main__ - INFO -    ‚úì predictTo/D09/J-0/xgb_scatter_plot.png
2025-12-01 23:11:54,942 - __main__ - INFO -    ‚úì predictTo/D09/J-0/xgb_feature_importance.png
2025-12-01 23:11:55,050 - __main__ - INFO -    ‚úì predictTo/D09/J-0/training_data_before_scaling.csv
2025-12-01 23:11:55,088 - __main__ - INFO -    ‚úì predictTo/D09/J-0/test_predictions.csv
2025-12-01 23:11:55,088 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-01 23:11:55,088 - __main__ - INFO -    URL: ml-models/predictTo/D09/J-0/
2025-12-01 23:11:55,089 - __main__ - INFO - ================================================================================
2025-12-01 23:11:55,089 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-01 23:11:55,089 - __main__ - INFO - ================================================================================
2025-12-01 23:11:55,089 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-01 23:11:55,089 - __main__ - INFO -    Train MAE:  0.0008
2025-12-01 23:11:55,089 - __main__ - INFO -    Train RMSE: 0.0011
2025-12-01 23:11:55,089 - __main__ - INFO -    Train R¬≤:   1.0000
2025-12-01 23:11:55,089 - __main__ - INFO -    Test MAE:   0.0124
2025-12-01 23:11:55,089 - __main__ - INFO -    Test RMSE:  0.0180
2025-12-01 23:11:55,089 - __main__ - INFO -    Test R¬≤:    0.9907
2025-12-02 05:45:47,680 - __main__ - INFO - ================================================================================
2025-12-02 05:45:47,680 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-02 05:45:47,681 - __main__ - INFO - ================================================================================
2025-12-02 05:45:47,681 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-02 05:45:47,684 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-02 05:45:47,685 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 59
2025-12-02 05:45:47,685 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-02 05:45:47,685 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel 6N8
2025-12-02 05:45:47,685 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 59, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-02 05:45:47,685 - __main__ - INFO - Chargement des donn√©es...
2025-12-02 05:45:47,685 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\6N8\clustering_results.csv
2025-12-02 05:45:47,721 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-02 05:45:47,937 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-02 05:45:47,937 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: 6N8
2025-12-02 05:45:47,956 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-02 05:45:47,956 - __main__ - INFO -    Indicateurs filtr√©s: (0, 17)
2025-12-02 05:45:47,956 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-02 05:45:47,992 - __main__ - INFO - PM pivot shape: (0, 2)
2025-12-02 05:45:47,996 - __main__ - INFO - Ant pivot shape: (0, 2)
2025-12-02 05:45:47,999 - __main__ - INFO - Ds pivot shape: (0, 2)
2025-12-02 05:45:48,004 - __main__ - INFO - DataFrame fusionn√©: (1462, 65)
2025-12-02 05:45:48,004 - __main__ - INFO - Calcul des features PM sur donn√©es J-60 √† J-60 (pas de data leakage)
2025-12-02 05:45:48,004 - __main__ - INFO -    Colonnes PM utilis√©es: 0
2025-12-02 05:45:48,004 - __main__ - ERROR - ‚ùå Aucune colonne PM disponible pour horizon=59
2025-12-02 05:45:48,004 - __main__ - ERROR -    Colonnes PM existantes: []
2025-12-02 05:45:48,004 - __main__ - ERROR - ‚ùå ERREUR FATALE: Pas de donn√©es PM disponibles pour horizon=59
Traceback (most recent call last):
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 1613, in main
    df = predictor.prepare_data(clusters, indicateurs)
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 593, in prepare_data
    raise ValueError(f"Pas de donn√©es PM disponibles pour horizon={horizon}")
ValueError: Pas de donn√©es PM disponibles pour horizon=59
2025-12-02 05:45:53,414 - __main__ - INFO - ================================================================================
2025-12-02 05:45:53,414 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-02 05:45:53,414 - __main__ - INFO - ================================================================================
2025-12-02 05:45:53,414 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-02 05:45:53,418 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-02 05:45:53,418 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 45
2025-12-02 05:45:53,418 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-02 05:45:53,418 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel 6N8
2025-12-02 05:45:53,418 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 45, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-02 05:45:53,418 - __main__ - INFO - Chargement des donn√©es...
2025-12-02 05:45:53,418 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\6N8\clustering_results.csv
2025-12-02 05:45:53,430 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-02 05:45:53,702 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-02 05:45:53,702 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: 6N8
2025-12-02 05:45:53,727 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-02 05:45:53,728 - __main__ - INFO -    Indicateurs filtr√©s: (0, 17)
2025-12-02 05:45:53,728 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-02 05:45:53,752 - __main__ - INFO - PM pivot shape: (0, 2)
2025-12-02 05:45:53,759 - __main__ - INFO - Ant pivot shape: (0, 2)
2025-12-02 05:45:53,765 - __main__ - INFO - Ds pivot shape: (0, 2)
2025-12-02 05:45:53,776 - __main__ - INFO - DataFrame fusionn√©: (1462, 65)
2025-12-02 05:45:53,776 - __main__ - INFO - Calcul des features PM sur donn√©es J-46 √† J-60 (pas de data leakage)
2025-12-02 05:45:53,776 - __main__ - INFO -    Colonnes PM utilis√©es: 0
2025-12-02 05:45:53,776 - __main__ - ERROR - ‚ùå Aucune colonne PM disponible pour horizon=45
2025-12-02 05:45:53,776 - __main__ - ERROR -    Colonnes PM existantes: []
2025-12-02 05:45:53,776 - __main__ - ERROR - ‚ùå ERREUR FATALE: Pas de donn√©es PM disponibles pour horizon=45
Traceback (most recent call last):
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 1613, in main
    df = predictor.prepare_data(clusters, indicateurs)
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 593, in prepare_data
    raise ValueError(f"Pas de donn√©es PM disponibles pour horizon={horizon}")
ValueError: Pas de donn√©es PM disponibles pour horizon=45
2025-12-02 05:45:59,089 - __main__ - INFO - ================================================================================
2025-12-02 05:45:59,090 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-02 05:45:59,090 - __main__ - INFO - ================================================================================
2025-12-02 05:45:59,090 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-02 05:45:59,093 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-02 05:45:59,093 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 30
2025-12-02 05:45:59,093 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-02 05:45:59,094 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel 6N8
2025-12-02 05:45:59,094 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 30, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-02 05:45:59,094 - __main__ - INFO - Chargement des donn√©es...
2025-12-02 05:45:59,094 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\6N8\clustering_results.csv
2025-12-02 05:45:59,106 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-02 05:45:59,298 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-02 05:45:59,298 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: 6N8
2025-12-02 05:45:59,309 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-02 05:45:59,309 - __main__ - INFO -    Indicateurs filtr√©s: (0, 17)
2025-12-02 05:45:59,309 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-02 05:45:59,319 - __main__ - INFO - PM pivot shape: (0, 2)
2025-12-02 05:45:59,322 - __main__ - INFO - Ant pivot shape: (0, 2)
2025-12-02 05:45:59,324 - __main__ - INFO - Ds pivot shape: (0, 2)
2025-12-02 05:45:59,329 - __main__ - INFO - DataFrame fusionn√©: (1462, 65)
2025-12-02 05:45:59,329 - __main__ - INFO - Calcul des features PM sur donn√©es J-31 √† J-60 (pas de data leakage)
2025-12-02 05:45:59,329 - __main__ - INFO -    Colonnes PM utilis√©es: 0
2025-12-02 05:45:59,329 - __main__ - ERROR - ‚ùå Aucune colonne PM disponible pour horizon=30
2025-12-02 05:45:59,329 - __main__ - ERROR -    Colonnes PM existantes: []
2025-12-02 05:45:59,329 - __main__ - ERROR - ‚ùå ERREUR FATALE: Pas de donn√©es PM disponibles pour horizon=30
Traceback (most recent call last):
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 1613, in main
    df = predictor.prepare_data(clusters, indicateurs)
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 593, in prepare_data
    raise ValueError(f"Pas de donn√©es PM disponibles pour horizon={horizon}")
ValueError: Pas de donn√©es PM disponibles pour horizon=30
2025-12-02 05:46:04,082 - __main__ - INFO - ================================================================================
2025-12-02 05:46:04,082 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-02 05:46:04,083 - __main__ - INFO - ================================================================================
2025-12-02 05:46:04,083 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-02 05:46:04,086 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-02 05:46:04,086 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 21
2025-12-02 05:46:04,086 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-02 05:46:04,086 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel 6N8
2025-12-02 05:46:04,086 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 21, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-02 05:46:04,086 - __main__ - INFO - Chargement des donn√©es...
2025-12-02 05:46:04,086 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\6N8\clustering_results.csv
2025-12-02 05:46:04,098 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-02 05:46:04,295 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-02 05:46:04,295 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: 6N8
2025-12-02 05:46:04,306 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-02 05:46:04,306 - __main__ - INFO -    Indicateurs filtr√©s: (0, 17)
2025-12-02 05:46:04,306 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-02 05:46:04,317 - __main__ - INFO - PM pivot shape: (0, 2)
2025-12-02 05:46:04,320 - __main__ - INFO - Ant pivot shape: (0, 2)
2025-12-02 05:46:04,322 - __main__ - INFO - Ds pivot shape: (0, 2)
2025-12-02 05:46:04,327 - __main__ - INFO - DataFrame fusionn√©: (1462, 65)
2025-12-02 05:46:04,327 - __main__ - INFO - Calcul des features PM sur donn√©es J-22 √† J-60 (pas de data leakage)
2025-12-02 05:46:04,327 - __main__ - INFO -    Colonnes PM utilis√©es: 0
2025-12-02 05:46:04,328 - __main__ - ERROR - ‚ùå Aucune colonne PM disponible pour horizon=21
2025-12-02 05:46:04,328 - __main__ - ERROR -    Colonnes PM existantes: []
2025-12-02 05:46:04,328 - __main__ - ERROR - ‚ùå ERREUR FATALE: Pas de donn√©es PM disponibles pour horizon=21
Traceback (most recent call last):
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 1613, in main
    df = predictor.prepare_data(clusters, indicateurs)
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 593, in prepare_data
    raise ValueError(f"Pas de donn√©es PM disponibles pour horizon={horizon}")
ValueError: Pas de donn√©es PM disponibles pour horizon=21
2025-12-02 05:52:08,214 - __main__ - INFO - ================================================================================
2025-12-02 05:52:08,214 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-02 05:52:08,214 - __main__ - INFO - ================================================================================
2025-12-02 05:52:08,214 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-02 05:52:08,217 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-02 05:52:08,218 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 59
2025-12-02 05:52:08,218 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-02 05:52:08,218 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel 6N8
2025-12-02 05:52:08,218 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 59, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-02 05:52:08,218 - __main__ - INFO - Chargement des donn√©es...
2025-12-02 05:52:08,218 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\6N8\clustering_results.csv
2025-12-02 05:52:08,229 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-02 05:52:08,458 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-02 05:52:08,458 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: 6N8
2025-12-02 05:52:08,472 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-02 05:52:08,472 - __main__ - INFO -    Indicateurs filtr√©s: (0, 17)
2025-12-02 05:52:08,472 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-02 05:52:08,482 - __main__ - INFO - PM pivot shape: (0, 2)
2025-12-02 05:52:08,485 - __main__ - INFO - Ant pivot shape: (0, 2)
2025-12-02 05:52:08,487 - __main__ - INFO - Ds pivot shape: (0, 2)
2025-12-02 05:52:08,492 - __main__ - INFO - DataFrame fusionn√©: (1462, 65)
2025-12-02 05:52:08,493 - __main__ - INFO - Calcul des features PM sur donn√©es J-60 √† J-60 (pas de data leakage)
2025-12-02 05:52:08,493 - __main__ - INFO -    Colonnes PM utilis√©es: 0
2025-12-02 05:52:08,493 - __main__ - ERROR - ‚ùå Aucune colonne PM disponible pour horizon=59
2025-12-02 05:52:08,493 - __main__ - ERROR -    Colonnes PM existantes: []
2025-12-02 05:52:08,493 - __main__ - ERROR - ‚ùå ERREUR FATALE: Pas de donn√©es PM disponibles pour horizon=59
Traceback (most recent call last):
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 1613, in main
    df = predictor.prepare_data(clusters, indicateurs)
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 593, in prepare_data
    raise ValueError(f"Pas de donn√©es PM disponibles pour horizon={horizon}")
ValueError: Pas de donn√©es PM disponibles pour horizon=59
2025-12-02 05:52:14,091 - __main__ - INFO - ================================================================================
2025-12-02 05:52:14,092 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-02 05:52:14,092 - __main__ - INFO - ================================================================================
2025-12-02 05:52:14,092 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-02 05:52:14,099 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-02 05:52:14,099 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 45
2025-12-02 05:52:14,099 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-02 05:52:14,099 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel 6N8
2025-12-02 05:52:14,100 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 45, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-02 05:52:14,100 - __main__ - INFO - Chargement des donn√©es...
2025-12-02 05:52:14,100 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\6N8\clustering_results.csv
2025-12-02 05:52:14,123 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-02 05:52:14,413 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-02 05:52:14,413 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: 6N8
2025-12-02 05:52:14,428 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-02 05:52:14,428 - __main__ - INFO -    Indicateurs filtr√©s: (0, 17)
2025-12-02 05:52:14,428 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-02 05:52:14,438 - __main__ - INFO - PM pivot shape: (0, 2)
2025-12-02 05:52:14,440 - __main__ - INFO - Ant pivot shape: (0, 2)
2025-12-02 05:52:14,443 - __main__ - INFO - Ds pivot shape: (0, 2)
2025-12-02 05:52:14,449 - __main__ - INFO - DataFrame fusionn√©: (1462, 65)
2025-12-02 05:52:14,450 - __main__ - INFO - Calcul des features PM sur donn√©es J-46 √† J-60 (pas de data leakage)
2025-12-02 05:52:14,450 - __main__ - INFO -    Colonnes PM utilis√©es: 0
2025-12-02 05:52:14,450 - __main__ - ERROR - ‚ùå Aucune colonne PM disponible pour horizon=45
2025-12-02 05:52:14,450 - __main__ - ERROR -    Colonnes PM existantes: []
2025-12-02 05:52:14,450 - __main__ - ERROR - ‚ùå ERREUR FATALE: Pas de donn√©es PM disponibles pour horizon=45
Traceback (most recent call last):
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 1613, in main
    df = predictor.prepare_data(clusters, indicateurs)
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 593, in prepare_data
    raise ValueError(f"Pas de donn√©es PM disponibles pour horizon={horizon}")
ValueError: Pas de donn√©es PM disponibles pour horizon=45
2025-12-02 05:52:19,526 - __main__ - INFO - ================================================================================
2025-12-02 05:52:19,527 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-02 05:52:19,527 - __main__ - INFO - ================================================================================
2025-12-02 05:52:19,527 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-02 05:52:19,531 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-02 05:52:19,531 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 30
2025-12-02 05:52:19,531 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-02 05:52:19,531 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel 6N8
2025-12-02 05:52:19,531 - __main__ - INFO - Configuration: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/D09/clustering_results.csv', 'indicateurs_path': '../data/D09/Indicateurs.csv', 'rateShopper_path': '../data/D09/rateShopper.csv', 'prediction_horizon': 30, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results/D09', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-02 05:52:19,531 - __main__ - INFO - Chargement des donn√©es...
2025-12-02 05:52:19,531 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\6N8\clustering_results.csv
2025-12-02 05:52:19,544 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-02 05:52:19,755 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-02 05:52:19,756 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: 6N8
2025-12-02 05:52:19,769 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-02 05:52:19,769 - __main__ - INFO -    Indicateurs filtr√©s: (0, 17)
2025-12-02 05:52:19,769 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-02 05:52:19,780 - __main__ - INFO - PM pivot shape: (0, 2)
2025-12-02 05:52:19,783 - __main__ - INFO - Ant pivot shape: (0, 2)
2025-12-02 05:52:19,785 - __main__ - INFO - Ds pivot shape: (0, 2)
2025-12-02 05:52:19,793 - __main__ - INFO - DataFrame fusionn√©: (1462, 65)
2025-12-02 05:52:19,794 - __main__ - INFO - Calcul des features PM sur donn√©es J-31 √† J-60 (pas de data leakage)
2025-12-02 05:52:19,794 - __main__ - INFO -    Colonnes PM utilis√©es: 0
2025-12-02 05:52:19,794 - __main__ - ERROR - ‚ùå Aucune colonne PM disponible pour horizon=30
2025-12-02 05:52:19,794 - __main__ - ERROR -    Colonnes PM existantes: []
2025-12-02 05:52:19,794 - __main__ - ERROR - ‚ùå ERREUR FATALE: Pas de donn√©es PM disponibles pour horizon=30
Traceback (most recent call last):
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 1613, in main
    df = predictor.prepare_data(clusters, indicateurs)
  File "C:\github\ml-demande\demande\predictTo\predictTo_train_model.py", line 593, in prepare_data
    raise ValueError(f"Pas de donn√©es PM disponibles pour horizon={horizon}")
ValueError: Pas de donn√©es PM disponibles pour horizon=30
2025-12-02 06:04:31,996 - __main__ - INFO - ================================================================================
2025-12-02 06:04:31,996 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-02 06:04:31,996 - __main__ - INFO - ================================================================================
2025-12-02 06:04:31,997 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-02 06:04:32,000 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-02 06:04:32,000 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 59
2025-12-02 06:04:32,000 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-02 06:04:32,000 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel 6N8
2025-12-02 06:04:32,000 - __main__ - INFO - Configuration apr√®s substitution: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/6N8/clustering_results.csv', 'indicateurs_path': '../data/6N8/Indicateurs.csv', 'rateShopper_path': '../data/6N8/rateShopper.csv', 'prediction_horizon': 59, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-02 06:04:32,000 - __main__ - INFO - Chargement des donn√©es...
2025-12-02 06:04:32,000 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\6N8\clustering_results.csv
2025-12-02 06:04:32,012 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-02 06:04:32,245 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-02 06:04:32,245 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: 6N8
2025-12-02 06:04:32,270 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-02 06:04:32,270 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-02 06:04:32,270 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-02 06:04:32,369 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-02 06:04:32,390 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-02 06:04:32,414 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-02 06:04:32,426 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-02 06:04:32,426 - __main__ - INFO - Calcul des features PM sur donn√©es J-60 √† J-60 (pas de data leakage)
2025-12-02 06:04:32,426 - __main__ - INFO -    Colonnes PM utilis√©es: 1
2025-12-02 06:04:33,430 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-02 06:04:33,431 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-60 √† J-60
2025-12-02 06:04:33,431 - __main__ - INFO -    Colonnes Ant utilis√©es: 1
2025-12-02 06:04:34,009 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-02 06:04:34,009 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-60 √† J-60
2025-12-02 06:04:34,009 - __main__ - INFO -    Colonnes Ds utilis√©es: 1
2025-12-02 06:04:34,597 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-02 06:04:34,597 - __main__ - INFO - Chargement des prix concurrents depuis ../data/6N8/rateShopper.csv...
2025-12-02 06:04:34,606 - __main__ - INFO - Prix concurrents charg√©s: (288, 7)
2025-12-02 06:04:34,606 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-02 06:04:34,617 - __main__ - INFO -    Features concurrentes calcul√©es sur J-60 √† J-60
2025-12-02 06:04:34,618 - __main__ - WARNING - ‚ö†Ô∏è  Aucune colonne Comp disponible pour horizon=59
2025-12-02 06:04:34,626 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-02 06:04:35,362 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-02 06:04:35,367 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-02 06:04:35,382 - __main__ - INFO -    ToF1 ajout√© : 669 valeurs non-nulles sur 1463
2025-12-02 06:04:35,383 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-02 06:04:36,429 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-02 06:04:36,551 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-02 06:04:36,570 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-02 06:04:36,571 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-02 06:04:36,571 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-02 06:04:36,571 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-02 06:04:36,571 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-02 06:04:36,571 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-02 06:04:36,571 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-02 06:04:36,576 - __main__ - INFO - Cr√©ation des features et target...
2025-12-02 06:04:36,576 - __main__ - INFO - --------------------------------
2025-12-02 06:04:36,576 - __main__ - INFO - Horizon: 59
2025-12-02 06:04:36,576 - __main__ - INFO - --------------------------------
2025-12-02 06:04:36,576 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-02 06:04:36,578 - __main__ - INFO - nb_observations recalcul√© pour horizon=59
2025-12-02 06:04:36,579 - __main__ - INFO -    Colonnes TO compt√©es: J-60 √† J-60 (1 colonnes)
2025-12-02 06:04:36,579 - __main__ - INFO -    Minimum: 1
2025-12-02 06:04:36,579 - __main__ - INFO -    Maximum: 1
2025-12-02 06:04:36,579 - __main__ - INFO -    Moyenne: 1.0
2025-12-02 06:04:36,579 - __main__ - INFO - Features TO historiques: J-60 √† J-60 (1 colonnes)
2025-12-02 06:04:36,579 - __main__ - INFO - Nombre total de features: 41
2025-12-02 06:04:36,579 - __main__ - INFO -    - TO historiques: 1
2025-12-02 06:04:36,579 - __main__ - INFO -    - Features PM: 7
2025-12-02 06:04:36,579 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-02 06:04:36,579 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-02 06:04:36,579 - __main__ - INFO -    - Features concurrents: 6
2025-12-02 06:04:36,579 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-02 06:04:36,579 - __main__ - INFO -    - Autres features: 11
2025-12-02 06:04:36,626 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results\6N8\J-59\training_data_before_scaling.csv
2025-12-02 06:04:36,627 - __main__ - INFO -    Shape: (1463, 44)
2025-12-02 06:04:36,627 - __main__ - INFO -    Colonnes: stay_date, hotCode, 41 features, J-0
2025-12-02 06:04:36,627 - __main__ - INFO - X shape: (1463, 41), y shape: (1463,)
2025-12-02 06:04:36,627 - __main__ - INFO - ================================================================================
2025-12-02 06:04:36,627 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-02 06:04:36,627 - __main__ - INFO - ================================================================================
2025-12-02 06:04:36,633 - __main__ - INFO - Train: (1170, 41), Validation: (293, 41)
2025-12-02 06:04:36,633 - __main__ - INFO - Configuration de la recherche:
2025-12-02 06:04:36,633 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-02 06:04:36,633 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-02 06:04:36,634 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-02 06:04:36,634 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-02 06:04:36,634 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-02 06:04:53,710 - __main__ - INFO - ================================================================================
2025-12-02 06:04:53,711 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-02 06:04:53,711 - __main__ - INFO - ================================================================================
2025-12-02 06:04:53,711 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0291
2025-12-02 06:04:53,711 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-02 06:04:53,711 - __main__ - INFO -    - subsample: 0.9
2025-12-02 06:04:53,711 - __main__ - INFO -    - reg_lambda: 1.5
2025-12-02 06:04:53,711 - __main__ - INFO -    - reg_alpha: 0
2025-12-02 06:04:53,711 - __main__ - INFO -    - n_estimators: 800
2025-12-02 06:04:53,711 - __main__ - INFO -    - min_child_weight: 2
2025-12-02 06:04:53,711 - __main__ - INFO -    - max_depth: 8
2025-12-02 06:04:53,711 - __main__ - INFO -    - learning_rate: 0.03
2025-12-02 06:04:53,711 - __main__ - INFO -    - colsample_bytree: 0.85
2025-12-02 06:04:53,722 - __main__ - INFO - 
Performances sur validation:
2025-12-02 06:04:53,722 - __main__ - INFO -    - MAE: 0.0224
2025-12-02 06:04:53,722 - __main__ - INFO -    - R¬≤: 0.9866
2025-12-02 06:04:53,722 - __main__ - INFO - ================================================================================
2025-12-02 06:04:53,723 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-02 06:04:53,723 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-02 06:04:53,725 - __main__ - INFO - Train: (1170, 41), Test: (293, 41)
2025-12-02 06:04:54,967 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-02 06:04:55,017 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results\6N8\J-59\test_predictions.csv
2025-12-02 06:04:55,017 - __main__ - INFO -    Shape: (293, 47)
2025-12-02 06:04:55,018 - __main__ - INFO -    Colonnes: stay_date, hotCode, 41 features + y_test + y_pred + error + abs_error
2025-12-02 06:04:55,018 - __main__ - INFO -    MAE moyen: 0.0224
2025-12-02 06:04:55,027 - __main__ - INFO - üìä Test MAE: 0.0224
2025-12-02 06:04:55,027 - __main__ - INFO - üìä Test R¬≤: 0.9866
2025-12-02 06:04:55,027 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-02 06:04:55,836 - __main__ - INFO - üìà Graphique sauvegard√©: results\6N8\J-59\xgb_scatter_plot.png
2025-12-02 06:04:56,150 - __main__ - INFO - üìà Graphique sauvegard√©: results\6N8\J-59\xgb_feature_importance.png
2025-12-02 06:04:56,164 - __main__ - INFO - Sauvegarde locale du mod√®le dans results\6N8\J-59\models...
2025-12-02 06:04:56,205 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results\6N8\J-59\models\xgb_to_predictor.joblib
2025-12-02 06:04:56,206 - __main__ - INFO - üíæ Scaler sauvegard√©: results\6N8\J-59\models\xgb_scaler.joblib
2025-12-02 06:04:56,206 - __main__ - INFO - üíæ Features sauvegard√©es: results\6N8\J-59\models\feature_columns.txt
2025-12-02 06:04:56,206 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-02 06:04:56,206 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-02 06:04:56,206 - __main__ - INFO -    Container: ml-models
2025-12-02 06:04:56,802 - __main__ - INFO -    Container existant trouv√©
2025-12-02 06:04:56,803 - __main__ - INFO -    Chemin Azure: predictTo/6N8/J-59/
2025-12-02 06:04:57,032 - __main__ - INFO -    ‚úì predictTo/6N8/J-59/models/xgb_to_predictor.joblib
2025-12-02 06:04:57,050 - __main__ - INFO -    ‚úì predictTo/6N8/J-59/models/xgb_scaler.joblib
2025-12-02 06:04:57,068 - __main__ - INFO -    ‚úì predictTo/6N8/J-59/models/feature_columns.txt
2025-12-02 06:04:57,087 - __main__ - INFO -    ‚úì predictTo/6N8/J-59/xgb_scatter_plot.png
2025-12-02 06:04:57,103 - __main__ - INFO -    ‚úì predictTo/6N8/J-59/xgb_feature_importance.png
2025-12-02 06:04:57,131 - __main__ - INFO -    ‚úì predictTo/6N8/J-59/training_data_before_scaling.csv
2025-12-02 06:04:57,148 - __main__ - INFO -    ‚úì predictTo/6N8/J-59/test_predictions.csv
2025-12-02 06:04:57,149 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-02 06:04:57,149 - __main__ - INFO -    URL: ml-models/predictTo/6N8/J-59/
2025-12-02 06:04:57,150 - __main__ - INFO - ================================================================================
2025-12-02 06:04:57,150 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-02 06:04:57,150 - __main__ - INFO - ================================================================================
2025-12-02 06:04:57,150 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-02 06:04:57,150 - __main__ - INFO -    Train MAE:  0.0008
2025-12-02 06:04:57,150 - __main__ - INFO -    Train RMSE: 0.0014
2025-12-02 06:04:57,150 - __main__ - INFO -    Train R¬≤:   1.0000
2025-12-02 06:04:57,150 - __main__ - INFO -    Test MAE:   0.0224
2025-12-02 06:04:57,150 - __main__ - INFO -    Test RMSE:  0.0445
2025-12-02 06:04:57,150 - __main__ - INFO -    Test R¬≤:    0.9866
2025-12-02 06:05:03,615 - __main__ - INFO - ================================================================================
2025-12-02 06:05:03,616 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-02 06:05:03,616 - __main__ - INFO - ================================================================================
2025-12-02 06:05:03,616 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-02 06:05:03,620 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-02 06:05:03,620 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 45
2025-12-02 06:05:03,620 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-02 06:05:03,620 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel 6N8
2025-12-02 06:05:03,620 - __main__ - INFO - Configuration apr√®s substitution: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/6N8/clustering_results.csv', 'indicateurs_path': '../data/6N8/Indicateurs.csv', 'rateShopper_path': '../data/6N8/rateShopper.csv', 'prediction_horizon': 45, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-02 06:05:03,620 - __main__ - INFO - Chargement des donn√©es...
2025-12-02 06:05:03,620 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\6N8\clustering_results.csv
2025-12-02 06:05:03,634 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-02 06:05:03,883 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-02 06:05:03,883 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: 6N8
2025-12-02 06:05:03,913 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-02 06:05:03,913 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-02 06:05:03,913 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-02 06:05:04,037 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-02 06:05:04,075 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-02 06:05:04,111 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-02 06:05:04,129 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-02 06:05:04,129 - __main__ - INFO - Calcul des features PM sur donn√©es J-46 √† J-60 (pas de data leakage)
2025-12-02 06:05:04,129 - __main__ - INFO -    Colonnes PM utilis√©es: 15
2025-12-02 06:05:05,744 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-02 06:05:05,744 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-46 √† J-60
2025-12-02 06:05:05,744 - __main__ - INFO -    Colonnes Ant utilis√©es: 15
2025-12-02 06:05:06,842 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-02 06:05:06,842 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-46 √† J-60
2025-12-02 06:05:06,843 - __main__ - INFO -    Colonnes Ds utilis√©es: 15
2025-12-02 06:05:08,108 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-02 06:05:08,109 - __main__ - INFO - Chargement des prix concurrents depuis ../data/6N8/rateShopper.csv...
2025-12-02 06:05:08,112 - __main__ - INFO - Prix concurrents charg√©s: (288, 7)
2025-12-02 06:05:08,113 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-02 06:05:08,121 - __main__ - INFO -    Features concurrentes calcul√©es sur J-46 √† J-60
2025-12-02 06:05:08,121 - __main__ - WARNING - ‚ö†Ô∏è  Aucune colonne Comp disponible pour horizon=45
2025-12-02 06:05:08,126 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-02 06:05:09,213 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-02 06:05:09,219 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-02 06:05:09,226 - __main__ - INFO -    ToF1 ajout√© : 669 valeurs non-nulles sur 1463
2025-12-02 06:05:09,226 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-02 06:05:09,824 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-02 06:05:09,964 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-02 06:05:09,987 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-02 06:05:09,987 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-02 06:05:09,988 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-02 06:05:09,988 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-02 06:05:09,988 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-02 06:05:09,988 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-02 06:05:09,988 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-02 06:05:09,992 - __main__ - INFO - Cr√©ation des features et target...
2025-12-02 06:05:09,992 - __main__ - INFO - --------------------------------
2025-12-02 06:05:09,992 - __main__ - INFO - Horizon: 45
2025-12-02 06:05:09,992 - __main__ - INFO - --------------------------------
2025-12-02 06:05:09,993 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-02 06:05:09,995 - __main__ - INFO - nb_observations recalcul√© pour horizon=45
2025-12-02 06:05:09,995 - __main__ - INFO -    Colonnes TO compt√©es: J-60 √† J-46 (15 colonnes)
2025-12-02 06:05:09,995 - __main__ - INFO -    Minimum: 15
2025-12-02 06:05:09,995 - __main__ - INFO -    Maximum: 15
2025-12-02 06:05:09,995 - __main__ - INFO -    Moyenne: 15.0
2025-12-02 06:05:09,995 - __main__ - INFO - Features TO historiques: J-60 √† J-46 (15 colonnes)
2025-12-02 06:05:09,995 - __main__ - INFO - Nombre total de features: 55
2025-12-02 06:05:09,995 - __main__ - INFO -    - TO historiques: 15
2025-12-02 06:05:09,995 - __main__ - INFO -    - Features PM: 7
2025-12-02 06:05:09,995 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-02 06:05:09,995 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-02 06:05:09,995 - __main__ - INFO -    - Features concurrents: 6
2025-12-02 06:05:09,995 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-02 06:05:09,995 - __main__ - INFO -    - Autres features: 11
2025-12-02 06:05:10,063 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results\6N8\J-45\training_data_before_scaling.csv
2025-12-02 06:05:10,064 - __main__ - INFO -    Shape: (1463, 58)
2025-12-02 06:05:10,064 - __main__ - INFO -    Colonnes: stay_date, hotCode, 55 features, J-0
2025-12-02 06:05:10,064 - __main__ - INFO - X shape: (1463, 55), y shape: (1463,)
2025-12-02 06:05:10,064 - __main__ - INFO - ================================================================================
2025-12-02 06:05:10,064 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-02 06:05:10,064 - __main__ - INFO - ================================================================================
2025-12-02 06:05:10,068 - __main__ - INFO - Train: (1170, 55), Validation: (293, 55)
2025-12-02 06:05:10,068 - __main__ - INFO - Configuration de la recherche:
2025-12-02 06:05:10,069 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-02 06:05:10,069 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-02 06:05:10,069 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-02 06:05:10,069 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-02 06:05:10,069 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-02 06:05:46,047 - __main__ - INFO - ================================================================================
2025-12-02 06:05:46,047 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-02 06:05:46,047 - __main__ - INFO - ================================================================================
2025-12-02 06:05:46,047 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0279
2025-12-02 06:05:46,047 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-02 06:05:46,047 - __main__ - INFO -    - subsample: 0.9
2025-12-02 06:05:46,048 - __main__ - INFO -    - reg_lambda: 1.5
2025-12-02 06:05:46,048 - __main__ - INFO -    - reg_alpha: 0
2025-12-02 06:05:46,048 - __main__ - INFO -    - n_estimators: 500
2025-12-02 06:05:46,048 - __main__ - INFO -    - min_child_weight: 2
2025-12-02 06:05:46,048 - __main__ - INFO -    - max_depth: 8
2025-12-02 06:05:46,048 - __main__ - INFO -    - learning_rate: 0.03
2025-12-02 06:05:46,048 - __main__ - INFO -    - colsample_bytree: 0.9
2025-12-02 06:05:46,052 - __main__ - INFO - 
Performances sur validation:
2025-12-02 06:05:46,053 - __main__ - INFO -    - MAE: 0.0226
2025-12-02 06:05:46,053 - __main__ - INFO -    - R¬≤: 0.9863
2025-12-02 06:05:46,053 - __main__ - INFO - ================================================================================
2025-12-02 06:05:46,053 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-02 06:05:46,054 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-02 06:05:46,056 - __main__ - INFO - Train: (1170, 55), Test: (293, 55)
2025-12-02 06:05:47,308 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-02 06:05:47,361 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results\6N8\J-45\test_predictions.csv
2025-12-02 06:05:47,361 - __main__ - INFO -    Shape: (293, 61)
2025-12-02 06:05:47,361 - __main__ - INFO -    Colonnes: stay_date, hotCode, 55 features + y_test + y_pred + error + abs_error
2025-12-02 06:05:47,362 - __main__ - INFO -    MAE moyen: 0.0226
2025-12-02 06:05:47,367 - __main__ - INFO - üìä Test MAE: 0.0226
2025-12-02 06:05:47,367 - __main__ - INFO - üìä Test R¬≤: 0.9863
2025-12-02 06:05:47,367 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-02 06:05:47,760 - __main__ - INFO - üìà Graphique sauvegard√©: results\6N8\J-45\xgb_scatter_plot.png
2025-12-02 06:05:48,062 - __main__ - INFO - üìà Graphique sauvegard√©: results\6N8\J-45\xgb_feature_importance.png
2025-12-02 06:05:48,072 - __main__ - INFO - Sauvegarde locale du mod√®le dans results\6N8\J-45\models...
2025-12-02 06:05:48,105 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results\6N8\J-45\models\xgb_to_predictor.joblib
2025-12-02 06:05:48,106 - __main__ - INFO - üíæ Scaler sauvegard√©: results\6N8\J-45\models\xgb_scaler.joblib
2025-12-02 06:05:48,106 - __main__ - INFO - üíæ Features sauvegard√©es: results\6N8\J-45\models\feature_columns.txt
2025-12-02 06:05:48,106 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-02 06:05:48,106 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-02 06:05:48,106 - __main__ - INFO -    Container: ml-models
2025-12-02 06:05:48,597 - __main__ - INFO -    Container existant trouv√©
2025-12-02 06:05:48,636 - __main__ - INFO -    Chemin Azure: predictTo/6N8/J-45/
2025-12-02 06:05:48,789 - __main__ - INFO -    ‚úì predictTo/6N8/J-45/models/xgb_to_predictor.joblib
2025-12-02 06:05:48,808 - __main__ - INFO -    ‚úì predictTo/6N8/J-45/models/xgb_scaler.joblib
2025-12-02 06:05:48,826 - __main__ - INFO -    ‚úì predictTo/6N8/J-45/models/feature_columns.txt
2025-12-02 06:05:48,843 - __main__ - INFO -    ‚úì predictTo/6N8/J-45/xgb_scatter_plot.png
2025-12-02 06:05:48,860 - __main__ - INFO -    ‚úì predictTo/6N8/J-45/xgb_feature_importance.png
2025-12-02 06:05:48,909 - __main__ - INFO -    ‚úì predictTo/6N8/J-45/training_data_before_scaling.csv
2025-12-02 06:05:48,929 - __main__ - INFO -    ‚úì predictTo/6N8/J-45/test_predictions.csv
2025-12-02 06:05:48,929 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-02 06:05:48,929 - __main__ - INFO -    URL: ml-models/predictTo/6N8/J-45/
2025-12-02 06:05:48,930 - __main__ - INFO - ================================================================================
2025-12-02 06:05:48,931 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-02 06:05:48,931 - __main__ - INFO - ================================================================================
2025-12-02 06:05:48,931 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-02 06:05:48,931 - __main__ - INFO -    Train MAE:  0.0009
2025-12-02 06:05:48,931 - __main__ - INFO -    Train RMSE: 0.0017
2025-12-02 06:05:48,931 - __main__ - INFO -    Train R¬≤:   1.0000
2025-12-02 06:05:48,931 - __main__ - INFO -    Test MAE:   0.0226
2025-12-02 06:05:48,931 - __main__ - INFO -    Test RMSE:  0.0450
2025-12-02 06:05:48,931 - __main__ - INFO -    Test R¬≤:    0.9863
2025-12-02 06:05:54,237 - __main__ - INFO - ================================================================================
2025-12-02 06:05:54,237 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-02 06:05:54,237 - __main__ - INFO - ================================================================================
2025-12-02 06:05:54,237 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-02 06:05:54,241 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-02 06:05:54,241 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 30
2025-12-02 06:05:54,241 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-02 06:05:54,241 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel 6N8
2025-12-02 06:05:54,241 - __main__ - INFO - Configuration apr√®s substitution: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/6N8/clustering_results.csv', 'indicateurs_path': '../data/6N8/Indicateurs.csv', 'rateShopper_path': '../data/6N8/rateShopper.csv', 'prediction_horizon': 30, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-02 06:05:54,241 - __main__ - INFO - Chargement des donn√©es...
2025-12-02 06:05:54,241 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\6N8\clustering_results.csv
2025-12-02 06:05:54,252 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-02 06:05:54,445 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-02 06:05:54,445 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: 6N8
2025-12-02 06:05:54,464 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-02 06:05:54,464 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-02 06:05:54,464 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-02 06:05:54,534 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-02 06:05:54,553 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-02 06:05:54,571 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-02 06:05:54,580 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-02 06:05:54,580 - __main__ - INFO - Calcul des features PM sur donn√©es J-31 √† J-60 (pas de data leakage)
2025-12-02 06:05:54,580 - __main__ - INFO -    Colonnes PM utilis√©es: 30
2025-12-02 06:05:55,796 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-02 06:05:55,796 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-31 √† J-60
2025-12-02 06:05:55,797 - __main__ - INFO -    Colonnes Ant utilis√©es: 30
2025-12-02 06:05:56,548 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-02 06:05:56,549 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-31 √† J-60
2025-12-02 06:05:56,549 - __main__ - INFO -    Colonnes Ds utilis√©es: 30
2025-12-02 06:05:57,327 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-02 06:05:57,327 - __main__ - INFO - Chargement des prix concurrents depuis ../data/6N8/rateShopper.csv...
2025-12-02 06:05:57,330 - __main__ - INFO - Prix concurrents charg√©s: (288, 7)
2025-12-02 06:05:57,330 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-02 06:05:57,337 - __main__ - INFO -    Features concurrentes calcul√©es sur J-31 √† J-60
2025-12-02 06:05:57,337 - __main__ - WARNING - ‚ö†Ô∏è  Aucune colonne Comp disponible pour horizon=30
2025-12-02 06:05:57,340 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-02 06:05:58,026 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-02 06:05:58,030 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-02 06:05:58,038 - __main__ - INFO -    ToF1 ajout√© : 669 valeurs non-nulles sur 1463
2025-12-02 06:05:58,038 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-02 06:05:58,398 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-02 06:05:58,486 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-02 06:05:58,500 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-02 06:05:58,501 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-02 06:05:58,501 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-02 06:05:58,501 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-02 06:05:58,501 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-02 06:05:58,501 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-02 06:05:58,501 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-02 06:05:58,505 - __main__ - INFO - Cr√©ation des features et target...
2025-12-02 06:05:58,505 - __main__ - INFO - --------------------------------
2025-12-02 06:05:58,506 - __main__ - INFO - Horizon: 30
2025-12-02 06:05:58,506 - __main__ - INFO - --------------------------------
2025-12-02 06:05:58,506 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-02 06:05:58,507 - __main__ - INFO - nb_observations recalcul√© pour horizon=30
2025-12-02 06:05:58,507 - __main__ - INFO -    Colonnes TO compt√©es: J-60 √† J-31 (30 colonnes)
2025-12-02 06:05:58,507 - __main__ - INFO -    Minimum: 30
2025-12-02 06:05:58,507 - __main__ - INFO -    Maximum: 30
2025-12-02 06:05:58,507 - __main__ - INFO -    Moyenne: 30.0
2025-12-02 06:05:58,507 - __main__ - INFO - Features TO historiques: J-60 √† J-31 (30 colonnes)
2025-12-02 06:05:58,507 - __main__ - INFO - Nombre total de features: 70
2025-12-02 06:05:58,507 - __main__ - INFO -    - TO historiques: 30
2025-12-02 06:05:58,507 - __main__ - INFO -    - Features PM: 7
2025-12-02 06:05:58,507 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-02 06:05:58,508 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-02 06:05:58,508 - __main__ - INFO -    - Features concurrents: 6
2025-12-02 06:05:58,508 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-02 06:05:58,508 - __main__ - INFO -    - Autres features: 11
2025-12-02 06:05:58,584 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results\6N8\J-30\training_data_before_scaling.csv
2025-12-02 06:05:58,584 - __main__ - INFO -    Shape: (1463, 73)
2025-12-02 06:05:58,584 - __main__ - INFO -    Colonnes: stay_date, hotCode, 70 features, J-0
2025-12-02 06:05:58,584 - __main__ - INFO - X shape: (1463, 70), y shape: (1463,)
2025-12-02 06:05:58,584 - __main__ - INFO - ================================================================================
2025-12-02 06:05:58,584 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-02 06:05:58,584 - __main__ - INFO - ================================================================================
2025-12-02 06:05:58,588 - __main__ - INFO - Train: (1170, 70), Validation: (293, 70)
2025-12-02 06:05:58,588 - __main__ - INFO - Configuration de la recherche:
2025-12-02 06:05:58,588 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-02 06:05:58,588 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-02 06:05:58,588 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-02 06:05:58,588 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-02 06:05:58,588 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-02 06:06:45,056 - __main__ - INFO - ================================================================================
2025-12-02 06:06:45,056 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-02 06:06:45,056 - __main__ - INFO - ================================================================================
2025-12-02 06:06:45,056 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0244
2025-12-02 06:06:45,056 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-02 06:06:45,056 - __main__ - INFO -    - subsample: 0.95
2025-12-02 06:06:45,056 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-02 06:06:45,056 - __main__ - INFO -    - reg_alpha: 0
2025-12-02 06:06:45,057 - __main__ - INFO -    - n_estimators: 500
2025-12-02 06:06:45,057 - __main__ - INFO -    - min_child_weight: 3
2025-12-02 06:06:45,057 - __main__ - INFO -    - max_depth: 5
2025-12-02 06:06:45,057 - __main__ - INFO -    - learning_rate: 0.05
2025-12-02 06:06:45,057 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-02 06:06:45,062 - __main__ - INFO - 
Performances sur validation:
2025-12-02 06:06:45,062 - __main__ - INFO -    - MAE: 0.0187
2025-12-02 06:06:45,062 - __main__ - INFO -    - R¬≤: 0.9918
2025-12-02 06:06:45,062 - __main__ - INFO - ================================================================================
2025-12-02 06:06:45,062 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-02 06:06:45,063 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-02 06:06:45,065 - __main__ - INFO - Train: (1170, 70), Test: (293, 70)
2025-12-02 06:06:46,134 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-02 06:06:46,209 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results\6N8\J-30\test_predictions.csv
2025-12-02 06:06:46,210 - __main__ - INFO -    Shape: (293, 76)
2025-12-02 06:06:46,210 - __main__ - INFO -    Colonnes: stay_date, hotCode, 70 features + y_test + y_pred + error + abs_error
2025-12-02 06:06:46,211 - __main__ - INFO -    MAE moyen: 0.0187
2025-12-02 06:06:46,218 - __main__ - INFO - üìä Test MAE: 0.0187
2025-12-02 06:06:46,219 - __main__ - INFO - üìä Test R¬≤: 0.9918
2025-12-02 06:06:46,219 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-02 06:06:46,754 - __main__ - INFO - üìà Graphique sauvegard√©: results\6N8\J-30\xgb_scatter_plot.png
2025-12-02 06:06:47,126 - __main__ - INFO - üìà Graphique sauvegard√©: results\6N8\J-30\xgb_feature_importance.png
2025-12-02 06:06:47,143 - __main__ - INFO - Sauvegarde locale du mod√®le dans results\6N8\J-30\models...
2025-12-02 06:06:47,174 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results\6N8\J-30\models\xgb_to_predictor.joblib
2025-12-02 06:06:47,174 - __main__ - INFO - üíæ Scaler sauvegard√©: results\6N8\J-30\models\xgb_scaler.joblib
2025-12-02 06:06:47,175 - __main__ - INFO - üíæ Features sauvegard√©es: results\6N8\J-30\models\feature_columns.txt
2025-12-02 06:06:47,175 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-02 06:06:47,175 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-02 06:06:47,175 - __main__ - INFO -    Container: ml-models
2025-12-02 06:06:47,753 - __main__ - INFO -    Container existant trouv√©
2025-12-02 06:06:47,753 - __main__ - INFO -    Chemin Azure: predictTo/6N8/J-30/
2025-12-02 06:06:47,847 - __main__ - INFO -    ‚úì predictTo/6N8/J-30/models/xgb_to_predictor.joblib
2025-12-02 06:06:47,868 - __main__ - INFO -    ‚úì predictTo/6N8/J-30/models/xgb_scaler.joblib
2025-12-02 06:06:47,887 - __main__ - INFO -    ‚úì predictTo/6N8/J-30/models/feature_columns.txt
2025-12-02 06:06:47,905 - __main__ - INFO -    ‚úì predictTo/6N8/J-30/xgb_scatter_plot.png
2025-12-02 06:06:47,923 - __main__ - INFO -    ‚úì predictTo/6N8/J-30/xgb_feature_importance.png
2025-12-02 06:06:47,989 - __main__ - INFO -    ‚úì predictTo/6N8/J-30/training_data_before_scaling.csv
2025-12-02 06:06:48,017 - __main__ - INFO -    ‚úì predictTo/6N8/J-30/test_predictions.csv
2025-12-02 06:06:48,017 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-02 06:06:48,017 - __main__ - INFO -    URL: ml-models/predictTo/6N8/J-30/
2025-12-02 06:06:48,018 - __main__ - INFO - ================================================================================
2025-12-02 06:06:48,019 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-02 06:06:48,019 - __main__ - INFO - ================================================================================
2025-12-02 06:06:48,019 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-02 06:06:48,019 - __main__ - INFO -    Train MAE:  0.0018
2025-12-02 06:06:48,019 - __main__ - INFO -    Train RMSE: 0.0031
2025-12-02 06:06:48,019 - __main__ - INFO -    Train R¬≤:   0.9999
2025-12-02 06:06:48,019 - __main__ - INFO -    Test MAE:   0.0187
2025-12-02 06:06:48,019 - __main__ - INFO -    Test RMSE:  0.0347
2025-12-02 06:06:48,019 - __main__ - INFO -    Test R¬≤:    0.9918
2025-12-02 06:06:54,496 - __main__ - INFO - ================================================================================
2025-12-02 06:06:54,496 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-02 06:06:54,496 - __main__ - INFO - ================================================================================
2025-12-02 06:06:54,497 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-02 06:06:54,501 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-02 06:06:54,501 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 21
2025-12-02 06:06:54,501 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-02 06:06:54,501 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel 6N8
2025-12-02 06:06:54,501 - __main__ - INFO - Configuration apr√®s substitution: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/6N8/clustering_results.csv', 'indicateurs_path': '../data/6N8/Indicateurs.csv', 'rateShopper_path': '../data/6N8/rateShopper.csv', 'prediction_horizon': 21, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-02 06:06:54,501 - __main__ - INFO - Chargement des donn√©es...
2025-12-02 06:06:54,501 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\6N8\clustering_results.csv
2025-12-02 06:06:54,515 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-02 06:06:54,737 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-02 06:06:54,737 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: 6N8
2025-12-02 06:06:54,759 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-02 06:06:54,759 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-02 06:06:54,759 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-02 06:06:54,843 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-02 06:06:54,865 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-02 06:06:54,893 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-02 06:06:54,904 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-02 06:06:54,905 - __main__ - INFO - Calcul des features PM sur donn√©es J-22 √† J-60 (pas de data leakage)
2025-12-02 06:06:54,905 - __main__ - INFO -    Colonnes PM utilis√©es: 39
2025-12-02 06:06:56,495 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-02 06:06:56,495 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-22 √† J-60
2025-12-02 06:06:56,495 - __main__ - INFO -    Colonnes Ant utilis√©es: 39
2025-12-02 06:06:57,554 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-02 06:06:57,554 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-22 √† J-60
2025-12-02 06:06:57,554 - __main__ - INFO -    Colonnes Ds utilis√©es: 39
2025-12-02 06:06:58,540 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-02 06:06:58,541 - __main__ - INFO - Chargement des prix concurrents depuis ../data/6N8/rateShopper.csv...
2025-12-02 06:06:58,544 - __main__ - INFO - Prix concurrents charg√©s: (288, 7)
2025-12-02 06:06:58,544 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-02 06:06:58,551 - __main__ - INFO -    Features concurrentes calcul√©es sur J-22 √† J-60
2025-12-02 06:06:58,551 - __main__ - WARNING - ‚ö†Ô∏è  Aucune colonne Comp disponible pour horizon=21
2025-12-02 06:06:58,555 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-02 06:06:59,311 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-02 06:06:59,315 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-02 06:06:59,321 - __main__ - INFO -    ToF1 ajout√© : 669 valeurs non-nulles sur 1463
2025-12-02 06:06:59,321 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-02 06:06:59,740 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-02 06:06:59,839 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-02 06:06:59,854 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-02 06:06:59,855 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-02 06:06:59,855 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-02 06:06:59,855 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-02 06:06:59,855 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-02 06:06:59,855 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-02 06:06:59,855 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-02 06:06:59,859 - __main__ - INFO - Cr√©ation des features et target...
2025-12-02 06:06:59,859 - __main__ - INFO - --------------------------------
2025-12-02 06:06:59,859 - __main__ - INFO - Horizon: 21
2025-12-02 06:06:59,859 - __main__ - INFO - --------------------------------
2025-12-02 06:06:59,859 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-02 06:06:59,861 - __main__ - INFO - nb_observations recalcul√© pour horizon=21
2025-12-02 06:06:59,861 - __main__ - INFO -    Colonnes TO compt√©es: J-60 √† J-22 (39 colonnes)
2025-12-02 06:06:59,861 - __main__ - INFO -    Minimum: 39
2025-12-02 06:06:59,861 - __main__ - INFO -    Maximum: 39
2025-12-02 06:06:59,861 - __main__ - INFO -    Moyenne: 39.0
2025-12-02 06:06:59,861 - __main__ - INFO - Features TO historiques: J-60 √† J-22 (39 colonnes)
2025-12-02 06:06:59,861 - __main__ - INFO - Nombre total de features: 79
2025-12-02 06:06:59,861 - __main__ - INFO -    - TO historiques: 39
2025-12-02 06:06:59,861 - __main__ - INFO -    - Features PM: 7
2025-12-02 06:06:59,861 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-02 06:06:59,861 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-02 06:06:59,861 - __main__ - INFO -    - Features concurrents: 6
2025-12-02 06:06:59,861 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-02 06:06:59,861 - __main__ - INFO -    - Autres features: 11
2025-12-02 06:06:59,948 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results\6N8\J-21\training_data_before_scaling.csv
2025-12-02 06:06:59,949 - __main__ - INFO -    Shape: (1463, 82)
2025-12-02 06:06:59,949 - __main__ - INFO -    Colonnes: stay_date, hotCode, 79 features, J-0
2025-12-02 06:06:59,949 - __main__ - INFO - X shape: (1463, 79), y shape: (1463,)
2025-12-02 06:06:59,949 - __main__ - INFO - ================================================================================
2025-12-02 06:06:59,949 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-02 06:06:59,949 - __main__ - INFO - ================================================================================
2025-12-02 06:06:59,957 - __main__ - INFO - Train: (1170, 79), Validation: (293, 79)
2025-12-02 06:06:59,957 - __main__ - INFO - Configuration de la recherche:
2025-12-02 06:06:59,957 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-02 06:06:59,957 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-02 06:06:59,957 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-02 06:06:59,957 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-02 06:06:59,957 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-02 06:07:52,800 - __main__ - INFO - ================================================================================
2025-12-02 06:07:52,801 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-02 06:07:52,801 - __main__ - INFO - ================================================================================
2025-12-02 06:07:52,801 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0230
2025-12-02 06:07:52,801 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-02 06:07:52,801 - __main__ - INFO -    - subsample: 0.95
2025-12-02 06:07:52,801 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-02 06:07:52,801 - __main__ - INFO -    - reg_alpha: 0
2025-12-02 06:07:52,801 - __main__ - INFO -    - n_estimators: 500
2025-12-02 06:07:52,801 - __main__ - INFO -    - min_child_weight: 3
2025-12-02 06:07:52,801 - __main__ - INFO -    - max_depth: 5
2025-12-02 06:07:52,801 - __main__ - INFO -    - learning_rate: 0.05
2025-12-02 06:07:52,801 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-02 06:07:52,806 - __main__ - INFO - 
Performances sur validation:
2025-12-02 06:07:52,806 - __main__ - INFO -    - MAE: 0.0180
2025-12-02 06:07:52,807 - __main__ - INFO -    - R¬≤: 0.9917
2025-12-02 06:07:52,807 - __main__ - INFO - ================================================================================
2025-12-02 06:07:52,807 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-02 06:07:52,807 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-02 06:07:52,810 - __main__ - INFO - Train: (1170, 79), Test: (293, 79)
2025-12-02 06:07:53,700 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-02 06:07:53,762 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results\6N8\J-21\test_predictions.csv
2025-12-02 06:07:53,762 - __main__ - INFO -    Shape: (293, 85)
2025-12-02 06:07:53,762 - __main__ - INFO -    Colonnes: stay_date, hotCode, 79 features + y_test + y_pred + error + abs_error
2025-12-02 06:07:53,763 - __main__ - INFO -    MAE moyen: 0.0180
2025-12-02 06:07:53,767 - __main__ - INFO - üìä Test MAE: 0.0180
2025-12-02 06:07:53,767 - __main__ - INFO - üìä Test R¬≤: 0.9917
2025-12-02 06:07:53,768 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-02 06:07:54,234 - __main__ - INFO - üìà Graphique sauvegard√©: results\6N8\J-21\xgb_scatter_plot.png
2025-12-02 06:07:54,575 - __main__ - INFO - üìà Graphique sauvegard√©: results\6N8\J-21\xgb_feature_importance.png
2025-12-02 06:07:54,590 - __main__ - INFO - Sauvegarde locale du mod√®le dans results\6N8\J-21\models...
2025-12-02 06:07:54,617 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results\6N8\J-21\models\xgb_to_predictor.joblib
2025-12-02 06:07:54,618 - __main__ - INFO - üíæ Scaler sauvegard√©: results\6N8\J-21\models\xgb_scaler.joblib
2025-12-02 06:07:54,618 - __main__ - INFO - üíæ Features sauvegard√©es: results\6N8\J-21\models\feature_columns.txt
2025-12-02 06:07:54,618 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-02 06:07:54,618 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-02 06:07:54,618 - __main__ - INFO -    Container: ml-models
2025-12-02 06:07:55,122 - __main__ - INFO -    Container existant trouv√©
2025-12-02 06:07:55,123 - __main__ - INFO -    Chemin Azure: predictTo/6N8/J-21/
2025-12-02 06:07:55,219 - __main__ - INFO -    ‚úì predictTo/6N8/J-21/models/xgb_to_predictor.joblib
2025-12-02 06:07:55,238 - __main__ - INFO -    ‚úì predictTo/6N8/J-21/models/xgb_scaler.joblib
2025-12-02 06:07:55,256 - __main__ - INFO -    ‚úì predictTo/6N8/J-21/models/feature_columns.txt
2025-12-02 06:07:55,278 - __main__ - INFO -    ‚úì predictTo/6N8/J-21/xgb_scatter_plot.png
2025-12-02 06:07:55,303 - __main__ - INFO -    ‚úì predictTo/6N8/J-21/xgb_feature_importance.png
2025-12-02 06:07:55,367 - __main__ - INFO -    ‚úì predictTo/6N8/J-21/training_data_before_scaling.csv
2025-12-02 06:07:55,396 - __main__ - INFO -    ‚úì predictTo/6N8/J-21/test_predictions.csv
2025-12-02 06:07:55,396 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-02 06:07:55,396 - __main__ - INFO -    URL: ml-models/predictTo/6N8/J-21/
2025-12-02 06:07:55,397 - __main__ - INFO - ================================================================================
2025-12-02 06:07:55,397 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-02 06:07:55,397 - __main__ - INFO - ================================================================================
2025-12-02 06:07:55,397 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-02 06:07:55,397 - __main__ - INFO -    Train MAE:  0.0014
2025-12-02 06:07:55,397 - __main__ - INFO -    Train RMSE: 0.0026
2025-12-02 06:07:55,397 - __main__ - INFO -    Train R¬≤:   1.0000
2025-12-02 06:07:55,397 - __main__ - INFO -    Test MAE:   0.0180
2025-12-02 06:07:55,397 - __main__ - INFO -    Test RMSE:  0.0350
2025-12-02 06:07:55,397 - __main__ - INFO -    Test R¬≤:    0.9917
2025-12-02 06:08:00,645 - __main__ - INFO - ================================================================================
2025-12-02 06:08:00,645 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-02 06:08:00,645 - __main__ - INFO - ================================================================================
2025-12-02 06:08:00,646 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-02 06:08:00,649 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-02 06:08:00,649 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 15
2025-12-02 06:08:00,649 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-02 06:08:00,649 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel 6N8
2025-12-02 06:08:00,649 - __main__ - INFO - Configuration apr√®s substitution: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/6N8/clustering_results.csv', 'indicateurs_path': '../data/6N8/Indicateurs.csv', 'rateShopper_path': '../data/6N8/rateShopper.csv', 'prediction_horizon': 15, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-02 06:08:00,649 - __main__ - INFO - Chargement des donn√©es...
2025-12-02 06:08:00,649 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\6N8\clustering_results.csv
2025-12-02 06:08:00,661 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-02 06:08:00,853 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-02 06:08:00,853 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: 6N8
2025-12-02 06:08:00,873 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-02 06:08:00,873 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-02 06:08:00,873 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-02 06:08:00,949 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-02 06:08:00,969 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-02 06:08:00,987 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-02 06:08:00,995 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-02 06:08:00,996 - __main__ - INFO - Calcul des features PM sur donn√©es J-16 √† J-60 (pas de data leakage)
2025-12-02 06:08:00,996 - __main__ - INFO -    Colonnes PM utilis√©es: 45
2025-12-02 06:08:02,102 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-02 06:08:02,102 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-16 √† J-60
2025-12-02 06:08:02,102 - __main__ - INFO -    Colonnes Ant utilis√©es: 45
2025-12-02 06:08:02,900 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-02 06:08:02,900 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-16 √† J-60
2025-12-02 06:08:02,900 - __main__ - INFO -    Colonnes Ds utilis√©es: 45
2025-12-02 06:08:03,788 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-02 06:08:03,788 - __main__ - INFO - Chargement des prix concurrents depuis ../data/6N8/rateShopper.csv...
2025-12-02 06:08:03,792 - __main__ - INFO - Prix concurrents charg√©s: (288, 7)
2025-12-02 06:08:03,793 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-02 06:08:03,800 - __main__ - INFO -    Features concurrentes calcul√©es sur J-16 √† J-60
2025-12-02 06:08:03,800 - __main__ - WARNING - ‚ö†Ô∏è  Aucune colonne Comp disponible pour horizon=15
2025-12-02 06:08:03,804 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-02 06:08:04,516 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-02 06:08:04,519 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-02 06:08:04,526 - __main__ - INFO -    ToF1 ajout√© : 669 valeurs non-nulles sur 1463
2025-12-02 06:08:04,526 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-02 06:08:04,944 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-02 06:08:05,047 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-02 06:08:05,061 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-02 06:08:05,061 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-02 06:08:05,062 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-02 06:08:05,062 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-02 06:08:05,062 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-02 06:08:05,062 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-02 06:08:05,062 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-02 06:08:05,065 - __main__ - INFO - Cr√©ation des features et target...
2025-12-02 06:08:05,065 - __main__ - INFO - --------------------------------
2025-12-02 06:08:05,065 - __main__ - INFO - Horizon: 15
2025-12-02 06:08:05,065 - __main__ - INFO - --------------------------------
2025-12-02 06:08:05,065 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-02 06:08:05,067 - __main__ - INFO - nb_observations recalcul√© pour horizon=15
2025-12-02 06:08:05,067 - __main__ - INFO -    Colonnes TO compt√©es: J-60 √† J-16 (45 colonnes)
2025-12-02 06:08:05,067 - __main__ - INFO -    Minimum: 45
2025-12-02 06:08:05,067 - __main__ - INFO -    Maximum: 45
2025-12-02 06:08:05,067 - __main__ - INFO -    Moyenne: 45.0
2025-12-02 06:08:05,067 - __main__ - INFO - Features TO historiques: J-60 √† J-16 (45 colonnes)
2025-12-02 06:08:05,067 - __main__ - INFO - Nombre total de features: 85
2025-12-02 06:08:05,067 - __main__ - INFO -    - TO historiques: 45
2025-12-02 06:08:05,067 - __main__ - INFO -    - Features PM: 7
2025-12-02 06:08:05,067 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-02 06:08:05,067 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-02 06:08:05,067 - __main__ - INFO -    - Features concurrents: 6
2025-12-02 06:08:05,067 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-02 06:08:05,067 - __main__ - INFO -    - Autres features: 11
2025-12-02 06:08:05,150 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results\6N8\J-15\training_data_before_scaling.csv
2025-12-02 06:08:05,150 - __main__ - INFO -    Shape: (1463, 88)
2025-12-02 06:08:05,150 - __main__ - INFO -    Colonnes: stay_date, hotCode, 85 features, J-0
2025-12-02 06:08:05,150 - __main__ - INFO - X shape: (1463, 85), y shape: (1463,)
2025-12-02 06:08:05,150 - __main__ - INFO - ================================================================================
2025-12-02 06:08:05,150 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-02 06:08:05,150 - __main__ - INFO - ================================================================================
2025-12-02 06:08:05,155 - __main__ - INFO - Train: (1170, 85), Validation: (293, 85)
2025-12-02 06:08:05,156 - __main__ - INFO - Configuration de la recherche:
2025-12-02 06:08:05,156 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-02 06:08:05,156 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-02 06:08:05,156 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-02 06:08:05,156 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-02 06:08:05,156 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-02 06:08:57,739 - __main__ - INFO - ================================================================================
2025-12-02 06:08:57,739 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-02 06:08:57,739 - __main__ - INFO - ================================================================================
2025-12-02 06:08:57,740 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0212
2025-12-02 06:08:57,740 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-02 06:08:57,740 - __main__ - INFO -    - subsample: 0.9
2025-12-02 06:08:57,740 - __main__ - INFO -    - reg_lambda: 1.5
2025-12-02 06:08:57,740 - __main__ - INFO -    - reg_alpha: 0
2025-12-02 06:08:57,740 - __main__ - INFO -    - n_estimators: 800
2025-12-02 06:08:57,740 - __main__ - INFO -    - min_child_weight: 2
2025-12-02 06:08:57,740 - __main__ - INFO -    - max_depth: 8
2025-12-02 06:08:57,740 - __main__ - INFO -    - learning_rate: 0.03
2025-12-02 06:08:57,740 - __main__ - INFO -    - colsample_bytree: 0.85
2025-12-02 06:08:57,746 - __main__ - INFO - 
Performances sur validation:
2025-12-02 06:08:57,747 - __main__ - INFO -    - MAE: 0.0172
2025-12-02 06:08:57,747 - __main__ - INFO -    - R¬≤: 0.9927
2025-12-02 06:08:57,747 - __main__ - INFO - ================================================================================
2025-12-02 06:08:57,747 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-02 06:08:57,747 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-02 06:08:57,750 - __main__ - INFO - Train: (1170, 85), Test: (293, 85)
2025-12-02 06:09:00,651 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-02 06:09:00,734 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results\6N8\J-15\test_predictions.csv
2025-12-02 06:09:00,734 - __main__ - INFO -    Shape: (293, 91)
2025-12-02 06:09:00,734 - __main__ - INFO -    Colonnes: stay_date, hotCode, 85 features + y_test + y_pred + error + abs_error
2025-12-02 06:09:00,735 - __main__ - INFO -    MAE moyen: 0.0172
2025-12-02 06:09:00,741 - __main__ - INFO - üìä Test MAE: 0.0172
2025-12-02 06:09:00,742 - __main__ - INFO - üìä Test R¬≤: 0.9927
2025-12-02 06:09:00,742 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-02 06:09:01,224 - __main__ - INFO - üìà Graphique sauvegard√©: results\6N8\J-15\xgb_scatter_plot.png
2025-12-02 06:09:01,529 - __main__ - INFO - üìà Graphique sauvegard√©: results\6N8\J-15\xgb_feature_importance.png
2025-12-02 06:09:01,543 - __main__ - INFO - Sauvegarde locale du mod√®le dans results\6N8\J-15\models...
2025-12-02 06:09:01,580 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results\6N8\J-15\models\xgb_to_predictor.joblib
2025-12-02 06:09:01,580 - __main__ - INFO - üíæ Scaler sauvegard√©: results\6N8\J-15\models\xgb_scaler.joblib
2025-12-02 06:09:01,580 - __main__ - INFO - üíæ Features sauvegard√©es: results\6N8\J-15\models\feature_columns.txt
2025-12-02 06:09:01,581 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-02 06:09:01,581 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-02 06:09:01,581 - __main__ - INFO -    Container: ml-models
2025-12-02 06:09:02,113 - __main__ - INFO -    Container existant trouv√©
2025-12-02 06:09:02,113 - __main__ - INFO -    Chemin Azure: predictTo/6N8/J-15/
2025-12-02 06:09:02,271 - __main__ - INFO -    ‚úì predictTo/6N8/J-15/models/xgb_to_predictor.joblib
2025-12-02 06:09:02,288 - __main__ - INFO -    ‚úì predictTo/6N8/J-15/models/xgb_scaler.joblib
2025-12-02 06:09:02,306 - __main__ - INFO -    ‚úì predictTo/6N8/J-15/models/feature_columns.txt
2025-12-02 06:09:02,323 - __main__ - INFO -    ‚úì predictTo/6N8/J-15/xgb_scatter_plot.png
2025-12-02 06:09:02,342 - __main__ - INFO -    ‚úì predictTo/6N8/J-15/xgb_feature_importance.png
2025-12-02 06:09:02,476 - __main__ - INFO -    ‚úì predictTo/6N8/J-15/training_data_before_scaling.csv
2025-12-02 06:09:02,503 - __main__ - INFO -    ‚úì predictTo/6N8/J-15/test_predictions.csv
2025-12-02 06:09:02,503 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-02 06:09:02,503 - __main__ - INFO -    URL: ml-models/predictTo/6N8/J-15/
2025-12-02 06:09:02,505 - __main__ - INFO - ================================================================================
2025-12-02 06:09:02,505 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-02 06:09:02,505 - __main__ - INFO - ================================================================================
2025-12-02 06:09:02,505 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-02 06:09:02,505 - __main__ - INFO -    Train MAE:  0.0003
2025-12-02 06:09:02,505 - __main__ - INFO -    Train RMSE: 0.0006
2025-12-02 06:09:02,505 - __main__ - INFO -    Train R¬≤:   1.0000
2025-12-02 06:09:02,505 - __main__ - INFO -    Test MAE:   0.0172
2025-12-02 06:09:02,505 - __main__ - INFO -    Test RMSE:  0.0328
2025-12-02 06:09:02,505 - __main__ - INFO -    Test R¬≤:    0.9927
2025-12-02 06:09:08,522 - __main__ - INFO - ================================================================================
2025-12-02 06:09:08,522 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-02 06:09:08,522 - __main__ - INFO - ================================================================================
2025-12-02 06:09:08,523 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-02 06:09:08,526 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-02 06:09:08,526 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 10
2025-12-02 06:09:08,526 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-02 06:09:08,526 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel 6N8
2025-12-02 06:09:08,526 - __main__ - INFO - Configuration apr√®s substitution: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/6N8/clustering_results.csv', 'indicateurs_path': '../data/6N8/Indicateurs.csv', 'rateShopper_path': '../data/6N8/rateShopper.csv', 'prediction_horizon': 10, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-02 06:09:08,527 - __main__ - INFO - Chargement des donn√©es...
2025-12-02 06:09:08,527 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\6N8\clustering_results.csv
2025-12-02 06:09:08,538 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-02 06:09:08,734 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-02 06:09:08,734 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: 6N8
2025-12-02 06:09:08,759 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-02 06:09:08,759 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-02 06:09:08,759 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-02 06:09:08,842 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-02 06:09:08,863 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-02 06:09:08,884 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-02 06:09:08,893 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-02 06:09:08,893 - __main__ - INFO - Calcul des features PM sur donn√©es J-11 √† J-60 (pas de data leakage)
2025-12-02 06:09:08,893 - __main__ - INFO -    Colonnes PM utilis√©es: 50
2025-12-02 06:09:10,185 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-02 06:09:10,185 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-11 √† J-60
2025-12-02 06:09:10,185 - __main__ - INFO -    Colonnes Ant utilis√©es: 50
2025-12-02 06:09:11,011 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-02 06:09:11,011 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-11 √† J-60
2025-12-02 06:09:11,011 - __main__ - INFO -    Colonnes Ds utilis√©es: 50
2025-12-02 06:09:11,791 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-02 06:09:11,791 - __main__ - INFO - Chargement des prix concurrents depuis ../data/6N8/rateShopper.csv...
2025-12-02 06:09:11,795 - __main__ - INFO - Prix concurrents charg√©s: (288, 7)
2025-12-02 06:09:11,795 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-02 06:09:11,802 - __main__ - INFO -    Features concurrentes calcul√©es sur J-11 √† J-60
2025-12-02 06:09:11,808 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-02 06:09:13,108 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-02 06:09:13,112 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-02 06:09:13,119 - __main__ - INFO -    ToF1 ajout√© : 669 valeurs non-nulles sur 1463
2025-12-02 06:09:13,119 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-02 06:09:13,505 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-02 06:09:13,596 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-02 06:09:13,612 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-02 06:09:13,612 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-02 06:09:13,612 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-02 06:09:13,612 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-02 06:09:13,612 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-02 06:09:13,612 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-02 06:09:13,612 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-02 06:09:13,615 - __main__ - INFO - Cr√©ation des features et target...
2025-12-02 06:09:13,615 - __main__ - INFO - --------------------------------
2025-12-02 06:09:13,615 - __main__ - INFO - Horizon: 10
2025-12-02 06:09:13,615 - __main__ - INFO - --------------------------------
2025-12-02 06:09:13,616 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-02 06:09:13,617 - __main__ - INFO - nb_observations recalcul√© pour horizon=10
2025-12-02 06:09:13,617 - __main__ - INFO -    Colonnes TO compt√©es: J-60 √† J-11 (50 colonnes)
2025-12-02 06:09:13,617 - __main__ - INFO -    Minimum: 50
2025-12-02 06:09:13,617 - __main__ - INFO -    Maximum: 50
2025-12-02 06:09:13,617 - __main__ - INFO -    Moyenne: 50.0
2025-12-02 06:09:13,617 - __main__ - INFO - Features TO historiques: J-60 √† J-11 (50 colonnes)
2025-12-02 06:09:13,617 - __main__ - INFO - Nombre total de features: 90
2025-12-02 06:09:13,617 - __main__ - INFO -    - TO historiques: 50
2025-12-02 06:09:13,617 - __main__ - INFO -    - Features PM: 7
2025-12-02 06:09:13,617 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-02 06:09:13,617 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-02 06:09:13,617 - __main__ - INFO -    - Features concurrents: 6
2025-12-02 06:09:13,617 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-02 06:09:13,617 - __main__ - INFO -    - Autres features: 11
2025-12-02 06:09:13,700 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results\6N8\J-10\training_data_before_scaling.csv
2025-12-02 06:09:13,700 - __main__ - INFO -    Shape: (1463, 93)
2025-12-02 06:09:13,700 - __main__ - INFO -    Colonnes: stay_date, hotCode, 90 features, J-0
2025-12-02 06:09:13,700 - __main__ - INFO - X shape: (1463, 90), y shape: (1463,)
2025-12-02 06:09:13,700 - __main__ - INFO - ================================================================================
2025-12-02 06:09:13,700 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-02 06:09:13,700 - __main__ - INFO - ================================================================================
2025-12-02 06:09:13,704 - __main__ - INFO - Train: (1170, 90), Validation: (293, 90)
2025-12-02 06:09:13,704 - __main__ - INFO - Configuration de la recherche:
2025-12-02 06:09:13,705 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-02 06:09:13,705 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-02 06:09:13,705 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-02 06:09:13,705 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-02 06:09:13,705 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-02 06:10:11,897 - __main__ - INFO - ================================================================================
2025-12-02 06:10:11,898 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-02 06:10:11,898 - __main__ - INFO - ================================================================================
2025-12-02 06:10:11,898 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0194
2025-12-02 06:10:11,898 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-02 06:10:11,898 - __main__ - INFO -    - subsample: 0.95
2025-12-02 06:10:11,899 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-02 06:10:11,899 - __main__ - INFO -    - reg_alpha: 0
2025-12-02 06:10:11,899 - __main__ - INFO -    - n_estimators: 500
2025-12-02 06:10:11,899 - __main__ - INFO -    - min_child_weight: 3
2025-12-02 06:10:11,899 - __main__ - INFO -    - max_depth: 5
2025-12-02 06:10:11,899 - __main__ - INFO -    - learning_rate: 0.05
2025-12-02 06:10:11,899 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-02 06:10:11,904 - __main__ - INFO - 
Performances sur validation:
2025-12-02 06:10:11,904 - __main__ - INFO -    - MAE: 0.0164
2025-12-02 06:10:11,904 - __main__ - INFO -    - R¬≤: 0.9932
2025-12-02 06:10:11,905 - __main__ - INFO - ================================================================================
2025-12-02 06:10:11,905 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-02 06:10:11,905 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-02 06:10:11,908 - __main__ - INFO - Train: (1170, 90), Test: (293, 90)
2025-12-02 06:10:13,490 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-02 06:10:13,578 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results\6N8\J-10\test_predictions.csv
2025-12-02 06:10:13,578 - __main__ - INFO -    Shape: (293, 96)
2025-12-02 06:10:13,578 - __main__ - INFO -    Colonnes: stay_date, hotCode, 90 features + y_test + y_pred + error + abs_error
2025-12-02 06:10:13,579 - __main__ - INFO -    MAE moyen: 0.0164
2025-12-02 06:10:13,584 - __main__ - INFO - üìä Test MAE: 0.0164
2025-12-02 06:10:13,585 - __main__ - INFO - üìä Test R¬≤: 0.9932
2025-12-02 06:10:13,585 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-02 06:10:14,130 - __main__ - INFO - üìà Graphique sauvegard√©: results\6N8\J-10\xgb_scatter_plot.png
2025-12-02 06:10:14,558 - __main__ - INFO - üìà Graphique sauvegard√©: results\6N8\J-10\xgb_feature_importance.png
2025-12-02 06:10:14,583 - __main__ - INFO - Sauvegarde locale du mod√®le dans results\6N8\J-10\models...
2025-12-02 06:10:14,621 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results\6N8\J-10\models\xgb_to_predictor.joblib
2025-12-02 06:10:14,621 - __main__ - INFO - üíæ Scaler sauvegard√©: results\6N8\J-10\models\xgb_scaler.joblib
2025-12-02 06:10:14,621 - __main__ - INFO - üíæ Features sauvegard√©es: results\6N8\J-10\models\feature_columns.txt
2025-12-02 06:10:14,621 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-02 06:10:14,621 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-02 06:10:14,622 - __main__ - INFO -    Container: ml-models
2025-12-02 06:10:15,294 - __main__ - INFO -    Container existant trouv√©
2025-12-02 06:10:15,294 - __main__ - INFO -    Chemin Azure: predictTo/6N8/J-10/
2025-12-02 06:10:15,408 - __main__ - INFO -    ‚úì predictTo/6N8/J-10/models/xgb_to_predictor.joblib
2025-12-02 06:10:15,427 - __main__ - INFO -    ‚úì predictTo/6N8/J-10/models/xgb_scaler.joblib
2025-12-02 06:10:15,447 - __main__ - INFO -    ‚úì predictTo/6N8/J-10/models/feature_columns.txt
2025-12-02 06:10:15,465 - __main__ - INFO -    ‚úì predictTo/6N8/J-10/xgb_scatter_plot.png
2025-12-02 06:10:15,485 - __main__ - INFO -    ‚úì predictTo/6N8/J-10/xgb_feature_importance.png
2025-12-02 06:10:15,562 - __main__ - INFO -    ‚úì predictTo/6N8/J-10/training_data_before_scaling.csv
2025-12-02 06:10:15,600 - __main__ - INFO -    ‚úì predictTo/6N8/J-10/test_predictions.csv
2025-12-02 06:10:15,600 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-02 06:10:15,600 - __main__ - INFO -    URL: ml-models/predictTo/6N8/J-10/
2025-12-02 06:10:15,601 - __main__ - INFO - ================================================================================
2025-12-02 06:10:15,601 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-02 06:10:15,601 - __main__ - INFO - ================================================================================
2025-12-02 06:10:15,601 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-02 06:10:15,601 - __main__ - INFO -    Train MAE:  0.0012
2025-12-02 06:10:15,601 - __main__ - INFO -    Train RMSE: 0.0022
2025-12-02 06:10:15,601 - __main__ - INFO -    Train R¬≤:   1.0000
2025-12-02 06:10:15,601 - __main__ - INFO -    Test MAE:   0.0164
2025-12-02 06:10:15,601 - __main__ - INFO -    Test RMSE:  0.0316
2025-12-02 06:10:15,602 - __main__ - INFO -    Test R¬≤:    0.9932
2025-12-02 06:10:23,252 - __main__ - INFO - ================================================================================
2025-12-02 06:10:23,252 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-02 06:10:23,252 - __main__ - INFO - ================================================================================
2025-12-02 06:10:23,252 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-02 06:10:23,259 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-02 06:10:23,259 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 7
2025-12-02 06:10:23,259 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-02 06:10:23,260 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel 6N8
2025-12-02 06:10:23,260 - __main__ - INFO - Configuration apr√®s substitution: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/6N8/clustering_results.csv', 'indicateurs_path': '../data/6N8/Indicateurs.csv', 'rateShopper_path': '../data/6N8/rateShopper.csv', 'prediction_horizon': 7, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-02 06:10:23,260 - __main__ - INFO - Chargement des donn√©es...
2025-12-02 06:10:23,260 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\6N8\clustering_results.csv
2025-12-02 06:10:23,278 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-02 06:10:23,550 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-02 06:10:23,550 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: 6N8
2025-12-02 06:10:23,575 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-02 06:10:23,576 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-02 06:10:23,576 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-02 06:10:23,680 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-02 06:10:23,715 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-02 06:10:23,754 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-02 06:10:23,772 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-02 06:10:23,772 - __main__ - INFO - Calcul des features PM sur donn√©es J-8 √† J-60 (pas de data leakage)
2025-12-02 06:10:23,772 - __main__ - INFO -    Colonnes PM utilis√©es: 53
2025-12-02 06:10:25,909 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-02 06:10:25,910 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-8 √† J-60
2025-12-02 06:10:25,910 - __main__ - INFO -    Colonnes Ant utilis√©es: 53
2025-12-02 06:10:27,369 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-02 06:10:27,370 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-8 √† J-60
2025-12-02 06:10:27,370 - __main__ - INFO -    Colonnes Ds utilis√©es: 53
2025-12-02 06:10:28,564 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-02 06:10:28,564 - __main__ - INFO - Chargement des prix concurrents depuis ../data/6N8/rateShopper.csv...
2025-12-02 06:10:28,567 - __main__ - INFO - Prix concurrents charg√©s: (288, 7)
2025-12-02 06:10:28,568 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-02 06:10:28,577 - __main__ - INFO -    Features concurrentes calcul√©es sur J-8 √† J-60
2025-12-02 06:10:28,582 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-02 06:10:30,469 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-02 06:10:30,474 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-02 06:10:30,481 - __main__ - INFO -    ToF1 ajout√© : 669 valeurs non-nulles sur 1463
2025-12-02 06:10:30,481 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-02 06:10:30,935 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-02 06:10:31,051 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-02 06:10:31,072 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-02 06:10:31,072 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-02 06:10:31,072 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-02 06:10:31,073 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-02 06:10:31,073 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-02 06:10:31,073 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-02 06:10:31,073 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-02 06:10:31,078 - __main__ - INFO - Cr√©ation des features et target...
2025-12-02 06:10:31,078 - __main__ - INFO - --------------------------------
2025-12-02 06:10:31,078 - __main__ - INFO - Horizon: 7
2025-12-02 06:10:31,078 - __main__ - INFO - --------------------------------
2025-12-02 06:10:31,079 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-02 06:10:31,080 - __main__ - INFO - nb_observations recalcul√© pour horizon=7
2025-12-02 06:10:31,080 - __main__ - INFO -    Colonnes TO compt√©es: J-60 √† J-8 (53 colonnes)
2025-12-02 06:10:31,080 - __main__ - INFO -    Minimum: 53
2025-12-02 06:10:31,080 - __main__ - INFO -    Maximum: 53
2025-12-02 06:10:31,081 - __main__ - INFO -    Moyenne: 53.0
2025-12-02 06:10:31,081 - __main__ - INFO - Features TO historiques: J-60 √† J-8 (53 colonnes)
2025-12-02 06:10:31,081 - __main__ - INFO - Nombre total de features: 93
2025-12-02 06:10:31,081 - __main__ - INFO -    - TO historiques: 53
2025-12-02 06:10:31,081 - __main__ - INFO -    - Features PM: 7
2025-12-02 06:10:31,081 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-02 06:10:31,081 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-02 06:10:31,081 - __main__ - INFO -    - Features concurrents: 6
2025-12-02 06:10:31,081 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-02 06:10:31,081 - __main__ - INFO -    - Autres features: 11
2025-12-02 06:10:31,193 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results\6N8\J-7\training_data_before_scaling.csv
2025-12-02 06:10:31,193 - __main__ - INFO -    Shape: (1463, 96)
2025-12-02 06:10:31,193 - __main__ - INFO -    Colonnes: stay_date, hotCode, 93 features, J-0
2025-12-02 06:10:31,193 - __main__ - INFO - X shape: (1463, 93), y shape: (1463,)
2025-12-02 06:10:31,193 - __main__ - INFO - ================================================================================
2025-12-02 06:10:31,193 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-02 06:10:31,193 - __main__ - INFO - ================================================================================
2025-12-02 06:10:31,198 - __main__ - INFO - Train: (1170, 93), Validation: (293, 93)
2025-12-02 06:10:31,198 - __main__ - INFO - Configuration de la recherche:
2025-12-02 06:10:31,199 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-02 06:10:31,199 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-02 06:10:31,199 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-02 06:10:31,199 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-02 06:10:31,199 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-02 06:11:25,958 - __main__ - INFO - ================================================================================
2025-12-02 06:11:25,958 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-02 06:11:25,958 - __main__ - INFO - ================================================================================
2025-12-02 06:11:25,958 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0176
2025-12-02 06:11:25,958 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-02 06:11:25,958 - __main__ - INFO -    - subsample: 0.9
2025-12-02 06:11:25,959 - __main__ - INFO -    - reg_lambda: 2.0
2025-12-02 06:11:25,959 - __main__ - INFO -    - reg_alpha: 0
2025-12-02 06:11:25,959 - __main__ - INFO -    - n_estimators: 300
2025-12-02 06:11:25,959 - __main__ - INFO -    - min_child_weight: 3
2025-12-02 06:11:25,959 - __main__ - INFO -    - max_depth: 9
2025-12-02 06:11:25,959 - __main__ - INFO -    - learning_rate: 0.03
2025-12-02 06:11:25,959 - __main__ - INFO -    - colsample_bytree: 0.9
2025-12-02 06:11:25,963 - __main__ - INFO - 
Performances sur validation:
2025-12-02 06:11:25,964 - __main__ - INFO -    - MAE: 0.0147
2025-12-02 06:11:25,964 - __main__ - INFO -    - R¬≤: 0.9944
2025-12-02 06:11:25,964 - __main__ - INFO - ================================================================================
2025-12-02 06:11:25,964 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-02 06:11:25,964 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-02 06:11:25,966 - __main__ - INFO - Train: (1170, 93), Test: (293, 93)
2025-12-02 06:11:27,719 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-02 06:11:27,783 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results\6N8\J-7\test_predictions.csv
2025-12-02 06:11:27,783 - __main__ - INFO -    Shape: (293, 99)
2025-12-02 06:11:27,783 - __main__ - INFO -    Colonnes: stay_date, hotCode, 93 features + y_test + y_pred + error + abs_error
2025-12-02 06:11:27,784 - __main__ - INFO -    MAE moyen: 0.0147
2025-12-02 06:11:27,788 - __main__ - INFO - üìä Test MAE: 0.0147
2025-12-02 06:11:27,789 - __main__ - INFO - üìä Test R¬≤: 0.9944
2025-12-02 06:11:27,789 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-02 06:11:28,187 - __main__ - INFO - üìà Graphique sauvegard√©: results\6N8\J-7\xgb_scatter_plot.png
2025-12-02 06:11:28,496 - __main__ - INFO - üìà Graphique sauvegard√©: results\6N8\J-7\xgb_feature_importance.png
2025-12-02 06:11:28,507 - __main__ - INFO - Sauvegarde locale du mod√®le dans results\6N8\J-7\models...
2025-12-02 06:11:28,532 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results\6N8\J-7\models\xgb_to_predictor.joblib
2025-12-02 06:11:28,532 - __main__ - INFO - üíæ Scaler sauvegard√©: results\6N8\J-7\models\xgb_scaler.joblib
2025-12-02 06:11:28,532 - __main__ - INFO - üíæ Features sauvegard√©es: results\6N8\J-7\models\feature_columns.txt
2025-12-02 06:11:28,532 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-02 06:11:28,532 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-02 06:11:28,533 - __main__ - INFO -    Container: ml-models
2025-12-02 06:11:29,053 - __main__ - INFO -    Container existant trouv√©
2025-12-02 06:11:29,054 - __main__ - INFO -    Chemin Azure: predictTo/6N8/J-7/
2025-12-02 06:11:29,168 - __main__ - INFO -    ‚úì predictTo/6N8/J-7/models/xgb_to_predictor.joblib
2025-12-02 06:11:29,186 - __main__ - INFO -    ‚úì predictTo/6N8/J-7/models/xgb_scaler.joblib
2025-12-02 06:11:29,203 - __main__ - INFO -    ‚úì predictTo/6N8/J-7/models/feature_columns.txt
2025-12-02 06:11:29,222 - __main__ - INFO -    ‚úì predictTo/6N8/J-7/xgb_scatter_plot.png
2025-12-02 06:11:29,241 - __main__ - INFO -    ‚úì predictTo/6N8/J-7/xgb_feature_importance.png
2025-12-02 06:11:29,355 - __main__ - INFO -    ‚úì predictTo/6N8/J-7/training_data_before_scaling.csv
2025-12-02 06:11:29,388 - __main__ - INFO -    ‚úì predictTo/6N8/J-7/test_predictions.csv
2025-12-02 06:11:29,388 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-02 06:11:29,388 - __main__ - INFO -    URL: ml-models/predictTo/6N8/J-7/
2025-12-02 06:11:29,389 - __main__ - INFO - ================================================================================
2025-12-02 06:11:29,389 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-02 06:11:29,389 - __main__ - INFO - ================================================================================
2025-12-02 06:11:29,389 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-02 06:11:29,390 - __main__ - INFO -    Train MAE:  0.0009
2025-12-02 06:11:29,390 - __main__ - INFO -    Train RMSE: 0.0022
2025-12-02 06:11:29,390 - __main__ - INFO -    Train R¬≤:   1.0000
2025-12-02 06:11:29,390 - __main__ - INFO -    Test MAE:   0.0147
2025-12-02 06:11:29,390 - __main__ - INFO -    Test RMSE:  0.0287
2025-12-02 06:11:29,390 - __main__ - INFO -    Test R¬≤:    0.9944
2025-12-02 06:11:34,738 - __main__ - INFO - ================================================================================
2025-12-02 06:11:34,738 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-02 06:11:34,738 - __main__ - INFO - ================================================================================
2025-12-02 06:11:34,738 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-02 06:11:34,742 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-02 06:11:34,743 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 5
2025-12-02 06:11:34,743 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-02 06:11:34,743 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel 6N8
2025-12-02 06:11:34,743 - __main__ - INFO - Configuration apr√®s substitution: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/6N8/clustering_results.csv', 'indicateurs_path': '../data/6N8/Indicateurs.csv', 'rateShopper_path': '../data/6N8/rateShopper.csv', 'prediction_horizon': 5, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-02 06:11:34,743 - __main__ - INFO - Chargement des donn√©es...
2025-12-02 06:11:34,743 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\6N8\clustering_results.csv
2025-12-02 06:11:34,755 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-02 06:11:34,950 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-02 06:11:34,950 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: 6N8
2025-12-02 06:11:34,970 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-02 06:11:34,970 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-02 06:11:34,970 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-02 06:11:35,045 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-02 06:11:35,067 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-02 06:11:35,088 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-02 06:11:35,098 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-02 06:11:35,098 - __main__ - INFO - Calcul des features PM sur donn√©es J-6 √† J-60 (pas de data leakage)
2025-12-02 06:11:35,098 - __main__ - INFO -    Colonnes PM utilis√©es: 55
2025-12-02 06:11:36,249 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-02 06:11:36,249 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-6 √† J-60
2025-12-02 06:11:36,249 - __main__ - INFO -    Colonnes Ant utilis√©es: 55
2025-12-02 06:11:37,070 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-02 06:11:37,071 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-6 √† J-60
2025-12-02 06:11:37,071 - __main__ - INFO -    Colonnes Ds utilis√©es: 55
2025-12-02 06:11:37,894 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-02 06:11:37,894 - __main__ - INFO - Chargement des prix concurrents depuis ../data/6N8/rateShopper.csv...
2025-12-02 06:11:37,897 - __main__ - INFO - Prix concurrents charg√©s: (288, 7)
2025-12-02 06:11:37,897 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-02 06:11:37,904 - __main__ - INFO -    Features concurrentes calcul√©es sur J-6 √† J-60
2025-12-02 06:11:37,911 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-02 06:11:39,257 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-02 06:11:39,261 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-02 06:11:39,268 - __main__ - INFO -    ToF1 ajout√© : 669 valeurs non-nulles sur 1463
2025-12-02 06:11:39,268 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-02 06:11:39,625 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-02 06:11:39,721 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-02 06:11:39,735 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-02 06:11:39,735 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-02 06:11:39,736 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-02 06:11:39,736 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-02 06:11:39,736 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-02 06:11:39,736 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-02 06:11:39,736 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-02 06:11:39,740 - __main__ - INFO - Cr√©ation des features et target...
2025-12-02 06:11:39,740 - __main__ - INFO - --------------------------------
2025-12-02 06:11:39,740 - __main__ - INFO - Horizon: 5
2025-12-02 06:11:39,740 - __main__ - INFO - --------------------------------
2025-12-02 06:11:39,740 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-02 06:11:39,742 - __main__ - INFO - nb_observations recalcul√© pour horizon=5
2025-12-02 06:11:39,742 - __main__ - INFO -    Colonnes TO compt√©es: J-60 √† J-6 (55 colonnes)
2025-12-02 06:11:39,742 - __main__ - INFO -    Minimum: 55
2025-12-02 06:11:39,742 - __main__ - INFO -    Maximum: 55
2025-12-02 06:11:39,742 - __main__ - INFO -    Moyenne: 55.0
2025-12-02 06:11:39,742 - __main__ - INFO - Features TO historiques: J-60 √† J-6 (55 colonnes)
2025-12-02 06:11:39,742 - __main__ - INFO - Nombre total de features: 95
2025-12-02 06:11:39,742 - __main__ - INFO -    - TO historiques: 55
2025-12-02 06:11:39,742 - __main__ - INFO -    - Features PM: 7
2025-12-02 06:11:39,742 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-02 06:11:39,742 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-02 06:11:39,743 - __main__ - INFO -    - Features concurrents: 6
2025-12-02 06:11:39,743 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-02 06:11:39,743 - __main__ - INFO -    - Autres features: 11
2025-12-02 06:11:39,940 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results\6N8\J-5\training_data_before_scaling.csv
2025-12-02 06:11:39,941 - __main__ - INFO -    Shape: (1463, 98)
2025-12-02 06:11:39,941 - __main__ - INFO -    Colonnes: stay_date, hotCode, 95 features, J-0
2025-12-02 06:11:39,941 - __main__ - INFO - X shape: (1463, 95), y shape: (1463,)
2025-12-02 06:11:39,941 - __main__ - INFO - ================================================================================
2025-12-02 06:11:39,941 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-02 06:11:39,941 - __main__ - INFO - ================================================================================
2025-12-02 06:11:39,945 - __main__ - INFO - Train: (1170, 95), Validation: (293, 95)
2025-12-02 06:11:39,945 - __main__ - INFO - Configuration de la recherche:
2025-12-02 06:11:39,945 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-02 06:11:39,945 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-02 06:11:39,945 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-02 06:11:39,946 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-02 06:11:39,946 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-02 06:12:34,860 - __main__ - INFO - ================================================================================
2025-12-02 06:12:34,860 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-02 06:12:34,861 - __main__ - INFO - ================================================================================
2025-12-02 06:12:34,861 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0168
2025-12-02 06:12:34,861 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-02 06:12:34,861 - __main__ - INFO -    - subsample: 0.95
2025-12-02 06:12:34,861 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-02 06:12:34,861 - __main__ - INFO -    - reg_alpha: 0
2025-12-02 06:12:34,861 - __main__ - INFO -    - n_estimators: 500
2025-12-02 06:12:34,862 - __main__ - INFO -    - min_child_weight: 3
2025-12-02 06:12:34,862 - __main__ - INFO -    - max_depth: 5
2025-12-02 06:12:34,862 - __main__ - INFO -    - learning_rate: 0.05
2025-12-02 06:12:34,862 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-02 06:12:34,867 - __main__ - INFO - 
Performances sur validation:
2025-12-02 06:12:34,867 - __main__ - INFO -    - MAE: 0.0144
2025-12-02 06:12:34,867 - __main__ - INFO -    - R¬≤: 0.9944
2025-12-02 06:12:34,867 - __main__ - INFO - ================================================================================
2025-12-02 06:12:34,867 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-02 06:12:34,868 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-02 06:12:34,870 - __main__ - INFO - Train: (1170, 95), Test: (293, 95)
2025-12-02 06:12:35,842 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-02 06:12:35,918 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results\6N8\J-5\test_predictions.csv
2025-12-02 06:12:35,918 - __main__ - INFO -    Shape: (293, 101)
2025-12-02 06:12:35,919 - __main__ - INFO -    Colonnes: stay_date, hotCode, 95 features + y_test + y_pred + error + abs_error
2025-12-02 06:12:35,919 - __main__ - INFO -    MAE moyen: 0.0144
2025-12-02 06:12:35,924 - __main__ - INFO - üìä Test MAE: 0.0144
2025-12-02 06:12:35,924 - __main__ - INFO - üìä Test R¬≤: 0.9944
2025-12-02 06:12:35,924 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-02 06:12:36,360 - __main__ - INFO - üìà Graphique sauvegard√©: results\6N8\J-5\xgb_scatter_plot.png
2025-12-02 06:12:36,665 - __main__ - INFO - üìà Graphique sauvegard√©: results\6N8\J-5\xgb_feature_importance.png
2025-12-02 06:12:36,678 - __main__ - INFO - Sauvegarde locale du mod√®le dans results\6N8\J-5\models...
2025-12-02 06:12:36,705 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results\6N8\J-5\models\xgb_to_predictor.joblib
2025-12-02 06:12:36,705 - __main__ - INFO - üíæ Scaler sauvegard√©: results\6N8\J-5\models\xgb_scaler.joblib
2025-12-02 06:12:36,705 - __main__ - INFO - üíæ Features sauvegard√©es: results\6N8\J-5\models\feature_columns.txt
2025-12-02 06:12:36,706 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-02 06:12:36,706 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-02 06:12:36,706 - __main__ - INFO -    Container: ml-models
2025-12-02 06:12:37,235 - __main__ - INFO -    Container existant trouv√©
2025-12-02 06:12:37,235 - __main__ - INFO -    Chemin Azure: predictTo/6N8/J-5/
2025-12-02 06:12:37,327 - __main__ - INFO -    ‚úì predictTo/6N8/J-5/models/xgb_to_predictor.joblib
2025-12-02 06:12:37,345 - __main__ - INFO -    ‚úì predictTo/6N8/J-5/models/xgb_scaler.joblib
2025-12-02 06:12:37,362 - __main__ - INFO -    ‚úì predictTo/6N8/J-5/models/feature_columns.txt
2025-12-02 06:12:37,383 - __main__ - INFO -    ‚úì predictTo/6N8/J-5/xgb_scatter_plot.png
2025-12-02 06:12:37,400 - __main__ - INFO -    ‚úì predictTo/6N8/J-5/xgb_feature_importance.png
2025-12-02 06:12:37,477 - __main__ - INFO -    ‚úì predictTo/6N8/J-5/training_data_before_scaling.csv
2025-12-02 06:12:37,515 - __main__ - INFO -    ‚úì predictTo/6N8/J-5/test_predictions.csv
2025-12-02 06:12:37,515 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-02 06:12:37,515 - __main__ - INFO -    URL: ml-models/predictTo/6N8/J-5/
2025-12-02 06:12:37,516 - __main__ - INFO - ================================================================================
2025-12-02 06:12:37,517 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-02 06:12:37,517 - __main__ - INFO - ================================================================================
2025-12-02 06:12:37,517 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-02 06:12:37,517 - __main__ - INFO -    Train MAE:  0.0011
2025-12-02 06:12:37,517 - __main__ - INFO -    Train RMSE: 0.0019
2025-12-02 06:12:37,517 - __main__ - INFO -    Train R¬≤:   1.0000
2025-12-02 06:12:37,517 - __main__ - INFO -    Test MAE:   0.0144
2025-12-02 06:12:37,517 - __main__ - INFO -    Test RMSE:  0.0287
2025-12-02 06:12:37,517 - __main__ - INFO -    Test R¬≤:    0.9944
2025-12-02 06:12:43,309 - __main__ - INFO - ================================================================================
2025-12-02 06:12:43,309 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-02 06:12:43,309 - __main__ - INFO - ================================================================================
2025-12-02 06:12:43,309 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-02 06:12:43,313 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-02 06:12:43,313 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 3
2025-12-02 06:12:43,313 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-02 06:12:43,313 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel 6N8
2025-12-02 06:12:43,313 - __main__ - INFO - Configuration apr√®s substitution: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/6N8/clustering_results.csv', 'indicateurs_path': '../data/6N8/Indicateurs.csv', 'rateShopper_path': '../data/6N8/rateShopper.csv', 'prediction_horizon': 3, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-02 06:12:43,313 - __main__ - INFO - Chargement des donn√©es...
2025-12-02 06:12:43,313 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\6N8\clustering_results.csv
2025-12-02 06:12:43,325 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-02 06:12:43,519 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-02 06:12:43,519 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: 6N8
2025-12-02 06:12:43,540 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-02 06:12:43,540 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-02 06:12:43,540 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-02 06:12:43,619 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-02 06:12:43,643 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-02 06:12:43,665 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-02 06:12:43,674 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-02 06:12:43,675 - __main__ - INFO - Calcul des features PM sur donn√©es J-4 √† J-60 (pas de data leakage)
2025-12-02 06:12:43,675 - __main__ - INFO -    Colonnes PM utilis√©es: 57
2025-12-02 06:12:44,871 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-02 06:12:44,871 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-4 √† J-60
2025-12-02 06:12:44,871 - __main__ - INFO -    Colonnes Ant utilis√©es: 57
2025-12-02 06:12:45,703 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-02 06:12:45,703 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-4 √† J-60
2025-12-02 06:12:45,703 - __main__ - INFO -    Colonnes Ds utilis√©es: 57
2025-12-02 06:12:46,535 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-02 06:12:46,535 - __main__ - INFO - Chargement des prix concurrents depuis ../data/6N8/rateShopper.csv...
2025-12-02 06:12:46,538 - __main__ - INFO - Prix concurrents charg√©s: (288, 7)
2025-12-02 06:12:46,538 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-02 06:12:46,547 - __main__ - INFO -    Features concurrentes calcul√©es sur J-4 √† J-60
2025-12-02 06:12:46,553 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-02 06:12:48,236 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-02 06:12:48,240 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-02 06:12:48,247 - __main__ - INFO -    ToF1 ajout√© : 669 valeurs non-nulles sur 1463
2025-12-02 06:12:48,247 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-02 06:12:48,635 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-02 06:12:48,732 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-02 06:12:48,746 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-02 06:12:48,746 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-02 06:12:48,746 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-02 06:12:48,746 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-02 06:12:48,747 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-02 06:12:48,747 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-02 06:12:48,747 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-02 06:12:48,750 - __main__ - INFO - Cr√©ation des features et target...
2025-12-02 06:12:48,750 - __main__ - INFO - --------------------------------
2025-12-02 06:12:48,750 - __main__ - INFO - Horizon: 3
2025-12-02 06:12:48,750 - __main__ - INFO - --------------------------------
2025-12-02 06:12:48,750 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-02 06:12:48,752 - __main__ - INFO - nb_observations recalcul√© pour horizon=3
2025-12-02 06:12:48,752 - __main__ - INFO -    Colonnes TO compt√©es: J-60 √† J-4 (57 colonnes)
2025-12-02 06:12:48,752 - __main__ - INFO -    Minimum: 57
2025-12-02 06:12:48,752 - __main__ - INFO -    Maximum: 57
2025-12-02 06:12:48,752 - __main__ - INFO -    Moyenne: 57.0
2025-12-02 06:12:48,752 - __main__ - INFO - Features TO historiques: J-60 √† J-4 (57 colonnes)
2025-12-02 06:12:48,752 - __main__ - INFO - Nombre total de features: 97
2025-12-02 06:12:48,752 - __main__ - INFO -    - TO historiques: 57
2025-12-02 06:12:48,752 - __main__ - INFO -    - Features PM: 7
2025-12-02 06:12:48,752 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-02 06:12:48,752 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-02 06:12:48,752 - __main__ - INFO -    - Features concurrents: 6
2025-12-02 06:12:48,752 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-02 06:12:48,752 - __main__ - INFO -    - Autres features: 11
2025-12-02 06:12:48,857 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results\6N8\J-3\training_data_before_scaling.csv
2025-12-02 06:12:48,858 - __main__ - INFO -    Shape: (1463, 100)
2025-12-02 06:12:48,858 - __main__ - INFO -    Colonnes: stay_date, hotCode, 97 features, J-0
2025-12-02 06:12:48,858 - __main__ - INFO - X shape: (1463, 97), y shape: (1463,)
2025-12-02 06:12:48,858 - __main__ - INFO - ================================================================================
2025-12-02 06:12:48,858 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-02 06:12:48,858 - __main__ - INFO - ================================================================================
2025-12-02 06:12:48,863 - __main__ - INFO - Train: (1170, 97), Validation: (293, 97)
2025-12-02 06:12:48,863 - __main__ - INFO - Configuration de la recherche:
2025-12-02 06:12:48,863 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-02 06:12:48,863 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-02 06:12:48,863 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-02 06:12:48,863 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-02 06:12:48,863 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-02 06:13:44,498 - __main__ - INFO - ================================================================================
2025-12-02 06:13:44,498 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-02 06:13:44,498 - __main__ - INFO - ================================================================================
2025-12-02 06:13:44,498 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0144
2025-12-02 06:13:44,498 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-02 06:13:44,498 - __main__ - INFO -    - subsample: 0.9
2025-12-02 06:13:44,499 - __main__ - INFO -    - reg_lambda: 1.5
2025-12-02 06:13:44,499 - __main__ - INFO -    - reg_alpha: 0
2025-12-02 06:13:44,499 - __main__ - INFO -    - n_estimators: 500
2025-12-02 06:13:44,499 - __main__ - INFO -    - min_child_weight: 2
2025-12-02 06:13:44,499 - __main__ - INFO -    - max_depth: 8
2025-12-02 06:13:44,499 - __main__ - INFO -    - learning_rate: 0.03
2025-12-02 06:13:44,499 - __main__ - INFO -    - colsample_bytree: 0.9
2025-12-02 06:13:44,504 - __main__ - INFO - 
Performances sur validation:
2025-12-02 06:13:44,505 - __main__ - INFO -    - MAE: 0.0127
2025-12-02 06:13:44,505 - __main__ - INFO -    - R¬≤: 0.9957
2025-12-02 06:13:44,505 - __main__ - INFO - ================================================================================
2025-12-02 06:13:44,505 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-02 06:13:44,505 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-02 06:13:44,508 - __main__ - INFO - Train: (1170, 97), Test: (293, 97)
2025-12-02 06:13:47,208 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-02 06:13:47,303 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results\6N8\J-3\test_predictions.csv
2025-12-02 06:13:47,304 - __main__ - INFO -    Shape: (293, 103)
2025-12-02 06:13:47,304 - __main__ - INFO -    Colonnes: stay_date, hotCode, 97 features + y_test + y_pred + error + abs_error
2025-12-02 06:13:47,305 - __main__ - INFO -    MAE moyen: 0.0127
2025-12-02 06:13:47,312 - __main__ - INFO - üìä Test MAE: 0.0127
2025-12-02 06:13:47,312 - __main__ - INFO - üìä Test R¬≤: 0.9957
2025-12-02 06:13:47,313 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-02 06:13:47,786 - __main__ - INFO - üìà Graphique sauvegard√©: results\6N8\J-3\xgb_scatter_plot.png
2025-12-02 06:13:48,126 - __main__ - INFO - üìà Graphique sauvegard√©: results\6N8\J-3\xgb_feature_importance.png
2025-12-02 06:13:48,142 - __main__ - INFO - Sauvegarde locale du mod√®le dans results\6N8\J-3\models...
2025-12-02 06:13:48,178 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results\6N8\J-3\models\xgb_to_predictor.joblib
2025-12-02 06:13:48,178 - __main__ - INFO - üíæ Scaler sauvegard√©: results\6N8\J-3\models\xgb_scaler.joblib
2025-12-02 06:13:48,178 - __main__ - INFO - üíæ Features sauvegard√©es: results\6N8\J-3\models\feature_columns.txt
2025-12-02 06:13:48,178 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-02 06:13:48,178 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-02 06:13:48,178 - __main__ - INFO -    Container: ml-models
2025-12-02 06:13:48,732 - __main__ - INFO -    Container existant trouv√©
2025-12-02 06:13:48,733 - __main__ - INFO -    Chemin Azure: predictTo/6N8/J-3/
2025-12-02 06:13:48,884 - __main__ - INFO -    ‚úì predictTo/6N8/J-3/models/xgb_to_predictor.joblib
2025-12-02 06:13:48,904 - __main__ - INFO -    ‚úì predictTo/6N8/J-3/models/xgb_scaler.joblib
2025-12-02 06:13:48,923 - __main__ - INFO -    ‚úì predictTo/6N8/J-3/models/feature_columns.txt
2025-12-02 06:13:48,941 - __main__ - INFO -    ‚úì predictTo/6N8/J-3/xgb_scatter_plot.png
2025-12-02 06:13:48,958 - __main__ - INFO -    ‚úì predictTo/6N8/J-3/xgb_feature_importance.png
2025-12-02 06:13:49,208 - __main__ - INFO -    ‚úì predictTo/6N8/J-3/training_data_before_scaling.csv
2025-12-02 06:13:49,247 - __main__ - INFO -    ‚úì predictTo/6N8/J-3/test_predictions.csv
2025-12-02 06:13:49,247 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-02 06:13:49,247 - __main__ - INFO -    URL: ml-models/predictTo/6N8/J-3/
2025-12-02 06:13:49,248 - __main__ - INFO - ================================================================================
2025-12-02 06:13:49,248 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-02 06:13:49,248 - __main__ - INFO - ================================================================================
2025-12-02 06:13:49,248 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-02 06:13:49,248 - __main__ - INFO -    Train MAE:  0.0003
2025-12-02 06:13:49,248 - __main__ - INFO -    Train RMSE: 0.0005
2025-12-02 06:13:49,248 - __main__ - INFO -    Train R¬≤:   1.0000
2025-12-02 06:13:49,248 - __main__ - INFO -    Test MAE:   0.0127
2025-12-02 06:13:49,249 - __main__ - INFO -    Test RMSE:  0.0253
2025-12-02 06:13:49,249 - __main__ - INFO -    Test R¬≤:    0.9957
2025-12-02 06:13:55,447 - __main__ - INFO - ================================================================================
2025-12-02 06:13:55,448 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-02 06:13:55,448 - __main__ - INFO - ================================================================================
2025-12-02 06:13:55,448 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-02 06:13:55,451 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-02 06:13:55,452 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 1
2025-12-02 06:13:55,452 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-02 06:13:55,452 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel 6N8
2025-12-02 06:13:55,452 - __main__ - INFO - Configuration apr√®s substitution: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/6N8/clustering_results.csv', 'indicateurs_path': '../data/6N8/Indicateurs.csv', 'rateShopper_path': '../data/6N8/rateShopper.csv', 'prediction_horizon': 1, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-02 06:13:55,452 - __main__ - INFO - Chargement des donn√©es...
2025-12-02 06:13:55,452 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\6N8\clustering_results.csv
2025-12-02 06:13:55,468 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-02 06:13:55,667 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-02 06:13:55,667 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: 6N8
2025-12-02 06:13:55,688 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-02 06:13:55,688 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-02 06:13:55,688 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-02 06:13:55,776 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-02 06:13:55,803 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-02 06:13:55,830 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-02 06:13:55,842 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-02 06:13:55,843 - __main__ - INFO - Calcul des features PM sur donn√©es J-2 √† J-60 (pas de data leakage)
2025-12-02 06:13:55,843 - __main__ - INFO -    Colonnes PM utilis√©es: 59
2025-12-02 06:13:57,253 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-02 06:13:57,253 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-2 √† J-60
2025-12-02 06:13:57,253 - __main__ - INFO -    Colonnes Ant utilis√©es: 59
2025-12-02 06:13:58,244 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-02 06:13:58,244 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-2 √† J-60
2025-12-02 06:13:58,244 - __main__ - INFO -    Colonnes Ds utilis√©es: 59
2025-12-02 06:13:59,249 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-02 06:13:59,249 - __main__ - INFO - Chargement des prix concurrents depuis ../data/6N8/rateShopper.csv...
2025-12-02 06:13:59,252 - __main__ - INFO - Prix concurrents charg√©s: (288, 7)
2025-12-02 06:13:59,252 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-02 06:13:59,260 - __main__ - INFO -    Features concurrentes calcul√©es sur J-2 √† J-60
2025-12-02 06:13:59,268 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-02 06:14:00,880 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-02 06:14:00,884 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-02 06:14:00,892 - __main__ - INFO -    ToF1 ajout√© : 669 valeurs non-nulles sur 1463
2025-12-02 06:14:00,892 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-02 06:14:01,417 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-02 06:14:01,524 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-02 06:14:01,541 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-02 06:14:01,542 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-02 06:14:01,542 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-02 06:14:01,542 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-02 06:14:01,542 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-02 06:14:01,542 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-02 06:14:01,542 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-02 06:14:01,546 - __main__ - INFO - Cr√©ation des features et target...
2025-12-02 06:14:01,546 - __main__ - INFO - --------------------------------
2025-12-02 06:14:01,546 - __main__ - INFO - Horizon: 1
2025-12-02 06:14:01,546 - __main__ - INFO - --------------------------------
2025-12-02 06:14:01,546 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-02 06:14:01,547 - __main__ - INFO - nb_observations recalcul√© pour horizon=1
2025-12-02 06:14:01,547 - __main__ - INFO -    Colonnes TO compt√©es: J-60 √† J-2 (59 colonnes)
2025-12-02 06:14:01,548 - __main__ - INFO -    Minimum: 59
2025-12-02 06:14:01,548 - __main__ - INFO -    Maximum: 59
2025-12-02 06:14:01,548 - __main__ - INFO -    Moyenne: 59.0
2025-12-02 06:14:01,548 - __main__ - INFO - Features TO historiques: J-60 √† J-2 (59 colonnes)
2025-12-02 06:14:01,548 - __main__ - INFO - Nombre total de features: 99
2025-12-02 06:14:01,548 - __main__ - INFO -    - TO historiques: 59
2025-12-02 06:14:01,548 - __main__ - INFO -    - Features PM: 7
2025-12-02 06:14:01,548 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-02 06:14:01,548 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-02 06:14:01,548 - __main__ - INFO -    - Features concurrents: 6
2025-12-02 06:14:01,548 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-02 06:14:01,548 - __main__ - INFO -    - Autres features: 11
2025-12-02 06:14:01,648 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results\6N8\J-1\training_data_before_scaling.csv
2025-12-02 06:14:01,648 - __main__ - INFO -    Shape: (1463, 102)
2025-12-02 06:14:01,648 - __main__ - INFO -    Colonnes: stay_date, hotCode, 99 features, J-0
2025-12-02 06:14:01,648 - __main__ - INFO - X shape: (1463, 99), y shape: (1463,)
2025-12-02 06:14:01,648 - __main__ - INFO - ================================================================================
2025-12-02 06:14:01,649 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-02 06:14:01,649 - __main__ - INFO - ================================================================================
2025-12-02 06:14:01,654 - __main__ - INFO - Train: (1170, 99), Validation: (293, 99)
2025-12-02 06:14:01,654 - __main__ - INFO - Configuration de la recherche:
2025-12-02 06:14:01,654 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-02 06:14:01,654 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-02 06:14:01,654 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-02 06:14:01,654 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-02 06:14:01,654 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-02 06:14:50,380 - __main__ - INFO - ================================================================================
2025-12-02 06:14:50,380 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-02 06:14:50,380 - __main__ - INFO - ================================================================================
2025-12-02 06:14:50,380 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0103
2025-12-02 06:14:50,380 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-02 06:14:50,381 - __main__ - INFO -    - subsample: 0.9
2025-12-02 06:14:50,381 - __main__ - INFO -    - reg_lambda: 2.0
2025-12-02 06:14:50,381 - __main__ - INFO -    - reg_alpha: 0
2025-12-02 06:14:50,381 - __main__ - INFO -    - n_estimators: 300
2025-12-02 06:14:50,381 - __main__ - INFO -    - min_child_weight: 3
2025-12-02 06:14:50,381 - __main__ - INFO -    - max_depth: 9
2025-12-02 06:14:50,381 - __main__ - INFO -    - learning_rate: 0.03
2025-12-02 06:14:50,381 - __main__ - INFO -    - colsample_bytree: 0.9
2025-12-02 06:14:50,384 - __main__ - INFO - 
Performances sur validation:
2025-12-02 06:14:50,384 - __main__ - INFO -    - MAE: 0.0093
2025-12-02 06:14:50,384 - __main__ - INFO -    - R¬≤: 0.9979
2025-12-02 06:14:50,384 - __main__ - INFO - ================================================================================
2025-12-02 06:14:50,385 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-02 06:14:50,385 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-02 06:14:50,386 - __main__ - INFO - Train: (1170, 99), Test: (293, 99)
2025-12-02 06:14:52,087 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-02 06:14:52,168 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results\6N8\J-1\test_predictions.csv
2025-12-02 06:14:52,168 - __main__ - INFO -    Shape: (293, 105)
2025-12-02 06:14:52,168 - __main__ - INFO -    Colonnes: stay_date, hotCode, 99 features + y_test + y_pred + error + abs_error
2025-12-02 06:14:52,169 - __main__ - INFO -    MAE moyen: 0.0093
2025-12-02 06:14:52,175 - __main__ - INFO - üìä Test MAE: 0.0093
2025-12-02 06:14:52,175 - __main__ - INFO - üìä Test R¬≤: 0.9979
2025-12-02 06:14:52,176 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-02 06:14:52,552 - __main__ - INFO - üìà Graphique sauvegard√©: results\6N8\J-1\xgb_scatter_plot.png
2025-12-02 06:14:52,946 - __main__ - INFO - üìà Graphique sauvegard√©: results\6N8\J-1\xgb_feature_importance.png
2025-12-02 06:14:52,958 - __main__ - INFO - Sauvegarde locale du mod√®le dans results\6N8\J-1\models...
2025-12-02 06:14:52,985 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results\6N8\J-1\models\xgb_to_predictor.joblib
2025-12-02 06:14:52,985 - __main__ - INFO - üíæ Scaler sauvegard√©: results\6N8\J-1\models\xgb_scaler.joblib
2025-12-02 06:14:52,985 - __main__ - INFO - üíæ Features sauvegard√©es: results\6N8\J-1\models\feature_columns.txt
2025-12-02 06:14:52,985 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-02 06:14:52,986 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-02 06:14:52,986 - __main__ - INFO -    Container: ml-models
2025-12-02 06:14:53,483 - __main__ - INFO -    Container existant trouv√©
2025-12-02 06:14:53,483 - __main__ - INFO -    Chemin Azure: predictTo/6N8/J-1/
2025-12-02 06:14:53,627 - __main__ - INFO -    ‚úì predictTo/6N8/J-1/models/xgb_to_predictor.joblib
2025-12-02 06:14:53,670 - __main__ - INFO -    ‚úì predictTo/6N8/J-1/models/xgb_scaler.joblib
2025-12-02 06:14:53,687 - __main__ - INFO -    ‚úì predictTo/6N8/J-1/models/feature_columns.txt
2025-12-02 06:14:53,704 - __main__ - INFO -    ‚úì predictTo/6N8/J-1/xgb_scatter_plot.png
2025-12-02 06:14:53,718 - __main__ - INFO -    ‚úì predictTo/6N8/J-1/xgb_feature_importance.png
2025-12-02 06:14:53,831 - __main__ - INFO -    ‚úì predictTo/6N8/J-1/training_data_before_scaling.csv
2025-12-02 06:14:53,870 - __main__ - INFO -    ‚úì predictTo/6N8/J-1/test_predictions.csv
2025-12-02 06:14:53,871 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-02 06:14:53,871 - __main__ - INFO -    URL: ml-models/predictTo/6N8/J-1/
2025-12-02 06:14:53,871 - __main__ - INFO - ================================================================================
2025-12-02 06:14:53,872 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-02 06:14:53,872 - __main__ - INFO - ================================================================================
2025-12-02 06:14:53,872 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-02 06:14:53,872 - __main__ - INFO -    Train MAE:  0.0007
2025-12-02 06:14:53,872 - __main__ - INFO -    Train RMSE: 0.0017
2025-12-02 06:14:53,872 - __main__ - INFO -    Train R¬≤:   1.0000
2025-12-02 06:14:53,872 - __main__ - INFO -    Test MAE:   0.0093
2025-12-02 06:14:53,872 - __main__ - INFO -    Test RMSE:  0.0175
2025-12-02 06:14:53,872 - __main__ - INFO -    Test R¬≤:    0.9979
2025-12-02 06:14:58,916 - __main__ - INFO - ================================================================================
2025-12-02 06:14:58,916 - __main__ - INFO - D√âBUT DE L'ENTRA√éNEMENT DU MOD√àLE XGBOOST
2025-12-02 06:14:58,917 - __main__ - INFO - ================================================================================
2025-12-02 06:14:58,917 - __main__ - INFO - ‚úÖ Fichier .env d√©tect√© et charg√©
2025-12-02 06:14:58,920 - __main__ - INFO - ‚úÖ Configuration charg√©e depuis config_predictTo.yaml
2025-12-02 06:14:58,920 - __main__ - INFO - üîß Override de l'horizon: 7 ‚Üí 0
2025-12-02 06:14:58,920 - __main__ - INFO - Initialisation du XGBoostOccupancyPredictor
2025-12-02 06:14:58,920 - __main__ - INFO - Mode: Entra√Ænement pour l'h√¥tel 6N8
2025-12-02 06:14:58,920 - __main__ - INFO - Configuration apr√®s substitution: {'clustering_base_dir': '../cluster/results', 'clustering_results_path': '../cluster/results/6N8/clustering_results.csv', 'indicateurs_path': '../data/6N8/Indicateurs.csv', 'rateShopper_path': '../data/6N8/rateShopper.csv', 'prediction_horizon': 0, 'test_size': 0.2, 'random_state': 42, 'model_params': {'n_estimators': 600, 'learning_rate': 0.05, 'max_depth': 7, 'subsample': 0.9, 'colsample_bytree': 0.9, 'min_child_weight': 1, 'reg_lambda': 1.0, 'n_jobs': -1, 'random_state': 42}, 'azure_container': 'ml-models', 'save_to_azure': True, 'output_base_dir': 'results', 'hyperparam_search': {'n_iter': 30, 'cv_folds': 3}}
2025-12-02 06:14:58,920 - __main__ - INFO - Chargement des donn√©es...
2025-12-02 06:14:58,920 - __main__ - INFO - Chargement des clusters depuis: ../cluster/results\6N8\clustering_results.csv
2025-12-02 06:14:58,931 - __main__ - INFO - ‚úÖ Clusters charg√©s: (1462, 65)
2025-12-02 06:14:59,122 - __main__ - INFO - ‚úÖ Indicateurs charg√©s: (268538, 17)
2025-12-02 06:14:59,123 - __main__ - INFO - üè® Filtrage des donn√©es pour l'h√¥tel: 6N8
2025-12-02 06:14:59,143 - __main__ - INFO -    Clusters filtr√©s: (1462, 65)
2025-12-02 06:14:59,144 - __main__ - INFO -    Indicateurs filtr√©s: (268538, 17)
2025-12-02 06:14:59,144 - __main__ - INFO - Pr√©paration des donn√©es...
2025-12-02 06:14:59,224 - __main__ - INFO - PM pivot shape: (1462, 63)
2025-12-02 06:14:59,244 - __main__ - INFO - Ant pivot shape: (1462, 63)
2025-12-02 06:14:59,264 - __main__ - INFO - Ds pivot shape: (1462, 63)
2025-12-02 06:14:59,273 - __main__ - INFO - DataFrame fusionn√©: (1462, 248)
2025-12-02 06:14:59,273 - __main__ - INFO - Calcul des features PM sur donn√©es J-1 √† J-60 (pas de data leakage)
2025-12-02 06:14:59,273 - __main__ - INFO -    Colonnes PM utilis√©es: 60
2025-12-02 06:15:00,385 - __main__ - INFO - Features PM ajout√©es: (1462, 255)
2025-12-02 06:15:00,443 - __main__ - INFO - Calcul des features Ant (anticipation) sur donn√©es J-1 √† J-60
2025-12-02 06:15:00,443 - __main__ - INFO -    Colonnes Ant utilis√©es: 60
2025-12-02 06:15:01,395 - __main__ - INFO - Features Ant ajout√©es: (1462, 261)
2025-12-02 06:15:01,395 - __main__ - INFO - Calcul des features Ds (dur√©e s√©jour) sur donn√©es J-1 √† J-60
2025-12-02 06:15:01,395 - __main__ - INFO -    Colonnes Ds utilis√©es: 60
2025-12-02 06:15:02,363 - __main__ - INFO - Features Ds ajout√©es: (1462, 267)
2025-12-02 06:15:02,363 - __main__ - INFO - Chargement des prix concurrents depuis ../data/6N8/rateShopper.csv...
2025-12-02 06:15:02,366 - __main__ - INFO - Prix concurrents charg√©s: (288, 7)
2025-12-02 06:15:02,367 - __main__ - INFO - Pr√©paration des features concurrentes (prix m√©dian)...
2025-12-02 06:15:02,373 - __main__ - INFO -    Features concurrentes calcul√©es sur J-1 √† J-60
2025-12-02 06:15:02,380 - __main__ - INFO - Construction des s√©ries Gap et Elasticity...
2025-12-02 06:15:03,785 - __main__ - INFO - Features concurrentes + Gap/Elasticity ajout√©es (10 features). Shape: (1462, 277)
2025-12-02 06:15:03,789 - __main__ - INFO - Ajout de ToF1 (TO final ann√©e N-1)...
2025-12-02 06:15:03,797 - __main__ - INFO -    ToF1 ajout√© : 669 valeurs non-nulles sur 1463
2025-12-02 06:15:03,797 - __main__ - INFO - Ajout des features jours f√©ri√©s...
2025-12-02 06:15:04,201 - __main__ - INFO - Ajout des vacances scolaires...
2025-12-02 06:15:04,295 - __main__ - INFO - Ajout des weekends prolong√©s...
2025-12-02 06:15:04,309 - __main__ - INFO - Features jours f√©ri√©s et vacances ajout√©es. Shape: (1463, 286)
2025-12-02 06:15:04,310 - __main__ - INFO -    - Jours f√©ri√©s: 45 (3.08%)
2025-12-02 06:15:04,310 - __main__ - INFO -    - Jours de pont: 88 (6.02%)
2025-12-02 06:15:04,310 - __main__ - INFO -    - Distance au f√©ri√©: min=0, max=90, moyenne=29.8
2025-12-02 06:15:04,310 - __main__ - INFO -    - Vacances scolaires: 604 (41.29%)
2025-12-02 06:15:04,310 - __main__ - INFO -    - Weekends 3j: 57 (3.90%)
2025-12-02 06:15:04,310 - __main__ - INFO -    - Weekends 4j: 106 (7.25%)
2025-12-02 06:15:04,314 - __main__ - INFO - Cr√©ation des features et target...
2025-12-02 06:15:04,314 - __main__ - INFO - --------------------------------
2025-12-02 06:15:04,314 - __main__ - INFO - Horizon: 0
2025-12-02 06:15:04,314 - __main__ - INFO - --------------------------------
2025-12-02 06:15:04,314 - __main__ - INFO - df.columns: Index(['hotCode', 'stay_date', 'nb_observations', 'J-60', 'J-59', 'J-58',
       'J-57', 'J-56', 'J-55', 'J-54',
       ...
       'comp_trend_changes', 'month', 'dayofweek', 'ToF1', 'is_holiday_fr',
       'is_bridge_day', 'days_to_holiday', 'is_vacances_scolaires',
       'is_long_weekend_3j', 'is_long_weekend_4j'],
      dtype='object', length=286)
2025-12-02 06:15:04,315 - __main__ - INFO - nb_observations recalcul√© pour horizon=0
2025-12-02 06:15:04,315 - __main__ - INFO -    Colonnes TO compt√©es: J-60 √† J-1 (60 colonnes)
2025-12-02 06:15:04,315 - __main__ - INFO -    Minimum: 60
2025-12-02 06:15:04,316 - __main__ - INFO -    Maximum: 60
2025-12-02 06:15:04,316 - __main__ - INFO -    Moyenne: 60.0
2025-12-02 06:15:04,316 - __main__ - INFO - Features TO historiques: J-60 √† J-1 (60 colonnes)
2025-12-02 06:15:04,316 - __main__ - INFO - Nombre total de features: 100
2025-12-02 06:15:04,316 - __main__ - INFO -    - TO historiques: 60
2025-12-02 06:15:04,316 - __main__ - INFO -    - Features PM: 7
2025-12-02 06:15:04,316 - __main__ - INFO -    - Features Ant (anticipation): 6
2025-12-02 06:15:04,316 - __main__ - INFO -    - Features Ds (dur√©e s√©jour): 6
2025-12-02 06:15:04,316 - __main__ - INFO -    - Features concurrents: 6
2025-12-02 06:15:04,316 - __main__ - INFO -    - Features Gap/Elasticity: 4
2025-12-02 06:15:04,316 - __main__ - INFO -    - Autres features: 11
2025-12-02 06:15:04,410 - __main__ - INFO - üíæ Donn√©es d'entra√Ænement sauvegard√©es: results\6N8\J-0\training_data_before_scaling.csv
2025-12-02 06:15:04,410 - __main__ - INFO -    Shape: (1463, 103)
2025-12-02 06:15:04,411 - __main__ - INFO -    Colonnes: stay_date, hotCode, 100 features, J-0
2025-12-02 06:15:04,411 - __main__ - INFO - X shape: (1463, 100), y shape: (1463,)
2025-12-02 06:15:04,411 - __main__ - INFO - ================================================================================
2025-12-02 06:15:04,411 - __main__ - INFO - RECHERCHE D'HYPERPARAM√àTRES (RANDOMIZED SEARCH)
2025-12-02 06:15:04,411 - __main__ - INFO - ================================================================================
2025-12-02 06:15:04,417 - __main__ - INFO - Train: (1170, 100), Validation: (293, 100)
2025-12-02 06:15:04,418 - __main__ - INFO - Configuration de la recherche:
2025-12-02 06:15:04,418 - __main__ - INFO -    - Nombre d'it√©rations: 30
2025-12-02 06:15:04,418 - __main__ - INFO -    - Cross-validation: 3 folds
2025-12-02 06:15:04,418 - __main__ - INFO -    - Nombre total d'entra√Ænements: 90
2025-12-02 06:15:04,418 - __main__ - INFO -    - M√©trique: neg_mean_absolute_error
2025-12-02 06:15:04,418 - __main__ - INFO - 
D√©marrage de la recherche d'hyperparam√®tres...
2025-12-02 06:15:49,892 - __main__ - INFO - ================================================================================
2025-12-02 06:15:49,892 - __main__ - INFO - R√âSULTATS DE LA RECHERCHE
2025-12-02 06:15:49,892 - __main__ - INFO - ================================================================================
2025-12-02 06:15:49,892 - __main__ - INFO - Meilleur score (MAE sur CV): 0.0065
2025-12-02 06:15:49,892 - __main__ - INFO - Meilleurs param√®tres trouv√©s:
2025-12-02 06:15:49,892 - __main__ - INFO -    - subsample: 0.95
2025-12-02 06:15:49,892 - __main__ - INFO -    - reg_lambda: 1.0
2025-12-02 06:15:49,892 - __main__ - INFO -    - reg_alpha: 0
2025-12-02 06:15:49,892 - __main__ - INFO -    - n_estimators: 500
2025-12-02 06:15:49,892 - __main__ - INFO -    - min_child_weight: 3
2025-12-02 06:15:49,893 - __main__ - INFO -    - max_depth: 5
2025-12-02 06:15:49,893 - __main__ - INFO -    - learning_rate: 0.05
2025-12-02 06:15:49,893 - __main__ - INFO -    - colsample_bytree: 0.95
2025-12-02 06:15:49,896 - __main__ - INFO - 
Performances sur validation:
2025-12-02 06:15:49,896 - __main__ - INFO -    - MAE: 0.0048
2025-12-02 06:15:49,896 - __main__ - INFO -    - R¬≤: 0.9995
2025-12-02 06:15:49,896 - __main__ - INFO - ================================================================================
2025-12-02 06:15:49,896 - __main__ - INFO - 
üîß Mise √† jour de la configuration avec les meilleurs param√®tres...
2025-12-02 06:15:49,897 - __main__ - INFO - Entra√Ænement du mod√®le XGBoost...
2025-12-02 06:15:49,898 - __main__ - INFO - Train: (1170, 100), Test: (293, 100)
2025-12-02 06:15:50,822 - __main__ - INFO - Mod√®le entra√Æn√© avec succ√®s
2025-12-02 06:15:50,902 - __main__ - INFO - üíæ Pr√©dictions de test sauvegard√©es: results\6N8\J-0\test_predictions.csv
2025-12-02 06:15:50,902 - __main__ - INFO -    Shape: (293, 106)
2025-12-02 06:15:50,902 - __main__ - INFO -    Colonnes: stay_date, hotCode, 100 features + y_test + y_pred + error + abs_error
2025-12-02 06:15:50,903 - __main__ - INFO -    MAE moyen: 0.0048
2025-12-02 06:15:50,907 - __main__ - INFO - üìä Test MAE: 0.0048
2025-12-02 06:15:50,907 - __main__ - INFO - üìä Test R¬≤: 0.9995
2025-12-02 06:15:50,907 - __main__ - INFO - √âvaluation du mod√®le...
2025-12-02 06:15:51,340 - __main__ - INFO - üìà Graphique sauvegard√©: results\6N8\J-0\xgb_scatter_plot.png
2025-12-02 06:15:51,732 - __main__ - INFO - üìà Graphique sauvegard√©: results\6N8\J-0\xgb_feature_importance.png
2025-12-02 06:15:51,744 - __main__ - INFO - Sauvegarde locale du mod√®le dans results\6N8\J-0\models...
2025-12-02 06:15:51,770 - __main__ - INFO - üíæ Mod√®le sauvegard√©: results\6N8\J-0\models\xgb_to_predictor.joblib
2025-12-02 06:15:51,770 - __main__ - INFO - üíæ Scaler sauvegard√©: results\6N8\J-0\models\xgb_scaler.joblib
2025-12-02 06:15:51,771 - __main__ - INFO - üíæ Features sauvegard√©es: results\6N8\J-0\models\feature_columns.txt
2025-12-02 06:15:51,771 - __main__ - INFO - 
üì§ Pr√©paration de l'upload Azure (7 fichiers)...
2025-12-02 06:15:51,771 - __main__ - INFO - ‚òÅÔ∏è  Sauvegarde dans Azure Blob Storage...
2025-12-02 06:15:51,771 - __main__ - INFO -    Container: ml-models
2025-12-02 06:15:52,287 - __main__ - INFO -    Container existant trouv√©
2025-12-02 06:15:52,287 - __main__ - INFO -    Chemin Azure: predictTo/6N8/J-0/
2025-12-02 06:15:52,377 - __main__ - INFO -    ‚úì predictTo/6N8/J-0/models/xgb_to_predictor.joblib
2025-12-02 06:15:52,394 - __main__ - INFO -    ‚úì predictTo/6N8/J-0/models/xgb_scaler.joblib
2025-12-02 06:15:52,412 - __main__ - INFO -    ‚úì predictTo/6N8/J-0/models/feature_columns.txt
2025-12-02 06:15:52,430 - __main__ - INFO -    ‚úì predictTo/6N8/J-0/xgb_scatter_plot.png
2025-12-02 06:15:52,448 - __main__ - INFO -    ‚úì predictTo/6N8/J-0/xgb_feature_importance.png
2025-12-02 06:15:52,532 - __main__ - INFO -    ‚úì predictTo/6N8/J-0/training_data_before_scaling.csv
2025-12-02 06:15:52,569 - __main__ - INFO -    ‚úì predictTo/6N8/J-0/test_predictions.csv
2025-12-02 06:15:52,570 - __main__ - INFO - ‚úÖ 7 fichier(s) upload√©(s) dans Azure Blob Storage
2025-12-02 06:15:52,570 - __main__ - INFO -    URL: ml-models/predictTo/6N8/J-0/
2025-12-02 06:15:52,571 - __main__ - INFO - ================================================================================
2025-12-02 06:15:52,571 - __main__ - INFO - ‚úÖ ENTRA√éNEMENT TERMIN√â AVEC SUCC√àS
2025-12-02 06:15:52,571 - __main__ - INFO - ================================================================================
2025-12-02 06:15:52,571 - __main__ - INFO - 
üìä M√âTRIQUES FINALES:
2025-12-02 06:15:52,571 - __main__ - INFO -    Train MAE:  0.0004
2025-12-02 06:15:52,571 - __main__ - INFO -    Train RMSE: 0.0007
2025-12-02 06:15:52,571 - __main__ - INFO -    Train R¬≤:   1.0000
2025-12-02 06:15:52,571 - __main__ - INFO -    Test MAE:   0.0048
2025-12-02 06:15:52,571 - __main__ - INFO -    Test RMSE:  0.0088
2025-12-02 06:15:52,571 - __main__ - INFO -    Test R¬≤:    0.9995
